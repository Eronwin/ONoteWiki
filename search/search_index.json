{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Preface The purpose of this blog is just to collect the knowledge fragments of the author, to become a better developer and to facilitate the review of learning content. In addition, the level of this blog is still in the green stage, and the author will try to run in with it for high efficiency.","title":"Preface"},{"location":"#preface","text":"The purpose of this blog is just to collect the knowledge fragments of the author, to become a better developer and to facilitate the review of learning content. In addition, the level of this blog is still in the green stage, and the author will try to run in with it for high efficiency.","title":"Preface"},{"location":"Author/","text":"Introduction Hello, I am kekao whose name is Xiayu, in Chinese \u590f\u5b87 I love software development and system research Education B.Eng Network Engineering ,2023 Shandong University of Science and Technology Competition International Collegiate Programming Contest 512 / 576 Place in The \\(46^{th}\\) International Collegiate Programming Contest At ShenYang 456 / 800 Place in The \\(46^{th}\\) International Collegiate Programming Contest At JiNan China Collegiate Programming Contest 278 / 317 Place in The \\(7^{th}\\) China Collegiate Programming Contest At Harbin Blue Bridge Cup National Second Prize in The \\(12^{th}\\) Blue Bridge Cup Software C/C++ Programming Group National Second Prize in The \\(13^{th}\\) Blue Bridge Cup Software Python Programming Group Programming Ability Test For Emerging Engineering 161 / 615 Place in Basic Level International Collegiate Programming Contest At ShanDong Province 143 / 264 Place (Bronze) in The \\(12^{th}\\) ICPC China ShanDong Provincial Programming Contest 171 / 286 Place (Bronze) in The \\(11^{th}\\) ICPC China ShanDong Provincial Programming Contest","title":"Author"},{"location":"Author/#introduction","text":"Hello, I am kekao whose name is Xiayu, in Chinese \u590f\u5b87 I love software development and system research","title":"Introduction"},{"location":"Author/#education","text":"B.Eng Network Engineering ,2023 Shandong University of Science and Technology","title":"Education"},{"location":"Author/#competition","text":"International Collegiate Programming Contest 512 / 576 Place in The \\(46^{th}\\) International Collegiate Programming Contest At ShenYang 456 / 800 Place in The \\(46^{th}\\) International Collegiate Programming Contest At JiNan China Collegiate Programming Contest 278 / 317 Place in The \\(7^{th}\\) China Collegiate Programming Contest At Harbin Blue Bridge Cup National Second Prize in The \\(12^{th}\\) Blue Bridge Cup Software C/C++ Programming Group National Second Prize in The \\(13^{th}\\) Blue Bridge Cup Software Python Programming Group Programming Ability Test For Emerging Engineering 161 / 615 Place in Basic Level International Collegiate Programming Contest At ShanDong Province 143 / 264 Place (Bronze) in The \\(12^{th}\\) ICPC China ShanDong Provincial Programming Contest 171 / 286 Place (Bronze) in The \\(11^{th}\\) ICPC China ShanDong Provincial Programming Contest","title":"Competition"},{"location":"Introduction/","text":"","title":"Introduction"},{"location":"Advanced_programming_language/","text":"Introduction Designed to record personal understanding and usage of various high-level programming languages","title":"Introduction"},{"location":"Advanced_programming_language/#introduction","text":"Designed to record personal understanding and usage of various high-level programming languages","title":"Introduction"},{"location":"Advanced_programming_language/C%2B%2B/","text":"","title":"C++"},{"location":"Advanced_programming_language/Css/","text":"","title":"Css"},{"location":"Advanced_programming_language/Golang/","text":"","title":"Golang"},{"location":"Advanced_programming_language/Html/","text":"","title":"Html"},{"location":"Advanced_programming_language/JavaScript/","text":"","title":"JavaScript"},{"location":"Advanced_programming_language/Python/","text":"","title":"Python"},{"location":"Advanced_programming_language/Rust/","text":"","title":"Rust"},{"location":"Advanced_programming_language/TypeScript/","text":"","title":"TypeScript"},{"location":"Advanced_programming_language/lua/","text":"","title":"Lua"},{"location":"Algorithm/","text":"Introduction Designed to record algorithms encountered in some matches Acknowledgement MIT 6.046J","title":"Introduction"},{"location":"Algorithm/#introduction","text":"Designed to record algorithms encountered in some matches","title":"Introduction"},{"location":"Algorithm/#acknowledgement","text":"MIT 6.046J","title":"Acknowledgement"},{"location":"Machine_Learning/","text":"Introduction Introduction to the principles, mathematical derivation and practical application of algorithms in the field of machine learning Acknowledgement MIT 6.042J MIT 6.036J Mathematical principles(\u767d\u677f\u63a8\u5bfc) for Shuhuai008 Bilibili","title":"Introduction"},{"location":"Machine_Learning/#introduction","text":"Introduction to the principles, mathematical derivation and practical application of algorithms in the field of machine learning","title":"Introduction"},{"location":"Machine_Learning/#acknowledgement","text":"MIT 6.042J MIT 6.036J Mathematical principles(\u767d\u677f\u63a8\u5bfc) for Shuhuai008 Bilibili","title":"Acknowledgement"},{"location":"Machine_Learning/1.Intro_Math/","text":"Introduction \u5bf9\u6982\u7387\u7684\u8be0\u91ca\u6709\u4e24\u5927\u5b66\u6d3e\uff0c\u4e00\u79cd\u662f\u9891\u7387\u6d3e\u53e6\u4e00\u79cd\u662f\u8d1d\u53f6\u65af\u6d3e\u3002\u540e\u9762\u6211\u4eec\u5bf9\u89c2\u6d4b\u96c6\u91c7\u7528\u4e0b\u9762\u8bb0\u53f7\uff1a $$ X_{N\\times p}=(x_{1},x_{2},\\cdots,x_{N})^{T},x_{i}=(x_{i1},x_{i2},\\cdots,x_{ip})^{T} $$ \u8fd9\u4e2a\u8bb0\u53f7\u8868\u793a\u6709 \\(N\\) \u4e2a\u6837\u672c\uff0c\u6bcf\u4e2a\u6837\u672c\u90fd\u662f \\(p\\) \u7ef4\u5411\u91cf\u3002\u5176\u4e2d\u6bcf\u4e2a\u89c2\u6d4b\u90fd\u662f\u7531 \\(p(x|\\theta)\\) \u751f\u6210\u7684\u3002 \u9891\u7387\u6d3e\u7684\u89c2\u70b9 \\(p(x|\\theta)\\) \u4e2d\u7684 \\(\\theta\\) \u662f\u4e00\u4e2a\u5e38\u91cf\u3002\u5bf9\u4e8e \\(N\\) \u4e2a\u89c2\u6d4b\u6765\u8bf4\u89c2\u6d4b\u96c6\u7684\u6982\u7387\u4e3a \\(p(X|\\theta)\\mathop{=}\\limits _{iid}\\prod\\limits _{i=1}^{N}p(x_{i}|\\theta))\\) \u3002\u4e3a\u4e86\u6c42 \\(\\theta\\) \u7684\u5927\u5c0f\uff0c\u6211\u4eec\u91c7\u7528\u6700\u5927\u5bf9\u6570\u4f3c\u7136MLE\u7684\u65b9\u6cd5\uff1a \\[ \\theta_{MLE}=\\mathop{argmax}\\limits _{\\theta}\\log p(X|\\theta)\\mathop{=}\\limits _{iid}\\mathop{argmax}\\limits _{\\theta}\\sum\\limits _{i=1}^{N}\\log p(x_{i}|\\theta) \\] \u8d1d\u53f6\u65af\u6d3e\u7684\u89c2\u70b9 \u8d1d\u53f6\u65af\u6d3e\u8ba4\u4e3a \\(p(x|\\theta)\\) \u4e2d\u7684 \\(\\theta\\) \u4e0d\u662f\u4e00\u4e2a\u5e38\u91cf\u3002\u8fd9\u4e2a \\(\\theta\\) \u6ee1\u8db3\u4e00\u4e2a\u9884\u8bbe\u7684\u5148\u9a8c\u7684\u5206\u5e03 \\(\\theta\\sim p(\\theta)\\) \u3002\u4e8e\u662f\u6839\u636e\u8d1d\u53f6\u65af\u5b9a\u7406\u4f9d\u8d56\u89c2\u6d4b\u96c6\u53c2\u6570\u7684\u540e\u9a8c\u53ef\u4ee5\u5199\u6210\uff1a \\[ p(\\theta|X)=\\frac{p(X|\\theta)\\cdot p(\\theta)}{p(X)}=\\frac{p(X|\\theta)\\cdot p(\\theta)}{\\int\\limits _{\\theta}p(X|\\theta)\\cdot p(\\theta)d\\theta} \\] \u4e3a\u4e86\u6c42 \\(\\theta\\) \u7684\u503c\uff0c\u6211\u4eec\u8981\u6700\u5927\u5316\u8fd9\u4e2a\u53c2\u6570\u540e\u9a8cMAP\uff1a \\[ \\theta_{MAP}=\\mathop{argmax}\\limits _{\\theta}p(\\theta|X)=\\mathop{argmax}\\limits _{\\theta}p(X|\\theta)\\cdot p(\\theta) \\] \u5176\u4e2d\u7b2c\u4e8c\u4e2a\u7b49\u53f7\u662f\u7531\u4e8e\u5206\u6bcd\u548c \\(\\theta\\) \u6ca1\u6709\u5173\u7cfb\u3002\u6c42\u89e3\u8fd9\u4e2a \\(\\theta\\) \u503c\u540e\u8ba1\u7b97 \\(\\frac{p(X|\\theta)\\cdot p(\\theta)}{\\int\\limits _{\\theta}p(X|\\theta)\\cdot p(\\theta)d\\theta}\\) \uff0c\u5c31\u5f97\u5230\u4e86\u53c2\u6570\u7684\u540e\u9a8c\u6982\u7387\u3002\u5176\u4e2d \\(p(X|\\theta)\\) \u53eb\u4f3c\u7136\uff0c\u662f\u6211\u4eec\u7684\u6a21\u578b\u5206\u5e03\u3002\u5f97\u5230\u4e86\u53c2\u6570\u7684\u540e\u9a8c\u5206\u5e03\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5206\u5e03\u7528\u4e8e\u9884\u6d4b\u8d1d\u53f6\u65af\u9884\u6d4b\uff1a $$ p(x_{new}|X)=\\int\\limits {\\theta}p(x |\\theta)\\cdot p(\\theta|X)d\\theta $$ \u5176\u4e2d\u79ef\u5206\u4e2d\u7684\u88ab\u4e58\u6570\u662f\u6a21\u578b\uff0c\u4e58\u6570\u662f\u540e\u9a8c\u5206\u5e03\u3002 \u5c0f\u7ed3 \u9891\u7387\u6d3e\u548c\u8d1d\u53f6\u65af\u6d3e\u5206\u522b\u7ed9\u51fa\u4e86\u4e00\u7cfb\u5217\u7684\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u3002\u9891\u7387\u6d3e\u7684\u89c2\u70b9\u5bfc\u51fa\u4e86\u4e00\u7cfb\u5217\u7684\u7edf\u8ba1\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u800c\u8d1d\u53f6\u65af\u6d3e\u5bfc\u51fa\u4e86\u6982\u7387\u56fe\u7406\u8bba\u3002\u5728\u5e94\u7528\u9891\u7387\u6d3e\u7684 MLE \u65b9\u6cd5\u65f6\u6700\u4f18\u5316\u7406\u8bba\u5360\u6709\u91cd\u8981\u5730\u4f4d\u3002\u800c\u8d1d\u53f6\u65af\u6d3e\u7684\u7b97\u6cd5\u65e0\u8bba\u662f\u540e\u9a8c\u6982\u7387\u7684\u5efa\u6a21\u8fd8\u662f\u5e94\u7528\u8fd9\u4e2a\u540e\u9a8c\u8fdb\u884c\u63a8\u65ad\u65f6\u79ef\u5206\u5360\u6709\u91cd\u8981\u5730\u4f4d\u3002\u56e0\u6b64\u91c7\u6837\u79ef\u5206\u65b9\u6cd5\u5982 MCMC \u6709\u5f88\u591a\u5e94\u7528\u3002 MathBasics \u9ad8\u65af\u5206\u5e03 \u4e00\u7ef4\u60c5\u51b5 MLE \u9ad8\u65af\u5206\u5e03\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u5360\u6709\u4e3e\u8db3\u8f7b\u91cd\u7684\u4f5c\u7528\u3002\u5728 MLE \u65b9\u6cd5\u4e2d\uff1a $$ \\theta=(\\mu,\\Sigma)=(\\mu,\\sigma^{2}),\\theta_{MLE}=\\mathop{argmax}\\limits {\\theta}\\log p(X|\\theta)\\mathop{=}\\limits \\mathop{argmax}\\limits {\\theta}\\sum\\limits ^{N}\\log p(x_{i}|\\theta) $$ \u4e00\u822c\u5730\uff0c\u9ad8\u65af\u5206\u5e03\u7684\u6982\u7387\u5bc6\u5ea6\u51fd\u6570PDF\u5199\u4e3a\uff1a $$ p(x|\\mu,\\Sigma)=\\frac{1}{(2\\pi)^{p/2}|\\Sigma|^{1/2}}e^{-\\frac{1}{2}(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)} $$ \u5e26\u5165 MLE \u4e2d\u6211\u4eec\u8003\u8651\u4e00\u7ef4\u7684\u60c5\u51b5 $$ \\log p(X|\\theta)=\\sum\\limits {i=1}^{N}\\log p(x |\\theta)=\\sum\\limits {i=1}^{N}\\log\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp(-(x -\\mu)^{2}/2\\sigma^{2}) $$ \u9996\u5148\u5bf9 \\(\\mu\\) \u7684\u6781\u503c\u53ef\u4ee5\u5f97\u5230 \uff1a $$ \\mu_{MLE}=\\mathop{argmax}\\limits {\\mu}\\log p(X|\\theta)=\\mathop{argmax}\\limits \\sum\\limits {i=1}^{N}(x -\\mu)^{2} $$ \u4e8e\u662f\uff1a $$ \\frac{\\partial}{\\partial\\mu}\\sum\\limits {i=1}^{N}(x -\\mu)^{2}=0\\longrightarrow\\mu_{MLE}=\\frac{1}{N}\\sum\\limits {i=1}^{N}x $$ \u5176\u6b21\u5bf9 \\(\\theta\\) \u4e2d\u7684\u53e6\u4e00\u4e2a\u53c2\u6570 \\(\\sigma\\) \uff0c\u6709\uff1a $$ \\begin{align} \\sigma_{MLE}=\\mathop{argmax}\\limits {\\sigma}\\log p(X|\\theta)&=\\mathop{argmax}\\limits \\sum\\limits {i=1}^{N}[-\\log\\sigma-\\frac{1}{2\\sigma^{2}}(x -\\mu)^{2}]\\nonumber\\ &=\\mathop{argmin}\\limits {\\sigma}\\sum\\limits ^{N}[\\log\\sigma+\\frac{1}{2\\sigma^{2}}(x_{i}-\\mu)^{2}] \\end{align} $$ \u4e8e\u662f\uff1a $$ \\frac{\\partial}{\\partial\\sigma}\\sum\\limits {i=1}^{N}[\\log\\sigma+\\frac{1}{2\\sigma^{2}}(x -\\mu)^{2}]=0\\longrightarrow\\sigma_{MLE}^{2}=\\frac{1}{N}\\sum\\limits {i=1}^{N}(x -\\mu)^{2} $$ \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u4e0a\u9762\u7684\u63a8\u5bfc\u4e2d\uff0c\u9996\u5148\u5bf9 \\(\\mu\\) \u6c42 MLE\uff0c \u7136\u540e\u5229\u7528\u8fd9\u4e2a\u7ed3\u679c\u6c42 \\(\\sigma_{MLE}\\) \uff0c\u56e0\u6b64\u53ef\u4ee5\u9884\u671f\u7684\u662f\u5bf9\u6570\u636e\u96c6\u6c42\u671f\u671b\u65f6 \\(\\mathbb{E}_{\\mathcal{D} }[\\mu_{MLE}]\\) \u662f\u65e0\u504f\u5dee\u7684\uff1a $$ \\mathbb{E} {\\mathcal{D}}[\\mu ]=\\mathbb{E} {\\mathcal{D}}[\\frac{1}{N}\\sum\\limits ^{N}x_{i}]=\\frac{1}{N}\\sum\\limits {i=1}^{N}\\mathbb{E} }[x_{i}]=\\mu $$ \u4f46\u662f\u5f53\u5bf9 \\(\\sigma_{MLE}\\) \u6c42 \u671f\u671b\u7684\u65f6\u5019\u7531\u4e8e\u4f7f\u7528\u4e86\u5355\u4e2a\u6570\u636e\u96c6\u7684 \\(\\mu_{MLE}\\) \uff0c\u56e0\u6b64\u5bf9\u6240\u6709\u6570\u636e\u96c6\u6c42\u671f\u671b\u7684\u65f6\u5019\u6211\u4eec\u4f1a\u53d1\u73b0 \\(\\sigma_{MLE}\\) \u662f \u6709\u504f\u7684\uff1a \\[ \\begin{align} \\mathbb{E}_{\\mathcal{D}}[\\sigma_{MLE}^{2}]&=\\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}(x_{i}-\\mu_{MLE})^{2}]=\\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}(x_{i}^{2}-2x_{i}\\mu_{MLE}+\\mu_{MLE}^{2})\\nonumber \\\\&=\\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}x_{i}^{2}-\\mu_{MLE}^{2}]=\\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}x_{i}^{2}-\\mu^{2}+\\mu^{2}-\\mu_{MLE}^{2}]\\nonumber\\\\ &= \\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}x_{i}^{2}-\\mu^{2}]-\\mathbb{E}_{\\mathcal{D}}[\\mu_{MLE}^{2}-\\mu^{2}]=\\sigma^{2}-(\\mathbb{E}_{\\mathcal{D}}[\\mu_{MLE}^{2}]-\\mu^{2})\\nonumber\\\\&=\\sigma^{2}-(\\mathbb{E}_{\\mathcal{D}}[\\mu_{MLE}^{2}]-\\mathbb{E}_{\\mathcal{D}}^{2}[\\mu_{MLE}])=\\sigma^{2}-Var[\\mu_{MLE}]\\nonumber\\\\&=\\sigma^{2}-Var[\\frac{1}{N}\\sum\\limits _{i=1}^{N}x_{i}]=\\sigma^{2}-\\frac{1}{N^{2}}\\sum\\limits _{i=1}^{N}Var[x_{i}]=\\frac{N-1}{N}\\sigma^{2} \\end{align} $$ \u6240\u4ee5\uff1a $$ \\hat{\\sigma}^{2}=\\frac{1}{N-1}\\sum\\limits _{i=1}^{N}(x_{i}-\\mu)^{2} \\] \u591a\u7ef4\u60c5\u51b5 \u591a\u7ef4\u9ad8\u65af\u5206\u5e03\u8868\u8fbe\u5f0f\u4e3a\uff1a $$ p(x|\\mu,\\Sigma)=\\frac{1}{(2\\pi)^{p/2}|\\Sigma|^{1/2}}e^{-\\frac{1}{2}(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)} $$ \u5176\u4e2d \\(x,\\mu\\in\\mathbb{R}^{p},\\Sigma\\in\\mathbb{R}^{p\\times p}\\) \uff0c \\(\\Sigma\\) \u4e3a\u534f\u65b9\u5dee\u77e9\u9635\uff0c\u4e00\u822c\u800c\u8a00\u4e5f\u662f\u534a\u6b63\u5b9a\u77e9\u9635\u3002\u8fd9\u91cc\u6211\u4eec\u53ea\u8003\u8651\u6b63\u5b9a\u77e9\u9635\u3002\u9996\u5148\u6211\u4eec\u5904\u7406\u6307\u6570\u4e0a\u7684\u6570\u5b57\uff0c\u6307\u6570\u4e0a\u7684\u6570\u5b57\u53ef\u4ee5\u8bb0\u4e3a \\(x\\) \u548c \\(\\mu\\) \u4e4b\u95f4\u7684\u9a6c\u6c0f\u8ddd\u79bb\u3002\u5bf9\u4e8e\u5bf9\u79f0\u7684\u534f\u65b9\u5dee\u77e9\u9635\u53ef\u8fdb\u884c\u7279\u5f81\u503c\u5206\u89e3\uff0c \\(\\Sigma=U\\Lambda U^{T}=(u_{1},u_{2},\\cdots,u_{p})diag(\\lambda_{i})(u_{1},u_{2},\\cdots,u_{p})^{T}=\\sum\\limits _{i=1}^{p}u_{i}\\lambda_{i}u_{i}^{T}\\) \uff0c\u4e8e\u662f\uff1a \\[ \\Sigma^{-1}=\\sum\\limits _{i=1}^{p}u_{i}\\frac{1}{\\lambda_{i}}u_{i}^{T} \\] \\[ \\Delta=(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)=\\sum\\limits _{i=1}^{p}(x-\\mu)^{T}u_{i}\\frac{1}{\\lambda_{i}}u_{i}^{T}(x-\\mu)=\\sum\\limits _{i=1}^{p}\\frac{y_{i}^{2}}{\\lambda_{i}} \\] \u6211\u4eec\u6ce8\u610f\u5230 \\(y_{i}\\) \u662f \\(x-\\mu\\) \u5728\u7279\u5f81\u5411\u91cf \\(u_{i}\\) \u4e0a\u7684\u6295\u5f71\u957f\u5ea6\uff0c\u56e0\u6b64\u4e0a\u5f0f\u5b50\u5c31\u662f \\(\\Delta\\) \u53d6\u4e0d\u540c\u503c\u65f6\u7684\u540c\u5fc3\u692d\u5706\u3002 \u4e0b\u9762\u6211\u4eec\u770b\u591a\u7ef4\u9ad8\u65af\u6a21\u578b\u5728\u5b9e\u9645\u5e94\u7528\u65f6\u7684\u4e24\u4e2a\u95ee\u9898 \u53c2\u6570 \\(\\Sigma,\\mu\\) \u7684\u81ea\u7531\u5ea6\u4e3a \\(O(p^{2})\\) \u5bf9\u4e8e\u7ef4\u5ea6\u5f88\u9ad8\u7684\u6570\u636e\u5176\u81ea\u7531\u5ea6\u592a\u9ad8\u3002\u89e3\u51b3\u65b9\u6848\uff1a\u9ad8\u81ea\u7531\u5ea6\u7684\u6765\u6e90\u662f \\(\\Sigma\\) \u6709 \\(\\frac{p(p+1)}{2}\\) \u4e2a\u81ea\u7531\u53c2\u6570\uff0c\u53ef\u4ee5\u5047\u8bbe\u5176\u662f\u5bf9\u89d2\u77e9\u9635\uff0c\u751a\u81f3\u5728\u5404\u5411\u540c\u6027\u5047\u8bbe\u4e2d\u5047\u8bbe\u5176\u5bf9\u89d2\u7ebf\u4e0a\u7684\u5143\u7d20\u90fd\u76f8\u540c\u3002\u524d\u4e00\u79cd\u7684\u7b97\u6cd5\u6709 Factor Analysis\uff0c\u540e\u4e00\u79cd\u6709\u6982\u7387 PCA(p-PCA) \u3002 \u7b2c\u4e8c\u4e2a\u95ee\u9898\u662f\u5355\u4e2a\u9ad8\u65af\u5206\u5e03\u662f\u5355\u5cf0\u7684\uff0c\u5bf9\u6709\u591a\u4e2a\u5cf0\u7684\u6570\u636e\u5206\u5e03\u4e0d\u80fd\u5f97\u5230\u597d\u7684\u7ed3\u679c\u3002\u89e3\u51b3\u65b9\u6848\uff1a\u9ad8\u65af\u6df7\u5408GMM \u6a21\u578b\u3002 \u4e0b\u9762\u5bf9\u591a\u7ef4\u9ad8\u65af\u5206\u5e03\u7684\u5e38\u7528\u5b9a\u7406\u8fdb\u884c\u4ecb\u7ecd\u3002 \u6211\u4eec\u8bb0 \\(x=(x_1, x_2,\\cdots,x_p)^T=(x_{a,m\\times 1}, x_{b,n\\times1})^T,\\mu=(\\mu_{a,m\\times1}, \\mu_{b,n\\times1}),\\Sigma=\\begin{pmatrix}\\Sigma_{aa}&\\Sigma_{ab}\\\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\) \uff0c\u5df2\u77e5 \\(x\\sim\\mathcal{N}(\\mu,\\Sigma)\\) \u3002 \u9996\u5148\u662f\u4e00\u4e2a\u9ad8\u65af\u5206\u5e03\u7684\u5b9a\u7406\uff1a \u5b9a\u7406\uff1a\u5df2\u77e5 \\(x\\sim\\mathcal{N}(\\mu,\\Sigma), y\\sim Ax+b\\) \uff0c\u90a3\u4e48 \\(y\\sim\\mathcal{N}(A\\mu+b, A\\Sigma A^T)\\) \u3002 \u8bc1\u660e\uff1a \\(\\mathbb{E}[y]=\\mathbb{E}[Ax+b]=A\\mathbb{E}[x]+b=A\\mu+b\\) \uff0c \\(Var[y]=Var[Ax+b]=Var[Ax]=A\\cdot Var[x]\\cdot A^T\\) \u3002 \u4e0b\u9762\u5229\u7528\u8fd9\u4e2a\u5b9a\u7406\u5f97\u5230 \\(p(x_a),p(x_b),p(x_a|x_b),p(x_b|x_a)\\) \u8fd9\u56db\u4e2a\u91cf\u3002 \\(x_a=\\begin{pmatrix}\\mathbb{I}_{m\\times m}&\\mathbb{O}_{m\\times n})\\end{pmatrix}\\begin{pmatrix}x_a\\\\x_b\\end{pmatrix}\\) \uff0c\u4ee3\u5165\u5b9a\u7406\u4e2d\u5f97\u5230\uff1a $$ \\mathbb{E}[x_a]=\\begin{pmatrix}\\mathbb{I}&\\mathbb{O}\\end{pmatrix}\\begin{pmatrix}\\mu_a\\\\mu_b\\end{pmatrix}=\\mu_a\\ Var[x_a]=\\begin{pmatrix}\\mathbb{I}&\\mathbb{O}\\end{pmatrix}\\begin{pmatrix}\\Sigma_{aa}&\\Sigma_{ab}\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\begin{pmatrix}\\mathbb{I}\\\\mathbb{O}\\end{pmatrix}=\\Sigma_{aa} $$ \u6240\u4ee5 \\(x_a\\sim\\mathcal{N}(\\mu_a,\\Sigma_{aa})\\) \u3002 \u540c\u6837\u7684\uff0c \\(x_b\\sim\\mathcal{N}(\\mu_b,\\Sigma_{bb})\\) \u3002 \u5bf9\u4e8e\u4e24\u4e2a\u6761\u4ef6\u6982\u7387\uff0c\u6211\u4eec\u5f15\u5165\u4e09\u4e2a\u91cf\uff1a $$ x_{b\\cdot a}=x_b-\\Sigma_{ba}\\Sigma_{aa}^{-1}x_a\\ \\mu_{b\\cdot a}=\\mu_b-\\Sigma_{ba}\\Sigma_{aa}^{-1}\\mu_a\\ \\Sigma_{bb\\cdot a}=\\Sigma_{bb}-\\Sigma_{ba}\\Sigma_{aa}^{-1}\\Sigma_{ab} $$ \u7279\u522b\u7684\uff0c\u6700\u540e\u4e00\u4e2a\u5f0f\u5b50\u53eb\u505a \\(\\Sigma_{bb}\\) \u7684 Schur Complementary\u3002\u53ef\u4ee5\u770b\u5230\uff1a $$ x_{b\\cdot a}=\\begin{pmatrix}-\\Sigma_{ba}\\Sigma_{aa}^{-1}&\\mathbb{I} {n\\times n}\\end{pmatrix}\\begin{pmatrix}x_a\\x_b\\end{pmatrix} $$ \u6240\u4ee5\uff1a $$ \\mathbb{E}[x ]=\\begin{pmatrix}-\\Sigma_{ba}\\Sigma_{aa}^{-1}&\\mathbb{I} {n\\times n}\\end{pmatrix}\\begin{pmatrix}\\mu_a\\\\mu_b\\end{pmatrix}=\\mu \\ Var[x_{b\\cdot a}]=\\begin{pmatrix}-\\Sigma_{ba}\\Sigma_{aa}^{-1}&\\mathbb{I} {n\\times n}\\end{pmatrix}\\begin{pmatrix}\\Sigma &\\Sigma_{ab}\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\begin{pmatrix}-\\Sigma_{aa}^{-1}\\Sigma_{ba}^T\\\\mathbb{I} {n\\times n}\\end{pmatrix}=\\Sigma $$ \u5229\u7528\u8fd9\u4e09\u4e2a\u91cf\u53ef\u4ee5\u5f97\u5230 \\(x_b=x_{b\\cdot a}+\\Sigma_{ba}\\Sigma_{aa}^{-1}x_a\\) \u3002\u56e0\u6b64\uff1a $$ \\mathbb{E}[x_b|x_a]=\\mu_{b\\cdot a}+\\Sigma_{ba}\\Sigma_{aa}^{-1}x_a $$ \\[ Var[x_b|x_a]=\\Sigma_{bb\\cdot a} \\] \u8fd9\u91cc\u540c\u6837\u7528\u5230\u4e86\u5b9a\u7406\u3002 \u540c\u6837\uff1a $$ x_{a\\cdot b}=x_a-\\Sigma_{ab}\\Sigma_{bb}^{-1}x_b\\ \\mu_{a\\cdot b}=\\mu_a-\\Sigma_{ab}\\Sigma_{bb}^{-1}\\mu_b\\ \\Sigma_{aa\\cdot b}=\\Sigma_{aa}-\\Sigma_{ab}\\Sigma_{bb}^{-1}\\Sigma_{ba} $$ \u6240\u4ee5\uff1a $$ \\mathbb{E}[x_a|x_b]=\\mu_{a\\cdot b}+\\Sigma_{ab}\\Sigma_{bb}^{-1}x_b $$ \\[ Var[x_a|x_b]=\\Sigma_{aa\\cdot b} \\] \u4e0b\u9762\u5229\u7528\u4e0a\u8fb9\u56db\u4e2a\u91cf\uff0c\u6c42\u89e3\u7ebf\u6027\u6a21\u578b\uff1a \u5df2\u77e5\uff1a \\(p(x)=\\mathcal{N}(\\mu,\\Lambda^{-1}),p(y|x)=\\mathcal{N}(Ax+b,L^{-1})\\) \uff0c\u6c42\u89e3\uff1a \\(p(y),p(x|y)\\) \u3002 \u89e3\uff1a\u4ee4 \\(y=Ax+b+\\epsilon,\\epsilon\\sim\\mathcal{N}(0,L^{-1})\\) \uff0c\u6240\u4ee5 \\(\\mathbb{E}[y]=\\mathbb{E}[Ax+b+\\epsilon]=A\\mu+b\\) \uff0c \\(Var[y]=A \\Lambda^{-1}A^T+L^{-1}\\) \uff0c\u56e0\u6b64\uff1a $$ p(y)=\\mathcal{N}(A\\mu+b,L^{-1}+A\\Lambda^{-1}A^T) $$ \u5f15\u5165 \\(z=\\begin{pmatrix}x\\\\y\\end{pmatrix}\\) \uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 \\(Cov[x,y]=\\mathbb{E}[(x-\\mathbb{E}[x])(y-\\mathbb{E}[y])^T]\\) \u3002\u5bf9\u4e8e\u8fd9\u4e2a\u534f\u65b9\u5dee\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\uff1a $$ \\begin{align} Cov(x,y)&=\\mathbb{E}[(x-\\mu)(Ax-A\\mu+\\epsilon)^T]=\\mathbb{E}[(x-\\mu)(x-\\mu)^TA^T]=Var[x]A^T=\\Lambda^{-1}A^T \\end{align} $$ \u6ce8\u610f\u5230\u534f\u65b9\u5dee\u77e9\u9635\u7684\u5bf9\u79f0\u6027\uff0c\u6240\u4ee5 \\(p(z)=\\mathcal{N}\\begin{pmatrix}\\mu\\\\A\\mu+b\\end{pmatrix},\\begin{pmatrix}\\Lambda^{-1}&\\Lambda^{-1}A^T\\\\A\\Lambda^{-1}&L^{-1}+A\\Lambda^{-1}A^T\\end{pmatrix})\\) \u3002\u6839\u636e\u4e4b\u524d\u7684\u516c\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a $$ \\mathbb{E}[x|y]=\\mu+\\Lambda^{-1}A^T(L^{-1}+A\\Lambda^{-1}A^T)^{-1}(y-A\\mu-b) $$ $$ Var[x|y]=\\Lambda^{-1}-\\Lambda^{-1}A^T(L^{-1}+A\\Lambda^{-1}A^T)^{-1}A\\Lambda^{-1} $$","title":"1.Intro_Math"},{"location":"Machine_Learning/1.Intro_Math/#introduction","text":"\u5bf9\u6982\u7387\u7684\u8be0\u91ca\u6709\u4e24\u5927\u5b66\u6d3e\uff0c\u4e00\u79cd\u662f\u9891\u7387\u6d3e\u53e6\u4e00\u79cd\u662f\u8d1d\u53f6\u65af\u6d3e\u3002\u540e\u9762\u6211\u4eec\u5bf9\u89c2\u6d4b\u96c6\u91c7\u7528\u4e0b\u9762\u8bb0\u53f7\uff1a $$ X_{N\\times p}=(x_{1},x_{2},\\cdots,x_{N})^{T},x_{i}=(x_{i1},x_{i2},\\cdots,x_{ip})^{T} $$ \u8fd9\u4e2a\u8bb0\u53f7\u8868\u793a\u6709 \\(N\\) \u4e2a\u6837\u672c\uff0c\u6bcf\u4e2a\u6837\u672c\u90fd\u662f \\(p\\) \u7ef4\u5411\u91cf\u3002\u5176\u4e2d\u6bcf\u4e2a\u89c2\u6d4b\u90fd\u662f\u7531 \\(p(x|\\theta)\\) \u751f\u6210\u7684\u3002","title":"Introduction"},{"location":"Machine_Learning/1.Intro_Math/#_1","text":"\\(p(x|\\theta)\\) \u4e2d\u7684 \\(\\theta\\) \u662f\u4e00\u4e2a\u5e38\u91cf\u3002\u5bf9\u4e8e \\(N\\) \u4e2a\u89c2\u6d4b\u6765\u8bf4\u89c2\u6d4b\u96c6\u7684\u6982\u7387\u4e3a \\(p(X|\\theta)\\mathop{=}\\limits _{iid}\\prod\\limits _{i=1}^{N}p(x_{i}|\\theta))\\) \u3002\u4e3a\u4e86\u6c42 \\(\\theta\\) \u7684\u5927\u5c0f\uff0c\u6211\u4eec\u91c7\u7528\u6700\u5927\u5bf9\u6570\u4f3c\u7136MLE\u7684\u65b9\u6cd5\uff1a \\[ \\theta_{MLE}=\\mathop{argmax}\\limits _{\\theta}\\log p(X|\\theta)\\mathop{=}\\limits _{iid}\\mathop{argmax}\\limits _{\\theta}\\sum\\limits _{i=1}^{N}\\log p(x_{i}|\\theta) \\]","title":"\u9891\u7387\u6d3e\u7684\u89c2\u70b9"},{"location":"Machine_Learning/1.Intro_Math/#_2","text":"\u8d1d\u53f6\u65af\u6d3e\u8ba4\u4e3a \\(p(x|\\theta)\\) \u4e2d\u7684 \\(\\theta\\) \u4e0d\u662f\u4e00\u4e2a\u5e38\u91cf\u3002\u8fd9\u4e2a \\(\\theta\\) \u6ee1\u8db3\u4e00\u4e2a\u9884\u8bbe\u7684\u5148\u9a8c\u7684\u5206\u5e03 \\(\\theta\\sim p(\\theta)\\) \u3002\u4e8e\u662f\u6839\u636e\u8d1d\u53f6\u65af\u5b9a\u7406\u4f9d\u8d56\u89c2\u6d4b\u96c6\u53c2\u6570\u7684\u540e\u9a8c\u53ef\u4ee5\u5199\u6210\uff1a \\[ p(\\theta|X)=\\frac{p(X|\\theta)\\cdot p(\\theta)}{p(X)}=\\frac{p(X|\\theta)\\cdot p(\\theta)}{\\int\\limits _{\\theta}p(X|\\theta)\\cdot p(\\theta)d\\theta} \\] \u4e3a\u4e86\u6c42 \\(\\theta\\) \u7684\u503c\uff0c\u6211\u4eec\u8981\u6700\u5927\u5316\u8fd9\u4e2a\u53c2\u6570\u540e\u9a8cMAP\uff1a \\[ \\theta_{MAP}=\\mathop{argmax}\\limits _{\\theta}p(\\theta|X)=\\mathop{argmax}\\limits _{\\theta}p(X|\\theta)\\cdot p(\\theta) \\] \u5176\u4e2d\u7b2c\u4e8c\u4e2a\u7b49\u53f7\u662f\u7531\u4e8e\u5206\u6bcd\u548c \\(\\theta\\) \u6ca1\u6709\u5173\u7cfb\u3002\u6c42\u89e3\u8fd9\u4e2a \\(\\theta\\) \u503c\u540e\u8ba1\u7b97 \\(\\frac{p(X|\\theta)\\cdot p(\\theta)}{\\int\\limits _{\\theta}p(X|\\theta)\\cdot p(\\theta)d\\theta}\\) \uff0c\u5c31\u5f97\u5230\u4e86\u53c2\u6570\u7684\u540e\u9a8c\u6982\u7387\u3002\u5176\u4e2d \\(p(X|\\theta)\\) \u53eb\u4f3c\u7136\uff0c\u662f\u6211\u4eec\u7684\u6a21\u578b\u5206\u5e03\u3002\u5f97\u5230\u4e86\u53c2\u6570\u7684\u540e\u9a8c\u5206\u5e03\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5206\u5e03\u7528\u4e8e\u9884\u6d4b\u8d1d\u53f6\u65af\u9884\u6d4b\uff1a $$ p(x_{new}|X)=\\int\\limits {\\theta}p(x |\\theta)\\cdot p(\\theta|X)d\\theta $$ \u5176\u4e2d\u79ef\u5206\u4e2d\u7684\u88ab\u4e58\u6570\u662f\u6a21\u578b\uff0c\u4e58\u6570\u662f\u540e\u9a8c\u5206\u5e03\u3002","title":"\u8d1d\u53f6\u65af\u6d3e\u7684\u89c2\u70b9"},{"location":"Machine_Learning/1.Intro_Math/#_3","text":"\u9891\u7387\u6d3e\u548c\u8d1d\u53f6\u65af\u6d3e\u5206\u522b\u7ed9\u51fa\u4e86\u4e00\u7cfb\u5217\u7684\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u3002\u9891\u7387\u6d3e\u7684\u89c2\u70b9\u5bfc\u51fa\u4e86\u4e00\u7cfb\u5217\u7684\u7edf\u8ba1\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u800c\u8d1d\u53f6\u65af\u6d3e\u5bfc\u51fa\u4e86\u6982\u7387\u56fe\u7406\u8bba\u3002\u5728\u5e94\u7528\u9891\u7387\u6d3e\u7684 MLE \u65b9\u6cd5\u65f6\u6700\u4f18\u5316\u7406\u8bba\u5360\u6709\u91cd\u8981\u5730\u4f4d\u3002\u800c\u8d1d\u53f6\u65af\u6d3e\u7684\u7b97\u6cd5\u65e0\u8bba\u662f\u540e\u9a8c\u6982\u7387\u7684\u5efa\u6a21\u8fd8\u662f\u5e94\u7528\u8fd9\u4e2a\u540e\u9a8c\u8fdb\u884c\u63a8\u65ad\u65f6\u79ef\u5206\u5360\u6709\u91cd\u8981\u5730\u4f4d\u3002\u56e0\u6b64\u91c7\u6837\u79ef\u5206\u65b9\u6cd5\u5982 MCMC \u6709\u5f88\u591a\u5e94\u7528\u3002","title":"\u5c0f\u7ed3"},{"location":"Machine_Learning/1.Intro_Math/#mathbasics","text":"","title":"MathBasics"},{"location":"Machine_Learning/1.Intro_Math/#_4","text":"","title":"\u9ad8\u65af\u5206\u5e03"},{"location":"Machine_Learning/1.Intro_Math/#mle","text":"\u9ad8\u65af\u5206\u5e03\u5728\u673a\u5668\u5b66\u4e60\u4e2d\u5360\u6709\u4e3e\u8db3\u8f7b\u91cd\u7684\u4f5c\u7528\u3002\u5728 MLE \u65b9\u6cd5\u4e2d\uff1a $$ \\theta=(\\mu,\\Sigma)=(\\mu,\\sigma^{2}),\\theta_{MLE}=\\mathop{argmax}\\limits {\\theta}\\log p(X|\\theta)\\mathop{=}\\limits \\mathop{argmax}\\limits {\\theta}\\sum\\limits ^{N}\\log p(x_{i}|\\theta) $$ \u4e00\u822c\u5730\uff0c\u9ad8\u65af\u5206\u5e03\u7684\u6982\u7387\u5bc6\u5ea6\u51fd\u6570PDF\u5199\u4e3a\uff1a $$ p(x|\\mu,\\Sigma)=\\frac{1}{(2\\pi)^{p/2}|\\Sigma|^{1/2}}e^{-\\frac{1}{2}(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)} $$ \u5e26\u5165 MLE \u4e2d\u6211\u4eec\u8003\u8651\u4e00\u7ef4\u7684\u60c5\u51b5 $$ \\log p(X|\\theta)=\\sum\\limits {i=1}^{N}\\log p(x |\\theta)=\\sum\\limits {i=1}^{N}\\log\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp(-(x -\\mu)^{2}/2\\sigma^{2}) $$ \u9996\u5148\u5bf9 \\(\\mu\\) \u7684\u6781\u503c\u53ef\u4ee5\u5f97\u5230 \uff1a $$ \\mu_{MLE}=\\mathop{argmax}\\limits {\\mu}\\log p(X|\\theta)=\\mathop{argmax}\\limits \\sum\\limits {i=1}^{N}(x -\\mu)^{2} $$ \u4e8e\u662f\uff1a $$ \\frac{\\partial}{\\partial\\mu}\\sum\\limits {i=1}^{N}(x -\\mu)^{2}=0\\longrightarrow\\mu_{MLE}=\\frac{1}{N}\\sum\\limits {i=1}^{N}x $$ \u5176\u6b21\u5bf9 \\(\\theta\\) \u4e2d\u7684\u53e6\u4e00\u4e2a\u53c2\u6570 \\(\\sigma\\) \uff0c\u6709\uff1a $$ \\begin{align} \\sigma_{MLE}=\\mathop{argmax}\\limits {\\sigma}\\log p(X|\\theta)&=\\mathop{argmax}\\limits \\sum\\limits {i=1}^{N}[-\\log\\sigma-\\frac{1}{2\\sigma^{2}}(x -\\mu)^{2}]\\nonumber\\ &=\\mathop{argmin}\\limits {\\sigma}\\sum\\limits ^{N}[\\log\\sigma+\\frac{1}{2\\sigma^{2}}(x_{i}-\\mu)^{2}] \\end{align} $$ \u4e8e\u662f\uff1a $$ \\frac{\\partial}{\\partial\\sigma}\\sum\\limits {i=1}^{N}[\\log\\sigma+\\frac{1}{2\\sigma^{2}}(x -\\mu)^{2}]=0\\longrightarrow\\sigma_{MLE}^{2}=\\frac{1}{N}\\sum\\limits {i=1}^{N}(x -\\mu)^{2} $$ \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u4e0a\u9762\u7684\u63a8\u5bfc\u4e2d\uff0c\u9996\u5148\u5bf9 \\(\\mu\\) \u6c42 MLE\uff0c \u7136\u540e\u5229\u7528\u8fd9\u4e2a\u7ed3\u679c\u6c42 \\(\\sigma_{MLE}\\) \uff0c\u56e0\u6b64\u53ef\u4ee5\u9884\u671f\u7684\u662f\u5bf9\u6570\u636e\u96c6\u6c42\u671f\u671b\u65f6 \\(\\mathbb{E}_{\\mathcal{D} }[\\mu_{MLE}]\\) \u662f\u65e0\u504f\u5dee\u7684\uff1a $$ \\mathbb{E} {\\mathcal{D}}[\\mu ]=\\mathbb{E} {\\mathcal{D}}[\\frac{1}{N}\\sum\\limits ^{N}x_{i}]=\\frac{1}{N}\\sum\\limits {i=1}^{N}\\mathbb{E} }[x_{i}]=\\mu $$ \u4f46\u662f\u5f53\u5bf9 \\(\\sigma_{MLE}\\) \u6c42 \u671f\u671b\u7684\u65f6\u5019\u7531\u4e8e\u4f7f\u7528\u4e86\u5355\u4e2a\u6570\u636e\u96c6\u7684 \\(\\mu_{MLE}\\) \uff0c\u56e0\u6b64\u5bf9\u6240\u6709\u6570\u636e\u96c6\u6c42\u671f\u671b\u7684\u65f6\u5019\u6211\u4eec\u4f1a\u53d1\u73b0 \\(\\sigma_{MLE}\\) \u662f \u6709\u504f\u7684\uff1a \\[ \\begin{align} \\mathbb{E}_{\\mathcal{D}}[\\sigma_{MLE}^{2}]&=\\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}(x_{i}-\\mu_{MLE})^{2}]=\\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}(x_{i}^{2}-2x_{i}\\mu_{MLE}+\\mu_{MLE}^{2})\\nonumber \\\\&=\\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}x_{i}^{2}-\\mu_{MLE}^{2}]=\\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}x_{i}^{2}-\\mu^{2}+\\mu^{2}-\\mu_{MLE}^{2}]\\nonumber\\\\ &= \\mathbb{E}_{\\mathcal{D}}[\\frac{1}{N}\\sum\\limits _{i=1}^{N}x_{i}^{2}-\\mu^{2}]-\\mathbb{E}_{\\mathcal{D}}[\\mu_{MLE}^{2}-\\mu^{2}]=\\sigma^{2}-(\\mathbb{E}_{\\mathcal{D}}[\\mu_{MLE}^{2}]-\\mu^{2})\\nonumber\\\\&=\\sigma^{2}-(\\mathbb{E}_{\\mathcal{D}}[\\mu_{MLE}^{2}]-\\mathbb{E}_{\\mathcal{D}}^{2}[\\mu_{MLE}])=\\sigma^{2}-Var[\\mu_{MLE}]\\nonumber\\\\&=\\sigma^{2}-Var[\\frac{1}{N}\\sum\\limits _{i=1}^{N}x_{i}]=\\sigma^{2}-\\frac{1}{N^{2}}\\sum\\limits _{i=1}^{N}Var[x_{i}]=\\frac{N-1}{N}\\sigma^{2} \\end{align} $$ \u6240\u4ee5\uff1a $$ \\hat{\\sigma}^{2}=\\frac{1}{N-1}\\sum\\limits _{i=1}^{N}(x_{i}-\\mu)^{2} \\]","title":"\u4e00\u7ef4\u60c5\u51b5 MLE"},{"location":"Machine_Learning/1.Intro_Math/#_5","text":"\u591a\u7ef4\u9ad8\u65af\u5206\u5e03\u8868\u8fbe\u5f0f\u4e3a\uff1a $$ p(x|\\mu,\\Sigma)=\\frac{1}{(2\\pi)^{p/2}|\\Sigma|^{1/2}}e^{-\\frac{1}{2}(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)} $$ \u5176\u4e2d \\(x,\\mu\\in\\mathbb{R}^{p},\\Sigma\\in\\mathbb{R}^{p\\times p}\\) \uff0c \\(\\Sigma\\) \u4e3a\u534f\u65b9\u5dee\u77e9\u9635\uff0c\u4e00\u822c\u800c\u8a00\u4e5f\u662f\u534a\u6b63\u5b9a\u77e9\u9635\u3002\u8fd9\u91cc\u6211\u4eec\u53ea\u8003\u8651\u6b63\u5b9a\u77e9\u9635\u3002\u9996\u5148\u6211\u4eec\u5904\u7406\u6307\u6570\u4e0a\u7684\u6570\u5b57\uff0c\u6307\u6570\u4e0a\u7684\u6570\u5b57\u53ef\u4ee5\u8bb0\u4e3a \\(x\\) \u548c \\(\\mu\\) \u4e4b\u95f4\u7684\u9a6c\u6c0f\u8ddd\u79bb\u3002\u5bf9\u4e8e\u5bf9\u79f0\u7684\u534f\u65b9\u5dee\u77e9\u9635\u53ef\u8fdb\u884c\u7279\u5f81\u503c\u5206\u89e3\uff0c \\(\\Sigma=U\\Lambda U^{T}=(u_{1},u_{2},\\cdots,u_{p})diag(\\lambda_{i})(u_{1},u_{2},\\cdots,u_{p})^{T}=\\sum\\limits _{i=1}^{p}u_{i}\\lambda_{i}u_{i}^{T}\\) \uff0c\u4e8e\u662f\uff1a \\[ \\Sigma^{-1}=\\sum\\limits _{i=1}^{p}u_{i}\\frac{1}{\\lambda_{i}}u_{i}^{T} \\] \\[ \\Delta=(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)=\\sum\\limits _{i=1}^{p}(x-\\mu)^{T}u_{i}\\frac{1}{\\lambda_{i}}u_{i}^{T}(x-\\mu)=\\sum\\limits _{i=1}^{p}\\frac{y_{i}^{2}}{\\lambda_{i}} \\] \u6211\u4eec\u6ce8\u610f\u5230 \\(y_{i}\\) \u662f \\(x-\\mu\\) \u5728\u7279\u5f81\u5411\u91cf \\(u_{i}\\) \u4e0a\u7684\u6295\u5f71\u957f\u5ea6\uff0c\u56e0\u6b64\u4e0a\u5f0f\u5b50\u5c31\u662f \\(\\Delta\\) \u53d6\u4e0d\u540c\u503c\u65f6\u7684\u540c\u5fc3\u692d\u5706\u3002 \u4e0b\u9762\u6211\u4eec\u770b\u591a\u7ef4\u9ad8\u65af\u6a21\u578b\u5728\u5b9e\u9645\u5e94\u7528\u65f6\u7684\u4e24\u4e2a\u95ee\u9898 \u53c2\u6570 \\(\\Sigma,\\mu\\) \u7684\u81ea\u7531\u5ea6\u4e3a \\(O(p^{2})\\) \u5bf9\u4e8e\u7ef4\u5ea6\u5f88\u9ad8\u7684\u6570\u636e\u5176\u81ea\u7531\u5ea6\u592a\u9ad8\u3002\u89e3\u51b3\u65b9\u6848\uff1a\u9ad8\u81ea\u7531\u5ea6\u7684\u6765\u6e90\u662f \\(\\Sigma\\) \u6709 \\(\\frac{p(p+1)}{2}\\) \u4e2a\u81ea\u7531\u53c2\u6570\uff0c\u53ef\u4ee5\u5047\u8bbe\u5176\u662f\u5bf9\u89d2\u77e9\u9635\uff0c\u751a\u81f3\u5728\u5404\u5411\u540c\u6027\u5047\u8bbe\u4e2d\u5047\u8bbe\u5176\u5bf9\u89d2\u7ebf\u4e0a\u7684\u5143\u7d20\u90fd\u76f8\u540c\u3002\u524d\u4e00\u79cd\u7684\u7b97\u6cd5\u6709 Factor Analysis\uff0c\u540e\u4e00\u79cd\u6709\u6982\u7387 PCA(p-PCA) \u3002 \u7b2c\u4e8c\u4e2a\u95ee\u9898\u662f\u5355\u4e2a\u9ad8\u65af\u5206\u5e03\u662f\u5355\u5cf0\u7684\uff0c\u5bf9\u6709\u591a\u4e2a\u5cf0\u7684\u6570\u636e\u5206\u5e03\u4e0d\u80fd\u5f97\u5230\u597d\u7684\u7ed3\u679c\u3002\u89e3\u51b3\u65b9\u6848\uff1a\u9ad8\u65af\u6df7\u5408GMM \u6a21\u578b\u3002 \u4e0b\u9762\u5bf9\u591a\u7ef4\u9ad8\u65af\u5206\u5e03\u7684\u5e38\u7528\u5b9a\u7406\u8fdb\u884c\u4ecb\u7ecd\u3002 \u6211\u4eec\u8bb0 \\(x=(x_1, x_2,\\cdots,x_p)^T=(x_{a,m\\times 1}, x_{b,n\\times1})^T,\\mu=(\\mu_{a,m\\times1}, \\mu_{b,n\\times1}),\\Sigma=\\begin{pmatrix}\\Sigma_{aa}&\\Sigma_{ab}\\\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\) \uff0c\u5df2\u77e5 \\(x\\sim\\mathcal{N}(\\mu,\\Sigma)\\) \u3002 \u9996\u5148\u662f\u4e00\u4e2a\u9ad8\u65af\u5206\u5e03\u7684\u5b9a\u7406\uff1a \u5b9a\u7406\uff1a\u5df2\u77e5 \\(x\\sim\\mathcal{N}(\\mu,\\Sigma), y\\sim Ax+b\\) \uff0c\u90a3\u4e48 \\(y\\sim\\mathcal{N}(A\\mu+b, A\\Sigma A^T)\\) \u3002 \u8bc1\u660e\uff1a \\(\\mathbb{E}[y]=\\mathbb{E}[Ax+b]=A\\mathbb{E}[x]+b=A\\mu+b\\) \uff0c \\(Var[y]=Var[Ax+b]=Var[Ax]=A\\cdot Var[x]\\cdot A^T\\) \u3002 \u4e0b\u9762\u5229\u7528\u8fd9\u4e2a\u5b9a\u7406\u5f97\u5230 \\(p(x_a),p(x_b),p(x_a|x_b),p(x_b|x_a)\\) \u8fd9\u56db\u4e2a\u91cf\u3002 \\(x_a=\\begin{pmatrix}\\mathbb{I}_{m\\times m}&\\mathbb{O}_{m\\times n})\\end{pmatrix}\\begin{pmatrix}x_a\\\\x_b\\end{pmatrix}\\) \uff0c\u4ee3\u5165\u5b9a\u7406\u4e2d\u5f97\u5230\uff1a $$ \\mathbb{E}[x_a]=\\begin{pmatrix}\\mathbb{I}&\\mathbb{O}\\end{pmatrix}\\begin{pmatrix}\\mu_a\\\\mu_b\\end{pmatrix}=\\mu_a\\ Var[x_a]=\\begin{pmatrix}\\mathbb{I}&\\mathbb{O}\\end{pmatrix}\\begin{pmatrix}\\Sigma_{aa}&\\Sigma_{ab}\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\begin{pmatrix}\\mathbb{I}\\\\mathbb{O}\\end{pmatrix}=\\Sigma_{aa} $$ \u6240\u4ee5 \\(x_a\\sim\\mathcal{N}(\\mu_a,\\Sigma_{aa})\\) \u3002 \u540c\u6837\u7684\uff0c \\(x_b\\sim\\mathcal{N}(\\mu_b,\\Sigma_{bb})\\) \u3002 \u5bf9\u4e8e\u4e24\u4e2a\u6761\u4ef6\u6982\u7387\uff0c\u6211\u4eec\u5f15\u5165\u4e09\u4e2a\u91cf\uff1a $$ x_{b\\cdot a}=x_b-\\Sigma_{ba}\\Sigma_{aa}^{-1}x_a\\ \\mu_{b\\cdot a}=\\mu_b-\\Sigma_{ba}\\Sigma_{aa}^{-1}\\mu_a\\ \\Sigma_{bb\\cdot a}=\\Sigma_{bb}-\\Sigma_{ba}\\Sigma_{aa}^{-1}\\Sigma_{ab} $$ \u7279\u522b\u7684\uff0c\u6700\u540e\u4e00\u4e2a\u5f0f\u5b50\u53eb\u505a \\(\\Sigma_{bb}\\) \u7684 Schur Complementary\u3002\u53ef\u4ee5\u770b\u5230\uff1a $$ x_{b\\cdot a}=\\begin{pmatrix}-\\Sigma_{ba}\\Sigma_{aa}^{-1}&\\mathbb{I} {n\\times n}\\end{pmatrix}\\begin{pmatrix}x_a\\x_b\\end{pmatrix} $$ \u6240\u4ee5\uff1a $$ \\mathbb{E}[x ]=\\begin{pmatrix}-\\Sigma_{ba}\\Sigma_{aa}^{-1}&\\mathbb{I} {n\\times n}\\end{pmatrix}\\begin{pmatrix}\\mu_a\\\\mu_b\\end{pmatrix}=\\mu \\ Var[x_{b\\cdot a}]=\\begin{pmatrix}-\\Sigma_{ba}\\Sigma_{aa}^{-1}&\\mathbb{I} {n\\times n}\\end{pmatrix}\\begin{pmatrix}\\Sigma &\\Sigma_{ab}\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\begin{pmatrix}-\\Sigma_{aa}^{-1}\\Sigma_{ba}^T\\\\mathbb{I} {n\\times n}\\end{pmatrix}=\\Sigma $$ \u5229\u7528\u8fd9\u4e09\u4e2a\u91cf\u53ef\u4ee5\u5f97\u5230 \\(x_b=x_{b\\cdot a}+\\Sigma_{ba}\\Sigma_{aa}^{-1}x_a\\) \u3002\u56e0\u6b64\uff1a $$ \\mathbb{E}[x_b|x_a]=\\mu_{b\\cdot a}+\\Sigma_{ba}\\Sigma_{aa}^{-1}x_a $$ \\[ Var[x_b|x_a]=\\Sigma_{bb\\cdot a} \\] \u8fd9\u91cc\u540c\u6837\u7528\u5230\u4e86\u5b9a\u7406\u3002 \u540c\u6837\uff1a $$ x_{a\\cdot b}=x_a-\\Sigma_{ab}\\Sigma_{bb}^{-1}x_b\\ \\mu_{a\\cdot b}=\\mu_a-\\Sigma_{ab}\\Sigma_{bb}^{-1}\\mu_b\\ \\Sigma_{aa\\cdot b}=\\Sigma_{aa}-\\Sigma_{ab}\\Sigma_{bb}^{-1}\\Sigma_{ba} $$ \u6240\u4ee5\uff1a $$ \\mathbb{E}[x_a|x_b]=\\mu_{a\\cdot b}+\\Sigma_{ab}\\Sigma_{bb}^{-1}x_b $$ \\[ Var[x_a|x_b]=\\Sigma_{aa\\cdot b} \\] \u4e0b\u9762\u5229\u7528\u4e0a\u8fb9\u56db\u4e2a\u91cf\uff0c\u6c42\u89e3\u7ebf\u6027\u6a21\u578b\uff1a \u5df2\u77e5\uff1a \\(p(x)=\\mathcal{N}(\\mu,\\Lambda^{-1}),p(y|x)=\\mathcal{N}(Ax+b,L^{-1})\\) \uff0c\u6c42\u89e3\uff1a \\(p(y),p(x|y)\\) \u3002 \u89e3\uff1a\u4ee4 \\(y=Ax+b+\\epsilon,\\epsilon\\sim\\mathcal{N}(0,L^{-1})\\) \uff0c\u6240\u4ee5 \\(\\mathbb{E}[y]=\\mathbb{E}[Ax+b+\\epsilon]=A\\mu+b\\) \uff0c \\(Var[y]=A \\Lambda^{-1}A^T+L^{-1}\\) \uff0c\u56e0\u6b64\uff1a $$ p(y)=\\mathcal{N}(A\\mu+b,L^{-1}+A\\Lambda^{-1}A^T) $$ \u5f15\u5165 \\(z=\\begin{pmatrix}x\\\\y\\end{pmatrix}\\) \uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 \\(Cov[x,y]=\\mathbb{E}[(x-\\mathbb{E}[x])(y-\\mathbb{E}[y])^T]\\) \u3002\u5bf9\u4e8e\u8fd9\u4e2a\u534f\u65b9\u5dee\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\uff1a $$ \\begin{align} Cov(x,y)&=\\mathbb{E}[(x-\\mu)(Ax-A\\mu+\\epsilon)^T]=\\mathbb{E}[(x-\\mu)(x-\\mu)^TA^T]=Var[x]A^T=\\Lambda^{-1}A^T \\end{align} $$ \u6ce8\u610f\u5230\u534f\u65b9\u5dee\u77e9\u9635\u7684\u5bf9\u79f0\u6027\uff0c\u6240\u4ee5 \\(p(z)=\\mathcal{N}\\begin{pmatrix}\\mu\\\\A\\mu+b\\end{pmatrix},\\begin{pmatrix}\\Lambda^{-1}&\\Lambda^{-1}A^T\\\\A\\Lambda^{-1}&L^{-1}+A\\Lambda^{-1}A^T\\end{pmatrix})\\) \u3002\u6839\u636e\u4e4b\u524d\u7684\u516c\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a $$ \\mathbb{E}[x|y]=\\mu+\\Lambda^{-1}A^T(L^{-1}+A\\Lambda^{-1}A^T)^{-1}(y-A\\mu-b) $$ $$ Var[x|y]=\\Lambda^{-1}-\\Lambda^{-1}A^T(L^{-1}+A\\Lambda^{-1}A^T)^{-1}A\\Lambda^{-1} $$","title":"\u591a\u7ef4\u60c5\u51b5"},{"location":"Machine_Learning/10.VI/","text":"\u53d8\u5206\u63a8\u65ad \u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u6982\u7387\u6a21\u578b\u53ef\u4ee5\u5206\u4e3a\uff0c\u9891\u7387\u6d3e\u7684\u4f18\u5316\u95ee\u9898\u548c\u8d1d\u53f6\u65af\u6d3e\u7684\u79ef\u5206\u95ee\u9898\u3002\u4ece\u8d1d\u53f6\u65af\u89d2\u5ea6\u6765\u770b\u63a8\u65ad\uff0c\u5bf9\u4e8e \\(\\hat{x}\\) \u8fd9\u6837\u7684\u65b0\u6837\u672c\uff0c\u9700\u8981\u5f97\u5230\uff1a $$ p(\\hat{x}|X)=\\int_\\theta p(\\hat{x},\\theta|X)d\\theta=\\int_\\theta p(\\theta|X)p(\\hat{x}|\\theta,X)d\\theta $$ \u5982\u679c\u65b0\u6837\u672c\u548c\u6570\u636e\u96c6\u72ec\u7acb\uff0c\u90a3\u4e48\u63a8\u65ad\u5c31\u662f\u6982\u7387\u5206\u5e03\u4f9d\u53c2\u6570\u540e\u9a8c\u5206\u5e03\u7684\u671f\u671b\u3002 \u6211\u4eec\u770b\u5230\uff0c\u63a8\u65ad\u95ee\u9898\u7684\u4e2d\u5fc3\u662f\u53c2\u6570\u540e\u9a8c\u5206\u5e03\u7684\u6c42\u89e3\uff0c\u63a8\u65ad\u5206\u4e3a\uff1a \u7cbe\u786e\u63a8\u65ad \u8fd1\u4f3c\u63a8\u65ad-\u53c2\u6570\u7a7a\u95f4\u65e0\u6cd5\u7cbe\u786e\u6c42\u89e3 \u786e\u5b9a\u6027\u8fd1\u4f3c-\u5982\u53d8\u5206\u63a8\u65ad \u968f\u673a\u8fd1\u4f3c-\u5982 MCMC\uff0cMH\uff0cGibbs \u57fa\u4e8e\u5e73\u5747\u573a\u5047\u8bbe\u7684\u53d8\u5206\u63a8\u65ad \u6211\u4eec\u8bb0 \\(Z\\) \u4e3a\u9690\u53d8\u91cf\u548c\u53c2\u6570\u7684\u96c6\u5408\uff0c \\(Z_i\\) \u4e3a\u7b2c \\(i\\) \u7ef4\u7684\u53c2\u6570\uff0c\u4e8e\u662f\uff0c\u56de\u987e\u4e00\u4e0b EM \u4e2d\u7684\u63a8\u5bfc\uff1a $$ \\log p(X)=\\log p(X,Z)-\\log p(Z|X)=\\log\\frac{p(X,Z)}{q(Z)}-\\log\\frac{p(Z|X)}{q(Z)} $$ \u5de6\u53f3\u4e24\u8fb9\u5206\u522b\u79ef\u5206\uff1a $$ Left:\\int_Zq(Z)\\log p(X)dZ=\\log p(X)\\ Right:\\int_Z[\\log \\frac{p(X,Z)}{q(Z)}-\\log \\frac{p(Z|X)}{q(Z)}]q(Z)dZ=ELBO+KL(q,p) $$ \u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5199\u4e3a\u53d8\u5206\u548c KL \u6563\u5ea6\u7684\u548c\uff1a $$ L(q)+KL(q,p) $$ \u7531\u4e8e\u8fd9\u4e2a\u5f0f\u5b50\u662f\u5e38\u6570\uff0c\u4e8e\u662f\u5bfb\u627e \\(q\\simeq p\\) \u5c31\u76f8\u5f53\u4e8e\u5bf9 \\(L(q)\\) \u6700\u5927\u503c\u3002 $$ \\hat{q}(Z)=\\mathop{argmax} {q(Z)}L(q) $$ \u5047\u8bbe \\(q(Z)\\) \u53ef\u4ee5\u5212\u5206\u4e3a \\(M\\) \u4e2a\u7ec4\uff08\u5e73\u5747\u573a\u8fd1\u4f3c\uff09\uff1a $$ q(Z)=\\prod\\limits ^Mq_i(Z_i) $$ \u56e0\u6b64\uff0c\u5728 \\(L(q)=\\int_Zq(Z)\\log p(X,Z)dZ-\\int_Zq(Z)\\log{q(Z)}\\) \u4e2d\uff0c\u770b \\(p(Z_j)\\) \uff0c\u7b2c\u4e00\u9879\uff1a $$ \\begin{align}\\int_Zq(Z)\\log p(X,Z)dZ&=\\int_Z\\prod\\limits_{i=1}^Mq_i(Z_i)\\log p(X,Z)dZ\\nonumber\\ &=\\int_{Z_j}q_j(Z_j)\\int_{Z-Z_{j}}\\prod\\limits_{i\\ne j}q_i(Z_i)\\log p(X,Z)dZ\\nonumber\\ &=\\int_{Z_j}q_j(Z_j)\\mathbb{E} {\\prod\\limits q_i(Z_i)}[\\log p(X,Z)]dZ_j \\end{align} $$ \u7b2c\u4e8c\u9879\uff1a $$ \\int_Zq(Z)\\log q(Z)dZ=\\int_Z\\prod\\limits_{i=1}^Mq_i(Z_i)\\sum\\limits_{i=1}^M\\log q_i(Z_i)dZ $$ \u5c55\u5f00\u6c42\u548c\u9879\u7b2c\u4e00\u9879\u4e3a\uff1a $$ \\int_Z\\prod\\limits_{i=1}^Mq_i(Z_i)\\log q_1(Z_1)dZ=\\int_{Z_1}q_1(Z_1)\\log q_1(Z_1)dZ_1 $$ \u6240\u4ee5\uff1a $$ \\int_Zq(Z)\\log q(Z)dZ=\\sum\\limits_{i=1}^M\\int_{Z_i}q_i(Z_i)\\log q_i(Z_i)dZ_i=\\int_{Z_j}q_j(Z_j)\\log q_j(Z_j)dZ_j+Const $$ \u4e24\u9879\u76f8\u51cf\uff0c\u4ee4 \\(\\mathbb{E}_{\\prod\\limits_{i\\ne j}q_i(Z_i)}[\\log p(X,Z)]=\\log \\hat{p}(X,Z_j)\\) \u53ef\u4ee5\u5f97\u5230\uff1a $$ -\\int_{Z_j}q_j(Z_j)\\log\\frac{q_j(Z_j)}{\\hat{p}(X,Z_j)}dZ_j\\le 0 $$ \u4e8e\u662f\u6700\u5927\u7684 \\(q_j(Z_j)=\\hat{p}(X,Z_j)\\) \u624d\u80fd\u5f97\u5230\u6700\u5927\u503c\u3002\u6211\u4eec\u770b\u5230\uff0c\u5bf9\u6bcf\u4e00\u4e2a \\(q_j\\) \uff0c\u90fd\u662f\u56fa\u5b9a\u5176\u4f59\u7684 \\(q_i\\) \uff0c\u6c42\u8fd9\u4e2a\u503c\uff0c\u4e8e\u662f\u53ef\u4ee5\u4f7f\u7528\u5750\u6807\u4e0a\u5347\u7684\u65b9\u6cd5\u8fdb\u884c\u8fed\u4ee3\u6c42\u89e3\uff0c\u4e0a\u9762\u7684\u63a8\u5bfc\u9488\u5bf9\u5355\u4e2a\u6837\u672c\uff0c\u4f46\u662f\u5bf9\u6570\u636e\u96c6\u4e5f\u662f\u9002\u7528\u7684\u3002 \u57fa\u4e8e\u5e73\u5747\u573a\u5047\u8bbe\u7684\u53d8\u5206\u63a8\u65ad\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff1a \u5047\u8bbe\u592a\u5f3a\uff0c \\(Z\\) \u975e\u5e38\u590d\u6742\u7684\u60c5\u51b5\u4e0b\uff0c\u5047\u8bbe\u4e0d\u9002\u7528 \u671f\u671b\u4e2d\u7684\u79ef\u5206\uff0c\u53ef\u80fd\u65e0\u6cd5\u8ba1\u7b97 SGVI \u4ece \\(Z\\) \u5230 \\(X\\) \u7684\u8fc7\u7a0b\u53eb\u505a\u751f\u6210\u8fc7\u7a0b\u6216\u8bd1\u7801\uff0c\u53cd\u8fc7\u6765\u7684\u989d\u8fc7\u7a0b\u53eb\u63a8\u65ad\u8fc7\u7a0b\u6216\u7f16\u7801\u8fc7\u7a0b\uff0c\u57fa\u4e8e\u5e73\u5747\u573a\u7684\u53d8\u5206\u63a8\u65ad\u53ef\u4ee5\u5bfc\u51fa\u5750\u6807\u4e0a\u5347\u7684\u7b97\u6cd5\uff0c\u4f46\u662f\u8fd9\u4e2a\u5047\u8bbe\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\u5047\u8bbe\u592a\u5f3a\uff0c\u540c\u65f6\u79ef\u5206\u4e5f\u4e0d\u4e00\u5b9a\u80fd\u7b97\u3002\u6211\u4eec\u77e5\u9053\uff0c\u4f18\u5316\u65b9\u6cd5\u9664\u4e86\u5750\u6807\u4e0a\u5347\uff0c\u8fd8\u6709\u68af\u5ea6\u4e0a\u5347\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u5e0c\u671b\u901a\u8fc7\u68af\u5ea6\u4e0a\u5347\u6765\u5f97\u5230\u53d8\u5206\u63a8\u65ad\u7684\u53e6\u4e00\u79cd\u7b97\u6cd5\u3002 \u6211\u4eec\u7684\u76ee\u6807\u51fd\u6570\uff1a $$ \\hat{q}(Z)=\\mathop{argmax} {q(Z)}L(q) $$ \u5047\u5b9a \\(q(Z)=q_\\phi(Z)\\) \uff0c\u662f\u548c \\(\\phi\\) \u8fd9\u4e2a\u53c2\u6570\u76f8\u8fde\u7684\u6982\u7387\u5206\u5e03\u3002\u4e8e\u662f \\(\\mathop{argmax}_{q(Z)}L(q)=\\mathop{argmax}_{\\phi}L(\\phi)\\) \uff0c\u5176\u4e2d \\(L(\\phi)=\\mathbb{E}_{q_\\phi}[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]\\) \uff0c\u8fd9\u91cc \\(x^i\\) \u8868\u793a\u7b2c \\(i\\) \u4e2a\u6837\u672c\u3002 $$ \\begin{align}\\nabla \\phi L(\\phi)&=\\nabla_\\phi\\mathbb{E} {q \\phi}[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]\\nonumber\\ &=\\nabla_\\phi\\int q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz\\nonumber\\ &=\\int\\nabla_\\phi q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz+\\int q_\\phi(z)\\nabla_\\phi [\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz\\nonumber\\ &=\\int\\nabla_\\phi q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz-\\int q_\\phi(z)\\nabla_\\phi \\log q_\\phi(z)dz\\nonumber\\ &=\\int\\nabla_\\phi q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz-\\int \\nabla_\\phi q_\\phi(z)dz\\nonumber\\ &=\\int\\nabla_\\phi q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz\\nonumber\\ &=\\int q_\\phi(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z))dz\\nonumber\\ &=\\mathbb{E} {q \\phi}[(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z))] \\end{align} $$ \u8fd9\u4e2a\u671f\u671b\u53ef\u4ee5\u901a\u8fc7\u8499\u7279\u5361\u6d1b\u91c7\u6837\u6765\u8fd1\u4f3c\uff0c\u4ece\u800c\u5f97\u5230\u68af\u5ea6\uff0c\u7136\u540e\u5229\u7528\u68af\u5ea6\u4e0a\u5347\u7684\u65b9\u6cd5\u6765\u5f97\u5230\u53c2\u6570\uff1a $$ z^l\\sim q_\\phi(z)\\ \\mathbb{E} {q \\phi}[(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z))]\\sim \\frac{1}{L}\\sum\\limits_{l=1}^L(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z)) $$ \u4f46\u662f\u7531\u4e8e\u6c42\u548c\u7b26\u53f7\u4e2d\u5b58\u5728\u4e00\u4e2a\u5bf9\u6570\u9879\uff0c\u4e8e\u662f\u76f4\u63a5\u91c7\u6837\u7684\u65b9\u5dee\u5f88\u5927\uff0c\u9700\u8981\u91c7\u6837\u7684\u6837\u672c\u975e\u5e38\u591a\u3002\u4e3a\u4e86\u89e3\u51b3\u65b9\u5dee\u592a\u5927\u7684\u95ee\u9898\uff0c\u6211\u4eec\u91c7\u7528 Reparameterization \u7684\u6280\u5de7\u3002 \u8003\u8651\uff1a $$ \\nabla_\\phi L(\\phi)=\\nabla_\\phi\\mathbb{E} {q \\phi}[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)] $$ \u6211\u4eec\u53d6\uff1a \\(z=g_\\phi(\\varepsilon,x^i),\\varepsilon\\sim p(\\varepsilon)\\) \uff0c\u4e8e\u662f\u5bf9\u540e\u9a8c\uff1a \\(z\\sim q_\\phi(z|x^i)\\) \uff0c\u6709 \\(|q_\\phi(z|x^i)dz|=|p(\\varepsilon)d\\varepsilon|\\) \u3002\u4ee3\u5165\u4e0a\u9762\u7684\u68af\u5ea6\u4e2d\uff1a $$ \\begin{align} \\nabla_\\phi L(\\phi)&=\\nabla_\\phi\\mathbb{E} {q \\phi}[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]\\nonumber\\ &=\\nabla_\\phi L(\\phi)=\\nabla_\\phi\\int[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]q_\\phi dz\\nonumber\\ &=\\nabla_\\phi\\int[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]p_\\varepsilon d\\varepsilon\\nonumber\\ &=\\mathbb{E} {p(\\varepsilon)}[\\nabla \\phi[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]]\\nonumber\\ &=\\mathbb{E} {p(\\varepsilon)}[\\nabla_z[\\log p \\theta(x^i,z)-\\log q_\\phi(z)]\\nabla_\\phi z]\\nonumber\\ &=\\mathbb{E} {p(\\varepsilon)}[\\nabla_z[\\log p \\theta(x^i,z)-\\log q_\\phi(z)]\\nabla_\\phi g_\\phi(\\varepsilon,x^i)] \\end{align} $$ \u5bf9\u8fd9\u4e2a\u5f0f\u5b50\u8fdb\u884c\u8499\u7279\u5361\u6d1b\u91c7\u6837\uff0c\u7136\u540e\u8ba1\u7b97\u671f\u671b\uff0c\u5f97\u5230\u68af\u5ea6\u3002","title":"\u53d8\u5206\u63a8\u65ad"},{"location":"Machine_Learning/10.VI/#_1","text":"\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u6982\u7387\u6a21\u578b\u53ef\u4ee5\u5206\u4e3a\uff0c\u9891\u7387\u6d3e\u7684\u4f18\u5316\u95ee\u9898\u548c\u8d1d\u53f6\u65af\u6d3e\u7684\u79ef\u5206\u95ee\u9898\u3002\u4ece\u8d1d\u53f6\u65af\u89d2\u5ea6\u6765\u770b\u63a8\u65ad\uff0c\u5bf9\u4e8e \\(\\hat{x}\\) \u8fd9\u6837\u7684\u65b0\u6837\u672c\uff0c\u9700\u8981\u5f97\u5230\uff1a $$ p(\\hat{x}|X)=\\int_\\theta p(\\hat{x},\\theta|X)d\\theta=\\int_\\theta p(\\theta|X)p(\\hat{x}|\\theta,X)d\\theta $$ \u5982\u679c\u65b0\u6837\u672c\u548c\u6570\u636e\u96c6\u72ec\u7acb\uff0c\u90a3\u4e48\u63a8\u65ad\u5c31\u662f\u6982\u7387\u5206\u5e03\u4f9d\u53c2\u6570\u540e\u9a8c\u5206\u5e03\u7684\u671f\u671b\u3002 \u6211\u4eec\u770b\u5230\uff0c\u63a8\u65ad\u95ee\u9898\u7684\u4e2d\u5fc3\u662f\u53c2\u6570\u540e\u9a8c\u5206\u5e03\u7684\u6c42\u89e3\uff0c\u63a8\u65ad\u5206\u4e3a\uff1a \u7cbe\u786e\u63a8\u65ad \u8fd1\u4f3c\u63a8\u65ad-\u53c2\u6570\u7a7a\u95f4\u65e0\u6cd5\u7cbe\u786e\u6c42\u89e3 \u786e\u5b9a\u6027\u8fd1\u4f3c-\u5982\u53d8\u5206\u63a8\u65ad \u968f\u673a\u8fd1\u4f3c-\u5982 MCMC\uff0cMH\uff0cGibbs","title":"\u53d8\u5206\u63a8\u65ad"},{"location":"Machine_Learning/10.VI/#_2","text":"\u6211\u4eec\u8bb0 \\(Z\\) \u4e3a\u9690\u53d8\u91cf\u548c\u53c2\u6570\u7684\u96c6\u5408\uff0c \\(Z_i\\) \u4e3a\u7b2c \\(i\\) \u7ef4\u7684\u53c2\u6570\uff0c\u4e8e\u662f\uff0c\u56de\u987e\u4e00\u4e0b EM \u4e2d\u7684\u63a8\u5bfc\uff1a $$ \\log p(X)=\\log p(X,Z)-\\log p(Z|X)=\\log\\frac{p(X,Z)}{q(Z)}-\\log\\frac{p(Z|X)}{q(Z)} $$ \u5de6\u53f3\u4e24\u8fb9\u5206\u522b\u79ef\u5206\uff1a $$ Left:\\int_Zq(Z)\\log p(X)dZ=\\log p(X)\\ Right:\\int_Z[\\log \\frac{p(X,Z)}{q(Z)}-\\log \\frac{p(Z|X)}{q(Z)}]q(Z)dZ=ELBO+KL(q,p) $$ \u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5199\u4e3a\u53d8\u5206\u548c KL \u6563\u5ea6\u7684\u548c\uff1a $$ L(q)+KL(q,p) $$ \u7531\u4e8e\u8fd9\u4e2a\u5f0f\u5b50\u662f\u5e38\u6570\uff0c\u4e8e\u662f\u5bfb\u627e \\(q\\simeq p\\) \u5c31\u76f8\u5f53\u4e8e\u5bf9 \\(L(q)\\) \u6700\u5927\u503c\u3002 $$ \\hat{q}(Z)=\\mathop{argmax} {q(Z)}L(q) $$ \u5047\u8bbe \\(q(Z)\\) \u53ef\u4ee5\u5212\u5206\u4e3a \\(M\\) \u4e2a\u7ec4\uff08\u5e73\u5747\u573a\u8fd1\u4f3c\uff09\uff1a $$ q(Z)=\\prod\\limits ^Mq_i(Z_i) $$ \u56e0\u6b64\uff0c\u5728 \\(L(q)=\\int_Zq(Z)\\log p(X,Z)dZ-\\int_Zq(Z)\\log{q(Z)}\\) \u4e2d\uff0c\u770b \\(p(Z_j)\\) \uff0c\u7b2c\u4e00\u9879\uff1a $$ \\begin{align}\\int_Zq(Z)\\log p(X,Z)dZ&=\\int_Z\\prod\\limits_{i=1}^Mq_i(Z_i)\\log p(X,Z)dZ\\nonumber\\ &=\\int_{Z_j}q_j(Z_j)\\int_{Z-Z_{j}}\\prod\\limits_{i\\ne j}q_i(Z_i)\\log p(X,Z)dZ\\nonumber\\ &=\\int_{Z_j}q_j(Z_j)\\mathbb{E} {\\prod\\limits q_i(Z_i)}[\\log p(X,Z)]dZ_j \\end{align} $$ \u7b2c\u4e8c\u9879\uff1a $$ \\int_Zq(Z)\\log q(Z)dZ=\\int_Z\\prod\\limits_{i=1}^Mq_i(Z_i)\\sum\\limits_{i=1}^M\\log q_i(Z_i)dZ $$ \u5c55\u5f00\u6c42\u548c\u9879\u7b2c\u4e00\u9879\u4e3a\uff1a $$ \\int_Z\\prod\\limits_{i=1}^Mq_i(Z_i)\\log q_1(Z_1)dZ=\\int_{Z_1}q_1(Z_1)\\log q_1(Z_1)dZ_1 $$ \u6240\u4ee5\uff1a $$ \\int_Zq(Z)\\log q(Z)dZ=\\sum\\limits_{i=1}^M\\int_{Z_i}q_i(Z_i)\\log q_i(Z_i)dZ_i=\\int_{Z_j}q_j(Z_j)\\log q_j(Z_j)dZ_j+Const $$ \u4e24\u9879\u76f8\u51cf\uff0c\u4ee4 \\(\\mathbb{E}_{\\prod\\limits_{i\\ne j}q_i(Z_i)}[\\log p(X,Z)]=\\log \\hat{p}(X,Z_j)\\) \u53ef\u4ee5\u5f97\u5230\uff1a $$ -\\int_{Z_j}q_j(Z_j)\\log\\frac{q_j(Z_j)}{\\hat{p}(X,Z_j)}dZ_j\\le 0 $$ \u4e8e\u662f\u6700\u5927\u7684 \\(q_j(Z_j)=\\hat{p}(X,Z_j)\\) \u624d\u80fd\u5f97\u5230\u6700\u5927\u503c\u3002\u6211\u4eec\u770b\u5230\uff0c\u5bf9\u6bcf\u4e00\u4e2a \\(q_j\\) \uff0c\u90fd\u662f\u56fa\u5b9a\u5176\u4f59\u7684 \\(q_i\\) \uff0c\u6c42\u8fd9\u4e2a\u503c\uff0c\u4e8e\u662f\u53ef\u4ee5\u4f7f\u7528\u5750\u6807\u4e0a\u5347\u7684\u65b9\u6cd5\u8fdb\u884c\u8fed\u4ee3\u6c42\u89e3\uff0c\u4e0a\u9762\u7684\u63a8\u5bfc\u9488\u5bf9\u5355\u4e2a\u6837\u672c\uff0c\u4f46\u662f\u5bf9\u6570\u636e\u96c6\u4e5f\u662f\u9002\u7528\u7684\u3002 \u57fa\u4e8e\u5e73\u5747\u573a\u5047\u8bbe\u7684\u53d8\u5206\u63a8\u65ad\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff1a \u5047\u8bbe\u592a\u5f3a\uff0c \\(Z\\) \u975e\u5e38\u590d\u6742\u7684\u60c5\u51b5\u4e0b\uff0c\u5047\u8bbe\u4e0d\u9002\u7528 \u671f\u671b\u4e2d\u7684\u79ef\u5206\uff0c\u53ef\u80fd\u65e0\u6cd5\u8ba1\u7b97","title":"\u57fa\u4e8e\u5e73\u5747\u573a\u5047\u8bbe\u7684\u53d8\u5206\u63a8\u65ad"},{"location":"Machine_Learning/10.VI/#sgvi","text":"\u4ece \\(Z\\) \u5230 \\(X\\) \u7684\u8fc7\u7a0b\u53eb\u505a\u751f\u6210\u8fc7\u7a0b\u6216\u8bd1\u7801\uff0c\u53cd\u8fc7\u6765\u7684\u989d\u8fc7\u7a0b\u53eb\u63a8\u65ad\u8fc7\u7a0b\u6216\u7f16\u7801\u8fc7\u7a0b\uff0c\u57fa\u4e8e\u5e73\u5747\u573a\u7684\u53d8\u5206\u63a8\u65ad\u53ef\u4ee5\u5bfc\u51fa\u5750\u6807\u4e0a\u5347\u7684\u7b97\u6cd5\uff0c\u4f46\u662f\u8fd9\u4e2a\u5047\u8bbe\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\u5047\u8bbe\u592a\u5f3a\uff0c\u540c\u65f6\u79ef\u5206\u4e5f\u4e0d\u4e00\u5b9a\u80fd\u7b97\u3002\u6211\u4eec\u77e5\u9053\uff0c\u4f18\u5316\u65b9\u6cd5\u9664\u4e86\u5750\u6807\u4e0a\u5347\uff0c\u8fd8\u6709\u68af\u5ea6\u4e0a\u5347\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u5e0c\u671b\u901a\u8fc7\u68af\u5ea6\u4e0a\u5347\u6765\u5f97\u5230\u53d8\u5206\u63a8\u65ad\u7684\u53e6\u4e00\u79cd\u7b97\u6cd5\u3002 \u6211\u4eec\u7684\u76ee\u6807\u51fd\u6570\uff1a $$ \\hat{q}(Z)=\\mathop{argmax} {q(Z)}L(q) $$ \u5047\u5b9a \\(q(Z)=q_\\phi(Z)\\) \uff0c\u662f\u548c \\(\\phi\\) \u8fd9\u4e2a\u53c2\u6570\u76f8\u8fde\u7684\u6982\u7387\u5206\u5e03\u3002\u4e8e\u662f \\(\\mathop{argmax}_{q(Z)}L(q)=\\mathop{argmax}_{\\phi}L(\\phi)\\) \uff0c\u5176\u4e2d \\(L(\\phi)=\\mathbb{E}_{q_\\phi}[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]\\) \uff0c\u8fd9\u91cc \\(x^i\\) \u8868\u793a\u7b2c \\(i\\) \u4e2a\u6837\u672c\u3002 $$ \\begin{align}\\nabla \\phi L(\\phi)&=\\nabla_\\phi\\mathbb{E} {q \\phi}[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]\\nonumber\\ &=\\nabla_\\phi\\int q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz\\nonumber\\ &=\\int\\nabla_\\phi q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz+\\int q_\\phi(z)\\nabla_\\phi [\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz\\nonumber\\ &=\\int\\nabla_\\phi q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz-\\int q_\\phi(z)\\nabla_\\phi \\log q_\\phi(z)dz\\nonumber\\ &=\\int\\nabla_\\phi q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz-\\int \\nabla_\\phi q_\\phi(z)dz\\nonumber\\ &=\\int\\nabla_\\phi q_\\phi(z)[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]dz\\nonumber\\ &=\\int q_\\phi(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z))dz\\nonumber\\ &=\\mathbb{E} {q \\phi}[(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z))] \\end{align} $$ \u8fd9\u4e2a\u671f\u671b\u53ef\u4ee5\u901a\u8fc7\u8499\u7279\u5361\u6d1b\u91c7\u6837\u6765\u8fd1\u4f3c\uff0c\u4ece\u800c\u5f97\u5230\u68af\u5ea6\uff0c\u7136\u540e\u5229\u7528\u68af\u5ea6\u4e0a\u5347\u7684\u65b9\u6cd5\u6765\u5f97\u5230\u53c2\u6570\uff1a $$ z^l\\sim q_\\phi(z)\\ \\mathbb{E} {q \\phi}[(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z))]\\sim \\frac{1}{L}\\sum\\limits_{l=1}^L(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z)) $$ \u4f46\u662f\u7531\u4e8e\u6c42\u548c\u7b26\u53f7\u4e2d\u5b58\u5728\u4e00\u4e2a\u5bf9\u6570\u9879\uff0c\u4e8e\u662f\u76f4\u63a5\u91c7\u6837\u7684\u65b9\u5dee\u5f88\u5927\uff0c\u9700\u8981\u91c7\u6837\u7684\u6837\u672c\u975e\u5e38\u591a\u3002\u4e3a\u4e86\u89e3\u51b3\u65b9\u5dee\u592a\u5927\u7684\u95ee\u9898\uff0c\u6211\u4eec\u91c7\u7528 Reparameterization \u7684\u6280\u5de7\u3002 \u8003\u8651\uff1a $$ \\nabla_\\phi L(\\phi)=\\nabla_\\phi\\mathbb{E} {q \\phi}[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)] $$ \u6211\u4eec\u53d6\uff1a \\(z=g_\\phi(\\varepsilon,x^i),\\varepsilon\\sim p(\\varepsilon)\\) \uff0c\u4e8e\u662f\u5bf9\u540e\u9a8c\uff1a \\(z\\sim q_\\phi(z|x^i)\\) \uff0c\u6709 \\(|q_\\phi(z|x^i)dz|=|p(\\varepsilon)d\\varepsilon|\\) \u3002\u4ee3\u5165\u4e0a\u9762\u7684\u68af\u5ea6\u4e2d\uff1a $$ \\begin{align} \\nabla_\\phi L(\\phi)&=\\nabla_\\phi\\mathbb{E} {q \\phi}[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]\\nonumber\\ &=\\nabla_\\phi L(\\phi)=\\nabla_\\phi\\int[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]q_\\phi dz\\nonumber\\ &=\\nabla_\\phi\\int[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]p_\\varepsilon d\\varepsilon\\nonumber\\ &=\\mathbb{E} {p(\\varepsilon)}[\\nabla \\phi[\\log p_\\theta(x^i,z)-\\log q_\\phi(z)]]\\nonumber\\ &=\\mathbb{E} {p(\\varepsilon)}[\\nabla_z[\\log p \\theta(x^i,z)-\\log q_\\phi(z)]\\nabla_\\phi z]\\nonumber\\ &=\\mathbb{E} {p(\\varepsilon)}[\\nabla_z[\\log p \\theta(x^i,z)-\\log q_\\phi(z)]\\nabla_\\phi g_\\phi(\\varepsilon,x^i)] \\end{align} $$ \u5bf9\u8fd9\u4e2a\u5f0f\u5b50\u8fdb\u884c\u8499\u7279\u5361\u6d1b\u91c7\u6837\uff0c\u7136\u540e\u8ba1\u7b97\u671f\u671b\uff0c\u5f97\u5230\u68af\u5ea6\u3002","title":"SGVI"},{"location":"Machine_Learning/11.MCMC/","text":"\u9a6c\u5c14\u53ef\u592b\u94fe\u8499\u7279\u5361\u6d1b MCMC \u662f\u4e00\u79cd\u968f\u673a\u7684\u8fd1\u4f3c\u63a8\u65ad\uff0c\u5176\u6838\u5fc3\u5c31\u662f\u57fa\u4e8e\u91c7\u6837\u7684\u968f\u673a\u8fd1\u4f3c\u65b9\u6cd5\u8499\u7279\u5361\u6d1b\u65b9\u6cd5\u3002\u5bf9\u4e8e\u91c7\u6837\u4efb\u52a1\u6765\u8bf4\uff0c\u6709\u4e0b\u9762\u4e00\u4e9b\u5e38\u7528\u7684\u573a\u666f\uff1a \u91c7\u6837\u4f5c\u4e3a\u4efb\u52a1\uff0c\u7528\u4e8e\u751f\u6210\u65b0\u7684\u6837\u672c \u6c42\u548c/\u6c42\u79ef\u5206 \u91c7\u6837\u7ed3\u675f\u540e\uff0c\u6211\u4eec\u9700\u8981\u8bc4\u4ef7\u91c7\u6837\u51fa\u6765\u7684\u6837\u672c\u70b9\u662f\u4e0d\u662f\u597d\u7684\u6837\u672c\u96c6\uff1a \u6837\u672c\u8d8b\u5411\u4e8e\u9ad8\u6982\u7387\u7684\u533a\u57df \u6837\u672c\u4e4b\u95f4\u5fc5\u987b\u72ec\u7acb \u5177\u4f53\u91c7\u6837\u4e2d\uff0c\u91c7\u6837\u662f\u4e00\u4e2a\u56f0\u96be\u7684\u8fc7\u7a0b\uff1a \u65e0\u6cd5\u91c7\u6837\u5f97\u5230\u5f52\u4e00\u5316\u56e0\u5b50\uff0c\u5373\u65e0\u6cd5\u76f4\u63a5\u5bf9\u6982\u7387 \\(p(x)=\\frac{1}{Z}\\hat{p}(x)\\) \u91c7\u6837\uff0c\u5e38\u5e38\u9700\u8981\u5bf9 CDF \u91c7\u6837\uff0c\u4f46\u590d\u6742\u7684\u60c5\u51b5\u4e0d\u884c \u5982\u679c\u5f52\u4e00\u5316\u56e0\u5b50\u53ef\u4ee5\u6c42\u5f97\uff0c\u4f46\u662f\u5bf9\u9ad8\u7ef4\u6570\u636e\u4f9d\u7136\u4e0d\u80fd\u5747\u5300\u91c7\u6837\uff08\u7ef4\u5ea6\u707e\u96be\uff09\uff0c\u8fd9\u662f\u7531\u4e8e\u5bf9 \\(p\\) \u7ef4\u7a7a\u95f4\uff0c\u603b\u7684\u72b6\u6001\u7a7a\u95f4\u662f \\(K^p\\) \u8fd9\u4e48\u5927\uff0c\u4e8e\u662f\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u91c7\u6837\u4e5f\u4e0d\u884c \u56e0\u6b64\u9700\u8981\u501f\u52a9\u5176\u4ed6\u624b\u6bb5\uff0c\u5982\u8499\u7279\u5361\u6d1b\u65b9\u6cd5\u4e2d\u7684\u62d2\u7edd\u91c7\u6837\uff0c\u91cd\u8981\u6027\u91c7\u6837\u548c MCMC\u3002 \u8499\u7279\u5361\u6d1b\u65b9\u6cd5 \u8499\u7279\u5361\u6d1b\u65b9\u6cd5\u65e8\u5728\u6c42\u5f97\u590d\u6742\u6982\u7387\u5206\u5e03\u4e0b\u7684\u671f\u671b\u503c\uff1a \\(\\mathbb{E}_{z|x}[f(z)]=\\int p(z|x)f(z)dz\\simeq\\frac{1}{N}\\sum\\limits_{i=1}^Nf(z_i)\\) \uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ece\u6982\u7387\u5206\u5e03\u4e2d\u53d6 \\(N\\) \u4e2a\u70b9\uff0c\u4ece\u800c\u8fd1\u4f3c\u8ba1\u7b97\u8fd9\u4e2a\u79ef\u5206\u3002\u91c7\u6837\u65b9\u6cd5\u6709\uff1a \u6982\u7387\u5206\u5e03\u91c7\u6837\uff0c\u9996\u5148\u6c42\u5f97\u6982\u7387\u5bc6\u5ea6\u7684\u7d2f\u79ef\u5bc6\u5ea6\u51fd\u6570 CDF\uff0c\u7136\u540e\u6c42\u5f97 CDF \u7684\u53cd\u51fd\u6570\uff0c\u57280\u52301\u4e4b\u95f4\u5747\u5300\u91c7\u6837\uff0c\u4ee3\u5165\u53cd\u51fd\u6570\uff0c\u5c31\u5f97\u5230\u4e86\u91c7\u6837\u70b9\u3002\u4f46\u662f\u5b9e\u9645\u5927\u90e8\u5206\u6982\u7387\u5206\u5e03\u4e0d\u80fd\u5f97\u5230 CDF\u3002 Rejection Sampling \u62d2\u7edd\u91c7\u6837\uff1a\u5bf9\u4e8e\u6982\u7387\u5206\u5e03 \\(p(z)\\) \uff0c\u5f15\u5165\u7b80\u5355\u7684\u63d0\u8bae\u5206\u5e03 \\(q(z)\\) \uff0c\u4f7f\u5f97 \\(\\forall z_i,Mq(z_i)\\ge p(z_i)\\) \u3002\u6211\u4eec\u5148\u5728 \\(q(z)\\) \u4e2d\u91c7\u6837\uff0c\u5b9a\u4e49\u63a5\u53d7\u7387\uff1a \\(\\alpha=\\frac{p(z^i)}{Mq(z^i)}\\le1\\) \u3002\u7b97\u6cd5\u63cf\u8ff0\u4e3a\uff1a \u53d6 \\(z^i\\sim q(z)\\) \u3002 \u5728\u5747\u5300\u5206\u5e03\u4e2d\u9009\u53d6 \\(u\\) \u3002 \u5982\u679c \\(u\\le\\alpha\\) \uff0c\u5219\u63a5\u53d7 \\(z^i\\) \uff0c\u5426\u5219\uff0c\u62d2\u7edd\u8fd9\u4e2a\u503c\u3002 Importance Sampling\uff1a\u76f4\u63a5\u5bf9\u671f\u671b\uff1a \\(\\mathbb{E}_{p(z)}[f(z)]\\) \u8fdb\u884c\u91c7\u6837\u3002 $$ \\mathbb{E} {p(z)}[f(z)]=\\int p(z)f(z)dz=\\int \\frac{p(z)}{q(z)}f(z)q(z)dz\\simeq\\frac{1}{N}\\sum\\limits ^Nf(z_i)\\frac{p(z_i)}{q(z_i)} $$ \u4e8e\u662f\u91c7\u6837\u5728 \\(q(z)\\) \u4e2d\u91c7\u6837\uff0c\u5e76\u901a\u8fc7\u6743\u91cd\u8ba1\u7b97\u548c\u3002\u91cd\u8981\u503c\u91c7\u6837\u5bf9\u4e8e\u6743\u91cd\u975e\u5e38\u5c0f\u7684\u65f6\u5019\uff0c\u6548\u7387\u975e\u5e38\u4f4e\u3002\u91cd\u8981\u6027\u91c7\u6837\u6709\u4e00\u4e2a\u53d8\u79cd Sampling-Importance-Resampling\uff0c\u8fd9\u79cd\u65b9\u6cd5\uff0c\u9996\u5148\u548c\u4e0a\u9762\u4e00\u6837\u8fdb\u884c\u91c7\u6837\uff0c\u7136\u540e\u5728\u91c7\u6837\u51fa\u6765\u7684 \\(N\\) \u4e2a\u6837\u672c\u4e2d\uff0c\u91cd\u65b0\u91c7\u6837\uff0c\u8fd9\u4e2a\u91cd\u65b0\u91c7\u6837\uff0c\u4f7f\u7528\u6bcf\u4e2a\u6837\u672c\u70b9\u7684\u6743\u91cd\u4f5c\u4e3a\u6982\u7387\u5206\u5e03\u8fdb\u884c\u91c7\u6837\u3002 MCMC \u9a6c\u5c14\u53ef\u592b\u94fe\u5f0f\u4e00\u79cd\u65f6\u95f4\u72b6\u6001\u90fd\u662f\u79bb\u6563\u7684\u968f\u673a\u53d8\u91cf\u5e8f\u5217\u3002\u6211\u4eec\u5173\u6ce8\u7684\u4e3b\u8981\u662f\u9f50\u6b21\u7684\u4e00\u9636\u9a6c\u5c14\u53ef\u592b\u94fe\u3002\u9a6c\u5c14\u53ef\u592b\u94fe\u6ee1\u8db3\uff1a \\(p(X_{t+1}|X_1,X_2,\\cdots,X_t)=p(X_{t+1}|X_t)\\) \u3002\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5199\u6210\u8f6c\u79fb\u77e9\u9635\u7684\u5f62\u5f0f \\(p_{ij}=p(X_{t+1}=j|X_t=i)\\) \u3002\u6211\u4eec\u6709\uff1a $$ \\pi_{t+1}(x^ )=\\int\\pi_i(x)p_{x\\to x^ }dx $$ \u5982\u679c\u5b58\u5728 \\(\\pi=(\\pi(1),\\pi(2),\\cdots),\\sum\\limits_{i=1}^{+\\infty}\\pi(i)=1\\) \uff0c\u6709\u4e0a\u5f0f\u6210\u7acb\uff0c\u8fd9\u4e2a\u5e8f\u5217\u5c31\u53eb\u9a6c\u5c14\u53ef\u592b\u94fe \\(X_t\\) \u7684\u5e73\u7a33\u5206\u5e03\uff0c\u5e73\u7a33\u5206\u5e03\u5c31\u662f\u8868\u793a\u5728\u67d0\u4e00\u4e2a\u65f6\u523b\u540e\uff0c\u5206\u5e03\u4e0d\u518d\u6539\u53d8\u3002MCMC \u5c31\u662f\u901a\u8fc7\u6784\u5efa\u9a6c\u5c14\u53ef\u592b\u94fe\u6982\u7387\u5e8f\u5217\uff0c\u4f7f\u5176\u6536\u655b\u5230\u5e73\u7a33\u5206\u5e03 \\(p(z)\\) \u3002\u5f15\u5165\u7ec6\u81f4\u5e73\u8861\uff1a \\(\\pi(x)p_{x\\to x^*}=\\pi(x^*)p_{x^*\\to x}\\) \u3002\u5982\u679c\u4e00\u4e2a\u5206\u5e03\u6ee1\u8db3\u7ec6\u81f4\u5e73\u8861\uff0c\u90a3\u4e48\u4e00\u5b9a\u6ee1\u8db3\u5e73\u7a33\u5206\u5e03\uff08\u53cd\u4e4b\u4e0d\u6210\u7acb\uff09\uff1a $$ \\int\\pi(x)p_{x\\to x^ }dx=\\int\\pi(x^ )p_{x^ \\to x}dx=\\pi(x^ ) $$ \u7ec6\u81f4\u5e73\u8861\u6761\u4ef6\u5c06\u5e73\u7a33\u5206\u5e03\u7684\u5e8f\u5217\u548c\u9a6c\u5c14\u53ef\u592b\u94fe\u7684\u8f6c\u79fb\u77e9\u9635\u8054\u7cfb\u5728\u4e00\u8d77\u4e86\uff0c\u901a\u8fc7\u8f6c\u79fb\u77e9\u9635\u53ef\u4ee5\u4e0d\u65ad\u751f\u6210\u6837\u672c\u70b9\u3002\u5047\u5b9a\u968f\u673a\u53d6\u4e00\u4e2a\u8f6c\u79fb\u77e9\u9635 \\((Q=Q_{ij})\\) \uff0c\u4f5c\u4e3a\u4e00\u4e2a\u63d0\u8bae\u77e9\u9635\u3002\u6211\u4eec\u6709\uff1a $$ p(z)\\cdot Q_{z\\to z^ }\\alpha(z,z^ )=p(z^ )\\cdot Q_{z^ \\to z}\\alpha(z^ ,z) $$ \u53d6 \uff1a $$ \\alpha(z,z^ )=\\min{1,\\frac{p(z^ )Q_{z^ \\to z}}{p(z)Q_{z\\to z^ }}} $$ \u5219 $$ p(z)\\cdot Q_{z\\to z^ }\\alpha(z,z^ )=\\min{p(z)Q_{z\\to z^ },p(z^ )Q_{z^ \\to z}}=p(z^ )\\cdot Q_{z^ \\to z}\\alpha(z^*,z) $$ \u4e8e\u662f\uff0c\u8fed\u4ee3\u5c31\u5f97\u5230\u4e86\u5e8f\u5217\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a Metropolis-Hastings \u7b97\u6cd5\uff1a \u901a\u8fc7\u57280\uff0c1\u4e4b\u95f4\u5747\u5300\u5206\u5e03\u53d6\u70b9 \\(u\\) \u751f\u6210 \\(z^*\\sim Q(z^*|z^{i-1})\\) \u8ba1\u7b97 \\(\\alpha\\) \u503c \u5982\u679c \\(\\alpha\\ge u\\) \uff0c\u5219 \\(z^i=z^*\\) \uff0c\u5426\u5219 \\(z^{i}=z^{i-1}\\) \u8fd9\u6837\u53d6\u7684\u6837\u672c\u5c31\u670d\u4ece \\(p(z)=\\frac{\\hat{p}(z)}{z_p}\\sim \\hat{p}(z)\\) \u3002 \u4e0b\u9762\u4ecb\u7ecd\u53e6\u4e00\u79cd\u91c7\u6837\u65b9\u5f0f Gibbs \u91c7\u6837\uff0c\u5982\u679c \\(z\\) \u7684\u7ef4\u5ea6\u975e\u5e38\u9ad8\uff0c\u90a3\u4e48\u901a\u8fc7\u56fa\u5b9a\u88ab\u91c7\u6837\u7684\u7ef4\u5ea6\u5176\u4f59\u7684\u7ef4\u5ea6\u6765\u7b80\u5316\u91c7\u6837\u8fc7\u7a0b\uff1a \\(z_i\\sim p(z_i|z_{-i})\\) \uff1a \u7ed9\u5b9a\u521d\u59cb\u503c \\(z_1^0,z_2^0,\\cdots\\) \u5728 \\(t+1\\) \u65f6\u523b\uff0c\u91c7\u6837 \\(z_i^{t+1}\\sim p(z_i|z_{-i})\\) \uff0c\u4ece\u7b2c\u4e00\u4e2a\u7ef4\u5ea6\u4e00\u4e2a\u4e2a\u91c7\u6837\u3002 Gibbs \u91c7\u6837\u65b9\u6cd5\u662f\u4e00\u79cd\u7279\u6b8a\u7684 MH \u91c7\u6837\uff0c\u53ef\u4ee5\u8ba1\u7b97 Gibbs \u91c7\u6837\u7684\u63a5\u53d7\u7387\uff1a $$ \\frac{p(z^ )Q_{z^ \\to z}}{p(z)Q_{z\\to z^ }}=\\frac{p(z_i^ |z^ _{-i})p(z^ {-i})p(z_i|z ^ )}{p(z_i|z_{-i})p(z_{-i})p(z_i^ |z_{-i})} $$ \u5bf9\u4e8e\u6bcf\u4e2a Gibbs \u91c7\u6837\u6b65\u9aa4\uff0c \\(z_{-i}=z_{-i}^*\\) \uff0c\u8fd9\u662f\u7531\u4e8e\u6bcf\u4e2a\u7ef4\u5ea6 \\(i\\) \u91c7\u6837\u7684\u65f6\u5019\uff0c\u5176\u4f59\u7684\u53c2\u91cf\u4fdd\u6301\u4e0d\u53d8\u3002\u6240\u4ee5\u4e0a\u5f0f\u4e3a1\u3002\u4e8e\u662f Gibbs \u91c7\u6837\u8fc7\u7a0b\u4e2d\uff0c\u76f8\u5f53\u4e8e\u627e\u5230\u4e86\u4e00\u4e2a\u6b65\u9aa4\uff0c\u4f7f\u5f97\u6240\u6709\u7684\u63a5\u53d7\u7387\u4e3a 1\u3002 \u5e73\u7a33\u5206\u5e03 \u5b9a\u4e49\u968f\u673a\u77e9\u9635\uff1a $$ Q=\\begin{pmatrix}Q_{11}&Q_{12}&\\cdots&Q_{1K}\\\\vdots&\\vdots&\\vdots&\\vdots\\Q_{k1}&Q_{k2}&\\cdots&Q_{KK}\\end{pmatrix} $$ \u8fd9\u4e2a\u77e9\u9635\u6bcf\u4e00\u884c\u6216\u8005\u6bcf\u4e00\u5217\u7684\u548c\u90fd\u662f1\u3002\u968f\u673a\u77e9\u9635\u7684\u7279\u5f81\u503c\u90fd\u5c0f\u4e8e\u7b49\u4e8e1\u3002\u5047\u8bbe\u53ea\u6709\u4e00\u4e2a\u7279\u5f81\u503c\u4e3a \\(\\lambda_i=1\\) \u3002\u4e8e\u662f\u5728\u9a6c\u5c14\u53ef\u592b\u8fc7\u7a0b\u4e2d\uff1a $$ q^{t+1}(x=j)=\\sum\\limits_{i=1}^Kq^t(x=i)Q_{ij}\\ \\Rightarrow q^{t+1}=q^t\\cdot Q=q^1Q^t $$ \u4e8e\u662f\u6709\uff1a $$ q^{t+1}=q^1A\\Lambda^t A^{-1} $$ \u5982\u679c \\(m\\) \u8db3\u591f\u5927\uff0c\u90a3\u4e48\uff0c \\(\\Lambda^m=diag(0,0,\\cdots,1,\\cdots,0)\\) \uff0c\u5219\uff1a \\(q^{m+1}=q^{m}\\) \uff0c\u5219\u8d8b\u4e8e\u5e73\u7a33\u5206\u5e03\u4e86\u3002\u9a6c\u5c14\u53ef\u592b\u94fe\u53ef\u80fd\u5177\u6709\u5e73\u7a33\u5206\u5e03\u7684\u6027\u8d28\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6784\u5efa\u9a6c\u5c14\u53ef\u592b\u94fe\u4f7f\u5176\u5e73\u7a33\u5206\u5e03\u6536\u655b\u4e8e\u9700\u8981\u7684\u6982\u7387\u5206\u5e03\uff08\u8bbe\u8ba1\u8f6c\u79fb\u77e9\u9635\uff09\u3002 \u5728\u91c7\u6837\u8fc7\u7a0b\u4e2d\uff0c\u9700\u8981\u7ecf\u5386\u4e00\u5b9a\u7684\u65f6\u95f4\uff08\u71c3\u70e7\u671f/\u6df7\u5408\u65f6\u95f4\uff09\u624d\u80fd\u8fbe\u5230\u5e73\u7a33\u5206\u5e03\u3002\u4f46\u662f MCMC \u65b9\u6cd5\u6709\u4e00\u4e9b\u95ee\u9898\uff1a \u65e0\u6cd5\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u6536\u655b \u71c3\u70e7\u671f\u8fc7\u957f\uff08\u7ef4\u5ea6\u592a\u9ad8\uff0c\u5e76\u4e14\u7ef4\u5ea6\u4e4b\u95f4\u6709\u5173\uff0c\u53ef\u80fd\u65e0\u6cd5\u91c7\u6837\u5230\u67d0\u4e9b\u7ef4\u5ea6\uff09\uff0c\u4f8b\u5982\u5728 GMM \u4e2d\uff0c\u53ef\u80fd\u65e0\u6cd5\u91c7\u6837\u5230\u67d0\u4e9b\u5cf0\u3002\u4e8e\u662f\u5728\u4e00\u4e9b\u6a21\u578b\u4e2d\uff0c\u9700\u8981\u5bf9\u9690\u53d8\u91cf\u4e4b\u95f4\u7684\u5173\u7cfb\u4f5c\u51fa\u7ea6\u675f\uff0c\u5982 RBM \u5047\u8bbe\u9690\u53d8\u91cf\u4e4b\u95f4\u65e0\u5173\u3002 \u6837\u672c\u4e4b\u95f4\u4e00\u5b9a\u662f\u6709\u76f8\u5173\u6027\u7684\uff0c\u5982\u679c\u6bcf\u4e2a\u65f6\u523b\u90fd\u53d6\u4e00\u4e2a\u70b9\uff0c\u90a3\u4e48\u6bcf\u4e2a\u6837\u672c\u4e00\u5b9a\u548c\u524d\u4e00\u4e2a\u76f8\u5173\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u95f4\u9694\u4e00\u6bb5\u65f6\u95f4\u91c7\u6837\u3002","title":"\u9a6c\u5c14\u53ef\u592b\u94fe\u8499\u7279\u5361\u6d1b"},{"location":"Machine_Learning/11.MCMC/#_1","text":"MCMC \u662f\u4e00\u79cd\u968f\u673a\u7684\u8fd1\u4f3c\u63a8\u65ad\uff0c\u5176\u6838\u5fc3\u5c31\u662f\u57fa\u4e8e\u91c7\u6837\u7684\u968f\u673a\u8fd1\u4f3c\u65b9\u6cd5\u8499\u7279\u5361\u6d1b\u65b9\u6cd5\u3002\u5bf9\u4e8e\u91c7\u6837\u4efb\u52a1\u6765\u8bf4\uff0c\u6709\u4e0b\u9762\u4e00\u4e9b\u5e38\u7528\u7684\u573a\u666f\uff1a \u91c7\u6837\u4f5c\u4e3a\u4efb\u52a1\uff0c\u7528\u4e8e\u751f\u6210\u65b0\u7684\u6837\u672c \u6c42\u548c/\u6c42\u79ef\u5206 \u91c7\u6837\u7ed3\u675f\u540e\uff0c\u6211\u4eec\u9700\u8981\u8bc4\u4ef7\u91c7\u6837\u51fa\u6765\u7684\u6837\u672c\u70b9\u662f\u4e0d\u662f\u597d\u7684\u6837\u672c\u96c6\uff1a \u6837\u672c\u8d8b\u5411\u4e8e\u9ad8\u6982\u7387\u7684\u533a\u57df \u6837\u672c\u4e4b\u95f4\u5fc5\u987b\u72ec\u7acb \u5177\u4f53\u91c7\u6837\u4e2d\uff0c\u91c7\u6837\u662f\u4e00\u4e2a\u56f0\u96be\u7684\u8fc7\u7a0b\uff1a \u65e0\u6cd5\u91c7\u6837\u5f97\u5230\u5f52\u4e00\u5316\u56e0\u5b50\uff0c\u5373\u65e0\u6cd5\u76f4\u63a5\u5bf9\u6982\u7387 \\(p(x)=\\frac{1}{Z}\\hat{p}(x)\\) \u91c7\u6837\uff0c\u5e38\u5e38\u9700\u8981\u5bf9 CDF \u91c7\u6837\uff0c\u4f46\u590d\u6742\u7684\u60c5\u51b5\u4e0d\u884c \u5982\u679c\u5f52\u4e00\u5316\u56e0\u5b50\u53ef\u4ee5\u6c42\u5f97\uff0c\u4f46\u662f\u5bf9\u9ad8\u7ef4\u6570\u636e\u4f9d\u7136\u4e0d\u80fd\u5747\u5300\u91c7\u6837\uff08\u7ef4\u5ea6\u707e\u96be\uff09\uff0c\u8fd9\u662f\u7531\u4e8e\u5bf9 \\(p\\) \u7ef4\u7a7a\u95f4\uff0c\u603b\u7684\u72b6\u6001\u7a7a\u95f4\u662f \\(K^p\\) \u8fd9\u4e48\u5927\uff0c\u4e8e\u662f\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u91c7\u6837\u4e5f\u4e0d\u884c \u56e0\u6b64\u9700\u8981\u501f\u52a9\u5176\u4ed6\u624b\u6bb5\uff0c\u5982\u8499\u7279\u5361\u6d1b\u65b9\u6cd5\u4e2d\u7684\u62d2\u7edd\u91c7\u6837\uff0c\u91cd\u8981\u6027\u91c7\u6837\u548c MCMC\u3002","title":"\u9a6c\u5c14\u53ef\u592b\u94fe\u8499\u7279\u5361\u6d1b"},{"location":"Machine_Learning/11.MCMC/#_2","text":"\u8499\u7279\u5361\u6d1b\u65b9\u6cd5\u65e8\u5728\u6c42\u5f97\u590d\u6742\u6982\u7387\u5206\u5e03\u4e0b\u7684\u671f\u671b\u503c\uff1a \\(\\mathbb{E}_{z|x}[f(z)]=\\int p(z|x)f(z)dz\\simeq\\frac{1}{N}\\sum\\limits_{i=1}^Nf(z_i)\\) \uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ece\u6982\u7387\u5206\u5e03\u4e2d\u53d6 \\(N\\) \u4e2a\u70b9\uff0c\u4ece\u800c\u8fd1\u4f3c\u8ba1\u7b97\u8fd9\u4e2a\u79ef\u5206\u3002\u91c7\u6837\u65b9\u6cd5\u6709\uff1a \u6982\u7387\u5206\u5e03\u91c7\u6837\uff0c\u9996\u5148\u6c42\u5f97\u6982\u7387\u5bc6\u5ea6\u7684\u7d2f\u79ef\u5bc6\u5ea6\u51fd\u6570 CDF\uff0c\u7136\u540e\u6c42\u5f97 CDF \u7684\u53cd\u51fd\u6570\uff0c\u57280\u52301\u4e4b\u95f4\u5747\u5300\u91c7\u6837\uff0c\u4ee3\u5165\u53cd\u51fd\u6570\uff0c\u5c31\u5f97\u5230\u4e86\u91c7\u6837\u70b9\u3002\u4f46\u662f\u5b9e\u9645\u5927\u90e8\u5206\u6982\u7387\u5206\u5e03\u4e0d\u80fd\u5f97\u5230 CDF\u3002 Rejection Sampling \u62d2\u7edd\u91c7\u6837\uff1a\u5bf9\u4e8e\u6982\u7387\u5206\u5e03 \\(p(z)\\) \uff0c\u5f15\u5165\u7b80\u5355\u7684\u63d0\u8bae\u5206\u5e03 \\(q(z)\\) \uff0c\u4f7f\u5f97 \\(\\forall z_i,Mq(z_i)\\ge p(z_i)\\) \u3002\u6211\u4eec\u5148\u5728 \\(q(z)\\) \u4e2d\u91c7\u6837\uff0c\u5b9a\u4e49\u63a5\u53d7\u7387\uff1a \\(\\alpha=\\frac{p(z^i)}{Mq(z^i)}\\le1\\) \u3002\u7b97\u6cd5\u63cf\u8ff0\u4e3a\uff1a \u53d6 \\(z^i\\sim q(z)\\) \u3002 \u5728\u5747\u5300\u5206\u5e03\u4e2d\u9009\u53d6 \\(u\\) \u3002 \u5982\u679c \\(u\\le\\alpha\\) \uff0c\u5219\u63a5\u53d7 \\(z^i\\) \uff0c\u5426\u5219\uff0c\u62d2\u7edd\u8fd9\u4e2a\u503c\u3002 Importance Sampling\uff1a\u76f4\u63a5\u5bf9\u671f\u671b\uff1a \\(\\mathbb{E}_{p(z)}[f(z)]\\) \u8fdb\u884c\u91c7\u6837\u3002 $$ \\mathbb{E} {p(z)}[f(z)]=\\int p(z)f(z)dz=\\int \\frac{p(z)}{q(z)}f(z)q(z)dz\\simeq\\frac{1}{N}\\sum\\limits ^Nf(z_i)\\frac{p(z_i)}{q(z_i)} $$ \u4e8e\u662f\u91c7\u6837\u5728 \\(q(z)\\) \u4e2d\u91c7\u6837\uff0c\u5e76\u901a\u8fc7\u6743\u91cd\u8ba1\u7b97\u548c\u3002\u91cd\u8981\u503c\u91c7\u6837\u5bf9\u4e8e\u6743\u91cd\u975e\u5e38\u5c0f\u7684\u65f6\u5019\uff0c\u6548\u7387\u975e\u5e38\u4f4e\u3002\u91cd\u8981\u6027\u91c7\u6837\u6709\u4e00\u4e2a\u53d8\u79cd Sampling-Importance-Resampling\uff0c\u8fd9\u79cd\u65b9\u6cd5\uff0c\u9996\u5148\u548c\u4e0a\u9762\u4e00\u6837\u8fdb\u884c\u91c7\u6837\uff0c\u7136\u540e\u5728\u91c7\u6837\u51fa\u6765\u7684 \\(N\\) \u4e2a\u6837\u672c\u4e2d\uff0c\u91cd\u65b0\u91c7\u6837\uff0c\u8fd9\u4e2a\u91cd\u65b0\u91c7\u6837\uff0c\u4f7f\u7528\u6bcf\u4e2a\u6837\u672c\u70b9\u7684\u6743\u91cd\u4f5c\u4e3a\u6982\u7387\u5206\u5e03\u8fdb\u884c\u91c7\u6837\u3002","title":"\u8499\u7279\u5361\u6d1b\u65b9\u6cd5"},{"location":"Machine_Learning/11.MCMC/#mcmc","text":"\u9a6c\u5c14\u53ef\u592b\u94fe\u5f0f\u4e00\u79cd\u65f6\u95f4\u72b6\u6001\u90fd\u662f\u79bb\u6563\u7684\u968f\u673a\u53d8\u91cf\u5e8f\u5217\u3002\u6211\u4eec\u5173\u6ce8\u7684\u4e3b\u8981\u662f\u9f50\u6b21\u7684\u4e00\u9636\u9a6c\u5c14\u53ef\u592b\u94fe\u3002\u9a6c\u5c14\u53ef\u592b\u94fe\u6ee1\u8db3\uff1a \\(p(X_{t+1}|X_1,X_2,\\cdots,X_t)=p(X_{t+1}|X_t)\\) \u3002\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5199\u6210\u8f6c\u79fb\u77e9\u9635\u7684\u5f62\u5f0f \\(p_{ij}=p(X_{t+1}=j|X_t=i)\\) \u3002\u6211\u4eec\u6709\uff1a $$ \\pi_{t+1}(x^ )=\\int\\pi_i(x)p_{x\\to x^ }dx $$ \u5982\u679c\u5b58\u5728 \\(\\pi=(\\pi(1),\\pi(2),\\cdots),\\sum\\limits_{i=1}^{+\\infty}\\pi(i)=1\\) \uff0c\u6709\u4e0a\u5f0f\u6210\u7acb\uff0c\u8fd9\u4e2a\u5e8f\u5217\u5c31\u53eb\u9a6c\u5c14\u53ef\u592b\u94fe \\(X_t\\) \u7684\u5e73\u7a33\u5206\u5e03\uff0c\u5e73\u7a33\u5206\u5e03\u5c31\u662f\u8868\u793a\u5728\u67d0\u4e00\u4e2a\u65f6\u523b\u540e\uff0c\u5206\u5e03\u4e0d\u518d\u6539\u53d8\u3002MCMC \u5c31\u662f\u901a\u8fc7\u6784\u5efa\u9a6c\u5c14\u53ef\u592b\u94fe\u6982\u7387\u5e8f\u5217\uff0c\u4f7f\u5176\u6536\u655b\u5230\u5e73\u7a33\u5206\u5e03 \\(p(z)\\) \u3002\u5f15\u5165\u7ec6\u81f4\u5e73\u8861\uff1a \\(\\pi(x)p_{x\\to x^*}=\\pi(x^*)p_{x^*\\to x}\\) \u3002\u5982\u679c\u4e00\u4e2a\u5206\u5e03\u6ee1\u8db3\u7ec6\u81f4\u5e73\u8861\uff0c\u90a3\u4e48\u4e00\u5b9a\u6ee1\u8db3\u5e73\u7a33\u5206\u5e03\uff08\u53cd\u4e4b\u4e0d\u6210\u7acb\uff09\uff1a $$ \\int\\pi(x)p_{x\\to x^ }dx=\\int\\pi(x^ )p_{x^ \\to x}dx=\\pi(x^ ) $$ \u7ec6\u81f4\u5e73\u8861\u6761\u4ef6\u5c06\u5e73\u7a33\u5206\u5e03\u7684\u5e8f\u5217\u548c\u9a6c\u5c14\u53ef\u592b\u94fe\u7684\u8f6c\u79fb\u77e9\u9635\u8054\u7cfb\u5728\u4e00\u8d77\u4e86\uff0c\u901a\u8fc7\u8f6c\u79fb\u77e9\u9635\u53ef\u4ee5\u4e0d\u65ad\u751f\u6210\u6837\u672c\u70b9\u3002\u5047\u5b9a\u968f\u673a\u53d6\u4e00\u4e2a\u8f6c\u79fb\u77e9\u9635 \\((Q=Q_{ij})\\) \uff0c\u4f5c\u4e3a\u4e00\u4e2a\u63d0\u8bae\u77e9\u9635\u3002\u6211\u4eec\u6709\uff1a $$ p(z)\\cdot Q_{z\\to z^ }\\alpha(z,z^ )=p(z^ )\\cdot Q_{z^ \\to z}\\alpha(z^ ,z) $$ \u53d6 \uff1a $$ \\alpha(z,z^ )=\\min{1,\\frac{p(z^ )Q_{z^ \\to z}}{p(z)Q_{z\\to z^ }}} $$ \u5219 $$ p(z)\\cdot Q_{z\\to z^ }\\alpha(z,z^ )=\\min{p(z)Q_{z\\to z^ },p(z^ )Q_{z^ \\to z}}=p(z^ )\\cdot Q_{z^ \\to z}\\alpha(z^*,z) $$ \u4e8e\u662f\uff0c\u8fed\u4ee3\u5c31\u5f97\u5230\u4e86\u5e8f\u5217\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a Metropolis-Hastings \u7b97\u6cd5\uff1a \u901a\u8fc7\u57280\uff0c1\u4e4b\u95f4\u5747\u5300\u5206\u5e03\u53d6\u70b9 \\(u\\) \u751f\u6210 \\(z^*\\sim Q(z^*|z^{i-1})\\) \u8ba1\u7b97 \\(\\alpha\\) \u503c \u5982\u679c \\(\\alpha\\ge u\\) \uff0c\u5219 \\(z^i=z^*\\) \uff0c\u5426\u5219 \\(z^{i}=z^{i-1}\\) \u8fd9\u6837\u53d6\u7684\u6837\u672c\u5c31\u670d\u4ece \\(p(z)=\\frac{\\hat{p}(z)}{z_p}\\sim \\hat{p}(z)\\) \u3002 \u4e0b\u9762\u4ecb\u7ecd\u53e6\u4e00\u79cd\u91c7\u6837\u65b9\u5f0f Gibbs \u91c7\u6837\uff0c\u5982\u679c \\(z\\) \u7684\u7ef4\u5ea6\u975e\u5e38\u9ad8\uff0c\u90a3\u4e48\u901a\u8fc7\u56fa\u5b9a\u88ab\u91c7\u6837\u7684\u7ef4\u5ea6\u5176\u4f59\u7684\u7ef4\u5ea6\u6765\u7b80\u5316\u91c7\u6837\u8fc7\u7a0b\uff1a \\(z_i\\sim p(z_i|z_{-i})\\) \uff1a \u7ed9\u5b9a\u521d\u59cb\u503c \\(z_1^0,z_2^0,\\cdots\\) \u5728 \\(t+1\\) \u65f6\u523b\uff0c\u91c7\u6837 \\(z_i^{t+1}\\sim p(z_i|z_{-i})\\) \uff0c\u4ece\u7b2c\u4e00\u4e2a\u7ef4\u5ea6\u4e00\u4e2a\u4e2a\u91c7\u6837\u3002 Gibbs \u91c7\u6837\u65b9\u6cd5\u662f\u4e00\u79cd\u7279\u6b8a\u7684 MH \u91c7\u6837\uff0c\u53ef\u4ee5\u8ba1\u7b97 Gibbs \u91c7\u6837\u7684\u63a5\u53d7\u7387\uff1a $$ \\frac{p(z^ )Q_{z^ \\to z}}{p(z)Q_{z\\to z^ }}=\\frac{p(z_i^ |z^ _{-i})p(z^ {-i})p(z_i|z ^ )}{p(z_i|z_{-i})p(z_{-i})p(z_i^ |z_{-i})} $$ \u5bf9\u4e8e\u6bcf\u4e2a Gibbs \u91c7\u6837\u6b65\u9aa4\uff0c \\(z_{-i}=z_{-i}^*\\) \uff0c\u8fd9\u662f\u7531\u4e8e\u6bcf\u4e2a\u7ef4\u5ea6 \\(i\\) \u91c7\u6837\u7684\u65f6\u5019\uff0c\u5176\u4f59\u7684\u53c2\u91cf\u4fdd\u6301\u4e0d\u53d8\u3002\u6240\u4ee5\u4e0a\u5f0f\u4e3a1\u3002\u4e8e\u662f Gibbs \u91c7\u6837\u8fc7\u7a0b\u4e2d\uff0c\u76f8\u5f53\u4e8e\u627e\u5230\u4e86\u4e00\u4e2a\u6b65\u9aa4\uff0c\u4f7f\u5f97\u6240\u6709\u7684\u63a5\u53d7\u7387\u4e3a 1\u3002","title":"MCMC"},{"location":"Machine_Learning/11.MCMC/#_3","text":"\u5b9a\u4e49\u968f\u673a\u77e9\u9635\uff1a $$ Q=\\begin{pmatrix}Q_{11}&Q_{12}&\\cdots&Q_{1K}\\\\vdots&\\vdots&\\vdots&\\vdots\\Q_{k1}&Q_{k2}&\\cdots&Q_{KK}\\end{pmatrix} $$ \u8fd9\u4e2a\u77e9\u9635\u6bcf\u4e00\u884c\u6216\u8005\u6bcf\u4e00\u5217\u7684\u548c\u90fd\u662f1\u3002\u968f\u673a\u77e9\u9635\u7684\u7279\u5f81\u503c\u90fd\u5c0f\u4e8e\u7b49\u4e8e1\u3002\u5047\u8bbe\u53ea\u6709\u4e00\u4e2a\u7279\u5f81\u503c\u4e3a \\(\\lambda_i=1\\) \u3002\u4e8e\u662f\u5728\u9a6c\u5c14\u53ef\u592b\u8fc7\u7a0b\u4e2d\uff1a $$ q^{t+1}(x=j)=\\sum\\limits_{i=1}^Kq^t(x=i)Q_{ij}\\ \\Rightarrow q^{t+1}=q^t\\cdot Q=q^1Q^t $$ \u4e8e\u662f\u6709\uff1a $$ q^{t+1}=q^1A\\Lambda^t A^{-1} $$ \u5982\u679c \\(m\\) \u8db3\u591f\u5927\uff0c\u90a3\u4e48\uff0c \\(\\Lambda^m=diag(0,0,\\cdots,1,\\cdots,0)\\) \uff0c\u5219\uff1a \\(q^{m+1}=q^{m}\\) \uff0c\u5219\u8d8b\u4e8e\u5e73\u7a33\u5206\u5e03\u4e86\u3002\u9a6c\u5c14\u53ef\u592b\u94fe\u53ef\u80fd\u5177\u6709\u5e73\u7a33\u5206\u5e03\u7684\u6027\u8d28\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6784\u5efa\u9a6c\u5c14\u53ef\u592b\u94fe\u4f7f\u5176\u5e73\u7a33\u5206\u5e03\u6536\u655b\u4e8e\u9700\u8981\u7684\u6982\u7387\u5206\u5e03\uff08\u8bbe\u8ba1\u8f6c\u79fb\u77e9\u9635\uff09\u3002 \u5728\u91c7\u6837\u8fc7\u7a0b\u4e2d\uff0c\u9700\u8981\u7ecf\u5386\u4e00\u5b9a\u7684\u65f6\u95f4\uff08\u71c3\u70e7\u671f/\u6df7\u5408\u65f6\u95f4\uff09\u624d\u80fd\u8fbe\u5230\u5e73\u7a33\u5206\u5e03\u3002\u4f46\u662f MCMC \u65b9\u6cd5\u6709\u4e00\u4e9b\u95ee\u9898\uff1a \u65e0\u6cd5\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u6536\u655b \u71c3\u70e7\u671f\u8fc7\u957f\uff08\u7ef4\u5ea6\u592a\u9ad8\uff0c\u5e76\u4e14\u7ef4\u5ea6\u4e4b\u95f4\u6709\u5173\uff0c\u53ef\u80fd\u65e0\u6cd5\u91c7\u6837\u5230\u67d0\u4e9b\u7ef4\u5ea6\uff09\uff0c\u4f8b\u5982\u5728 GMM \u4e2d\uff0c\u53ef\u80fd\u65e0\u6cd5\u91c7\u6837\u5230\u67d0\u4e9b\u5cf0\u3002\u4e8e\u662f\u5728\u4e00\u4e9b\u6a21\u578b\u4e2d\uff0c\u9700\u8981\u5bf9\u9690\u53d8\u91cf\u4e4b\u95f4\u7684\u5173\u7cfb\u4f5c\u51fa\u7ea6\u675f\uff0c\u5982 RBM \u5047\u8bbe\u9690\u53d8\u91cf\u4e4b\u95f4\u65e0\u5173\u3002 \u6837\u672c\u4e4b\u95f4\u4e00\u5b9a\u662f\u6709\u76f8\u5173\u6027\u7684\uff0c\u5982\u679c\u6bcf\u4e2a\u65f6\u523b\u90fd\u53d6\u4e00\u4e2a\u70b9\uff0c\u90a3\u4e48\u6bcf\u4e2a\u6837\u672c\u4e00\u5b9a\u548c\u524d\u4e00\u4e2a\u76f8\u5173\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u95f4\u9694\u4e00\u6bb5\u65f6\u95f4\u91c7\u6837\u3002","title":"\u5e73\u7a33\u5206\u5e03"},{"location":"Machine_Learning/12.HMM/","text":"\u9690\u9a6c\u5c14\u53ef\u592b\u6a21\u578b \u9690\u9a6c\u5c14\u53ef\u592b\u6a21\u578b\u662f\u4e00\u79cd\u6982\u7387\u56fe\u6a21\u578b\u3002\u6211\u4eec\u77e5\u9053\uff0c\u673a\u5668\u5b66\u4e60\u6a21\u578b\u53ef\u4ee5\u4ece\u9891\u7387\u6d3e\u548c\u8d1d\u53f6\u65af\u6d3e\u4e24\u4e2a\u65b9\u5411\u8003\u8651\uff0c\u5728\u9891\u7387\u6d3e\u7684\u65b9\u6cd5\u4e2d\u7684\u6838\u5fc3\u662f\u4f18\u5316\u95ee\u9898\uff0c\u800c\u5728\u8d1d\u53f6\u65af\u6d3e\u7684\u65b9\u6cd5\u4e2d\uff0c\u6838\u5fc3\u662f\u79ef\u5206\u95ee\u9898\uff0c\u4e5f\u53d1\u5c55\u51fa\u6765\u4e86\u4e00\u7cfb\u5217\u7684\u79ef\u5206\u65b9\u6cd5\u5982\u53d8\u5206\u63a8\u65ad\uff0cMCMC \u7b49\u3002\u6982\u7387\u56fe\u6a21\u578b\u6700\u57fa\u672c\u7684\u6a21\u578b\u53ef\u4ee5\u5206\u4e3a\u6709\u5411\u56fe\uff08\u8d1d\u53f6\u65af\u7f51\u7edc\uff09\u548c\u65e0\u5411\u56fe\uff08\u9a6c\u5c14\u53ef\u592b\u968f\u673a\u573a\uff09\u4e24\u4e2a\u65b9\u9762\uff0c\u4f8b\u5982 GMM\uff0c\u5728\u8fd9\u4e9b\u57fa\u672c\u7684\u6a21\u578b\u4e0a\uff0c\u5982\u679c\u6837\u672c\u4e4b\u95f4\u5b58\u5728\u5173\u8054\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u6837\u672c\u4e2d\u9644\u5e26\u4e86\u65f6\u5e8f\u4fe1\u606f\uff0c\u4ece\u800c\u6837\u672c\u4e4b\u95f4\u4e0d\u72ec\u7acb\u5168\u540c\u5206\u5e03\u7684\uff0c\u8fd9\u79cd\u6a21\u578b\u5c31\u53eb\u505a\u52a8\u6001\u6a21\u578b\uff0c\u9690\u53d8\u91cf\u968f\u7740\u65f6\u95f4\u53d1\u751f\u53d8\u5316\uff0c\u4e8e\u662f\u89c2\u6d4b\u53d8\u91cf\u4e5f\u53d1\u751f\u53d8\u5316\uff1a 1 2 graph LR; z1-->z2-->z3; \u6839\u636e\u72b6\u6001\u53d8\u91cf\u7684\u7279\u70b9\uff0c\u53ef\u4ee5\u5206\u4e3a\uff1a HMM\uff0c\u72b6\u6001\u53d8\u91cf\uff08\u9690\u53d8\u91cf\uff09\u662f\u79bb\u6563\u7684 Kalman \u6ee4\u6ce2\uff0c\u72b6\u6001\u53d8\u91cf\u662f\u8fde\u7eed\u7684\uff0c\u7ebf\u6027\u7684 \u7c92\u5b50\u6ee4\u6ce2\uff0c\u72b6\u6001\u53d8\u91cf\u662f\u8fde\u7eed\uff0c\u975e\u7ebf\u6027\u7684 HMM HMM \u7528\u6982\u7387\u56fe\u8868\u793a\u4e3a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 graph TD; t1-->t2; subgraph four t4-->x4((x4)) end subgraph three t3-->x3((x3)) end subgraph two t2-->x2((x2)) end subgraph one t1-->x1((x1)) end t2-->t3; t3-->t4; \u4e0a\u56fe\u8868\u793a\u4e86\u56db\u4e2a\u65f6\u523b\u7684\u9690\u53d8\u91cf\u53d8\u5316\u3002\u7528\u53c2\u6570 \\(\\lambda=(\\pi,A,B)\\) \u6765\u8868\u793a\uff0c\u5176\u4e2d \\(\\pi\\) \u662f\u5f00\u59cb\u7684\u6982\u7387\u5206\u5e03\uff0c \\(A\\) \u4e3a\u72b6\u6001\u8f6c\u79fb\u77e9\u9635\uff0c \\(B\\) \u4e3a\u53d1\u5c04\u77e9\u9635\u3002 \u4e0b\u9762\u4f7f\u7528 \\(o_t\\) \u6765\u8868\u793a\u89c2\u6d4b\u53d8\u91cf\uff0c \\(O\\) \u4e3a\u89c2\u6d4b\u5e8f\u5217\uff0c \\(V=\\{v_1,v_2,\\cdots,v_M\\}\\) \u8868\u793a\u89c2\u6d4b\u7684\u503c\u57df\uff0c \\(i_t\\) \u8868\u793a\u72b6\u6001\u53d8\u91cf\uff0c \\(I\\) \u4e3a\u72b6\u6001\u5e8f\u5217\uff0c \\(Q=\\{q_1,q_2,\\cdots,q_N\\}\\) \u8868\u793a\u72b6\u6001\u53d8\u91cf\u7684\u503c\u57df\u3002\u5b9a\u4e49 \\(A=(a_{ij}=p(i_{t+1}=q_j|i_t=q_i))\\) \u8868\u793a\u72b6\u6001\u8f6c\u79fb\u77e9\u9635\uff0c \\(B=(b_j(k)=p(o_t=v_k|i_t=q_j))\\) \u8868\u793a\u53d1\u5c04\u77e9\u9635\u3002 \u5728 HMM \u4e2d\uff0c\u6709\u4e24\u4e2a\u57fa\u672c\u5047\u8bbe\uff1a \u9f50\u6b21 Markov \u5047\u8bbe\uff08\u672a\u6765\u53ea\u4f9d\u8d56\u4e8e\u5f53\u524d\uff09\uff1a $$ p(i_{t+1}|i_t,i_{t-1},\\cdots,i_1,o_t,o_{t-1},\\cdots,o_1)=p(i_{t+1}|i_t) $$ \u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\uff1a $$ p(o_t|i_t,i_{t-1},\\cdots,i_1,o_{t-1},\\cdots,o_1)=p(o_t|i_t) $$ HMM \u8981\u89e3\u51b3\u4e09\u4e2a\u95ee\u9898\uff1a Evaluation\uff1a \\(p(O|\\lambda)\\) \uff0cForward-Backward \u7b97\u6cd5 Learning\uff1a \\(\\lambda=\\mathop{argmax}\\limits_{\\lambda}p(O|\\lambda)\\) \uff0cEM \u7b97\u6cd5\uff08Baum-Welch\uff09 Decoding\uff1a \\(I=\\mathop{argmax}\\limits_{I}p(I|O,\\lambda)\\) \uff0cVierbi \u7b97\u6cd5 \u9884\u6d4b\u95ee\u9898\uff1a \\(p(i_{t+1}|o_1,o_2,\\cdots,o_t)\\) \u6ee4\u6ce2\u95ee\u9898\uff1a \\(p(i_t|o_1,o_2,\\cdots,o_t)\\) Evaluation \\[ p(O|\\lambda)=\\sum\\limits_{I}p(I,O|\\lambda)=\\sum\\limits_{I}p(O|I,\\lambda)p(I|\\lambda) \\] \\[ p(I|\\lambda)=p(i_1,i_2,\\cdots,i_t|\\lambda)=p(i_t|i_1,i_2,\\cdots,i_{t-1},\\lambda)p(i_1,i_2,\\cdots,i_{t-1}|\\lambda) \\] \u6839\u636e\u9f50\u6b21 Markov \u5047\u8bbe\uff1a $$ p(i_t|i_1,i_2,\\cdots,i_{t-1},\\lambda)=p(i_t|i_{t-1})=a_{i_{t-1}i_t} $$ \u6240\u4ee5\uff1a $$ p(I|\\lambda)=\\pi_1\\prod\\limits_{t=2}^Ta_{i_{t-1},i_t} $$ \u53c8\u7531\u4e8e\uff1a $$ p(O|I,\\lambda)=\\prod\\limits_{t=1}^Tb_{i_t}(o_t) $$ \u4e8e\u662f\uff1a $$ p(O|\\lambda)=\\sum\\limits_{I}\\pi_{i_1}\\prod\\limits_{t=2}^Ta_{i_{t-1},i_t}\\prod\\limits_{t=1}^Tb_{i_t}(o_t) $$ \u6211\u4eec\u770b\u5230\uff0c\u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d\u7684\u6c42\u548c\u7b26\u53f7\u662f\u5bf9\u6240\u6709\u7684\u89c2\u6d4b\u53d8\u91cf\u6c42\u548c\uff0c\u4e8e\u662f\u590d\u6742\u5ea6\u4e3a \\(O(N^T)\\) \u3002 \u4e0b\u9762\uff0c\u8bb0 \\(\\alpha_t(i)=p(o_1,o_2,\\cdots,o_t,i_t=q_i|\\lambda)\\) \uff0c\u6240\u4ee5\uff0c \\(\\alpha_T(i)=p(O,i_T=q_i|\\lambda)\\) \u3002\u6211\u4eec\u770b\u5230\uff1a $$ p(O|\\lambda)=\\sum\\limits_{i=1}^Np(O,i_T=q_i|\\lambda)=\\sum\\limits_{i=1}^N\\alpha_T(i) $$ \u5bf9 \\(\\alpha_{t+1}(j)\\) \uff1a $$ \\begin{align}\\alpha_{t+1}(j)&=p(o_1,o_2,\\cdots,o_{t+1},i_{t+1}=q_j|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_1,o_2,\\cdots,o_{t+1},i_{t+1}=q_j,i_t=q_i|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_{t+1}|o_1,o_2,\\cdots,i_{t+1}=q_j,i_t=q_i|\\lambda)p(o_1,\\cdots,o_t,i_t=q_i,i_{t+1}=q_j|\\lambda) \\end{align} $$ \u5229\u7528\u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\uff1a $$ \\begin{align}\\alpha_{t+1}(j)&=\\sum\\limits_{i=1}^Np(o_{t+1}|i_{t+1}=q_j)p(o_1,\\cdots,o_t,i_t=q_i,i_{t+1}=q_j|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_{t+1}|i_{t+1}=q_j)p(i_{t+1}=q_j|o_1,\\cdots,o_t,i_t=q_i,\\lambda)p(o_1,\\cdots,o_t,i_t=q_i|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Nb_{j}(o_t)a_{ij}\\alpha_t(i) \\end{align} $$ \u4e0a\u9762\u5229\u7528\u4e86\u9f50\u6b21 Markov \u5047\u8bbe\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u63a8\u516c\u5f0f\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a\u524d\u5411\u7b97\u6cd5\u3002 \u8fd8\u6709\u4e00\u79cd\u7b97\u6cd5\u53eb\u505a\u540e\u5411\u7b97\u6cd5\uff0c\u5b9a\u4e49 \\(\\beta_t(i)=p(o_{t+1},o_{t+1},\\cdots\uff0co_T|i_t=i,\\lambda)\\) \uff1a $$ \\begin{align}p(O|\\lambda)&=p(o_1,\\cdots,o_T|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_1,o_2,\\cdots,o_T,i_1=q_i|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_1,o_2,\\cdots,o_T|i_1=q_i,\\lambda)\\pi_i\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_1|o_2,\\cdots,o_T,i_1=q_i,\\lambda)p(o_2,\\cdots,o_T|i_1=q_i,\\lambda)\\pi_i\\nonumber\\ &=\\sum\\limits_{i=1}^Nb_i(o_1)\\pi_i\\beta_1(i) \\end{align} $$ \u5bf9\u4e8e\u8fd9\u4e2a \\(\\beta_1(i)\\) \uff1a $$ \\begin{align}\\beta_t(i)&=p(o_{t+1},\\cdots,o_T|i_t=q_i)\\nonumber\\ &=\\sum\\limits_{j=1}^Np(o_{t+1},o_{t+2},\\cdots,o_T,i_{t+1}=q_j|i_t=q_i)\\nonumber\\ &=\\sum\\limits_{j=1}^Np(o_{t+1},\\cdots,o_T|i_{t+1}=q_j,i_t=q_i)p(i_{t+1}=q_j|i_t=q_i)\\nonumber\\ &=\\sum\\limits_{j=1}^Np(o_{t+1},\\cdots,o_T|i_{t+1}=q_j)a_{ij}\\nonumber\\ &=\\sum\\limits_{j=1}^Np(o_{t+1}|o_{t+2},\\cdots,o_T,i_{t+1}=q_j)p(o_{t+2},\\cdots,o_T|i_{t+1}=q_j)a_{ij}\\nonumber\\ &=\\sum\\limits_{j=1}^Nb_j(o_{t+1})a_{ij}\\beta_{t+1}(j) \\end{align} $$ \u4e8e\u662f\u540e\u5411\u5730\u5f97\u5230\u4e86\u7b2c\u4e00\u9879\u3002 Learning \u4e3a\u4e86\u5b66\u4e60\u5f97\u5230\u53c2\u6570\u7684\u6700\u4f18\u503c\uff0c\u5728 MLE \u4e2d\uff1a $$ \\lambda_{MLE}=\\mathop{argmax} \\lambda p(O|\\lambda) $$ \u6211\u4eec\u91c7\u7528 EM \u7b97\u6cd5\uff08\u5728\u8fd9\u91cc\u4e5f\u53eb Baum Welch \u7b97\u6cd5\uff09\uff0c\u7528\u4e0a\u6807\u8868\u793a\u8fed\u4ee3\uff1a $$ \\theta^{t+1}=\\mathop{argmax} \\int_z\\log p(X,Z|\\theta)p(Z|X,\\theta^t)dz $$ \u5176\u4e2d\uff0c \\(X\\) \u662f\u89c2\u6d4b\u53d8\u91cf\uff0c \\(Z\\) \u662f\u9690\u53d8\u91cf\u5e8f\u5217\u3002\u4e8e\u662f\uff1a $$ \\lambda^{t+1}=\\mathop{argmax} \\lambda\\sum\\limits_I\\log p(O,I|\\lambda)p(I|O,\\lambda^t)\\ =\\mathop{argmax} \\lambda\\sum\\limits_I\\log p(O,I|\\lambda)p(O,I|\\lambda^t) $$ \u8fd9\u91cc\u5229\u7528\u4e86 \\(p(O|\\lambda^t)\\) \u548c \\(\\lambda\\) \u65e0\u5173\u3002\u5c06 Evaluation \u4e2d\u7684\u5f0f\u5b50\u4ee3\u5165\uff1a $$ \\sum\\limits_I\\log p(O,I|\\lambda)p(O,I|\\lambda^t)=\\sum\\limits_I[\\log \\pi_{i_1}+\\sum\\limits_{t=2}^T\\log a_{i_{t-1},i_t}+\\sum\\limits_{t=1}^T\\log b_{i_t}(o_t)]p(O,I|\\lambda^t) $$ \u5bf9 \\(\\pi^{t+1}\\) \uff1a $$ \\begin{align}\\pi^{t+1}&=\\mathop{argmax} \\pi\\sum\\limits_I[\\log \\pi p(O,I|\\lambda^t)]\\nonumber\\ &=\\mathop{argmax} \\pi\\sum\\limits_I[\\log \\pi \\cdot p(O,i_1,i_2,\\cdots,i_T|\\lambda^t)] \\end{align} $$ \u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d\uff0c\u5bf9 \\(i_2,i_2,\\cdots,i_T\\) \u6c42\u548c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u53c2\u6570\u6d88\u6389\uff1a $$ \\pi^{t+1}=\\mathop{argmax} \\pi\\sum\\limits [\\log \\pi_{i_1}\\cdot p(O,i_1|\\lambda^t)] $$ \u4e0a\u9762\u7684\u5f0f\u5b50\u8fd8\u6709\u5bf9 \\(\\pi\\) \u7684\u7ea6\u675f \\(\\sum\\limits_i\\pi_i=1\\) \u3002\u5b9a\u4e49 Lagrange \u51fd\u6570\uff1a $$ L(\\pi,\\eta)=\\sum\\limits_{i=1}^N\\log \\pi_i\\cdot p(O,i_1=q_i|\\lambda^t)+\\eta(\\sum\\limits_{i=1}^N\\pi_i-1) $$ \u4e8e\u662f\uff1a $$ \\frac{\\partial L}{\\partial\\pi_i}=\\frac{1}{\\pi_i}p(O,i_1=q_i|\\lambda^t)+\\eta=0 $$ \u5bf9\u4e0a\u5f0f\u6c42\u548c\uff1a $$ \\sum\\limits_{i=1}^Np(O,i_1=q_i|\\lambda^t)+\\pi_i\\eta=0\\Rightarrow\\eta=-p(O|\\lambda^t) $$ \u6240\u4ee5\uff1a $$ \\pi_i^{t+1}=\\frac{p(O,i_1=q_i|\\lambda^t)}{p(O|\\lambda^t)} $$ Decoding Decoding \u95ee\u9898\u8868\u8ff0\u4e3a\uff1a $$ I=\\mathop{argmax}\\limits_{I}p(I|O,\\lambda) $$ \u6211\u4eec\u9700\u8981\u627e\u5230\u4e00\u4e2a\u5e8f\u5217\uff0c\u5176\u6982\u7387\u6700\u5927\uff0c\u8fd9\u4e2a\u5e8f\u5217\u5c31\u662f\u5728\u53c2\u6570\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a\u8def\u5f84\uff0c\u53ef\u4ee5\u91c7\u7528\u52a8\u6001\u89c4\u5212\u7684\u601d\u60f3\u3002 \u5b9a\u4e49\uff1a $$ \\delta_{t}(j)=\\max\\limits_{i_1,\\cdots,i_{t-1}}p(o_1,\\cdots,o_t,i_1,\\cdots,i_{t-1},i_t=q_i) $$ \u4e8e\u662f\uff1a $$ \\delta_{t+1}(j)=\\max\\limits_{1\\le i\\le N}\\delta_t(i)a_{ij}b_j(o_{t+1}) $$ \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u4ece\u4e0a\u4e00\u6b65\u5230\u4e0b\u4e00\u6b65\u7684\u6982\u7387\u518d\u6c42\u6700\u5927\u503c\u3002\u8bb0\u8fd9\u4e2a\u8def\u5f84\u4e3a\uff1a $$ \\psi_{t+1}(j)=\\mathop{argmax}\\limits_{1\\le i\\le N}\\delta_t(i)a_{ij} $$ \u5c0f\u7ed3 HMM \u662f\u4e00\u79cd\u52a8\u6001\u6a21\u578b\uff0c\u662f\u7531\u6df7\u5408\u6811\u5f62\u6a21\u578b\u548c\u65f6\u5e8f\u7ed3\u5408\u8d77\u6765\u7684\u4e00\u79cd\u6a21\u578b\uff08\u7c7b\u4f3c GMM + Time\uff09\u3002\u5bf9\u4e8e\u7c7b\u4f3c HMM \u7684\u8fd9\u79cd\u72b6\u6001\u7a7a\u95f4\u6a21\u578b\uff0c\u666e\u904d\u7684\u9664\u4e86\u5b66\u4e60\u4efb\u52a1\uff08\u91c7\u7528 EM \uff09\u5916\uff0c\u8fd8\u6709\u63a8\u65ad\u4efb\u52a1\uff0c\u63a8\u65ad\u4efb\u52a1\u5305\u62ec\uff1a \u8bd1\u7801 Decoding\uff1a \\(p(z_1,z_2,\\cdots,z_t|x_1,x_2,\\cdots,x_t)\\) \u4f3c\u7136\u6982\u7387\uff1a \\(p(X|\\theta)\\) \u6ee4\u6ce2\uff1a \\(p(z_t|x_1,\\cdots,x_t)\\) \uff0cOnline $$ p(z_t|x_{1:t})=\\frac{p(x_{1:t},z_t)}{p(x_{1:t})}=C\\alpha_t(z_t) $$ \u5e73\u6ed1\uff1a \\(p(z_t|x_1,\\cdots,x_T)\\) \uff0cOffline $$ p(z_t|x_{1:T})=\\frac{p(x_{1:T},z_t)}{p(x_{1:T})}=\\frac{\\alpha_t(z_t)p(x_{t+1:T}|x_{1:t},z_t)}{p(x_{1:T})} $$ \u6839\u636e\u6982\u7387\u56fe\u7684\u6761\u4ef6\u72ec\u7acb\u6027\uff0c\u6709\uff1a $$ p(z_t|x_{1:T})=\\frac{\\alpha_t(z_t)p(x_{t+1:T}|z_t)}{p(x_{1:T})}=C\\alpha_t(z_t)\\beta_t(z_t) $$ \u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a\u524d\u5411\u540e\u5411\u7b97\u6cd5\u3002 \u9884\u6d4b\uff1a \\(p(z_{t+1},z_{t+2}|x_1,\\cdots,x_t),p(x_{t+1},x_{t+2}|x_1,\\cdots,x_t)\\) $$ p(z_{t+1}|x_{1:t})=\\sum_{z_t}p(z_{t+1},z_t|x_{1:t})=\\sum\\limits_{z_t}p(z_{t+1}|z_t)p(z_t|x_{1:t}) $$ \\[ p(x_{t+1}|x_{1:t})=\\sum\\limits_{z_{t+1}}p(x_{t+1},z_{t+1}|x_{1:t})=\\sum\\limits_{z_{t+1}}p(x_{t+1}|z_{t+1})p(z_{t+1}|x_{1:t}) \\]","title":"12.HMM"},{"location":"Machine_Learning/12.HMM/#_1","text":"\u9690\u9a6c\u5c14\u53ef\u592b\u6a21\u578b\u662f\u4e00\u79cd\u6982\u7387\u56fe\u6a21\u578b\u3002\u6211\u4eec\u77e5\u9053\uff0c\u673a\u5668\u5b66\u4e60\u6a21\u578b\u53ef\u4ee5\u4ece\u9891\u7387\u6d3e\u548c\u8d1d\u53f6\u65af\u6d3e\u4e24\u4e2a\u65b9\u5411\u8003\u8651\uff0c\u5728\u9891\u7387\u6d3e\u7684\u65b9\u6cd5\u4e2d\u7684\u6838\u5fc3\u662f\u4f18\u5316\u95ee\u9898\uff0c\u800c\u5728\u8d1d\u53f6\u65af\u6d3e\u7684\u65b9\u6cd5\u4e2d\uff0c\u6838\u5fc3\u662f\u79ef\u5206\u95ee\u9898\uff0c\u4e5f\u53d1\u5c55\u51fa\u6765\u4e86\u4e00\u7cfb\u5217\u7684\u79ef\u5206\u65b9\u6cd5\u5982\u53d8\u5206\u63a8\u65ad\uff0cMCMC \u7b49\u3002\u6982\u7387\u56fe\u6a21\u578b\u6700\u57fa\u672c\u7684\u6a21\u578b\u53ef\u4ee5\u5206\u4e3a\u6709\u5411\u56fe\uff08\u8d1d\u53f6\u65af\u7f51\u7edc\uff09\u548c\u65e0\u5411\u56fe\uff08\u9a6c\u5c14\u53ef\u592b\u968f\u673a\u573a\uff09\u4e24\u4e2a\u65b9\u9762\uff0c\u4f8b\u5982 GMM\uff0c\u5728\u8fd9\u4e9b\u57fa\u672c\u7684\u6a21\u578b\u4e0a\uff0c\u5982\u679c\u6837\u672c\u4e4b\u95f4\u5b58\u5728\u5173\u8054\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u6837\u672c\u4e2d\u9644\u5e26\u4e86\u65f6\u5e8f\u4fe1\u606f\uff0c\u4ece\u800c\u6837\u672c\u4e4b\u95f4\u4e0d\u72ec\u7acb\u5168\u540c\u5206\u5e03\u7684\uff0c\u8fd9\u79cd\u6a21\u578b\u5c31\u53eb\u505a\u52a8\u6001\u6a21\u578b\uff0c\u9690\u53d8\u91cf\u968f\u7740\u65f6\u95f4\u53d1\u751f\u53d8\u5316\uff0c\u4e8e\u662f\u89c2\u6d4b\u53d8\u91cf\u4e5f\u53d1\u751f\u53d8\u5316\uff1a 1 2 graph LR; z1-->z2-->z3; \u6839\u636e\u72b6\u6001\u53d8\u91cf\u7684\u7279\u70b9\uff0c\u53ef\u4ee5\u5206\u4e3a\uff1a HMM\uff0c\u72b6\u6001\u53d8\u91cf\uff08\u9690\u53d8\u91cf\uff09\u662f\u79bb\u6563\u7684 Kalman \u6ee4\u6ce2\uff0c\u72b6\u6001\u53d8\u91cf\u662f\u8fde\u7eed\u7684\uff0c\u7ebf\u6027\u7684 \u7c92\u5b50\u6ee4\u6ce2\uff0c\u72b6\u6001\u53d8\u91cf\u662f\u8fde\u7eed\uff0c\u975e\u7ebf\u6027\u7684","title":"\u9690\u9a6c\u5c14\u53ef\u592b\u6a21\u578b"},{"location":"Machine_Learning/12.HMM/#hmm","text":"HMM \u7528\u6982\u7387\u56fe\u8868\u793a\u4e3a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 graph TD; t1-->t2; subgraph four t4-->x4((x4)) end subgraph three t3-->x3((x3)) end subgraph two t2-->x2((x2)) end subgraph one t1-->x1((x1)) end t2-->t3; t3-->t4; \u4e0a\u56fe\u8868\u793a\u4e86\u56db\u4e2a\u65f6\u523b\u7684\u9690\u53d8\u91cf\u53d8\u5316\u3002\u7528\u53c2\u6570 \\(\\lambda=(\\pi,A,B)\\) \u6765\u8868\u793a\uff0c\u5176\u4e2d \\(\\pi\\) \u662f\u5f00\u59cb\u7684\u6982\u7387\u5206\u5e03\uff0c \\(A\\) \u4e3a\u72b6\u6001\u8f6c\u79fb\u77e9\u9635\uff0c \\(B\\) \u4e3a\u53d1\u5c04\u77e9\u9635\u3002 \u4e0b\u9762\u4f7f\u7528 \\(o_t\\) \u6765\u8868\u793a\u89c2\u6d4b\u53d8\u91cf\uff0c \\(O\\) \u4e3a\u89c2\u6d4b\u5e8f\u5217\uff0c \\(V=\\{v_1,v_2,\\cdots,v_M\\}\\) \u8868\u793a\u89c2\u6d4b\u7684\u503c\u57df\uff0c \\(i_t\\) \u8868\u793a\u72b6\u6001\u53d8\u91cf\uff0c \\(I\\) \u4e3a\u72b6\u6001\u5e8f\u5217\uff0c \\(Q=\\{q_1,q_2,\\cdots,q_N\\}\\) \u8868\u793a\u72b6\u6001\u53d8\u91cf\u7684\u503c\u57df\u3002\u5b9a\u4e49 \\(A=(a_{ij}=p(i_{t+1}=q_j|i_t=q_i))\\) \u8868\u793a\u72b6\u6001\u8f6c\u79fb\u77e9\u9635\uff0c \\(B=(b_j(k)=p(o_t=v_k|i_t=q_j))\\) \u8868\u793a\u53d1\u5c04\u77e9\u9635\u3002 \u5728 HMM \u4e2d\uff0c\u6709\u4e24\u4e2a\u57fa\u672c\u5047\u8bbe\uff1a \u9f50\u6b21 Markov \u5047\u8bbe\uff08\u672a\u6765\u53ea\u4f9d\u8d56\u4e8e\u5f53\u524d\uff09\uff1a $$ p(i_{t+1}|i_t,i_{t-1},\\cdots,i_1,o_t,o_{t-1},\\cdots,o_1)=p(i_{t+1}|i_t) $$ \u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\uff1a $$ p(o_t|i_t,i_{t-1},\\cdots,i_1,o_{t-1},\\cdots,o_1)=p(o_t|i_t) $$ HMM \u8981\u89e3\u51b3\u4e09\u4e2a\u95ee\u9898\uff1a Evaluation\uff1a \\(p(O|\\lambda)\\) \uff0cForward-Backward \u7b97\u6cd5 Learning\uff1a \\(\\lambda=\\mathop{argmax}\\limits_{\\lambda}p(O|\\lambda)\\) \uff0cEM \u7b97\u6cd5\uff08Baum-Welch\uff09 Decoding\uff1a \\(I=\\mathop{argmax}\\limits_{I}p(I|O,\\lambda)\\) \uff0cVierbi \u7b97\u6cd5 \u9884\u6d4b\u95ee\u9898\uff1a \\(p(i_{t+1}|o_1,o_2,\\cdots,o_t)\\) \u6ee4\u6ce2\u95ee\u9898\uff1a \\(p(i_t|o_1,o_2,\\cdots,o_t)\\)","title":"HMM"},{"location":"Machine_Learning/12.HMM/#evaluation","text":"\\[ p(O|\\lambda)=\\sum\\limits_{I}p(I,O|\\lambda)=\\sum\\limits_{I}p(O|I,\\lambda)p(I|\\lambda) \\] \\[ p(I|\\lambda)=p(i_1,i_2,\\cdots,i_t|\\lambda)=p(i_t|i_1,i_2,\\cdots,i_{t-1},\\lambda)p(i_1,i_2,\\cdots,i_{t-1}|\\lambda) \\] \u6839\u636e\u9f50\u6b21 Markov \u5047\u8bbe\uff1a $$ p(i_t|i_1,i_2,\\cdots,i_{t-1},\\lambda)=p(i_t|i_{t-1})=a_{i_{t-1}i_t} $$ \u6240\u4ee5\uff1a $$ p(I|\\lambda)=\\pi_1\\prod\\limits_{t=2}^Ta_{i_{t-1},i_t} $$ \u53c8\u7531\u4e8e\uff1a $$ p(O|I,\\lambda)=\\prod\\limits_{t=1}^Tb_{i_t}(o_t) $$ \u4e8e\u662f\uff1a $$ p(O|\\lambda)=\\sum\\limits_{I}\\pi_{i_1}\\prod\\limits_{t=2}^Ta_{i_{t-1},i_t}\\prod\\limits_{t=1}^Tb_{i_t}(o_t) $$ \u6211\u4eec\u770b\u5230\uff0c\u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d\u7684\u6c42\u548c\u7b26\u53f7\u662f\u5bf9\u6240\u6709\u7684\u89c2\u6d4b\u53d8\u91cf\u6c42\u548c\uff0c\u4e8e\u662f\u590d\u6742\u5ea6\u4e3a \\(O(N^T)\\) \u3002 \u4e0b\u9762\uff0c\u8bb0 \\(\\alpha_t(i)=p(o_1,o_2,\\cdots,o_t,i_t=q_i|\\lambda)\\) \uff0c\u6240\u4ee5\uff0c \\(\\alpha_T(i)=p(O,i_T=q_i|\\lambda)\\) \u3002\u6211\u4eec\u770b\u5230\uff1a $$ p(O|\\lambda)=\\sum\\limits_{i=1}^Np(O,i_T=q_i|\\lambda)=\\sum\\limits_{i=1}^N\\alpha_T(i) $$ \u5bf9 \\(\\alpha_{t+1}(j)\\) \uff1a $$ \\begin{align}\\alpha_{t+1}(j)&=p(o_1,o_2,\\cdots,o_{t+1},i_{t+1}=q_j|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_1,o_2,\\cdots,o_{t+1},i_{t+1}=q_j,i_t=q_i|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_{t+1}|o_1,o_2,\\cdots,i_{t+1}=q_j,i_t=q_i|\\lambda)p(o_1,\\cdots,o_t,i_t=q_i,i_{t+1}=q_j|\\lambda) \\end{align} $$ \u5229\u7528\u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\uff1a $$ \\begin{align}\\alpha_{t+1}(j)&=\\sum\\limits_{i=1}^Np(o_{t+1}|i_{t+1}=q_j)p(o_1,\\cdots,o_t,i_t=q_i,i_{t+1}=q_j|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_{t+1}|i_{t+1}=q_j)p(i_{t+1}=q_j|o_1,\\cdots,o_t,i_t=q_i,\\lambda)p(o_1,\\cdots,o_t,i_t=q_i|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Nb_{j}(o_t)a_{ij}\\alpha_t(i) \\end{align} $$ \u4e0a\u9762\u5229\u7528\u4e86\u9f50\u6b21 Markov \u5047\u8bbe\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u63a8\u516c\u5f0f\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a\u524d\u5411\u7b97\u6cd5\u3002 \u8fd8\u6709\u4e00\u79cd\u7b97\u6cd5\u53eb\u505a\u540e\u5411\u7b97\u6cd5\uff0c\u5b9a\u4e49 \\(\\beta_t(i)=p(o_{t+1},o_{t+1},\\cdots\uff0co_T|i_t=i,\\lambda)\\) \uff1a $$ \\begin{align}p(O|\\lambda)&=p(o_1,\\cdots,o_T|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_1,o_2,\\cdots,o_T,i_1=q_i|\\lambda)\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_1,o_2,\\cdots,o_T|i_1=q_i,\\lambda)\\pi_i\\nonumber\\ &=\\sum\\limits_{i=1}^Np(o_1|o_2,\\cdots,o_T,i_1=q_i,\\lambda)p(o_2,\\cdots,o_T|i_1=q_i,\\lambda)\\pi_i\\nonumber\\ &=\\sum\\limits_{i=1}^Nb_i(o_1)\\pi_i\\beta_1(i) \\end{align} $$ \u5bf9\u4e8e\u8fd9\u4e2a \\(\\beta_1(i)\\) \uff1a $$ \\begin{align}\\beta_t(i)&=p(o_{t+1},\\cdots,o_T|i_t=q_i)\\nonumber\\ &=\\sum\\limits_{j=1}^Np(o_{t+1},o_{t+2},\\cdots,o_T,i_{t+1}=q_j|i_t=q_i)\\nonumber\\ &=\\sum\\limits_{j=1}^Np(o_{t+1},\\cdots,o_T|i_{t+1}=q_j,i_t=q_i)p(i_{t+1}=q_j|i_t=q_i)\\nonumber\\ &=\\sum\\limits_{j=1}^Np(o_{t+1},\\cdots,o_T|i_{t+1}=q_j)a_{ij}\\nonumber\\ &=\\sum\\limits_{j=1}^Np(o_{t+1}|o_{t+2},\\cdots,o_T,i_{t+1}=q_j)p(o_{t+2},\\cdots,o_T|i_{t+1}=q_j)a_{ij}\\nonumber\\ &=\\sum\\limits_{j=1}^Nb_j(o_{t+1})a_{ij}\\beta_{t+1}(j) \\end{align} $$ \u4e8e\u662f\u540e\u5411\u5730\u5f97\u5230\u4e86\u7b2c\u4e00\u9879\u3002","title":"Evaluation"},{"location":"Machine_Learning/12.HMM/#learning","text":"\u4e3a\u4e86\u5b66\u4e60\u5f97\u5230\u53c2\u6570\u7684\u6700\u4f18\u503c\uff0c\u5728 MLE \u4e2d\uff1a $$ \\lambda_{MLE}=\\mathop{argmax} \\lambda p(O|\\lambda) $$ \u6211\u4eec\u91c7\u7528 EM \u7b97\u6cd5\uff08\u5728\u8fd9\u91cc\u4e5f\u53eb Baum Welch \u7b97\u6cd5\uff09\uff0c\u7528\u4e0a\u6807\u8868\u793a\u8fed\u4ee3\uff1a $$ \\theta^{t+1}=\\mathop{argmax} \\int_z\\log p(X,Z|\\theta)p(Z|X,\\theta^t)dz $$ \u5176\u4e2d\uff0c \\(X\\) \u662f\u89c2\u6d4b\u53d8\u91cf\uff0c \\(Z\\) \u662f\u9690\u53d8\u91cf\u5e8f\u5217\u3002\u4e8e\u662f\uff1a $$ \\lambda^{t+1}=\\mathop{argmax} \\lambda\\sum\\limits_I\\log p(O,I|\\lambda)p(I|O,\\lambda^t)\\ =\\mathop{argmax} \\lambda\\sum\\limits_I\\log p(O,I|\\lambda)p(O,I|\\lambda^t) $$ \u8fd9\u91cc\u5229\u7528\u4e86 \\(p(O|\\lambda^t)\\) \u548c \\(\\lambda\\) \u65e0\u5173\u3002\u5c06 Evaluation \u4e2d\u7684\u5f0f\u5b50\u4ee3\u5165\uff1a $$ \\sum\\limits_I\\log p(O,I|\\lambda)p(O,I|\\lambda^t)=\\sum\\limits_I[\\log \\pi_{i_1}+\\sum\\limits_{t=2}^T\\log a_{i_{t-1},i_t}+\\sum\\limits_{t=1}^T\\log b_{i_t}(o_t)]p(O,I|\\lambda^t) $$ \u5bf9 \\(\\pi^{t+1}\\) \uff1a $$ \\begin{align}\\pi^{t+1}&=\\mathop{argmax} \\pi\\sum\\limits_I[\\log \\pi p(O,I|\\lambda^t)]\\nonumber\\ &=\\mathop{argmax} \\pi\\sum\\limits_I[\\log \\pi \\cdot p(O,i_1,i_2,\\cdots,i_T|\\lambda^t)] \\end{align} $$ \u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d\uff0c\u5bf9 \\(i_2,i_2,\\cdots,i_T\\) \u6c42\u548c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u53c2\u6570\u6d88\u6389\uff1a $$ \\pi^{t+1}=\\mathop{argmax} \\pi\\sum\\limits [\\log \\pi_{i_1}\\cdot p(O,i_1|\\lambda^t)] $$ \u4e0a\u9762\u7684\u5f0f\u5b50\u8fd8\u6709\u5bf9 \\(\\pi\\) \u7684\u7ea6\u675f \\(\\sum\\limits_i\\pi_i=1\\) \u3002\u5b9a\u4e49 Lagrange \u51fd\u6570\uff1a $$ L(\\pi,\\eta)=\\sum\\limits_{i=1}^N\\log \\pi_i\\cdot p(O,i_1=q_i|\\lambda^t)+\\eta(\\sum\\limits_{i=1}^N\\pi_i-1) $$ \u4e8e\u662f\uff1a $$ \\frac{\\partial L}{\\partial\\pi_i}=\\frac{1}{\\pi_i}p(O,i_1=q_i|\\lambda^t)+\\eta=0 $$ \u5bf9\u4e0a\u5f0f\u6c42\u548c\uff1a $$ \\sum\\limits_{i=1}^Np(O,i_1=q_i|\\lambda^t)+\\pi_i\\eta=0\\Rightarrow\\eta=-p(O|\\lambda^t) $$ \u6240\u4ee5\uff1a $$ \\pi_i^{t+1}=\\frac{p(O,i_1=q_i|\\lambda^t)}{p(O|\\lambda^t)} $$","title":"Learning"},{"location":"Machine_Learning/12.HMM/#decoding","text":"Decoding \u95ee\u9898\u8868\u8ff0\u4e3a\uff1a $$ I=\\mathop{argmax}\\limits_{I}p(I|O,\\lambda) $$ \u6211\u4eec\u9700\u8981\u627e\u5230\u4e00\u4e2a\u5e8f\u5217\uff0c\u5176\u6982\u7387\u6700\u5927\uff0c\u8fd9\u4e2a\u5e8f\u5217\u5c31\u662f\u5728\u53c2\u6570\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a\u8def\u5f84\uff0c\u53ef\u4ee5\u91c7\u7528\u52a8\u6001\u89c4\u5212\u7684\u601d\u60f3\u3002 \u5b9a\u4e49\uff1a $$ \\delta_{t}(j)=\\max\\limits_{i_1,\\cdots,i_{t-1}}p(o_1,\\cdots,o_t,i_1,\\cdots,i_{t-1},i_t=q_i) $$ \u4e8e\u662f\uff1a $$ \\delta_{t+1}(j)=\\max\\limits_{1\\le i\\le N}\\delta_t(i)a_{ij}b_j(o_{t+1}) $$ \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u4ece\u4e0a\u4e00\u6b65\u5230\u4e0b\u4e00\u6b65\u7684\u6982\u7387\u518d\u6c42\u6700\u5927\u503c\u3002\u8bb0\u8fd9\u4e2a\u8def\u5f84\u4e3a\uff1a $$ \\psi_{t+1}(j)=\\mathop{argmax}\\limits_{1\\le i\\le N}\\delta_t(i)a_{ij} $$","title":"Decoding"},{"location":"Machine_Learning/12.HMM/#_2","text":"HMM \u662f\u4e00\u79cd\u52a8\u6001\u6a21\u578b\uff0c\u662f\u7531\u6df7\u5408\u6811\u5f62\u6a21\u578b\u548c\u65f6\u5e8f\u7ed3\u5408\u8d77\u6765\u7684\u4e00\u79cd\u6a21\u578b\uff08\u7c7b\u4f3c GMM + Time\uff09\u3002\u5bf9\u4e8e\u7c7b\u4f3c HMM \u7684\u8fd9\u79cd\u72b6\u6001\u7a7a\u95f4\u6a21\u578b\uff0c\u666e\u904d\u7684\u9664\u4e86\u5b66\u4e60\u4efb\u52a1\uff08\u91c7\u7528 EM \uff09\u5916\uff0c\u8fd8\u6709\u63a8\u65ad\u4efb\u52a1\uff0c\u63a8\u65ad\u4efb\u52a1\u5305\u62ec\uff1a \u8bd1\u7801 Decoding\uff1a \\(p(z_1,z_2,\\cdots,z_t|x_1,x_2,\\cdots,x_t)\\) \u4f3c\u7136\u6982\u7387\uff1a \\(p(X|\\theta)\\) \u6ee4\u6ce2\uff1a \\(p(z_t|x_1,\\cdots,x_t)\\) \uff0cOnline $$ p(z_t|x_{1:t})=\\frac{p(x_{1:t},z_t)}{p(x_{1:t})}=C\\alpha_t(z_t) $$ \u5e73\u6ed1\uff1a \\(p(z_t|x_1,\\cdots,x_T)\\) \uff0cOffline $$ p(z_t|x_{1:T})=\\frac{p(x_{1:T},z_t)}{p(x_{1:T})}=\\frac{\\alpha_t(z_t)p(x_{t+1:T}|x_{1:t},z_t)}{p(x_{1:T})} $$ \u6839\u636e\u6982\u7387\u56fe\u7684\u6761\u4ef6\u72ec\u7acb\u6027\uff0c\u6709\uff1a $$ p(z_t|x_{1:T})=\\frac{\\alpha_t(z_t)p(x_{t+1:T}|z_t)}{p(x_{1:T})}=C\\alpha_t(z_t)\\beta_t(z_t) $$ \u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a\u524d\u5411\u540e\u5411\u7b97\u6cd5\u3002 \u9884\u6d4b\uff1a \\(p(z_{t+1},z_{t+2}|x_1,\\cdots,x_t),p(x_{t+1},x_{t+2}|x_1,\\cdots,x_t)\\) $$ p(z_{t+1}|x_{1:t})=\\sum_{z_t}p(z_{t+1},z_t|x_{1:t})=\\sum\\limits_{z_t}p(z_{t+1}|z_t)p(z_t|x_{1:t}) $$ \\[ p(x_{t+1}|x_{1:t})=\\sum\\limits_{z_{t+1}}p(x_{t+1},z_{t+1}|x_{1:t})=\\sum\\limits_{z_{t+1}}p(x_{t+1}|z_{t+1})p(z_{t+1}|x_{1:t}) \\]","title":"\u5c0f\u7ed3"},{"location":"Machine_Learning/13.LDS/","text":"\u7ebf\u6027\u52a8\u6001\u7cfb\u7edf HMM \u6a21\u578b\u9002\u7528\u4e8e\u9690\u53d8\u91cf\u662f\u79bb\u6563\u7684\u503c\u7684\u65f6\u5019\uff0c\u5bf9\u4e8e\u8fde\u7eed\u9690\u53d8\u91cf\u7684 HMM\uff0c\u5e38\u7528\u7ebf\u6027\u52a8\u6001\u7cfb\u7edf\u63cf\u8ff0\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\u7684\u6001\u53d8\u91cf\uff0c\u4f7f\u7528\u7c92\u5b50\u6ee4\u6ce2\u6765\u8868\u8ff0\u975e\u9ad8\u65af\u975e\u7ebf\u6027\u7684\u6001\u53d8\u91cf\u3002 LDS \u53c8\u53eb\u5361\u5c14\u66fc\u6ee4\u6ce2\uff0c\u5176\u4e2d\uff0c\u7ebf\u6027\u4f53\u73b0\u5728\u4e0a\u4e00\u65f6\u523b\u548c\u8fd9\u4e00\u65f6\u523b\u7684\u9690\u53d8\u91cf\u4ee5\u53ca\u9690\u53d8\u91cf\u548c\u89c2\u6d4b\u4e4b\u95f4\uff1a $$ \\begin{align} z_t&=A\\cdot z_{t-1}+B+\\varepsilon\\ x_t&=C\\cdot z_t+D+\\delta\\ \\varepsilon&\\sim\\mathcal{N}(0,Q)\\ \\delta&\\sim\\mathcal{N}(0,R) \\end{align} $$ \u7c7b\u6bd4 HMM \u4e2d\u7684\u51e0\u4e2a\u53c2\u6570\uff1a $$ \\begin{align} p(z_t|z_{t-1})&\\sim\\mathcal{N}(A\\cdot z_{t-1}+B,Q)\\ p(x_t|z_t)&\\sim\\mathcal{N}(C\\cdot z_t+D,R)\\ z_1&\\sim\\mathcal{N}(\\mu_1,\\Sigma_1) \\end{align} $$ \u5728\u542b\u65f6\u7684\u6982\u7387\u56fe\u4e2d\uff0c\u9664\u4e86\u5bf9\u53c2\u6570\u4f30\u8ba1\u7684\u5b66\u4e60\u95ee\u9898\u5916\uff0c\u5728\u63a8\u65ad\u4efb\u52a1\u4e2d\uff0c\u5305\u62ec\u8bd1\u7801\uff0c\u8bc1\u636e\u6982\u7387\uff0c\u6ee4\u6ce2\uff0c\u5e73\u6ed1\uff0c\u9884\u6d4b\u95ee\u9898\uff0cLDS \u66f4\u5173\u5fc3\u6ee4\u6ce2\u8fd9\u4e2a\u95ee\u9898\uff1a \\(p(z_t|x_1,x_2,\\cdots,x_t)\\) \u3002\u7c7b\u4f3c HMM \u4e2d\u7684\u524d\u5411\u7b97\u6cd5\uff0c\u6211\u4eec\u9700\u8981\u627e\u5230\u4e00\u4e2a\u9012\u63a8\u5173\u7cfb\u3002 $$ p(z_t|x_{1:t})=p(x_{1:t},z_t)/p(x_{1:t})=Cp(x_{1:t},z_t) $$ \u5bf9\u4e8e \\(p(x_{1:t},z_t)\\) \uff1a $$ \\begin{align}p(x_{1:t},z_t)&=p(x_t|x_{1:t-1},z_t)p(x_{1:t-1},z_t)=p(x_t|z_t)p(x_{1:t-1},z_t)\\nonumber\\ &=p(x_t|z_t)p(z_t|x_{1:t-1})p(x_{1:t-1})=Cp(x_t|z_t)p(z_t|x_{1:t-1})\\ \\end{align} $$ \u6211\u4eec\u770b\u5230\uff0c\u53f3\u8fb9\u9664\u4e86\u53ea\u548c\u89c2\u6d4b\u76f8\u5173\u7684\u5e38\u6570\u9879\uff0c\u8fd8\u6709\u4e00\u9879\u662f\u9884\u6d4b\u4efb\u52a1\u9700\u8981\u7684\u6982\u7387\u3002\u5bf9\u8fd9\u4e2a\u503c\uff1a $$ \\begin{align} p(z_t|x_{1:t-1})&=\\int_{z_{t-1}}p(z_t,z_{t-1}|x_{1:t-1})dz_{t-1}\\nonumber\\ &=\\int_{z_{t-1}}p(z_t|z_{t-1},x_{1:t-1})p(z_{t-1}|x_{1:t-1})dz_{t-1}\\nonumber\\ &=\\int_{z_{t-1}}p(z_t|z_{t-1})p(z_{t-1}|x_{1:t-1})dz_{t-1} \\end{align} $$ \u6211\u4eec\u770b\u5230\uff0c\u8fd9\u53c8\u5316\u6210\u4e86\u4e00\u4e2a\u6ee4\u6ce2\u95ee\u9898\u3002\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u63a8\u516c\u5f0f\uff1a \\(t=1\\) \uff0c \\(p(z_1|x_1)\\) \uff0c\u79f0\u4e3a update \u8fc7\u7a0b\uff0c\u7136\u540e\u8ba1\u7b97 \\(p(z_2|x_1)\\) \uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u79ef\u5206\u8fdb\u884c\uff0c\u79f0\u4e3a prediction \u8fc7\u7a0b\u3002 \\(t=2\\) \uff0c \\(p(z_2|x_2,x_1)\\) \u548c \\(p(z_3|x_1,x_2)\\) \u6211\u4eec\u770b\u5230\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u4e00\u4e2a Online \u7684\u8fc7\u7a0b\uff0c\u5bf9\u4e8e\u6211\u4eec\u7684\u7ebf\u6027\u9ad8\u65af\u5047\u8bbe\uff0c\u8fd9\u4e2a\u8ba1\u7b97\u8fc7\u7a0b\u90fd\u53ef\u4ee5\u5f97\u5230\u89e3\u6790\u89e3\u3002 Prediction\uff1a $$ p(z_t|x_{1:t-1})=\\int_{z_{t-1}}p(z_t|z_{t-1})p(z_{t-1}|x_{1:t-1})dz_{t-1}=\\int_{z_{t-1}}\\mathcal{N}(Az_{t-1}+B,Q)\\mathcal{N}(\\mu_{t-1},\\Sigma_{t-1})dz_{t-1} $$ \u5176\u4e2d\u7b2c\u4e8c\u4e2a\u9ad8\u65af\u5206\u5e03\u662f\u4e0a\u4e00\u6b65\u7684 Update \u8fc7\u7a0b\uff0c\u6240\u4ee5\u6839\u636e\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\uff0c\u76f4\u63a5\u53ef\u4ee5\u5199\u51fa\u8fd9\u4e2a\u79ef\u5206\uff1a $$ p(z_t|x_{1:t-1})=\\mathcal{N}(A\\mu_{t-1}+B,Q+A\\Sigma_{t-1}A^T) $$ Update: $$ p(z_t|x_{1:t})\\propto p(x_t|z_t)p(z_t|x_{1:t-1}) $$ \u540c\u6837\u5229\u7528\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5199\u51fa\u8fd9\u4e2a\u9ad8\u65af\u5206\u5e03\u3002","title":"\u7ebf\u6027\u52a8\u6001\u7cfb\u7edf"},{"location":"Machine_Learning/13.LDS/#_1","text":"HMM \u6a21\u578b\u9002\u7528\u4e8e\u9690\u53d8\u91cf\u662f\u79bb\u6563\u7684\u503c\u7684\u65f6\u5019\uff0c\u5bf9\u4e8e\u8fde\u7eed\u9690\u53d8\u91cf\u7684 HMM\uff0c\u5e38\u7528\u7ebf\u6027\u52a8\u6001\u7cfb\u7edf\u63cf\u8ff0\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\u7684\u6001\u53d8\u91cf\uff0c\u4f7f\u7528\u7c92\u5b50\u6ee4\u6ce2\u6765\u8868\u8ff0\u975e\u9ad8\u65af\u975e\u7ebf\u6027\u7684\u6001\u53d8\u91cf\u3002 LDS \u53c8\u53eb\u5361\u5c14\u66fc\u6ee4\u6ce2\uff0c\u5176\u4e2d\uff0c\u7ebf\u6027\u4f53\u73b0\u5728\u4e0a\u4e00\u65f6\u523b\u548c\u8fd9\u4e00\u65f6\u523b\u7684\u9690\u53d8\u91cf\u4ee5\u53ca\u9690\u53d8\u91cf\u548c\u89c2\u6d4b\u4e4b\u95f4\uff1a $$ \\begin{align} z_t&=A\\cdot z_{t-1}+B+\\varepsilon\\ x_t&=C\\cdot z_t+D+\\delta\\ \\varepsilon&\\sim\\mathcal{N}(0,Q)\\ \\delta&\\sim\\mathcal{N}(0,R) \\end{align} $$ \u7c7b\u6bd4 HMM \u4e2d\u7684\u51e0\u4e2a\u53c2\u6570\uff1a $$ \\begin{align} p(z_t|z_{t-1})&\\sim\\mathcal{N}(A\\cdot z_{t-1}+B,Q)\\ p(x_t|z_t)&\\sim\\mathcal{N}(C\\cdot z_t+D,R)\\ z_1&\\sim\\mathcal{N}(\\mu_1,\\Sigma_1) \\end{align} $$ \u5728\u542b\u65f6\u7684\u6982\u7387\u56fe\u4e2d\uff0c\u9664\u4e86\u5bf9\u53c2\u6570\u4f30\u8ba1\u7684\u5b66\u4e60\u95ee\u9898\u5916\uff0c\u5728\u63a8\u65ad\u4efb\u52a1\u4e2d\uff0c\u5305\u62ec\u8bd1\u7801\uff0c\u8bc1\u636e\u6982\u7387\uff0c\u6ee4\u6ce2\uff0c\u5e73\u6ed1\uff0c\u9884\u6d4b\u95ee\u9898\uff0cLDS \u66f4\u5173\u5fc3\u6ee4\u6ce2\u8fd9\u4e2a\u95ee\u9898\uff1a \\(p(z_t|x_1,x_2,\\cdots,x_t)\\) \u3002\u7c7b\u4f3c HMM \u4e2d\u7684\u524d\u5411\u7b97\u6cd5\uff0c\u6211\u4eec\u9700\u8981\u627e\u5230\u4e00\u4e2a\u9012\u63a8\u5173\u7cfb\u3002 $$ p(z_t|x_{1:t})=p(x_{1:t},z_t)/p(x_{1:t})=Cp(x_{1:t},z_t) $$ \u5bf9\u4e8e \\(p(x_{1:t},z_t)\\) \uff1a $$ \\begin{align}p(x_{1:t},z_t)&=p(x_t|x_{1:t-1},z_t)p(x_{1:t-1},z_t)=p(x_t|z_t)p(x_{1:t-1},z_t)\\nonumber\\ &=p(x_t|z_t)p(z_t|x_{1:t-1})p(x_{1:t-1})=Cp(x_t|z_t)p(z_t|x_{1:t-1})\\ \\end{align} $$ \u6211\u4eec\u770b\u5230\uff0c\u53f3\u8fb9\u9664\u4e86\u53ea\u548c\u89c2\u6d4b\u76f8\u5173\u7684\u5e38\u6570\u9879\uff0c\u8fd8\u6709\u4e00\u9879\u662f\u9884\u6d4b\u4efb\u52a1\u9700\u8981\u7684\u6982\u7387\u3002\u5bf9\u8fd9\u4e2a\u503c\uff1a $$ \\begin{align} p(z_t|x_{1:t-1})&=\\int_{z_{t-1}}p(z_t,z_{t-1}|x_{1:t-1})dz_{t-1}\\nonumber\\ &=\\int_{z_{t-1}}p(z_t|z_{t-1},x_{1:t-1})p(z_{t-1}|x_{1:t-1})dz_{t-1}\\nonumber\\ &=\\int_{z_{t-1}}p(z_t|z_{t-1})p(z_{t-1}|x_{1:t-1})dz_{t-1} \\end{align} $$ \u6211\u4eec\u770b\u5230\uff0c\u8fd9\u53c8\u5316\u6210\u4e86\u4e00\u4e2a\u6ee4\u6ce2\u95ee\u9898\u3002\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u63a8\u516c\u5f0f\uff1a \\(t=1\\) \uff0c \\(p(z_1|x_1)\\) \uff0c\u79f0\u4e3a update \u8fc7\u7a0b\uff0c\u7136\u540e\u8ba1\u7b97 \\(p(z_2|x_1)\\) \uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u79ef\u5206\u8fdb\u884c\uff0c\u79f0\u4e3a prediction \u8fc7\u7a0b\u3002 \\(t=2\\) \uff0c \\(p(z_2|x_2,x_1)\\) \u548c \\(p(z_3|x_1,x_2)\\) \u6211\u4eec\u770b\u5230\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u4e00\u4e2a Online \u7684\u8fc7\u7a0b\uff0c\u5bf9\u4e8e\u6211\u4eec\u7684\u7ebf\u6027\u9ad8\u65af\u5047\u8bbe\uff0c\u8fd9\u4e2a\u8ba1\u7b97\u8fc7\u7a0b\u90fd\u53ef\u4ee5\u5f97\u5230\u89e3\u6790\u89e3\u3002 Prediction\uff1a $$ p(z_t|x_{1:t-1})=\\int_{z_{t-1}}p(z_t|z_{t-1})p(z_{t-1}|x_{1:t-1})dz_{t-1}=\\int_{z_{t-1}}\\mathcal{N}(Az_{t-1}+B,Q)\\mathcal{N}(\\mu_{t-1},\\Sigma_{t-1})dz_{t-1} $$ \u5176\u4e2d\u7b2c\u4e8c\u4e2a\u9ad8\u65af\u5206\u5e03\u662f\u4e0a\u4e00\u6b65\u7684 Update \u8fc7\u7a0b\uff0c\u6240\u4ee5\u6839\u636e\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\uff0c\u76f4\u63a5\u53ef\u4ee5\u5199\u51fa\u8fd9\u4e2a\u79ef\u5206\uff1a $$ p(z_t|x_{1:t-1})=\\mathcal{N}(A\\mu_{t-1}+B,Q+A\\Sigma_{t-1}A^T) $$ Update: $$ p(z_t|x_{1:t})\\propto p(x_t|z_t)p(z_t|x_{1:t-1}) $$ \u540c\u6837\u5229\u7528\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5199\u51fa\u8fd9\u4e2a\u9ad8\u65af\u5206\u5e03\u3002","title":"\u7ebf\u6027\u52a8\u6001\u7cfb\u7edf"},{"location":"Machine_Learning/14.particleFilter/","text":"\u7c92\u5b50\u6ee4\u6ce2 Kalman \u6ee4\u6ce2\u6839\u636e\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\u53ef\u4ee5\u6c42\u5f97\u89e3\u6790\u89e3\uff0c\u4f46\u662f\u5728\u975e\u7ebf\u6027\uff0c\u975e\u9ad8\u65af\u7684\u60c5\u51b5\uff0c\u662f\u65e0\u6cd5\u5f97\u5230\u89e3\u6790\u89e3\u7684\uff0c\u5bf9\u8fd9\u7c7b\u4e00\u822c\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53eb\u505a\u7c92\u5b50\u6ee4\u6ce2\uff0c\u6211\u4eec\u9700\u8981\u6c42\u5f97\u6982\u7387\u5206\u5e03\uff0c\u9700\u8981\u91c7\u7528\u91c7\u6837\u7684\u65b9\u5f0f\u3002 \u6211\u4eec\u5e0c\u671b\u5e94\u7528 Monte Carlo \u65b9\u6cd5\u6765\u8fdb\u884c\u91c7\u6837\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6982\u7387\u5206\u5e03\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u8ba1\u7b97\u4f9d\u8fd9\u4e2a\u5206\u5e03\u7684\u67d0\u4e2a\u51fd\u6570 \\(f(z)\\) \u7684\u671f\u671b\uff0c\u53ef\u4ee5\u5229\u7528\u67d0\u79cd\u62bd\u6837\u65b9\u6cd5\uff0c\u5728\u8fd9\u4e2a\u6982\u7387\u5206\u5e03\u4e2d\u62bd\u53d6 \\(N\\) \u4e2a\u6837\u672c\uff0c\u5219 \\(\\mathbb{E}[f(z)]\\simeq\\frac{1}{N}\\sum\\limits_{i=1}^Nf(z_i)\\) \u3002\u4f46\u662f\u5982\u679c\u8fd9\u4e2a\u6982\u7387\u5341\u5206\u590d\u6742\uff0c\u90a3\u4e48\u91c7\u6837\u6bd4\u8f83\u56f0\u96be\u3002\u5bf9\u4e8e\u590d\u6742\u7684\u6982\u7387\u5206\u5e03\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u6982\u7387\u5206\u5e03 \\(q(z)\\) \u4f5c\u4e3a\u6865\u6881\uff08\u91cd\u8981\u503c\u91c7\u6837\uff09: $$ \\mathbb{E}[f(z)]=\\int_zf(z)p(z)dz=\\int_zf(z)\\frac{p(z)}{q(z)}q(z)dz=\\sum\\limits_{i=1}^Nf(z_i)\\frac{p(z_i)}{q(z_i)} $$ \u4e8e\u662f\u76f4\u63a5\u901a\u8fc7\u5bf9 \\(q(z)\\) \u91c7\u6837\uff0c\u7136\u540e\u5bf9\u6bcf\u4e00\u4e2a\u91c7\u6837\u7684\u6837\u672c\u5e94\u7528\u6743\u91cd\u5c31\u5f97\u5230\u4e86\u671f\u671b\u7684\u8fd1\u4f3c\uff0c\u5f53\u7136\u4e3a\u4e86\u6982\u7387\u5206\u5e03\u7684\u7279\u6027\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u6743\u91cd\u8fdb\u884c\u5f52\u4e00\u5316\u3002 \u5728\u6ee4\u6ce2\u95ee\u9898\u4e2d\uff0c\u9700\u8981\u6c42\u89e3 \\(p(z_t|x_{1:t})\\) \uff0c\u5176\u6743\u91cd\u4e3a\uff1a $$ w_t^i=\\frac{p(z_t^i|x_{1:t})}{q(z_t^i|x_{1:t})},i=1,2,\\cdots,N $$ \u4e8e\u662f\u5728\u6bcf\u4e00\u4e2a\u65f6\u523b \\(t\\) \uff0c\u90fd\u9700\u8981\u91c7\u6837 \\(N\\) \u4e2a\u70b9\uff0c\u4f46\u662f\u5373\u4f7f\u91c7\u6837\u4e86\u8fd9\u4e48\u591a\u70b9\uff0c\u5206\u5b50\u4e0a\u9762\u7684\u90a3\u4e00\u9879\u4e5f\u5341\u5206\u96be\u6c42\uff0c\u4e8e\u662f\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u5173\u4e8e\u6743\u91cd\u7684\u9012\u63a8\u516c\u5f0f\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5f15\u5165\u5e8f\u5217\u91cd\u8981\u6027\u91c7\u6837\uff08SIS\uff09\u3002 SIS \u5728 SIS \u4e2d\uff0c\u89e3\u51b3\u7684\u95ee\u9898\u662f \\(p(z_{1:t}|x_{1:t})\\) \u3002 $$ w_t^i\\propto\\frac{p(z_{1:t}|x_{1:t})}{q(z_{1:t}|x_{1:t})} $$ \u6839\u636e LDS \u4e2d\u7684\u63a8\u5bfc\uff1a $$ \\begin{align}p(z_{1:t}|x_{1:t})\\propto p(x_{1:t},z_{1:t})&=p(x_t|z_{1:t},x_{1:t-1})p(z_{1:t},x_{1:t-1})\\nonumber\\ &=p(x_t|z_t)p(z_t|x_{1:t-1},z_{1:t-1})p(x_{1:t-1},z_{1:t-1})\\nonumber\\ &=p(x_t|z_t)p(z_t|z_{t-1})p(x_{1:t-1},z_{1:t-1})\\nonumber\\ &\\propto p(x_t|z_t)p(z_t|z_{t-1})p(z_{1:t-1}|x_{1:t-1}) \\end{align} $$ \u4e8e\u662f\u5206\u5b50\u7684\u9012\u63a8\u5f0f\u5c31\u5f97\u5230\u4e86\u3002\u5bf9\u4e8e\u63d0\u8bae\u5206\u5e03\u7684\u5206\u6bcd\uff0c\u53ef\u4ee5\u53d6\uff1a $$ q(z_{1:t}|x_{1:t})=q(z_t|z_{1:t-1},x_{1:t})q(z_{1:t-1}|x_{1:t-1}) $$ \u6240\u4ee5\u6709\uff1a $$ w_t^i\\propto\\frac{p(z_{1:t}|x_{1:t})}{q(z_{1:t}|x_{1:t})}\\propto \\frac{p(x_t|z_t)p(z_t|z_{t-1})p(z_{1:t-1}|x_{1:t-1})}{q(z_t|z_{1:t-1},x_{1:t})q(z_{1:t-1}|x_{1:t-1})}=\\frac{p(x_t|z_t)p(z_t|z_{t-1})}{q(z_t|z_{1:t-1},x_{1:t})}w_{t-1}^i $$ \u6211\u4eec\u5f97\u5230\u7684\u5bf9\u6743\u91cd\u7684\u7b97\u6cd5\u4e3a\uff1a \\(t-1\\) \u65f6\u523b\uff0c\u91c7\u6837\u5b8c\u6210\u5e76\u8ba1\u7b97\u5f97\u5230\u6743\u91cd t \u65f6\u523b\uff0c\u6839\u636e \\(q(z_t|z_{1:t-1},x_{1:t})\\) \u8fdb\u884c\u91c7\u6837\u5f97\u5230 \\(z_t^i\\) \u3002\u7136\u540e\u8ba1\u7b97\u5f97\u5230 \\(N\\) \u4e2a\u6743\u91cd\u3002 \u6700\u540e\u5bf9\u6743\u91cd\u5f52\u4e00\u5316\u3002 SIS \u7b97\u6cd5\u4f1a\u51fa\u73b0\u6743\u503c\u9000\u5316\u7684\u60c5\u51b5\uff0c\u5728\u4e00\u5b9a\u65f6\u95f4\u540e\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u5927\u90e8\u5206\u6743\u91cd\u90fd\u903c\u8fd10\u7684\u60c5\u51b5\uff0c\u8fd9\u662f\u7531\u4e8e\u7a7a\u95f4\u7ef4\u5ea6\u8d8a\u6765\u8d8a\u9ad8\uff0c\u9700\u8981\u7684\u6837\u672c\u4e5f\u8d8a\u6765\u8d8a\u591a\u3002\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u65b9\u6cd5\u6709\uff1a \u91cd\u91c7\u6837\uff0c\u4ee5\u6743\u91cd\u4f5c\u4e3a\u6982\u7387\u5206\u5e03\uff0c\u91cd\u65b0\u5728\u5df2\u7ecf\u91c7\u6837\u7684\u6837\u672c\u4e2d\u91c7\u6837\uff0c\u7136\u540e\u6240\u6709\u6837\u672c\u7684\u6743\u91cd\u76f8\u540c\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u7684\u601d\u8def\u662f\u5c06\u6743\u91cd\u4f5c\u4e3a\u6982\u7387\u5206\u5e03\uff0c\u7136\u540e\u5f97\u5230\u7d2f\u79ef\u5bc6\u5ea6\u51fd\u6570\uff0c\u5728\u7d2f\u79ef\u5bc6\u5ea6\u4e0a\u53d6\u70b9\uff08\u9636\u68af\u51fd\u6570\uff09\u3002 \u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u63d0\u8bae\u5206\u5e03\uff0c \\(q(z_t|z_{1:t-1},x_{1:t})=p(z_t|z_{t-1})\\) \uff0c\u4e8e\u662f\u5c31\u6d88\u6389\u4e86\u4e00\u9879\uff0c\u5e76\u4e14\u91c7\u6837\u7684\u6982\u7387\u5c31\u662f \\(p(z_t|z_{t-1})\\) \uff0c\u8fd9\u5c31\u53eb\u505a\u751f\u6210\u4e0e\u6d4b\u8bd5\u65b9\u6cd5\u3002 \u91c7\u7528\u91cd\u91c7\u6837\u7684 SIS \u7b97\u6cd5\u5c31\u662f\u57fa\u672c\u7684\u7c92\u5b50\u6ee4\u6ce2\u7b97\u6cd5\u3002\u5982\u679c\u50cf\u4e0a\u9762\u90a3\u6837\u9009\u62e9\u63d0\u8bae\u5206\u5e03\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a SIR \u7b97\u6cd5\u3002","title":"\u7c92\u5b50\u6ee4\u6ce2"},{"location":"Machine_Learning/14.particleFilter/#_1","text":"Kalman \u6ee4\u6ce2\u6839\u636e\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\u53ef\u4ee5\u6c42\u5f97\u89e3\u6790\u89e3\uff0c\u4f46\u662f\u5728\u975e\u7ebf\u6027\uff0c\u975e\u9ad8\u65af\u7684\u60c5\u51b5\uff0c\u662f\u65e0\u6cd5\u5f97\u5230\u89e3\u6790\u89e3\u7684\uff0c\u5bf9\u8fd9\u7c7b\u4e00\u822c\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53eb\u505a\u7c92\u5b50\u6ee4\u6ce2\uff0c\u6211\u4eec\u9700\u8981\u6c42\u5f97\u6982\u7387\u5206\u5e03\uff0c\u9700\u8981\u91c7\u7528\u91c7\u6837\u7684\u65b9\u5f0f\u3002 \u6211\u4eec\u5e0c\u671b\u5e94\u7528 Monte Carlo \u65b9\u6cd5\u6765\u8fdb\u884c\u91c7\u6837\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6982\u7387\u5206\u5e03\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u8ba1\u7b97\u4f9d\u8fd9\u4e2a\u5206\u5e03\u7684\u67d0\u4e2a\u51fd\u6570 \\(f(z)\\) \u7684\u671f\u671b\uff0c\u53ef\u4ee5\u5229\u7528\u67d0\u79cd\u62bd\u6837\u65b9\u6cd5\uff0c\u5728\u8fd9\u4e2a\u6982\u7387\u5206\u5e03\u4e2d\u62bd\u53d6 \\(N\\) \u4e2a\u6837\u672c\uff0c\u5219 \\(\\mathbb{E}[f(z)]\\simeq\\frac{1}{N}\\sum\\limits_{i=1}^Nf(z_i)\\) \u3002\u4f46\u662f\u5982\u679c\u8fd9\u4e2a\u6982\u7387\u5341\u5206\u590d\u6742\uff0c\u90a3\u4e48\u91c7\u6837\u6bd4\u8f83\u56f0\u96be\u3002\u5bf9\u4e8e\u590d\u6742\u7684\u6982\u7387\u5206\u5e03\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u6982\u7387\u5206\u5e03 \\(q(z)\\) \u4f5c\u4e3a\u6865\u6881\uff08\u91cd\u8981\u503c\u91c7\u6837\uff09: $$ \\mathbb{E}[f(z)]=\\int_zf(z)p(z)dz=\\int_zf(z)\\frac{p(z)}{q(z)}q(z)dz=\\sum\\limits_{i=1}^Nf(z_i)\\frac{p(z_i)}{q(z_i)} $$ \u4e8e\u662f\u76f4\u63a5\u901a\u8fc7\u5bf9 \\(q(z)\\) \u91c7\u6837\uff0c\u7136\u540e\u5bf9\u6bcf\u4e00\u4e2a\u91c7\u6837\u7684\u6837\u672c\u5e94\u7528\u6743\u91cd\u5c31\u5f97\u5230\u4e86\u671f\u671b\u7684\u8fd1\u4f3c\uff0c\u5f53\u7136\u4e3a\u4e86\u6982\u7387\u5206\u5e03\u7684\u7279\u6027\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u6743\u91cd\u8fdb\u884c\u5f52\u4e00\u5316\u3002 \u5728\u6ee4\u6ce2\u95ee\u9898\u4e2d\uff0c\u9700\u8981\u6c42\u89e3 \\(p(z_t|x_{1:t})\\) \uff0c\u5176\u6743\u91cd\u4e3a\uff1a $$ w_t^i=\\frac{p(z_t^i|x_{1:t})}{q(z_t^i|x_{1:t})},i=1,2,\\cdots,N $$ \u4e8e\u662f\u5728\u6bcf\u4e00\u4e2a\u65f6\u523b \\(t\\) \uff0c\u90fd\u9700\u8981\u91c7\u6837 \\(N\\) \u4e2a\u70b9\uff0c\u4f46\u662f\u5373\u4f7f\u91c7\u6837\u4e86\u8fd9\u4e48\u591a\u70b9\uff0c\u5206\u5b50\u4e0a\u9762\u7684\u90a3\u4e00\u9879\u4e5f\u5341\u5206\u96be\u6c42\uff0c\u4e8e\u662f\u5e0c\u671b\u627e\u5230\u4e00\u4e2a\u5173\u4e8e\u6743\u91cd\u7684\u9012\u63a8\u516c\u5f0f\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5f15\u5165\u5e8f\u5217\u91cd\u8981\u6027\u91c7\u6837\uff08SIS\uff09\u3002","title":"\u7c92\u5b50\u6ee4\u6ce2"},{"location":"Machine_Learning/14.particleFilter/#sis","text":"\u5728 SIS \u4e2d\uff0c\u89e3\u51b3\u7684\u95ee\u9898\u662f \\(p(z_{1:t}|x_{1:t})\\) \u3002 $$ w_t^i\\propto\\frac{p(z_{1:t}|x_{1:t})}{q(z_{1:t}|x_{1:t})} $$ \u6839\u636e LDS \u4e2d\u7684\u63a8\u5bfc\uff1a $$ \\begin{align}p(z_{1:t}|x_{1:t})\\propto p(x_{1:t},z_{1:t})&=p(x_t|z_{1:t},x_{1:t-1})p(z_{1:t},x_{1:t-1})\\nonumber\\ &=p(x_t|z_t)p(z_t|x_{1:t-1},z_{1:t-1})p(x_{1:t-1},z_{1:t-1})\\nonumber\\ &=p(x_t|z_t)p(z_t|z_{t-1})p(x_{1:t-1},z_{1:t-1})\\nonumber\\ &\\propto p(x_t|z_t)p(z_t|z_{t-1})p(z_{1:t-1}|x_{1:t-1}) \\end{align} $$ \u4e8e\u662f\u5206\u5b50\u7684\u9012\u63a8\u5f0f\u5c31\u5f97\u5230\u4e86\u3002\u5bf9\u4e8e\u63d0\u8bae\u5206\u5e03\u7684\u5206\u6bcd\uff0c\u53ef\u4ee5\u53d6\uff1a $$ q(z_{1:t}|x_{1:t})=q(z_t|z_{1:t-1},x_{1:t})q(z_{1:t-1}|x_{1:t-1}) $$ \u6240\u4ee5\u6709\uff1a $$ w_t^i\\propto\\frac{p(z_{1:t}|x_{1:t})}{q(z_{1:t}|x_{1:t})}\\propto \\frac{p(x_t|z_t)p(z_t|z_{t-1})p(z_{1:t-1}|x_{1:t-1})}{q(z_t|z_{1:t-1},x_{1:t})q(z_{1:t-1}|x_{1:t-1})}=\\frac{p(x_t|z_t)p(z_t|z_{t-1})}{q(z_t|z_{1:t-1},x_{1:t})}w_{t-1}^i $$ \u6211\u4eec\u5f97\u5230\u7684\u5bf9\u6743\u91cd\u7684\u7b97\u6cd5\u4e3a\uff1a \\(t-1\\) \u65f6\u523b\uff0c\u91c7\u6837\u5b8c\u6210\u5e76\u8ba1\u7b97\u5f97\u5230\u6743\u91cd t \u65f6\u523b\uff0c\u6839\u636e \\(q(z_t|z_{1:t-1},x_{1:t})\\) \u8fdb\u884c\u91c7\u6837\u5f97\u5230 \\(z_t^i\\) \u3002\u7136\u540e\u8ba1\u7b97\u5f97\u5230 \\(N\\) \u4e2a\u6743\u91cd\u3002 \u6700\u540e\u5bf9\u6743\u91cd\u5f52\u4e00\u5316\u3002 SIS \u7b97\u6cd5\u4f1a\u51fa\u73b0\u6743\u503c\u9000\u5316\u7684\u60c5\u51b5\uff0c\u5728\u4e00\u5b9a\u65f6\u95f4\u540e\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u5927\u90e8\u5206\u6743\u91cd\u90fd\u903c\u8fd10\u7684\u60c5\u51b5\uff0c\u8fd9\u662f\u7531\u4e8e\u7a7a\u95f4\u7ef4\u5ea6\u8d8a\u6765\u8d8a\u9ad8\uff0c\u9700\u8981\u7684\u6837\u672c\u4e5f\u8d8a\u6765\u8d8a\u591a\u3002\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u65b9\u6cd5\u6709\uff1a \u91cd\u91c7\u6837\uff0c\u4ee5\u6743\u91cd\u4f5c\u4e3a\u6982\u7387\u5206\u5e03\uff0c\u91cd\u65b0\u5728\u5df2\u7ecf\u91c7\u6837\u7684\u6837\u672c\u4e2d\u91c7\u6837\uff0c\u7136\u540e\u6240\u6709\u6837\u672c\u7684\u6743\u91cd\u76f8\u540c\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u7684\u601d\u8def\u662f\u5c06\u6743\u91cd\u4f5c\u4e3a\u6982\u7387\u5206\u5e03\uff0c\u7136\u540e\u5f97\u5230\u7d2f\u79ef\u5bc6\u5ea6\u51fd\u6570\uff0c\u5728\u7d2f\u79ef\u5bc6\u5ea6\u4e0a\u53d6\u70b9\uff08\u9636\u68af\u51fd\u6570\uff09\u3002 \u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u63d0\u8bae\u5206\u5e03\uff0c \\(q(z_t|z_{1:t-1},x_{1:t})=p(z_t|z_{t-1})\\) \uff0c\u4e8e\u662f\u5c31\u6d88\u6389\u4e86\u4e00\u9879\uff0c\u5e76\u4e14\u91c7\u6837\u7684\u6982\u7387\u5c31\u662f \\(p(z_t|z_{t-1})\\) \uff0c\u8fd9\u5c31\u53eb\u505a\u751f\u6210\u4e0e\u6d4b\u8bd5\u65b9\u6cd5\u3002 \u91c7\u7528\u91cd\u91c7\u6837\u7684 SIS \u7b97\u6cd5\u5c31\u662f\u57fa\u672c\u7684\u7c92\u5b50\u6ee4\u6ce2\u7b97\u6cd5\u3002\u5982\u679c\u50cf\u4e0a\u9762\u90a3\u6837\u9009\u62e9\u63d0\u8bae\u5206\u5e03\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a SIR \u7b97\u6cd5\u3002","title":"SIS"},{"location":"Machine_Learning/15.CRF/","text":"\u6761\u4ef6\u968f\u673a\u573a \u6211\u4eec\u77e5\u9053\uff0c\u5206\u7c7b\u95ee\u9898\u53ef\u4ee5\u5206\u4e3a\u786c\u5206\u7c7b\u548c\u8f6f\u5206\u7c7b\u4e24\u79cd\uff0c\u5176\u4e2d\u786c\u5206\u7c7b\u6709 SVM\uff0cPLA\uff0cLDA \u7b49\u3002\u8f6f\u5206\u7c7b\u95ee\u9898\u5927\u4f53\u4e0a\u53ef\u4ee5\u5206\u4e3a\u6982\u7387\u751f\u6210\u548c\u6982\u7387\u5224\u522b\u6a21\u578b\uff0c\u5176\u4e2d\u8f83\u4e3a\u6709\u540d\u7684\u6982\u7387\u5224\u522b\u6a21\u578b\u6709 Logistic \u56de\u5f52\uff0c\u751f\u6210\u6a21\u578b\u6709\u6734\u7d20\u8d1d\u53f6\u65af\u6a21\u578b\u3002Logistic \u56de\u5f52\u6a21\u578b\u7684\u635f\u5931\u51fd\u6570\u4e3a\u4ea4\u53c9\u71b5\uff0c\u8fd9\u7c7b\u6a21\u578b\u4e5f\u53eb\u5bf9\u6570\u7ebf\u6027\u6a21\u578b\uff0c\u4e00\u822c\u5730\uff0c\u53c8\u53eb\u505a\u6700\u5927\u71b5\u6a21\u578b\uff0c\u8fd9\u7c7b\u6a21\u578b\u548c\u6307\u6570\u65cf\u5206\u5e03\u7684\u6982\u7387\u5047\u8bbe\u662f\u4e00\u81f4\u7684\u3002\u5bf9\u6734\u7d20\u8d1d\u53f6\u65af\u5047\u8bbe\uff0c\u5982\u679c\u5c06\u5176\u4e2d\u7684\u5355\u5143\u7d20\u7684\u6761\u4ef6\u72ec\u7acb\u6027\u505a\u63a8\u5e7f\u5230\u4e00\u7cfb\u5217\u7684\u9690\u53d8\u91cf\uff0c\u90a3\u4e48\uff0c\u7531\u6b64\u5f97\u5230\u7684\u6a21\u578b\u53c8\u88ab\u79f0\u4e3a\u52a8\u6001\u6a21\u578b\uff0c\u6bd4\u8f83\u6709\u4ee3\u8868\u6027\u7684\u5982 HMM\uff0c\u4ece\u6982\u7387\u610f\u4e49\u4e0a\uff0cHMM\u4e5f\u53ef\u4ee5\u770b\u6210\u662f GMM \u5728\u65f6\u5e8f\u4e0a\u9762\u7684\u63a8\u5e7f\u3002 \u6211\u4eec\u770b\u5230\uff0c\u4e00\u822c\u5730\uff0c\u5982\u679c\u5c06\u6700\u5927\u71b5\u6a21\u578b\u548c HMM\u76f8\u7ed3\u5408\uff0c\u90a3\u4e48\u8fd9\u79cd\u6a21\u578b\u53eb\u505a\u6700\u5927\u71b5 Markov \u6a21\u578b\uff08MEMM\uff09\uff1a 1 2 3 4 5 6 7 8 graph LR; x4((x4))-->y4 x2((x2))-->y2 x1((x1))-->y1 x3((x3))-->y3 y1-->y2; y2-->y3; y3-->y4; \u8fd9\u4e2a\u56fe\u5c31\u662f\u5c06 HMM \u7684\u56fe\u4e2d\u89c2\u6d4b\u53d8\u91cf\u548c\u9690\u53d8\u91cf\u7684\u8fb9\u65b9\u5411\u53cd\u5411\uff0c\u5e94\u7528\u5728\u5206\u7c7b\u4e2d\uff0c\u9690\u53d8\u91cf\u5c31\u662f\u8f93\u51fa\u7684\u5206\u7c7b\uff0c\u8fd9\u6837 HMM \u4e2d\u7684\u4e24\u4e2a\u5047\u8bbe\u5c31\u4e0d\u6210\u7acb\u4e86\uff0c\u7279\u522b\u662f\u89c2\u6d4b\u4e4b\u95f4\u4e0d\u662f\u5b8c\u5168\u72ec\u7acb\u7684\u4e86\u3002 HMM \u662f\u4e00\u79cd\u751f\u6210\u5f0f\u6a21\u578b\uff0c\u5176\u5efa\u6a21\u5bf9\u8c61\u4e3a \\(p(X,Y|\\lambda)\\) \uff0c\u6839\u636e HMM \u7684\u6982\u7387\u56fe\uff0c \\(p(X,Y|\\lambda)=\\prod\\limits_{t=1}^Tp(x_t,y_t|\\lambda,y_{t-1})\\) \u3002\u6211\u4eec\u770b\u5230\uff0c\u89c2\u6d4b\u72ec\u7acb\u6027\u5047\u8bbe\u662f\u4e00\u4e2a\u5f88\u5f3a\u7684\u5047\u8bbe\uff0c\u5982\u679c\u6211\u4eec\u6709\u4e00\u4e2a\u6587\u672c\u6837\u672c\uff0c\u90a3\u4e48\u89c2\u6d4b\u72ec\u7acb\u6027\u5047\u8bbe\u5c31\u5047\u5b9a\u4e86\u6240\u6709\u7684\u5355\u8bcd\u4e4b\u95f4\u6ca1\u6709\u5173\u8054\u3002 \u5728 MEMM \u4e2d\uff0c\u5efa\u6a21\u5bf9\u8c61\u662f \\(p(Y|X,\\lambda)\\) \uff0c\u6211\u4eec\u770b\u6982\u7387\u56fe\uff0c\u7ed9\u5b9a \\(y_t\\) \uff0c \\(x_t,x_{t-1}\\) \u662f\u4e0d\u72ec\u7acb\u7684\uff0c\u8fd9\u6837\uff0c\u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\u5c31\u4e0d\u6210\u7acb\u4e86\u3002\u6839\u636e\u6982\u7387\u56fe\uff0c \\(p(Y|X,\\lambda)=\\prod\\limits_{t=1}^Tp(y_t|y_{t-1},X,\\lambda)\\) \u3002 MEMM \u7684\u7f3a\u9677\u662f\u5176\u5fc5\u987b\u6ee1\u8db3\u5c40\u57df\u7684\u6982\u7387\u5f52\u4e00\u5316\uff08Label Bias Problem\uff09\uff0c\u6211\u4eec\u770b\u5230\uff0c\u5728\u4e0a\u9762\u7684\u6982\u7387\u56fe\u4e2d\uff0c \\(p(y_t|y_{t-1},x_t)\\) \uff0c \u8fd9\u4e2a\u6982\u7387\uff0c\u5982\u679c \\(p(y_t|y_{t-1})\\) \u975e\u5e38\u63a5\u8fd11\uff0c\u90a3\u4e48\u4e8b\u5b9e\u4e0a\uff0c\u89c2\u6d4b\u53d8\u91cf\u662f\u4ec0\u4e48\u5c31\u4e0d\u4f1a\u5f71\u54cd\u8fd9\u4e2a\u6982\u7387\u4e86\u3002 \u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5c06 \\(y\\) \u4e4b\u95f4\u7684\u7bad\u5934\u8f6c\u4e3a\u76f4\u7ebf\u8f6c\u4e3a\u65e0\u5411\u56fe\uff08\u7ebf\u6027\u94fe\u6761\u4ef6\u968f\u673a\u573a\uff09\uff0c\u8fd9\u6837\u5c31\u53ea\u8981\u6ee1\u8db3\u5168\u5c40\u5f52\u4e00\u5316\u4e86\uff08\u7834\u574f\u9f50\u6b21 Markov \u5047\u8bbe\uff09\u3002 1 2 3 4 5 6 7 8 graph LR; x4((x4))-->y4 x2((x2))-->y2 x1((x1))-->y1 x3((x3))-->y3 y1---y2; y2---y3; y3---y4; CRF \u7684 PDF \u7ebf\u6027\u94fe\u7684 CRF \u7684 PDF \u4e3a \\(p(Y|X)=\\frac{1}{Z}\\exp\\sum\\limits_{t=1}^T(F_t(y_{t-1},y_t,x_{1:T}))\\) \uff0c\u4e24\u4e24\u5f62\u6210\u4e86\u6700\u5927\u56e2\uff0c\u5176\u4e2d \\(y_0\\) \u662f\u968f\u610f\u5916\u52a0\u7684\u4e00\u4e2a\u5143\u7d20\u3002\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7b80\u5316\uff0c\u6211\u4eec\u5047\u8bbe\u6bcf\u4e2a\u56e2\u7684\u52bf\u51fd\u6570\u76f8\u540c \\(F_t=F\\) \u3002 \u5bf9\u4e8e\u8fd9\u4e2a \\(F\\) \uff0c\u6211\u4eec\u8fdb\u4e00\u6b65\uff0c\u53ef\u4ee5\u5c06\u5176\u5199\u4e3a \\(F(y_{t-1},y_t,X)=\\Delta_{y_{t-1},X}+\\Delta_{y_{t},X}+\\Delta_{y_t,y_{t-1},X}\\) \u8fd9\u4e09\u4e2a\u90e8\u5206\uff0c\u5206\u522b\u8868\u793a\u72b6\u6001\u51fd\u6570\u5df2\u7ecf\u8f6c\u79fb\u51fd\u6570\uff0c\u7531\u4e8e\u6574\u4f53\u7684\u6c42\u548c\uff0c\u53ef\u4ee5\u7b80\u5316\u4e3a \\(F(y_{t-1},y_t,X)=\\Delta_{y_{t},X}+\\Delta_{y_t,y_{t-1},X}\\) \u3002 \u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5c06\u5176\u53c2\u6570\u5316\uff1a $$ \\begin{align} \\Delta_{y_t,y_{t-1},X}&=\\sum\\limits_{k=1}^K\\lambda_kf_k(y_{t-1},y_t,X)\\ \\Delta_{y_{t},X}&=\\sum\\limits_{l=1}^L\\eta_lg_l(y_t,X) \\end{align} $$ \u5176\u4e2d $g,f $\u53eb\u505a\u7279\u5f81\u51fd\u6570\uff0c\u5bf9\u4e8e \\(y\\) \u6709 \\(S\\) \u79cd\u5143\u7d20\uff0c\u90a3\u4e48 \\(K\\le S^2,L\\le S\\) \u3002 \u4ee3\u5165\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u4e2d\uff1a $$ p(Y|X)=\\frac{1}{Z}\\exp\\sum\\limits_{t=1}^T[\\sum\\limits_{k=1}^K\\lambda_kf_k(y_{t-1},y_t,X)+\\sum\\limits_{l=1}^L\\eta_lg_l(y_t,X)] $$ \u5bf9\u4e8e\u5355\u4e2a\u6837\u672c\uff0c\u5c06\u5176\u5199\u6210\u5411\u91cf\u7684\u5f62\u5f0f\u3002\u5b9a\u4e49 \\(y=(y_1,y_2,\\cdots,y_T)^T,x=(x_1,x_2,\\cdots,x_T)^T,\\lambda=(\\lambda_1,\\lambda_2,\\cdots,\\lambda_K)^T,\\eta=(\\eta_1,\\eta_2,\\cdots,\\eta_L)^T\\) \u3002\u5e76\u4e14\u6709 \\(f=(f_1,f_2,\\cdots,f_K)^T,g=(g_1,g_2,\\cdots,g_L)^T\\) \u3002\u4e8e\u662f\uff1a $$ p(Y=y|X=x)=\\frac{1}{Z}\\exp\\sum\\limits_{t=1}^T[\\lambda^Tf(y_{t-1},y_t,x)+\\eta^Tg(y_t,x)] $$ \u4e0d\u59a8\u8bb0\uff1a \\(\\theta=(\\lambda,\\eta)^T,H=(\\sum\\limits_{t=1}^Tf,\\sum\\limits_{t=1}^Tg)^T\\) \uff1a $$ p(Y=y|X=x)=\\frac{1}{Z(x,\\theta)}\\exp[\\theta^TH(y_t,y_{t-1},x)] $$ \u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u662f\u4e00\u4e2a\u6307\u6570\u65cf\u5206\u5e03\uff0c\u4e8e\u662f \\(Z\\) \u662f\u914d\u5206\u51fd\u6570\u3002 CRF \u9700\u8981\u89e3\u51b3\u4e0b\u9762\u51e0\u4e2a\u95ee\u9898\uff1a Learning\uff1a\u53c2\u6570\u4f30\u8ba1\u95ee\u9898\uff0c\u5bf9 \\(N\\) \u4e2a \\(T\\) \u7ef4\u6837\u672c\uff0c \\(\\hat{\\theta}=\\mathop{argmax}\\limits_{\\theta}\\prod\\limits_{i=1}^Np(y^i|x^i)\\) \uff0c\u8fd9\u91cc\u7528\u4e0a\u6807\u8868\u793a\u6837\u672c\u7684\u7f16\u53f7\u3002 Inference\uff1a \u8fb9\u7f18\u6982\u7387\uff1a $$ p(y_t|x) $$ \u6761\u4ef6\u6982\u7387\uff1a\u4e00\u822c\u5728\u751f\u6210\u6a21\u578b\u4e2d\u8f83\u4e3a\u5173\u6ce8\uff0cCRF \u4e2d\u4e0d\u5173\u6ce8 MAP \u63a8\u65ad\uff1a $$ \\hat{y}=\\mathop{argmax}p(y|x) $$ \u8fb9\u7f18\u6982\u7387 \u8fb9\u7f18\u6982\u7387\u8fd9\u4e2a\u95ee\u9898\u63cf\u8ff0\u4e3a\uff0c\u6839\u636e\u5b66\u4e60\u4efb\u52a1\u5f97\u5230\u7684\u53c2\u6570\uff0c\u7ed9\u5b9a\u4e86 \\(p(Y=y|X=x)\\) \uff0c\u6c42\u89e3 \\(p(y_t=i|x)\\) \u3002\u6839\u636e\u65e0\u5411\u56fe\u53ef\u4ee5\u7ed9\u51fa\uff1a $$ p(y_t=i|x)=\\sum\\limits_{y_{1:t-1},y_{t+1:T}}p(y|x)=\\sum\\limits_{y_{1:t-1}}\\sum\\limits_{y_{t+1:T}}\\frac{1}{Z}\\prod\\limits_{t'=1}^T\\phi_{t'}(y_{t'-1},y_{t'},x) $$ \u6211\u4eec\u770b\u5230\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u76f4\u63a5\u8ba1\u7b97\u7684\u590d\u6742\u5ea6\u5f88\u9ad8\uff0c\u8fd9\u662f\u7531\u4e8e\u6c42\u548c\u7684\u590d\u6742\u5ea6\u5728 \\(O(S^T)\\) \uff0c\u6c42\u79ef\u7684\u590d\u6742\u5ea6\u5728 \\(O(T)\\) \uff0c\u6240\u4ee5\u6574\u4f53\u590d\u6742\u5ea6\u4e3a \\(O(TS^T)\\) \u3002\u6211\u4eec\u9700\u8981\u8c03\u6574\u6c42\u548c\u7b26\u53f7\u7684\u987a\u5e8f\uff0c\u4ece\u800c\u964d\u4f4e\u590d\u6742\u5ea6\u3002 \u9996\u5148\uff0c\u5c06\u4e24\u4e2a\u6c42\u548c\u5206\u4e3a\uff1a $$ \\begin{align}&p(y_t=i|x)=\\frac{1}{Z}\\Delta_l\\Delta_r\\ &\\Delta_l=\\sum\\limits_{y_{1:t-1}}\\phi_{1}(y_0,y_1,x)\\phi_2(y_1,y_2,x)\\cdots\\phi_{t-1}(y_{t-2},y_{t-1},x)\\phi_t(y_{t-1},y_t=i,x)\\ &\\Delta_r=\\sum\\limits_{y_{t+1:T}}\\phi_{t+1}(y_t=i,y_{t+1},x)\\phi_{t+2}(y_{t+1},y_{t+2},x)\\cdots\\phi_T(y_{T-1},y_T,x) \\end{align} $$ \u5bf9\u4e8e \\(\\Delta_l\\) \uff0c\u4ece\u5de6\u5411\u53f3\uff0c\u4e00\u6b65\u4e00\u6b65\u5c06 \\(y_t\\) \u6d88\u6389\uff1a $$ \\Delta_l=\\sum\\limits_{y_{t-1}}\\phi_t(y_{t-1},y_t=i,x)\\sum\\limits_{y_{t-2}}\\phi_{t-1}(y_{t-2},y_{t-1},x)\\cdots\\sum\\limits_{y_0}\\phi_1(y_0,y_1,x) $$ \u5f15\u5165\uff1a $$ \\alpha_t(i)=\\Delta_l $$ \u4e8e\u662f\uff1a $$ \\alpha_{t}(i)=\\sum\\limits_{j\\in S}\\phi_t(y_{t-1}=j,y_t=i,x)\\alpha_{t-1}(j) $$ \u8fd9\u6837\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u63a8\u5f0f\u3002 \u7c7b\u4f3c\u5730\uff0c \\(\\Delta_r=\\beta_t(i)=\\sum\\limits_{j\\in S}\\phi_{t+1}(y_t=i,y_{t+1}=j,x)\\beta_{t+1}(j)\\) \u3002\u8fd9\u4e2a\u65b9\u6cd5\u548c HMM \u4e2d\u7684\u524d\u5411\u540e\u5411\u7b97\u6cd5\u7c7b\u4f3c\uff0c\u5c31\u662f\u6982\u7387\u56fe\u6a21\u578b\u4e2d\u7cbe\u786e\u63a8\u65ad\u7684\u53d8\u91cf\u6d88\u9664\u7b97\u6cd5\uff08\u4fe1\u5ff5\u4f20\u64ad\uff09\u3002 \u53c2\u6570\u4f30\u8ba1 \u5728\u8fdb\u884c\u5404\u79cd\u7c7b\u578b\u7684\u63a8\u65ad\u4e4b\u524d\uff0c\u8fd8\u9700\u8981\u5bf9\u53c2\u6570\u8fdb\u884c\u5b66\u4e60\uff1a $$ \\begin{align}\\hat{\\theta}&=\\mathop{argmax} {\\theta}\\prod\\limits ^Np(y^i|x^i)\\ &=\\mathop{argmax} \\theta\\sum\\limits ^N\\log p(y^i|x^i)\\ &=\\mathop{argmax} \\theta\\sum\\limits ^N[-\\log Z(x^i,\\lambda,\\eta)+\\sum\\limits_{t=1}^T[\\lambda^Tf(y_{t-1},y_t,x)+\\eta^Tg(y_t,x)]] \\end{align} $$ \u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d\uff0c\u7b2c\u4e00\u9879\u662f\u5bf9\u6570\u914d\u5206\u51fd\u6570\uff0c\u6839\u636e\u6307\u6570\u65cf\u5206\u5e03\u7684\u7ed3\u8bba\uff1a $$ \\nabla_\\lambda(\\log Z(x^i,\\lambda,\\eta))=\\mathbb{E} {p(y^i|x^i)}[\\sum\\limits ^Tf(y_{t-1},y_t,x^i)] $$ \u5176\u4e2d\uff0c\u548c \\(\\eta\\) \u76f8\u5173\u7684\u9879\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5e38\u6570\u3002\u6c42\u89e3\u8fd9\u4e2a\u671f\u671b\u503c\uff1a $$ \\mathbb{E} {p(y^i|x^i)}[\\sum\\limits ^Tf(y_{t-1},y_t,x^i)]=\\sum\\limits_{y}p(y|x^i)\\sum\\limits_{t=1}^Tf(y_{t-1},y_t,x^i) $$ \u7b2c\u4e00\u4e2a\u6c42\u548c\u53f7\u7684\u590d\u6742\u5ea6\u4e3a \\(O(S^T)\\) \uff0c\u91cd\u65b0\u6392\u5217\u6c42\u548c\u7b26\u53f7\uff1a $$ \\begin{align}\\mathbb{E} {p(y^i|x^i)}[\\sum\\limits ^Tf(y_{t-1},y_t,x^i)]&=\\sum\\limits_{t=1}^T\\sum\\limits_{y_{1:t-2}}\\sum\\limits_{y_{t-1}}\\sum\\limits_{y_t}\\sum\\limits_{y_{t+1:T}}p(y|x^i)f(y_{t-1},y_t,x^i)\\nonumber\\ &=\\sum\\limits_{t=1}^T\\sum\\limits_{y_{t-1}}\\sum\\limits_{y_t}p(y_{t-1},y_t|x^i)f(y_{t-1},y_t,x^i) \\end{align} $$ \u548c\u4e0a\u9762\u7684\u8fb9\u7f18\u6982\u7387\u7c7b\u4f3c\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u524d\u5411\u540e\u5411\u7b97\u6cd5\u5f97\u5230\u4e0a\u9762\u5f0f\u5b50\u4e2d\u7684\u8fb9\u7f18\u6982\u7387\u3002 \u4e8e\u662f\uff1a $$ \\nabla_\\lambda L=\\sum\\limits_{i=1}^N\\sum\\limits_{t=1}^T[f(y_{t-1},y_t,x^i)-\\sum\\limits_{y_{t-1}}\\sum\\limits_{y_t}p(y_{t-1},y_t|x^i)f(y_{t-1},y_t,x^i)] $$ \u5229\u7528\u68af\u5ea6\u4e0a\u5347\u7b97\u6cd5\u53ef\u4ee5\u6c42\u89e3\u3002\u5bf9\u4e8e \\(\\eta\\) \u4e5f\u662f\u7c7b\u4f3c\u7684\u8fc7\u7a0b\u3002 \u8bd1\u7801 \u8bd1\u7801\u95ee\u9898\u548c HMM \u4e2d\u7684 Viterbi \u7b97\u6cd5\u7c7b\u4f3c\uff0c\u540c\u6837\u91c7\u6837\u52a8\u6001\u89c4\u5212\u7684\u601d\u60f3\u4e00\u5c42\u4e00\u5c42\u6c42\u89e3\u6700\u5927\u503c\u3002","title":"\u6761\u4ef6\u968f\u673a\u573a"},{"location":"Machine_Learning/15.CRF/#_1","text":"\u6211\u4eec\u77e5\u9053\uff0c\u5206\u7c7b\u95ee\u9898\u53ef\u4ee5\u5206\u4e3a\u786c\u5206\u7c7b\u548c\u8f6f\u5206\u7c7b\u4e24\u79cd\uff0c\u5176\u4e2d\u786c\u5206\u7c7b\u6709 SVM\uff0cPLA\uff0cLDA \u7b49\u3002\u8f6f\u5206\u7c7b\u95ee\u9898\u5927\u4f53\u4e0a\u53ef\u4ee5\u5206\u4e3a\u6982\u7387\u751f\u6210\u548c\u6982\u7387\u5224\u522b\u6a21\u578b\uff0c\u5176\u4e2d\u8f83\u4e3a\u6709\u540d\u7684\u6982\u7387\u5224\u522b\u6a21\u578b\u6709 Logistic \u56de\u5f52\uff0c\u751f\u6210\u6a21\u578b\u6709\u6734\u7d20\u8d1d\u53f6\u65af\u6a21\u578b\u3002Logistic \u56de\u5f52\u6a21\u578b\u7684\u635f\u5931\u51fd\u6570\u4e3a\u4ea4\u53c9\u71b5\uff0c\u8fd9\u7c7b\u6a21\u578b\u4e5f\u53eb\u5bf9\u6570\u7ebf\u6027\u6a21\u578b\uff0c\u4e00\u822c\u5730\uff0c\u53c8\u53eb\u505a\u6700\u5927\u71b5\u6a21\u578b\uff0c\u8fd9\u7c7b\u6a21\u578b\u548c\u6307\u6570\u65cf\u5206\u5e03\u7684\u6982\u7387\u5047\u8bbe\u662f\u4e00\u81f4\u7684\u3002\u5bf9\u6734\u7d20\u8d1d\u53f6\u65af\u5047\u8bbe\uff0c\u5982\u679c\u5c06\u5176\u4e2d\u7684\u5355\u5143\u7d20\u7684\u6761\u4ef6\u72ec\u7acb\u6027\u505a\u63a8\u5e7f\u5230\u4e00\u7cfb\u5217\u7684\u9690\u53d8\u91cf\uff0c\u90a3\u4e48\uff0c\u7531\u6b64\u5f97\u5230\u7684\u6a21\u578b\u53c8\u88ab\u79f0\u4e3a\u52a8\u6001\u6a21\u578b\uff0c\u6bd4\u8f83\u6709\u4ee3\u8868\u6027\u7684\u5982 HMM\uff0c\u4ece\u6982\u7387\u610f\u4e49\u4e0a\uff0cHMM\u4e5f\u53ef\u4ee5\u770b\u6210\u662f GMM \u5728\u65f6\u5e8f\u4e0a\u9762\u7684\u63a8\u5e7f\u3002 \u6211\u4eec\u770b\u5230\uff0c\u4e00\u822c\u5730\uff0c\u5982\u679c\u5c06\u6700\u5927\u71b5\u6a21\u578b\u548c HMM\u76f8\u7ed3\u5408\uff0c\u90a3\u4e48\u8fd9\u79cd\u6a21\u578b\u53eb\u505a\u6700\u5927\u71b5 Markov \u6a21\u578b\uff08MEMM\uff09\uff1a 1 2 3 4 5 6 7 8 graph LR; x4((x4))-->y4 x2((x2))-->y2 x1((x1))-->y1 x3((x3))-->y3 y1-->y2; y2-->y3; y3-->y4; \u8fd9\u4e2a\u56fe\u5c31\u662f\u5c06 HMM \u7684\u56fe\u4e2d\u89c2\u6d4b\u53d8\u91cf\u548c\u9690\u53d8\u91cf\u7684\u8fb9\u65b9\u5411\u53cd\u5411\uff0c\u5e94\u7528\u5728\u5206\u7c7b\u4e2d\uff0c\u9690\u53d8\u91cf\u5c31\u662f\u8f93\u51fa\u7684\u5206\u7c7b\uff0c\u8fd9\u6837 HMM \u4e2d\u7684\u4e24\u4e2a\u5047\u8bbe\u5c31\u4e0d\u6210\u7acb\u4e86\uff0c\u7279\u522b\u662f\u89c2\u6d4b\u4e4b\u95f4\u4e0d\u662f\u5b8c\u5168\u72ec\u7acb\u7684\u4e86\u3002 HMM \u662f\u4e00\u79cd\u751f\u6210\u5f0f\u6a21\u578b\uff0c\u5176\u5efa\u6a21\u5bf9\u8c61\u4e3a \\(p(X,Y|\\lambda)\\) \uff0c\u6839\u636e HMM \u7684\u6982\u7387\u56fe\uff0c \\(p(X,Y|\\lambda)=\\prod\\limits_{t=1}^Tp(x_t,y_t|\\lambda,y_{t-1})\\) \u3002\u6211\u4eec\u770b\u5230\uff0c\u89c2\u6d4b\u72ec\u7acb\u6027\u5047\u8bbe\u662f\u4e00\u4e2a\u5f88\u5f3a\u7684\u5047\u8bbe\uff0c\u5982\u679c\u6211\u4eec\u6709\u4e00\u4e2a\u6587\u672c\u6837\u672c\uff0c\u90a3\u4e48\u89c2\u6d4b\u72ec\u7acb\u6027\u5047\u8bbe\u5c31\u5047\u5b9a\u4e86\u6240\u6709\u7684\u5355\u8bcd\u4e4b\u95f4\u6ca1\u6709\u5173\u8054\u3002 \u5728 MEMM \u4e2d\uff0c\u5efa\u6a21\u5bf9\u8c61\u662f \\(p(Y|X,\\lambda)\\) \uff0c\u6211\u4eec\u770b\u6982\u7387\u56fe\uff0c\u7ed9\u5b9a \\(y_t\\) \uff0c \\(x_t,x_{t-1}\\) \u662f\u4e0d\u72ec\u7acb\u7684\uff0c\u8fd9\u6837\uff0c\u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\u5c31\u4e0d\u6210\u7acb\u4e86\u3002\u6839\u636e\u6982\u7387\u56fe\uff0c \\(p(Y|X,\\lambda)=\\prod\\limits_{t=1}^Tp(y_t|y_{t-1},X,\\lambda)\\) \u3002 MEMM \u7684\u7f3a\u9677\u662f\u5176\u5fc5\u987b\u6ee1\u8db3\u5c40\u57df\u7684\u6982\u7387\u5f52\u4e00\u5316\uff08Label Bias Problem\uff09\uff0c\u6211\u4eec\u770b\u5230\uff0c\u5728\u4e0a\u9762\u7684\u6982\u7387\u56fe\u4e2d\uff0c \\(p(y_t|y_{t-1},x_t)\\) \uff0c \u8fd9\u4e2a\u6982\u7387\uff0c\u5982\u679c \\(p(y_t|y_{t-1})\\) \u975e\u5e38\u63a5\u8fd11\uff0c\u90a3\u4e48\u4e8b\u5b9e\u4e0a\uff0c\u89c2\u6d4b\u53d8\u91cf\u662f\u4ec0\u4e48\u5c31\u4e0d\u4f1a\u5f71\u54cd\u8fd9\u4e2a\u6982\u7387\u4e86\u3002 \u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5c06 \\(y\\) \u4e4b\u95f4\u7684\u7bad\u5934\u8f6c\u4e3a\u76f4\u7ebf\u8f6c\u4e3a\u65e0\u5411\u56fe\uff08\u7ebf\u6027\u94fe\u6761\u4ef6\u968f\u673a\u573a\uff09\uff0c\u8fd9\u6837\u5c31\u53ea\u8981\u6ee1\u8db3\u5168\u5c40\u5f52\u4e00\u5316\u4e86\uff08\u7834\u574f\u9f50\u6b21 Markov \u5047\u8bbe\uff09\u3002 1 2 3 4 5 6 7 8 graph LR; x4((x4))-->y4 x2((x2))-->y2 x1((x1))-->y1 x3((x3))-->y3 y1---y2; y2---y3; y3---y4;","title":"\u6761\u4ef6\u968f\u673a\u573a"},{"location":"Machine_Learning/15.CRF/#crf-pdf","text":"\u7ebf\u6027\u94fe\u7684 CRF \u7684 PDF \u4e3a \\(p(Y|X)=\\frac{1}{Z}\\exp\\sum\\limits_{t=1}^T(F_t(y_{t-1},y_t,x_{1:T}))\\) \uff0c\u4e24\u4e24\u5f62\u6210\u4e86\u6700\u5927\u56e2\uff0c\u5176\u4e2d \\(y_0\\) \u662f\u968f\u610f\u5916\u52a0\u7684\u4e00\u4e2a\u5143\u7d20\u3002\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7b80\u5316\uff0c\u6211\u4eec\u5047\u8bbe\u6bcf\u4e2a\u56e2\u7684\u52bf\u51fd\u6570\u76f8\u540c \\(F_t=F\\) \u3002 \u5bf9\u4e8e\u8fd9\u4e2a \\(F\\) \uff0c\u6211\u4eec\u8fdb\u4e00\u6b65\uff0c\u53ef\u4ee5\u5c06\u5176\u5199\u4e3a \\(F(y_{t-1},y_t,X)=\\Delta_{y_{t-1},X}+\\Delta_{y_{t},X}+\\Delta_{y_t,y_{t-1},X}\\) \u8fd9\u4e09\u4e2a\u90e8\u5206\uff0c\u5206\u522b\u8868\u793a\u72b6\u6001\u51fd\u6570\u5df2\u7ecf\u8f6c\u79fb\u51fd\u6570\uff0c\u7531\u4e8e\u6574\u4f53\u7684\u6c42\u548c\uff0c\u53ef\u4ee5\u7b80\u5316\u4e3a \\(F(y_{t-1},y_t,X)=\\Delta_{y_{t},X}+\\Delta_{y_t,y_{t-1},X}\\) \u3002 \u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5c06\u5176\u53c2\u6570\u5316\uff1a $$ \\begin{align} \\Delta_{y_t,y_{t-1},X}&=\\sum\\limits_{k=1}^K\\lambda_kf_k(y_{t-1},y_t,X)\\ \\Delta_{y_{t},X}&=\\sum\\limits_{l=1}^L\\eta_lg_l(y_t,X) \\end{align} $$ \u5176\u4e2d $g,f $\u53eb\u505a\u7279\u5f81\u51fd\u6570\uff0c\u5bf9\u4e8e \\(y\\) \u6709 \\(S\\) \u79cd\u5143\u7d20\uff0c\u90a3\u4e48 \\(K\\le S^2,L\\le S\\) \u3002 \u4ee3\u5165\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u4e2d\uff1a $$ p(Y|X)=\\frac{1}{Z}\\exp\\sum\\limits_{t=1}^T[\\sum\\limits_{k=1}^K\\lambda_kf_k(y_{t-1},y_t,X)+\\sum\\limits_{l=1}^L\\eta_lg_l(y_t,X)] $$ \u5bf9\u4e8e\u5355\u4e2a\u6837\u672c\uff0c\u5c06\u5176\u5199\u6210\u5411\u91cf\u7684\u5f62\u5f0f\u3002\u5b9a\u4e49 \\(y=(y_1,y_2,\\cdots,y_T)^T,x=(x_1,x_2,\\cdots,x_T)^T,\\lambda=(\\lambda_1,\\lambda_2,\\cdots,\\lambda_K)^T,\\eta=(\\eta_1,\\eta_2,\\cdots,\\eta_L)^T\\) \u3002\u5e76\u4e14\u6709 \\(f=(f_1,f_2,\\cdots,f_K)^T,g=(g_1,g_2,\\cdots,g_L)^T\\) \u3002\u4e8e\u662f\uff1a $$ p(Y=y|X=x)=\\frac{1}{Z}\\exp\\sum\\limits_{t=1}^T[\\lambda^Tf(y_{t-1},y_t,x)+\\eta^Tg(y_t,x)] $$ \u4e0d\u59a8\u8bb0\uff1a \\(\\theta=(\\lambda,\\eta)^T,H=(\\sum\\limits_{t=1}^Tf,\\sum\\limits_{t=1}^Tg)^T\\) \uff1a $$ p(Y=y|X=x)=\\frac{1}{Z(x,\\theta)}\\exp[\\theta^TH(y_t,y_{t-1},x)] $$ \u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u662f\u4e00\u4e2a\u6307\u6570\u65cf\u5206\u5e03\uff0c\u4e8e\u662f \\(Z\\) \u662f\u914d\u5206\u51fd\u6570\u3002 CRF \u9700\u8981\u89e3\u51b3\u4e0b\u9762\u51e0\u4e2a\u95ee\u9898\uff1a Learning\uff1a\u53c2\u6570\u4f30\u8ba1\u95ee\u9898\uff0c\u5bf9 \\(N\\) \u4e2a \\(T\\) \u7ef4\u6837\u672c\uff0c \\(\\hat{\\theta}=\\mathop{argmax}\\limits_{\\theta}\\prod\\limits_{i=1}^Np(y^i|x^i)\\) \uff0c\u8fd9\u91cc\u7528\u4e0a\u6807\u8868\u793a\u6837\u672c\u7684\u7f16\u53f7\u3002 Inference\uff1a \u8fb9\u7f18\u6982\u7387\uff1a $$ p(y_t|x) $$ \u6761\u4ef6\u6982\u7387\uff1a\u4e00\u822c\u5728\u751f\u6210\u6a21\u578b\u4e2d\u8f83\u4e3a\u5173\u6ce8\uff0cCRF \u4e2d\u4e0d\u5173\u6ce8 MAP \u63a8\u65ad\uff1a $$ \\hat{y}=\\mathop{argmax}p(y|x) $$","title":"CRF \u7684 PDF"},{"location":"Machine_Learning/15.CRF/#_2","text":"\u8fb9\u7f18\u6982\u7387\u8fd9\u4e2a\u95ee\u9898\u63cf\u8ff0\u4e3a\uff0c\u6839\u636e\u5b66\u4e60\u4efb\u52a1\u5f97\u5230\u7684\u53c2\u6570\uff0c\u7ed9\u5b9a\u4e86 \\(p(Y=y|X=x)\\) \uff0c\u6c42\u89e3 \\(p(y_t=i|x)\\) \u3002\u6839\u636e\u65e0\u5411\u56fe\u53ef\u4ee5\u7ed9\u51fa\uff1a $$ p(y_t=i|x)=\\sum\\limits_{y_{1:t-1},y_{t+1:T}}p(y|x)=\\sum\\limits_{y_{1:t-1}}\\sum\\limits_{y_{t+1:T}}\\frac{1}{Z}\\prod\\limits_{t'=1}^T\\phi_{t'}(y_{t'-1},y_{t'},x) $$ \u6211\u4eec\u770b\u5230\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u76f4\u63a5\u8ba1\u7b97\u7684\u590d\u6742\u5ea6\u5f88\u9ad8\uff0c\u8fd9\u662f\u7531\u4e8e\u6c42\u548c\u7684\u590d\u6742\u5ea6\u5728 \\(O(S^T)\\) \uff0c\u6c42\u79ef\u7684\u590d\u6742\u5ea6\u5728 \\(O(T)\\) \uff0c\u6240\u4ee5\u6574\u4f53\u590d\u6742\u5ea6\u4e3a \\(O(TS^T)\\) \u3002\u6211\u4eec\u9700\u8981\u8c03\u6574\u6c42\u548c\u7b26\u53f7\u7684\u987a\u5e8f\uff0c\u4ece\u800c\u964d\u4f4e\u590d\u6742\u5ea6\u3002 \u9996\u5148\uff0c\u5c06\u4e24\u4e2a\u6c42\u548c\u5206\u4e3a\uff1a $$ \\begin{align}&p(y_t=i|x)=\\frac{1}{Z}\\Delta_l\\Delta_r\\ &\\Delta_l=\\sum\\limits_{y_{1:t-1}}\\phi_{1}(y_0,y_1,x)\\phi_2(y_1,y_2,x)\\cdots\\phi_{t-1}(y_{t-2},y_{t-1},x)\\phi_t(y_{t-1},y_t=i,x)\\ &\\Delta_r=\\sum\\limits_{y_{t+1:T}}\\phi_{t+1}(y_t=i,y_{t+1},x)\\phi_{t+2}(y_{t+1},y_{t+2},x)\\cdots\\phi_T(y_{T-1},y_T,x) \\end{align} $$ \u5bf9\u4e8e \\(\\Delta_l\\) \uff0c\u4ece\u5de6\u5411\u53f3\uff0c\u4e00\u6b65\u4e00\u6b65\u5c06 \\(y_t\\) \u6d88\u6389\uff1a $$ \\Delta_l=\\sum\\limits_{y_{t-1}}\\phi_t(y_{t-1},y_t=i,x)\\sum\\limits_{y_{t-2}}\\phi_{t-1}(y_{t-2},y_{t-1},x)\\cdots\\sum\\limits_{y_0}\\phi_1(y_0,y_1,x) $$ \u5f15\u5165\uff1a $$ \\alpha_t(i)=\\Delta_l $$ \u4e8e\u662f\uff1a $$ \\alpha_{t}(i)=\\sum\\limits_{j\\in S}\\phi_t(y_{t-1}=j,y_t=i,x)\\alpha_{t-1}(j) $$ \u8fd9\u6837\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u63a8\u5f0f\u3002 \u7c7b\u4f3c\u5730\uff0c \\(\\Delta_r=\\beta_t(i)=\\sum\\limits_{j\\in S}\\phi_{t+1}(y_t=i,y_{t+1}=j,x)\\beta_{t+1}(j)\\) \u3002\u8fd9\u4e2a\u65b9\u6cd5\u548c HMM \u4e2d\u7684\u524d\u5411\u540e\u5411\u7b97\u6cd5\u7c7b\u4f3c\uff0c\u5c31\u662f\u6982\u7387\u56fe\u6a21\u578b\u4e2d\u7cbe\u786e\u63a8\u65ad\u7684\u53d8\u91cf\u6d88\u9664\u7b97\u6cd5\uff08\u4fe1\u5ff5\u4f20\u64ad\uff09\u3002","title":"\u8fb9\u7f18\u6982\u7387"},{"location":"Machine_Learning/15.CRF/#_3","text":"\u5728\u8fdb\u884c\u5404\u79cd\u7c7b\u578b\u7684\u63a8\u65ad\u4e4b\u524d\uff0c\u8fd8\u9700\u8981\u5bf9\u53c2\u6570\u8fdb\u884c\u5b66\u4e60\uff1a $$ \\begin{align}\\hat{\\theta}&=\\mathop{argmax} {\\theta}\\prod\\limits ^Np(y^i|x^i)\\ &=\\mathop{argmax} \\theta\\sum\\limits ^N\\log p(y^i|x^i)\\ &=\\mathop{argmax} \\theta\\sum\\limits ^N[-\\log Z(x^i,\\lambda,\\eta)+\\sum\\limits_{t=1}^T[\\lambda^Tf(y_{t-1},y_t,x)+\\eta^Tg(y_t,x)]] \\end{align} $$ \u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d\uff0c\u7b2c\u4e00\u9879\u662f\u5bf9\u6570\u914d\u5206\u51fd\u6570\uff0c\u6839\u636e\u6307\u6570\u65cf\u5206\u5e03\u7684\u7ed3\u8bba\uff1a $$ \\nabla_\\lambda(\\log Z(x^i,\\lambda,\\eta))=\\mathbb{E} {p(y^i|x^i)}[\\sum\\limits ^Tf(y_{t-1},y_t,x^i)] $$ \u5176\u4e2d\uff0c\u548c \\(\\eta\\) \u76f8\u5173\u7684\u9879\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5e38\u6570\u3002\u6c42\u89e3\u8fd9\u4e2a\u671f\u671b\u503c\uff1a $$ \\mathbb{E} {p(y^i|x^i)}[\\sum\\limits ^Tf(y_{t-1},y_t,x^i)]=\\sum\\limits_{y}p(y|x^i)\\sum\\limits_{t=1}^Tf(y_{t-1},y_t,x^i) $$ \u7b2c\u4e00\u4e2a\u6c42\u548c\u53f7\u7684\u590d\u6742\u5ea6\u4e3a \\(O(S^T)\\) \uff0c\u91cd\u65b0\u6392\u5217\u6c42\u548c\u7b26\u53f7\uff1a $$ \\begin{align}\\mathbb{E} {p(y^i|x^i)}[\\sum\\limits ^Tf(y_{t-1},y_t,x^i)]&=\\sum\\limits_{t=1}^T\\sum\\limits_{y_{1:t-2}}\\sum\\limits_{y_{t-1}}\\sum\\limits_{y_t}\\sum\\limits_{y_{t+1:T}}p(y|x^i)f(y_{t-1},y_t,x^i)\\nonumber\\ &=\\sum\\limits_{t=1}^T\\sum\\limits_{y_{t-1}}\\sum\\limits_{y_t}p(y_{t-1},y_t|x^i)f(y_{t-1},y_t,x^i) \\end{align} $$ \u548c\u4e0a\u9762\u7684\u8fb9\u7f18\u6982\u7387\u7c7b\u4f3c\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u524d\u5411\u540e\u5411\u7b97\u6cd5\u5f97\u5230\u4e0a\u9762\u5f0f\u5b50\u4e2d\u7684\u8fb9\u7f18\u6982\u7387\u3002 \u4e8e\u662f\uff1a $$ \\nabla_\\lambda L=\\sum\\limits_{i=1}^N\\sum\\limits_{t=1}^T[f(y_{t-1},y_t,x^i)-\\sum\\limits_{y_{t-1}}\\sum\\limits_{y_t}p(y_{t-1},y_t|x^i)f(y_{t-1},y_t,x^i)] $$ \u5229\u7528\u68af\u5ea6\u4e0a\u5347\u7b97\u6cd5\u53ef\u4ee5\u6c42\u89e3\u3002\u5bf9\u4e8e \\(\\eta\\) \u4e5f\u662f\u7c7b\u4f3c\u7684\u8fc7\u7a0b\u3002","title":"\u53c2\u6570\u4f30\u8ba1"},{"location":"Machine_Learning/15.CRF/#_4","text":"\u8bd1\u7801\u95ee\u9898\u548c HMM \u4e2d\u7684 Viterbi \u7b97\u6cd5\u7c7b\u4f3c\uff0c\u540c\u6837\u91c7\u6837\u52a8\u6001\u89c4\u5212\u7684\u601d\u60f3\u4e00\u5c42\u4e00\u5c42\u6c42\u89e3\u6700\u5927\u503c\u3002","title":"\u8bd1\u7801"},{"location":"Machine_Learning/16.GaussianNetwork/","text":"\u9ad8\u65af\u7f51\u7edc \u9ad8\u65af\u56fe\u6a21\u578b\uff08\u9ad8\u65af\u7f51\u7edc\uff09\u662f\u4e00\u79cd\u968f\u673a\u53d8\u91cf\u4e3a\u8fde\u7eed\u7684\u6709\u5411\u6216\u8005\u65e0\u5411\u56fe\u3002\u6709\u5411\u56fe\u7248\u672c\u7684\u9ad8\u65af\u56fe\u662f\u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc\uff0c\u65e0\u5411\u7248\u672c\u7684\u53eb\u9ad8\u65af\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc\u3002 \u9ad8\u65af\u7f51\u7edc\u7684\u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u662f\u9ad8\u65af\u5206\u5e03\uff1a \\(\\mathcal{N}(\\mu_i,\\Sigma_i)\\) \uff0c\u4e8e\u662f\u6240\u6709\u8282\u70b9\u7684\u8054\u5408\u5206\u5e03\u5c31\u662f\u4e00\u4e2a\u9ad8\u65af\u5206\u5e03\uff0c\u5747\u503c\u4e3a \\(\\mu\\) \uff0c\u65b9\u5dee\u4e3a \\(\\Sigma\\) \u3002 \u5bf9\u4e8e\u8fb9\u7f18\u6982\u7387\uff0c\u6211\u4eec\u6709\u4e0b\u9762\u4e09\u4e2a\u7ed3\u8bba\uff1a \u5bf9\u4e8e\u65b9\u5dee\u77e9\u9635\uff0c\u53ef\u4ee5\u5f97\u5230\u72ec\u7acb\u6027\u6761\u4ef6\uff1a \\(x_i\\perp x_j\\Leftrightarrow\\sigma_{ij}=0\\) \uff0c\u8fd9\u4e2a\u53eb\u505a\u5168\u5c40\u72ec\u7acb\u6027\u3002 \u6211\u4eec\u770b\u65b9\u5dee\u77e9\u9635\u7684\u9006\uff08\u7cbe\u5ea6\u77e9\u9635\u6216\u4fe1\u606f\u77e9\u9635\uff09\uff1a \\(\\Lambda=\\Sigma^{-1}=(\\lambda_{ij})_{pp}\\) \uff0c\u6709\u5b9a\u7406\uff1a \\(x_i\\perp x_j|(X-\\{x_i,x_j\\})\\Leftrightarrow\\lambda_{ij}=0\\) \u56e0\u6b64\uff0c\u6211\u4eec\u4f7f\u7528\u7cbe\u5ea6\u77e9\u9635\u6765\u8868\u793a\u6761\u4ef6\u72ec\u7acb\u6027\u3002 \u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u65e0\u5411\u56fe\u4e2d\u7684\u8282\u70b9 \\(x_i\\) \uff0c \\(x_i|(X-x_i)\\sim \\mathcal{N}(\\sum\\limits_{j\\ne i}\\frac{\\lambda_{ij}}{\\lambda_{ii}}x_j,\\lambda_{ii}^{-1})\\) \u4e5f\u5c31\u662f\u5176\u4ed6\u6240\u6709\u5206\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u5373\u6240\u6709\u4e0e\u5b83\u6709\u94fe\u63a5\u7684\u5206\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\u3002 \u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc GBN \u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc\u53ef\u4ee5\u770b\u6210\u662f LDS \u7684\u4e00\u4e2a\u63a8\u5e7f\uff0cLDS \u7684\u5047\u8bbe\u662f\u76f8\u90bb\u65f6\u523b\u7684\u53d8\u91cf\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u56e0\u6b64\u662f\u4e00\u4e2a\u5c40\u57df\u6a21\u578b\uff0c\u800c\u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc\uff0c\u6bcf\u4e00\u4e2a\u8282\u70b9\u7684\u7236\u4eb2\u8282\u70b9\u4e0d\u4e00\u5b9a\u53ea\u6709\u4e00\u4e2a\uff0c\u56e0\u6b64\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u5168\u5c40\u7684\u6a21\u578b\u3002\u6839\u636e\u6709\u5411\u56fe\u7684\u56e0\u5b50\u5206\u89e3\uff1a $$ p(x)=\\prod\\limits_{i=1}^pp(x_i|x_{Parents(i)}) $$ \u5bf9\u91cc\u9762\u6bcf\u4e00\u9879\uff0c\u5047\u8bbe\u6bcf\u4e00\u4e2a\u7279\u5f81\u662f\u4e00\u7ef4\u7684\uff0c\u53ef\u4ee5\u5199\u6210\u7ebf\u6027\u7ec4\u5408\uff1a $$ p(x_i|x_{Parents(i)})=\\mathcal{N}(x_i|\\mu_i+W_i^Tx_{Parents(i)},\\sigma^2_i) $$ \u5c06\u968f\u673a\u53d8\u91cf\u5199\u6210\uff1a $$ x_i=\\mu_i+\\sum\\limits_{j\\in x_{Parents(i)}}w_{ij}(x_j-\\mu_j)+\\sigma_i\\varepsilon_i,\\varepsilon_i\\sim \\mathcal{N}(0,1) $$ \u5199\u6210\u77e9\u9635\u5f62\u5f0f\uff0c\u5e76\u4e14\u5bf9 \\(w\\) \u8fdb\u884c\u6269\u5c55\uff1a $$ x-\\mu=W(x-\\mu)+S\\varepsilon $$ \u5176\u4e2d\uff0c \\(S=diag(\\sigma_i)\\) \u3002\u6240\u4ee5\u6709\uff1a \\(x-\\mu=(\\mathbb{I}-W)^{-1}S\\varepsilon\\) \u7531\u4e8e\uff1a $$ Cov(x)=Cov(x-\\mu) $$ \u53ef\u4ee5\u5f97\u5230\u534f\u65b9\u5dee\u77e9\u9635\u3002 \u9ad8\u65af\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc GMN \u5bf9\u4e8e\u65e0\u5411\u56fe\u7248\u672c\u7684\u9ad8\u65af\u7f51\u7edc\uff0c\u53ef\u4ee5\u5199\u6210\uff1a $$ p(x)=\\frac{1}{Z}\\prod\\limits_{i=1}^p\\phi_i(x_i)\\prod\\limits_{i,j\\in X}\\phi_{i,j}(x_i,x_j) $$ \u4e3a\u4e86\u5c06\u9ad8\u65af\u5206\u5e03\u548c\u8fd9\u4e2a\u5f0f\u5b50\u7ed3\u5408\uff0c\u6211\u4eec\u5199\u51fa\u9ad8\u65af\u5206\u5e03\u548c\u53d8\u91cf\u76f8\u5173\u7684\u90e8\u5206\uff1a $$ \\begin{align}p(x)&\\propto \\exp(-\\frac{1}{2}(x-\\mu)^T\\Sigma^{-1}(x-\\mu))\\nonumber\\ &=\\exp(-\\frac{1}{2}(x^T\\Lambda x-2\\mu^T\\Lambda x+\\mu^T\\Lambda\\mu))\\nonumber\\ &=\\exp(-\\frac{1}{2}x^T\\Lambda x+(\\Lambda\\mu)^Tx) \\end{align} $$ \u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u4e0e\u65e0\u5411\u56fe\u5206\u89e3\u4e2d\u7684\u4e24\u4e2a\u90e8\u5206\u5bf9\u5e94\uff0c\u6211\u4eec\u8bb0 \\(h=\\Lambda\\mu\\) \u4e3a Potential Vector\u3002\u5176\u4e2d\u548c \\(x_i\\) \u76f8\u5173\u7684\u4e3a\uff1a \\(x_i:-\\frac{1}{2}\\lambda_{ii}x_i^2+h_ix_i\\) \uff0c\u4e0e \\(x_i,x_j\\) \u76f8\u5173\u7684\u662f\uff1a \\(x_i,x_j:-\\lambda_{ij}x_ix_j\\) \uff0c\u8fd9\u91cc\u5229\u7528\u4e86\u7cbe\u5ea6\u77e9\u9635\u4e3a\u5bf9\u79f0\u77e9\u9635\u7684\u6027\u8d28\u3002\u6211\u4eec\u770b\u5230\uff0c\u8fd9\u91cc\u4e5f\u53ef\u4ee5\u770b\u51fa\uff0c \\(x_i,x_j\\) \u6784\u6210\u7684\u4e00\u4e2a\u52bf\u51fd\u6570\uff0c\u53ea\u548c \\(\\lambda_{ij}\\) \u6709\u5173\uff0c\u4e8e\u662f \\(x_i \\perp x_j|(X-\\{x_i,x_j\\})\\Leftrightarrow\\lambda_{ij}=0\\) \u3002","title":"\u9ad8\u65af\u7f51\u7edc"},{"location":"Machine_Learning/16.GaussianNetwork/#_1","text":"\u9ad8\u65af\u56fe\u6a21\u578b\uff08\u9ad8\u65af\u7f51\u7edc\uff09\u662f\u4e00\u79cd\u968f\u673a\u53d8\u91cf\u4e3a\u8fde\u7eed\u7684\u6709\u5411\u6216\u8005\u65e0\u5411\u56fe\u3002\u6709\u5411\u56fe\u7248\u672c\u7684\u9ad8\u65af\u56fe\u662f\u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc\uff0c\u65e0\u5411\u7248\u672c\u7684\u53eb\u9ad8\u65af\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc\u3002 \u9ad8\u65af\u7f51\u7edc\u7684\u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u662f\u9ad8\u65af\u5206\u5e03\uff1a \\(\\mathcal{N}(\\mu_i,\\Sigma_i)\\) \uff0c\u4e8e\u662f\u6240\u6709\u8282\u70b9\u7684\u8054\u5408\u5206\u5e03\u5c31\u662f\u4e00\u4e2a\u9ad8\u65af\u5206\u5e03\uff0c\u5747\u503c\u4e3a \\(\\mu\\) \uff0c\u65b9\u5dee\u4e3a \\(\\Sigma\\) \u3002 \u5bf9\u4e8e\u8fb9\u7f18\u6982\u7387\uff0c\u6211\u4eec\u6709\u4e0b\u9762\u4e09\u4e2a\u7ed3\u8bba\uff1a \u5bf9\u4e8e\u65b9\u5dee\u77e9\u9635\uff0c\u53ef\u4ee5\u5f97\u5230\u72ec\u7acb\u6027\u6761\u4ef6\uff1a \\(x_i\\perp x_j\\Leftrightarrow\\sigma_{ij}=0\\) \uff0c\u8fd9\u4e2a\u53eb\u505a\u5168\u5c40\u72ec\u7acb\u6027\u3002 \u6211\u4eec\u770b\u65b9\u5dee\u77e9\u9635\u7684\u9006\uff08\u7cbe\u5ea6\u77e9\u9635\u6216\u4fe1\u606f\u77e9\u9635\uff09\uff1a \\(\\Lambda=\\Sigma^{-1}=(\\lambda_{ij})_{pp}\\) \uff0c\u6709\u5b9a\u7406\uff1a \\(x_i\\perp x_j|(X-\\{x_i,x_j\\})\\Leftrightarrow\\lambda_{ij}=0\\) \u56e0\u6b64\uff0c\u6211\u4eec\u4f7f\u7528\u7cbe\u5ea6\u77e9\u9635\u6765\u8868\u793a\u6761\u4ef6\u72ec\u7acb\u6027\u3002 \u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u65e0\u5411\u56fe\u4e2d\u7684\u8282\u70b9 \\(x_i\\) \uff0c \\(x_i|(X-x_i)\\sim \\mathcal{N}(\\sum\\limits_{j\\ne i}\\frac{\\lambda_{ij}}{\\lambda_{ii}}x_j,\\lambda_{ii}^{-1})\\) \u4e5f\u5c31\u662f\u5176\u4ed6\u6240\u6709\u5206\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u5373\u6240\u6709\u4e0e\u5b83\u6709\u94fe\u63a5\u7684\u5206\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\u3002","title":"\u9ad8\u65af\u7f51\u7edc"},{"location":"Machine_Learning/16.GaussianNetwork/#gbn","text":"\u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc\u53ef\u4ee5\u770b\u6210\u662f LDS \u7684\u4e00\u4e2a\u63a8\u5e7f\uff0cLDS \u7684\u5047\u8bbe\u662f\u76f8\u90bb\u65f6\u523b\u7684\u53d8\u91cf\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u56e0\u6b64\u662f\u4e00\u4e2a\u5c40\u57df\u6a21\u578b\uff0c\u800c\u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc\uff0c\u6bcf\u4e00\u4e2a\u8282\u70b9\u7684\u7236\u4eb2\u8282\u70b9\u4e0d\u4e00\u5b9a\u53ea\u6709\u4e00\u4e2a\uff0c\u56e0\u6b64\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u5168\u5c40\u7684\u6a21\u578b\u3002\u6839\u636e\u6709\u5411\u56fe\u7684\u56e0\u5b50\u5206\u89e3\uff1a $$ p(x)=\\prod\\limits_{i=1}^pp(x_i|x_{Parents(i)}) $$ \u5bf9\u91cc\u9762\u6bcf\u4e00\u9879\uff0c\u5047\u8bbe\u6bcf\u4e00\u4e2a\u7279\u5f81\u662f\u4e00\u7ef4\u7684\uff0c\u53ef\u4ee5\u5199\u6210\u7ebf\u6027\u7ec4\u5408\uff1a $$ p(x_i|x_{Parents(i)})=\\mathcal{N}(x_i|\\mu_i+W_i^Tx_{Parents(i)},\\sigma^2_i) $$ \u5c06\u968f\u673a\u53d8\u91cf\u5199\u6210\uff1a $$ x_i=\\mu_i+\\sum\\limits_{j\\in x_{Parents(i)}}w_{ij}(x_j-\\mu_j)+\\sigma_i\\varepsilon_i,\\varepsilon_i\\sim \\mathcal{N}(0,1) $$ \u5199\u6210\u77e9\u9635\u5f62\u5f0f\uff0c\u5e76\u4e14\u5bf9 \\(w\\) \u8fdb\u884c\u6269\u5c55\uff1a $$ x-\\mu=W(x-\\mu)+S\\varepsilon $$ \u5176\u4e2d\uff0c \\(S=diag(\\sigma_i)\\) \u3002\u6240\u4ee5\u6709\uff1a \\(x-\\mu=(\\mathbb{I}-W)^{-1}S\\varepsilon\\) \u7531\u4e8e\uff1a $$ Cov(x)=Cov(x-\\mu) $$ \u53ef\u4ee5\u5f97\u5230\u534f\u65b9\u5dee\u77e9\u9635\u3002","title":"\u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc GBN"},{"location":"Machine_Learning/16.GaussianNetwork/#gmn","text":"\u5bf9\u4e8e\u65e0\u5411\u56fe\u7248\u672c\u7684\u9ad8\u65af\u7f51\u7edc\uff0c\u53ef\u4ee5\u5199\u6210\uff1a $$ p(x)=\\frac{1}{Z}\\prod\\limits_{i=1}^p\\phi_i(x_i)\\prod\\limits_{i,j\\in X}\\phi_{i,j}(x_i,x_j) $$ \u4e3a\u4e86\u5c06\u9ad8\u65af\u5206\u5e03\u548c\u8fd9\u4e2a\u5f0f\u5b50\u7ed3\u5408\uff0c\u6211\u4eec\u5199\u51fa\u9ad8\u65af\u5206\u5e03\u548c\u53d8\u91cf\u76f8\u5173\u7684\u90e8\u5206\uff1a $$ \\begin{align}p(x)&\\propto \\exp(-\\frac{1}{2}(x-\\mu)^T\\Sigma^{-1}(x-\\mu))\\nonumber\\ &=\\exp(-\\frac{1}{2}(x^T\\Lambda x-2\\mu^T\\Lambda x+\\mu^T\\Lambda\\mu))\\nonumber\\ &=\\exp(-\\frac{1}{2}x^T\\Lambda x+(\\Lambda\\mu)^Tx) \\end{align} $$ \u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u4e0e\u65e0\u5411\u56fe\u5206\u89e3\u4e2d\u7684\u4e24\u4e2a\u90e8\u5206\u5bf9\u5e94\uff0c\u6211\u4eec\u8bb0 \\(h=\\Lambda\\mu\\) \u4e3a Potential Vector\u3002\u5176\u4e2d\u548c \\(x_i\\) \u76f8\u5173\u7684\u4e3a\uff1a \\(x_i:-\\frac{1}{2}\\lambda_{ii}x_i^2+h_ix_i\\) \uff0c\u4e0e \\(x_i,x_j\\) \u76f8\u5173\u7684\u662f\uff1a \\(x_i,x_j:-\\lambda_{ij}x_ix_j\\) \uff0c\u8fd9\u91cc\u5229\u7528\u4e86\u7cbe\u5ea6\u77e9\u9635\u4e3a\u5bf9\u79f0\u77e9\u9635\u7684\u6027\u8d28\u3002\u6211\u4eec\u770b\u5230\uff0c\u8fd9\u91cc\u4e5f\u53ef\u4ee5\u770b\u51fa\uff0c \\(x_i,x_j\\) \u6784\u6210\u7684\u4e00\u4e2a\u52bf\u51fd\u6570\uff0c\u53ea\u548c \\(\\lambda_{ij}\\) \u6709\u5173\uff0c\u4e8e\u662f \\(x_i \\perp x_j|(X-\\{x_i,x_j\\})\\Leftrightarrow\\lambda_{ij}=0\\) \u3002","title":"\u9ad8\u65af\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc GMN"},{"location":"Machine_Learning/17.BayesianLR/","text":"\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52 \u6211\u4eec\u77e5\u9053\uff0c\u7ebf\u6027\u56de\u5f52\u5f53\u566a\u58f0\u4e3a\u9ad8\u65af\u5206\u5e03\u7684\u65f6\u5019\uff0c\u6700\u5c0f\u4e8c\u4e58\u635f\u5931\u5bfc\u51fa\u7684\u7ed3\u679c\u76f8\u5f53\u4e8e\u5bf9\u6982\u7387\u6a21\u578b\u5e94\u7528 MLE\uff0c\u5f15\u5165\u53c2\u6570\u7684\u5148\u9a8c\u65f6\uff0c\u5148\u9a8c\u5206\u5e03\u662f\u9ad8\u65af\u5206\u5e03\uff0c\u90a3\u4e48 MAP\u7684\u7ed3\u679c\u76f8\u5f53\u4e8e\u5cad\u56de\u5f52\u7684\u6b63\u5219\u5316\uff0c\u5982\u679c\u5148\u9a8c\u662f\u62c9\u666e\u62c9\u65af\u5206\u5e03\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e Lasso \u7684\u6b63\u5219\u5316\u3002\u8fd9\u4e24\u79cd\u65b9\u6848\u90fd\u662f\u70b9\u4f30\u8ba1\u65b9\u6cd5\u3002\u6211\u4eec\u5e0c\u671b\u5229\u7528\u8d1d\u53f6\u65af\u65b9\u6cd5\u6765\u6c42\u89e3\u53c2\u6570\u7684\u540e\u9a8c\u5206\u5e03\u3002 \u7ebf\u6027\u56de\u5f52\u7684\u6a21\u578b\u5047\u8bbe\u4e3a\uff1a $$ \\begin{align}f(x)=w^Tx \\y=f(x)+\\varepsilon\\ \\varepsilon\\sim\\mathcal{N}(0,\\sigma^2) \\end{align} $$ \u5728\u8d1d\u53f6\u65af\u65b9\u6cd5\u4e2d\uff0c\u9700\u8981\u89e3\u51b3\u63a8\u65ad\u548c\u9884\u6d4b\u4e24\u4e2a\u95ee\u9898\u3002 \u63a8\u65ad \u5f15\u5165\u9ad8\u65af\u5148\u9a8c\uff1a $$ p(w)=\\mathcal{N}(0,\\Sigma_p) $$ \u5bf9\u53c2\u6570\u7684\u540e\u9a8c\u5206\u5e03\u8fdb\u884c\u63a8\u65ad\uff1a $$ p(w|X,Y)=\\frac{p(w,Y|X)}{p(Y|X)}=\\frac{p(Y|w,X)p(w|X)}{\\int p(Y|w,X)p(w|X)dw} $$ \u5206\u6bcd\u548c\u53c2\u6570\u65e0\u5173\uff0c\u7531\u4e8e \\(p(w|X)=p(w)\\) \uff0c\u4ee3\u5165\u5148\u9a8c\u5f97\u5230\uff1a $$ p(w|X,Y)\\propto \\prod\\limits_{i=1}^N\\mathcal{N}(y_i|w^Tx_i,\\sigma^2)\\cdot\\mathcal{N}(0,\\Sigma_p) $$ \u9ad8\u65af\u5206\u5e03\u53d6\u9ad8\u65af\u5148\u9a8c\u7684\u5171\u8f6d\u5206\u5e03\u4f9d\u7136\u662f\u9ad8\u65af\u5206\u5e03\uff0c\u4e8e\u662f\u53ef\u4ee5\u5f97\u5230\u540e\u9a8c\u5206\u5e03\u4e5f\u662f\u4e00\u4e2a\u9ad8\u65af\u5206\u5e03\u3002\u7b2c\u4e00\u9879\uff1a $$ \\begin{align}\\prod\\limits_{i=1}^N\\mathcal{N}(y_i|w^Tx_i,\\sigma^2)&=\\frac{1}{(2\\pi)^{N/2}\\sigma^N}\\exp(-\\frac{1}{2\\sigma^2}\\sum\\limits_{i=1}^N(y_i-w^Tx_i)^2)\\nonumber\\ &=\\frac{1}{(2\\pi)^{N/2}\\sigma^N}\\exp(-\\frac{1}{2}(Y-Xw)^T(\\sigma^{-2}\\mathbb{I})(Y-Xw)) \\nonumber\\&=\\mathcal{N}(Xw,\\sigma^2\\mathbb{I}) \\end{align} $$ \u4ee3\u5165\u4e0a\u9762\u7684\u5f0f\u5b50\uff1a $$ p(w|X,Y)\\propto\\exp(-\\frac{1}{2\\sigma^2}(Y-Xw)^T\\sigma^{-2}\\mathbb{I}(Y-Xw)-\\frac{1}{2}w^T\\Sigma_p^{-1}w) $$ \u5047\u5b9a\u6700\u540e\u5f97\u5230\u7684\u9ad8\u65af\u5206\u5e03\u4e3a\uff1a \\(\\mathcal{N}(\\mu_w,\\Sigma_w)\\) \u3002\u5bf9\u4e8e\u4e0a\u9762\u7684\u5206\u5e03\uff0c\u91c7\u7528\u914d\u65b9\u7684\u65b9\u5f0f\u6765\u5f97\u5230\u6700\u7ec8\u7684\u5206\u5e03\uff0c\u6307\u6570\u4e0a\u9762\u7684\u4e8c\u6b21\u9879\u4e3a\uff1a $$ -\\frac{1}{2\\sigma^2}w^TX^TXw-\\frac{1}{2}w^T\\Sigma_p^{-1}w $$ \u4e8e\u662f\uff1a $$ \\Sigma_w^{-1}=\\sigma^{-2}X^TX+\\Sigma_p^{-1}=A $$ \u4e00\u6b21\u9879\uff1a $$ \\frac{1}{2\\sigma^2}2Y^TXw=\\sigma^{-2}Y^TXw $$ \u4e8e\u662f\uff1a $$ \\mu_w^T\\Sigma_w^{-1}=\\sigma^{-2}Y^TX\\Rightarrow\\mu_w=\\sigma^{-2}A^{-1}X^TY $$ \u9884\u6d4b \u7ed9\u5b9a\u4e00\u4e2a \\(x^*\\) \uff0c\u6c42\u89e3 \\(y^*\\) \uff0c\u6240\u4ee5 \\(f(x^*)=x^{*T}w\\) \uff0c\u4ee3\u5165\u53c2\u6570\u540e\u9a8c\uff0c\u6709 \\(x^{*T}w\\sim \\mathcal{N}(x^{*T}\\mu_w,x^{*T}\\Sigma_wx^*)\\) \uff0c\u6dfb\u4e0a\u566a\u58f0\u9879\uff1a $$ p(y^ |X,Y,x^ )=\\int_wp(y^ |w,X,Y,x^ )p(w|X,Y,x^ )dw=\\int_wp(y^ |w,x^ )p(w|X,Y)dw\\ =\\mathcal{N}(x^{ T}\\mu_w,x^{ T}\\Sigma_wx^ +\\sigma^2) $$","title":"\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52"},{"location":"Machine_Learning/17.BayesianLR/#_1","text":"\u6211\u4eec\u77e5\u9053\uff0c\u7ebf\u6027\u56de\u5f52\u5f53\u566a\u58f0\u4e3a\u9ad8\u65af\u5206\u5e03\u7684\u65f6\u5019\uff0c\u6700\u5c0f\u4e8c\u4e58\u635f\u5931\u5bfc\u51fa\u7684\u7ed3\u679c\u76f8\u5f53\u4e8e\u5bf9\u6982\u7387\u6a21\u578b\u5e94\u7528 MLE\uff0c\u5f15\u5165\u53c2\u6570\u7684\u5148\u9a8c\u65f6\uff0c\u5148\u9a8c\u5206\u5e03\u662f\u9ad8\u65af\u5206\u5e03\uff0c\u90a3\u4e48 MAP\u7684\u7ed3\u679c\u76f8\u5f53\u4e8e\u5cad\u56de\u5f52\u7684\u6b63\u5219\u5316\uff0c\u5982\u679c\u5148\u9a8c\u662f\u62c9\u666e\u62c9\u65af\u5206\u5e03\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e Lasso \u7684\u6b63\u5219\u5316\u3002\u8fd9\u4e24\u79cd\u65b9\u6848\u90fd\u662f\u70b9\u4f30\u8ba1\u65b9\u6cd5\u3002\u6211\u4eec\u5e0c\u671b\u5229\u7528\u8d1d\u53f6\u65af\u65b9\u6cd5\u6765\u6c42\u89e3\u53c2\u6570\u7684\u540e\u9a8c\u5206\u5e03\u3002 \u7ebf\u6027\u56de\u5f52\u7684\u6a21\u578b\u5047\u8bbe\u4e3a\uff1a $$ \\begin{align}f(x)=w^Tx \\y=f(x)+\\varepsilon\\ \\varepsilon\\sim\\mathcal{N}(0,\\sigma^2) \\end{align} $$ \u5728\u8d1d\u53f6\u65af\u65b9\u6cd5\u4e2d\uff0c\u9700\u8981\u89e3\u51b3\u63a8\u65ad\u548c\u9884\u6d4b\u4e24\u4e2a\u95ee\u9898\u3002","title":"\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52"},{"location":"Machine_Learning/17.BayesianLR/#_2","text":"\u5f15\u5165\u9ad8\u65af\u5148\u9a8c\uff1a $$ p(w)=\\mathcal{N}(0,\\Sigma_p) $$ \u5bf9\u53c2\u6570\u7684\u540e\u9a8c\u5206\u5e03\u8fdb\u884c\u63a8\u65ad\uff1a $$ p(w|X,Y)=\\frac{p(w,Y|X)}{p(Y|X)}=\\frac{p(Y|w,X)p(w|X)}{\\int p(Y|w,X)p(w|X)dw} $$ \u5206\u6bcd\u548c\u53c2\u6570\u65e0\u5173\uff0c\u7531\u4e8e \\(p(w|X)=p(w)\\) \uff0c\u4ee3\u5165\u5148\u9a8c\u5f97\u5230\uff1a $$ p(w|X,Y)\\propto \\prod\\limits_{i=1}^N\\mathcal{N}(y_i|w^Tx_i,\\sigma^2)\\cdot\\mathcal{N}(0,\\Sigma_p) $$ \u9ad8\u65af\u5206\u5e03\u53d6\u9ad8\u65af\u5148\u9a8c\u7684\u5171\u8f6d\u5206\u5e03\u4f9d\u7136\u662f\u9ad8\u65af\u5206\u5e03\uff0c\u4e8e\u662f\u53ef\u4ee5\u5f97\u5230\u540e\u9a8c\u5206\u5e03\u4e5f\u662f\u4e00\u4e2a\u9ad8\u65af\u5206\u5e03\u3002\u7b2c\u4e00\u9879\uff1a $$ \\begin{align}\\prod\\limits_{i=1}^N\\mathcal{N}(y_i|w^Tx_i,\\sigma^2)&=\\frac{1}{(2\\pi)^{N/2}\\sigma^N}\\exp(-\\frac{1}{2\\sigma^2}\\sum\\limits_{i=1}^N(y_i-w^Tx_i)^2)\\nonumber\\ &=\\frac{1}{(2\\pi)^{N/2}\\sigma^N}\\exp(-\\frac{1}{2}(Y-Xw)^T(\\sigma^{-2}\\mathbb{I})(Y-Xw)) \\nonumber\\&=\\mathcal{N}(Xw,\\sigma^2\\mathbb{I}) \\end{align} $$ \u4ee3\u5165\u4e0a\u9762\u7684\u5f0f\u5b50\uff1a $$ p(w|X,Y)\\propto\\exp(-\\frac{1}{2\\sigma^2}(Y-Xw)^T\\sigma^{-2}\\mathbb{I}(Y-Xw)-\\frac{1}{2}w^T\\Sigma_p^{-1}w) $$ \u5047\u5b9a\u6700\u540e\u5f97\u5230\u7684\u9ad8\u65af\u5206\u5e03\u4e3a\uff1a \\(\\mathcal{N}(\\mu_w,\\Sigma_w)\\) \u3002\u5bf9\u4e8e\u4e0a\u9762\u7684\u5206\u5e03\uff0c\u91c7\u7528\u914d\u65b9\u7684\u65b9\u5f0f\u6765\u5f97\u5230\u6700\u7ec8\u7684\u5206\u5e03\uff0c\u6307\u6570\u4e0a\u9762\u7684\u4e8c\u6b21\u9879\u4e3a\uff1a $$ -\\frac{1}{2\\sigma^2}w^TX^TXw-\\frac{1}{2}w^T\\Sigma_p^{-1}w $$ \u4e8e\u662f\uff1a $$ \\Sigma_w^{-1}=\\sigma^{-2}X^TX+\\Sigma_p^{-1}=A $$ \u4e00\u6b21\u9879\uff1a $$ \\frac{1}{2\\sigma^2}2Y^TXw=\\sigma^{-2}Y^TXw $$ \u4e8e\u662f\uff1a $$ \\mu_w^T\\Sigma_w^{-1}=\\sigma^{-2}Y^TX\\Rightarrow\\mu_w=\\sigma^{-2}A^{-1}X^TY $$","title":"\u63a8\u65ad"},{"location":"Machine_Learning/17.BayesianLR/#_3","text":"\u7ed9\u5b9a\u4e00\u4e2a \\(x^*\\) \uff0c\u6c42\u89e3 \\(y^*\\) \uff0c\u6240\u4ee5 \\(f(x^*)=x^{*T}w\\) \uff0c\u4ee3\u5165\u53c2\u6570\u540e\u9a8c\uff0c\u6709 \\(x^{*T}w\\sim \\mathcal{N}(x^{*T}\\mu_w,x^{*T}\\Sigma_wx^*)\\) \uff0c\u6dfb\u4e0a\u566a\u58f0\u9879\uff1a $$ p(y^ |X,Y,x^ )=\\int_wp(y^ |w,X,Y,x^ )p(w|X,Y,x^ )dw=\\int_wp(y^ |w,x^ )p(w|X,Y)dw\\ =\\mathcal{N}(x^{ T}\\mu_w,x^{ T}\\Sigma_wx^ +\\sigma^2) $$","title":"\u9884\u6d4b"},{"location":"Machine_Learning/18.GaussianProcess/","text":"\u9ad8\u65af\u8fc7\u7a0b\u56de\u5f52 \u5c06\u4e00\u7ef4\u9ad8\u65af\u5206\u5e03\u63a8\u5e7f\u5230\u591a\u53d8\u91cf\u4e2d\u5c31\u5f97\u5230\u4e86\u9ad8\u65af\u7f51\u7edc\uff0c\u5c06\u591a\u53d8\u91cf\u63a8\u5e7f\u5230\u65e0\u9650\u7ef4\uff0c\u5c31\u5f97\u5230\u4e86\u9ad8\u65af\u8fc7\u7a0b\uff0c\u9ad8\u65af\u8fc7\u7a0b\u662f\u5b9a\u4e49\u5728\u8fde\u7eed\u57df\uff08\u65f6\u95f4\u7a7a\u95f4\uff09\u4e0a\u7684\u65e0\u9650\u591a\u4e2a\u9ad8\u7ef4\u968f\u673a\u53d8\u91cf\u6240\u7ec4\u6210\u7684\u968f\u673a\u8fc7\u7a0b\u3002 \u5728\u65f6\u95f4\u8f74\u4e0a\u7684\u4efb\u610f\u4e00\u4e2a\u70b9\u90fd\u6ee1\u8db3\u9ad8\u65af\u5206\u5e03\u5417\uff0c\u5c06\u8fd9\u4e9b\u70b9\u7684\u96c6\u5408\u53eb\u505a\u9ad8\u65af\u8fc7\u7a0b\u7684\u4e00\u4e2a\u6837\u672c\u3002 \u5bf9\u4e8e\u65f6\u95f4\u8f74\u4e0a\u7684\u5e8f\u5217 \\(\\xi_t\\) \uff0c\u5982\u679c \\(\\forall n\\in N^+\uff0ct_i\\in T\\) \uff0c\u6709 \\(\\xi_{t_1-t_n}\\sim \\mathcal{N}(\\mu_{t_1-t_n},\\Sigma_{t_1-t_n})\\) \uff0c \u90a3\u4e48 \\(\\{\\xi_t\\}_{t\\in T}\\) \u662f\u4e00\u4e2a\u9ad8\u65af\u8fc7\u7a0b\u3002 \u9ad8\u65af\u8fc7\u7a0b\u6709\u4e24\u4e2a\u53c2\u6570\uff08\u9ad8\u65af\u8fc7\u7a0b\u5b58\u5728\u6027\u5b9a\u7406\uff09\uff0c\u5747\u503c\u51fd\u6570 \\(m(t)=\\mathbb{E}[\\xi_t]\\) \u548c\u534f\u65b9\u5dee\u51fd\u6570 \\(k(s,t)=\\mathbb{E}[(\\xi_s-\\mathbb{E}[\\xi_s])(\\xi_t-\\mathbb{E}[\\xi_t])]\\) \u3002 \u6211\u4eec\u5c06\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u6dfb\u52a0\u6838\u6280\u5de7\u7684\u8fd9\u4e2a\u6a21\u578b\u53eb\u505a\u9ad8\u65af\u8fc7\u7a0b\u56de\u5f52\uff0c\u9ad8\u65af\u8fc7\u7a0b\u56de\u5f52\u5206\u4e3a\u4e24\u79cd\u89c6\u89d2\uff1a \u6743\u7a7a\u95f4\u7684\u89c6\u89d2-\u6838\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\uff0c\u76f8\u5f53\u4e8e \\(x\\) \u4e3a \\(t\\) \uff0c\u5728\u6bcf\u4e2a\u65f6\u523b\u7684\u9ad8\u65af\u5206\u5e03\u6765\u6e90\u4e8e\u6743\u91cd\uff0c\u6839\u636e\u4e0a\u9762\u7684\u63a8\u5bfc\uff0c\u9884\u6d4b\u7684\u51fd\u6570\u4f9d\u7136\u662f\u9ad8\u65af\u5206\u5e03\u3002 \u51fd\u6570\u7a7a\u95f4\u7684\u89c6\u89d2-\u9ad8\u65af\u5206\u5e03\u901a\u8fc7\u51fd\u6570 \\(f(x)\\) \u6765\u4f53\u73b0\u3002 \u6838\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52 \u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u53ef\u4ee5\u901a\u8fc7\u52a0\u5165\u6838\u51fd\u6570\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u975e\u7ebf\u6027\u51fd\u6570\u7684\u95ee\u9898\uff0c\u5c06 \\(f(x)=x^Tw\\) \u8fd9\u4e2a\u51fd\u6570\u53d8\u4e3a \\(f(x)=\\phi(x)^Tw\\) \uff08\u5f53\u7136\u8fd9\u4e2a\u65f6\u5019\uff0c \\(\\Sigma_p\\) \u4e5f\u8981\u53d8\u4e3a\u66f4\u9ad8\u7ef4\u5ea6\u7684\uff09\uff0c\u53d8\u6362\u5230\u66f4\u9ad8\u7ef4\u7684\u7a7a\u95f4\uff0c\u6709\uff1a $$ \\begin{align}f(x^ )\\sim \\mathcal{N}(\\phi(x^ )^{T}\\sigma^{-2}A^{-1}\\Phi^TY,\\phi(x^ )^{T}A^{-1}\\phi(x^ ))\\ A=\\sigma^{-2}\\Phi^T\\Phi+\\Sigma_p^{-1} \\end{align} $$ \u5176\u4e2d\uff0c \\(\\Phi=(\\phi(x_1),\\phi(x_2),\\cdots,\\phi(x_N))^T\\) \u3002 \u4e3a\u4e86\u6c42\u89e3 \\(A^{-1}\\) \uff0c\u53ef\u4ee5\u5229\u7528 Woodbury Formula\uff0c \\(A=\\Sigma_p^{-1},C=\\sigma^{-2}\\mathbb{I}\\) \uff1a $$ (A+UCV)^{-1}=A^{-1}-A^{-1}U(C^{-1}+VA^{-1}U)^{-1}VA^{-1} $$ \u6240\u4ee5 \\(A^{-1}=\\Sigma_p-\\Sigma_p\\Phi^T(\\sigma^2\\mathbb{I}+\\Phi\\Sigma_p\\Phi^T)^{-1}\\Phi\\Sigma_p\\) \u4e5f\u53ef\u4ee5\u7528\u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a $$ \\begin{align} A&=\\sigma^{-2}\\Phi^T\\Phi+\\Sigma_p^{-1}\\nonumber\\ \\Leftrightarrow A\\Sigma_p&=\\sigma^{-2}\\Phi^T\\Phi\\Sigma_p+\\mathbb{I}\\nonumber\\ \\Leftrightarrow A\\Sigma_p\\Phi^T&=\\sigma^{-2}\\Phi^T\\Phi\\Sigma_p\\Phi^T+\\Phi^T=\\sigma^{-2}\\Phi^T(k+\\sigma^2\\mathbb{I})\\nonumber\\ \\Leftrightarrow \\Sigma_p\\Phi^T&=\\sigma^{-2}A^{-1}\\Phi^T(k+\\sigma^2\\mathbb{I})\\nonumber\\ \\Leftrightarrow \\sigma^{-2}A^{-1}\\Phi^T&=\\Sigma_p\\Phi^T(k+\\sigma^2\\mathbb{I})^{-1}\\nonumber\\ \\Leftrightarrow \\phi(x^ )^T\\sigma^{-2}A^{-1}\\Phi^T&=\\phi(x^ )^T\\Sigma_p\\Phi^T(k+\\sigma^2\\mathbb{I})^{-1} \\end{align} $$ \u4e0a\u9762\u7684\u5de6\u8fb9\u7684\u5f0f\u5b50\u5c31\u662f\u53d8\u6362\u540e\u7684\u5747\u503c\uff0c\u800c\u53f3\u8fb9\u7684\u5f0f\u5b50\u5c31\u662f\u4e0d\u542b \\(A^{-1}\\) \u7684\u5f0f\u5b50\uff0c\u5176\u4e2d \\(k=\\Phi\\Sigma_p\\Phi^T\\) \u3002 \u6839\u636e \\(A^{-1}\\) \u5f97\u5230\u65b9\u5dee\u4e3a\uff1a $$ \\phi(x^ )^T\\Sigma_p\\phi(x^ )-\\phi(x^ )^T\\Sigma_p\\Phi^T(\\sigma^2\\mathbb{I}+k)^{-1}\\Phi\\Sigma_p\\phi(x^ ) $$ \u4e0a\u9762\u5b9a\u4e49\u4e86\uff1a $$ k=\\Phi\\Sigma_p\\Phi^T $$ \u6211\u4eec\u770b\u5230\uff0c\u5728\u5747\u503c\u548c\u65b9\u5dee\u4e2d\uff0c\u542b\u6709\u4e0b\u9762\u56db\u9879\uff1a $$ \\phi(x^ )^T\\Sigma_p\\Phi^T,\\phi(x^ )^T\\Sigma_p\\phi(x^ ),\\phi(x^ )^T\\Sigma_p\\Phi^T,\\Phi\\Sigma_p\\phi(x^*) $$ \u5c55\u5f00\u540e\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u6709\u5171\u540c\u7684\u9879\uff1a \\(k(x,x')=\\phi(x)^T\\Sigma_p\\phi(x\u2018)\\) \u3002\u7531\u4e8e \\(\\Sigma_p\\) \u662f\u6b63\u5b9a\u5bf9\u79f0\u7684\u65b9\u5dee\u77e9\u9635\uff0c\u6240\u4ee5\uff0c\u8fd9\u662f\u4e00\u4e2a\u6838\u51fd\u6570\u3002 \u5bf9\u4e8e\u9ad8\u65af\u8fc7\u7a0b\u4e2d\u7684\u534f\u65b9\u5dee\uff1a $$ k(t,s)=Cov[f(x),f(x')]=\\mathbb{E}[\\phi(x)^Tww^T\\phi(x')]=\\phi(x)^T\\mathbb{E}[ww^T]\\phi(x')=\\phi(x)^T\\Sigma_p\\phi(x') $$ \u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u5c31\u5bf9\u5e94\u7740\u4e0a\u9762\u7684\u6838\u51fd\u6570\u3002\u56e0\u6b64\u6211\u4eec\u770b\u5230 \\(\\{f(x)\\}\\) \u7ec4\u6210\u7684\u7ec4\u5408\u5c31\u662f\u4e00\u4e2a\u9ad8\u65af\u8fc7\u7a0b\u3002 \u51fd\u6570\u7a7a\u95f4\u7684\u89c2\u70b9 \u76f8\u6bd4\u6743\u91cd\u7a7a\u95f4\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5173\u6ce8 \\(f\\) \u8fd9\u4e2a\u7a7a\u95f4\uff0c\u5bf9\u4e8e\u9884\u6d4b\u4efb\u52a1\uff0c\u8fd9\u5c31\u662f\u7c7b\u4f3c\u4e8e\u6c42\uff1a $$ p(y^ |X,Y,x^ )=\\int_fp(y^ |f,X,Y,x^ )p(f|X,Y,x^ )df $$ \u5bf9\u4e8e\u6570\u636e\u96c6\u6765\u8bf4\uff0c\u53d6 \\(f(X)\\sim\\mathcal{N}(\\mu(X),k(X,X)),Y=f(X)+\\varepsilon\\sim\\mathcal{N}(\\mu(X),k(X,X)+\\sigma^2\\mathbb{I})\\) \u3002\u9884\u6d4b\u4efb\u52a1\u7684\u76ee\u7684\u662f\u7ed9\u5b9a\u4e00\u4e2a\u65b0\u6570\u636e\u5e8f\u5217 \\(X^*=(x_1^*,\\cdots,x_M^*)^T\\) \uff0c\u5f97\u5230 \\(Y^*=f(X^*)+\\varepsilon\\) \u3002\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\uff1a $$ \\begin{pmatrix}Y\\f(X^ )\\end{pmatrix}\\sim\\mathcal{N}\\left(\\begin{pmatrix}\\mu(X)\\\\mu(X^ )\\end{pmatrix},\\begin{pmatrix}k(X,X)+\\sigma^2\\mathbb{I}&k(X,X^ )\\k(X^ ,X)&k(X^ ,X^ )\\end{pmatrix}\\right) $$ \u6839\u636e\u9ad8\u65af\u5206\u5e03\u7684\u65b9\u6cd5\uff1a $$ \\begin{align}x=\\begin{pmatrix}x_a\\x_b\\end{pmatrix}\\sim\\mathcal{N}\\left(\\begin{pmatrix}\\mu_a\\\\mu_b\\end{pmatrix},\\begin{pmatrix}\\Sigma_{aa}&\\Sigma_{ab}\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\right)\\ x_b|x_a\\sim\\mathcal{N}(\\mu_{b|a},\\Sigma_{b|a})\\ \\mu_{b|a}=\\Sigma_{ba}\\Sigma_{aa}^{-1}(x_a-\\mu_a)+\\mu_b\\ \\Sigma_{b|a}=\\Sigma_{bb}-\\Sigma_{ba}\\Sigma_{aa}^{-1}\\Sigma_{ab} \\end{align} $$ \u53ef\u4ee5\u76f4\u63a5\u5199\u51fa\uff1a $$ p(f(X^ )|X,Y,X^ )=p(f(X^ )|Y)\\ =\\mathcal{N}(k(X^ ,X)[k(X,X)+\\sigma^2\\mathbb{I}]^{-1}(Y-\\mu(X))+\\mu(X^ ),\\ k(X^ ,X^ )-k(X^ ,X)[k(X,X)+\\sigma^2\\mathbb{I}]^{1}k(X,X^ )) $$ \u6240\u4ee5\u5bf9\u4e8e \\(Y=f(X^*)+\\varepsilon\\) \uff1a $$ \\mathcal{N}(k(X^ ,X)[k(X,X)+\\sigma^2\\mathbb{I}]^{-1}(Y-\\mu(X))+\\mu(X^ ),\\ k(X^ ,X^ )-k(X^ ,X)[k(X,X)+\\sigma^2\\mathbb{I}]^{1}k(X,X^ )+\\sigma^2\\mathbb{I}) $$ \u6211\u4eec\u770b\u5230\uff0c\u51fd\u6570\u7a7a\u95f4\u7684\u89c2\u70b9\u66f4\u52a0\u7b80\u5355\u6613\u4e8e\u6c42\u89e3\u3002","title":"\u9ad8\u65af\u8fc7\u7a0b\u56de\u5f52"},{"location":"Machine_Learning/18.GaussianProcess/#_1","text":"\u5c06\u4e00\u7ef4\u9ad8\u65af\u5206\u5e03\u63a8\u5e7f\u5230\u591a\u53d8\u91cf\u4e2d\u5c31\u5f97\u5230\u4e86\u9ad8\u65af\u7f51\u7edc\uff0c\u5c06\u591a\u53d8\u91cf\u63a8\u5e7f\u5230\u65e0\u9650\u7ef4\uff0c\u5c31\u5f97\u5230\u4e86\u9ad8\u65af\u8fc7\u7a0b\uff0c\u9ad8\u65af\u8fc7\u7a0b\u662f\u5b9a\u4e49\u5728\u8fde\u7eed\u57df\uff08\u65f6\u95f4\u7a7a\u95f4\uff09\u4e0a\u7684\u65e0\u9650\u591a\u4e2a\u9ad8\u7ef4\u968f\u673a\u53d8\u91cf\u6240\u7ec4\u6210\u7684\u968f\u673a\u8fc7\u7a0b\u3002 \u5728\u65f6\u95f4\u8f74\u4e0a\u7684\u4efb\u610f\u4e00\u4e2a\u70b9\u90fd\u6ee1\u8db3\u9ad8\u65af\u5206\u5e03\u5417\uff0c\u5c06\u8fd9\u4e9b\u70b9\u7684\u96c6\u5408\u53eb\u505a\u9ad8\u65af\u8fc7\u7a0b\u7684\u4e00\u4e2a\u6837\u672c\u3002 \u5bf9\u4e8e\u65f6\u95f4\u8f74\u4e0a\u7684\u5e8f\u5217 \\(\\xi_t\\) \uff0c\u5982\u679c \\(\\forall n\\in N^+\uff0ct_i\\in T\\) \uff0c\u6709 \\(\\xi_{t_1-t_n}\\sim \\mathcal{N}(\\mu_{t_1-t_n},\\Sigma_{t_1-t_n})\\) \uff0c \u90a3\u4e48 \\(\\{\\xi_t\\}_{t\\in T}\\) \u662f\u4e00\u4e2a\u9ad8\u65af\u8fc7\u7a0b\u3002 \u9ad8\u65af\u8fc7\u7a0b\u6709\u4e24\u4e2a\u53c2\u6570\uff08\u9ad8\u65af\u8fc7\u7a0b\u5b58\u5728\u6027\u5b9a\u7406\uff09\uff0c\u5747\u503c\u51fd\u6570 \\(m(t)=\\mathbb{E}[\\xi_t]\\) \u548c\u534f\u65b9\u5dee\u51fd\u6570 \\(k(s,t)=\\mathbb{E}[(\\xi_s-\\mathbb{E}[\\xi_s])(\\xi_t-\\mathbb{E}[\\xi_t])]\\) \u3002 \u6211\u4eec\u5c06\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u6dfb\u52a0\u6838\u6280\u5de7\u7684\u8fd9\u4e2a\u6a21\u578b\u53eb\u505a\u9ad8\u65af\u8fc7\u7a0b\u56de\u5f52\uff0c\u9ad8\u65af\u8fc7\u7a0b\u56de\u5f52\u5206\u4e3a\u4e24\u79cd\u89c6\u89d2\uff1a \u6743\u7a7a\u95f4\u7684\u89c6\u89d2-\u6838\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\uff0c\u76f8\u5f53\u4e8e \\(x\\) \u4e3a \\(t\\) \uff0c\u5728\u6bcf\u4e2a\u65f6\u523b\u7684\u9ad8\u65af\u5206\u5e03\u6765\u6e90\u4e8e\u6743\u91cd\uff0c\u6839\u636e\u4e0a\u9762\u7684\u63a8\u5bfc\uff0c\u9884\u6d4b\u7684\u51fd\u6570\u4f9d\u7136\u662f\u9ad8\u65af\u5206\u5e03\u3002 \u51fd\u6570\u7a7a\u95f4\u7684\u89c6\u89d2-\u9ad8\u65af\u5206\u5e03\u901a\u8fc7\u51fd\u6570 \\(f(x)\\) \u6765\u4f53\u73b0\u3002","title":"\u9ad8\u65af\u8fc7\u7a0b\u56de\u5f52"},{"location":"Machine_Learning/18.GaussianProcess/#_2","text":"\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52\u53ef\u4ee5\u901a\u8fc7\u52a0\u5165\u6838\u51fd\u6570\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\u975e\u7ebf\u6027\u51fd\u6570\u7684\u95ee\u9898\uff0c\u5c06 \\(f(x)=x^Tw\\) \u8fd9\u4e2a\u51fd\u6570\u53d8\u4e3a \\(f(x)=\\phi(x)^Tw\\) \uff08\u5f53\u7136\u8fd9\u4e2a\u65f6\u5019\uff0c \\(\\Sigma_p\\) \u4e5f\u8981\u53d8\u4e3a\u66f4\u9ad8\u7ef4\u5ea6\u7684\uff09\uff0c\u53d8\u6362\u5230\u66f4\u9ad8\u7ef4\u7684\u7a7a\u95f4\uff0c\u6709\uff1a $$ \\begin{align}f(x^ )\\sim \\mathcal{N}(\\phi(x^ )^{T}\\sigma^{-2}A^{-1}\\Phi^TY,\\phi(x^ )^{T}A^{-1}\\phi(x^ ))\\ A=\\sigma^{-2}\\Phi^T\\Phi+\\Sigma_p^{-1} \\end{align} $$ \u5176\u4e2d\uff0c \\(\\Phi=(\\phi(x_1),\\phi(x_2),\\cdots,\\phi(x_N))^T\\) \u3002 \u4e3a\u4e86\u6c42\u89e3 \\(A^{-1}\\) \uff0c\u53ef\u4ee5\u5229\u7528 Woodbury Formula\uff0c \\(A=\\Sigma_p^{-1},C=\\sigma^{-2}\\mathbb{I}\\) \uff1a $$ (A+UCV)^{-1}=A^{-1}-A^{-1}U(C^{-1}+VA^{-1}U)^{-1}VA^{-1} $$ \u6240\u4ee5 \\(A^{-1}=\\Sigma_p-\\Sigma_p\\Phi^T(\\sigma^2\\mathbb{I}+\\Phi\\Sigma_p\\Phi^T)^{-1}\\Phi\\Sigma_p\\) \u4e5f\u53ef\u4ee5\u7528\u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a $$ \\begin{align} A&=\\sigma^{-2}\\Phi^T\\Phi+\\Sigma_p^{-1}\\nonumber\\ \\Leftrightarrow A\\Sigma_p&=\\sigma^{-2}\\Phi^T\\Phi\\Sigma_p+\\mathbb{I}\\nonumber\\ \\Leftrightarrow A\\Sigma_p\\Phi^T&=\\sigma^{-2}\\Phi^T\\Phi\\Sigma_p\\Phi^T+\\Phi^T=\\sigma^{-2}\\Phi^T(k+\\sigma^2\\mathbb{I})\\nonumber\\ \\Leftrightarrow \\Sigma_p\\Phi^T&=\\sigma^{-2}A^{-1}\\Phi^T(k+\\sigma^2\\mathbb{I})\\nonumber\\ \\Leftrightarrow \\sigma^{-2}A^{-1}\\Phi^T&=\\Sigma_p\\Phi^T(k+\\sigma^2\\mathbb{I})^{-1}\\nonumber\\ \\Leftrightarrow \\phi(x^ )^T\\sigma^{-2}A^{-1}\\Phi^T&=\\phi(x^ )^T\\Sigma_p\\Phi^T(k+\\sigma^2\\mathbb{I})^{-1} \\end{align} $$ \u4e0a\u9762\u7684\u5de6\u8fb9\u7684\u5f0f\u5b50\u5c31\u662f\u53d8\u6362\u540e\u7684\u5747\u503c\uff0c\u800c\u53f3\u8fb9\u7684\u5f0f\u5b50\u5c31\u662f\u4e0d\u542b \\(A^{-1}\\) \u7684\u5f0f\u5b50\uff0c\u5176\u4e2d \\(k=\\Phi\\Sigma_p\\Phi^T\\) \u3002 \u6839\u636e \\(A^{-1}\\) \u5f97\u5230\u65b9\u5dee\u4e3a\uff1a $$ \\phi(x^ )^T\\Sigma_p\\phi(x^ )-\\phi(x^ )^T\\Sigma_p\\Phi^T(\\sigma^2\\mathbb{I}+k)^{-1}\\Phi\\Sigma_p\\phi(x^ ) $$ \u4e0a\u9762\u5b9a\u4e49\u4e86\uff1a $$ k=\\Phi\\Sigma_p\\Phi^T $$ \u6211\u4eec\u770b\u5230\uff0c\u5728\u5747\u503c\u548c\u65b9\u5dee\u4e2d\uff0c\u542b\u6709\u4e0b\u9762\u56db\u9879\uff1a $$ \\phi(x^ )^T\\Sigma_p\\Phi^T,\\phi(x^ )^T\\Sigma_p\\phi(x^ ),\\phi(x^ )^T\\Sigma_p\\Phi^T,\\Phi\\Sigma_p\\phi(x^*) $$ \u5c55\u5f00\u540e\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u6709\u5171\u540c\u7684\u9879\uff1a \\(k(x,x')=\\phi(x)^T\\Sigma_p\\phi(x\u2018)\\) \u3002\u7531\u4e8e \\(\\Sigma_p\\) \u662f\u6b63\u5b9a\u5bf9\u79f0\u7684\u65b9\u5dee\u77e9\u9635\uff0c\u6240\u4ee5\uff0c\u8fd9\u662f\u4e00\u4e2a\u6838\u51fd\u6570\u3002 \u5bf9\u4e8e\u9ad8\u65af\u8fc7\u7a0b\u4e2d\u7684\u534f\u65b9\u5dee\uff1a $$ k(t,s)=Cov[f(x),f(x')]=\\mathbb{E}[\\phi(x)^Tww^T\\phi(x')]=\\phi(x)^T\\mathbb{E}[ww^T]\\phi(x')=\\phi(x)^T\\Sigma_p\\phi(x') $$ \u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u5c31\u5bf9\u5e94\u7740\u4e0a\u9762\u7684\u6838\u51fd\u6570\u3002\u56e0\u6b64\u6211\u4eec\u770b\u5230 \\(\\{f(x)\\}\\) \u7ec4\u6210\u7684\u7ec4\u5408\u5c31\u662f\u4e00\u4e2a\u9ad8\u65af\u8fc7\u7a0b\u3002","title":"\u6838\u8d1d\u53f6\u65af\u7ebf\u6027\u56de\u5f52"},{"location":"Machine_Learning/18.GaussianProcess/#_3","text":"\u76f8\u6bd4\u6743\u91cd\u7a7a\u95f4\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5173\u6ce8 \\(f\\) \u8fd9\u4e2a\u7a7a\u95f4\uff0c\u5bf9\u4e8e\u9884\u6d4b\u4efb\u52a1\uff0c\u8fd9\u5c31\u662f\u7c7b\u4f3c\u4e8e\u6c42\uff1a $$ p(y^ |X,Y,x^ )=\\int_fp(y^ |f,X,Y,x^ )p(f|X,Y,x^ )df $$ \u5bf9\u4e8e\u6570\u636e\u96c6\u6765\u8bf4\uff0c\u53d6 \\(f(X)\\sim\\mathcal{N}(\\mu(X),k(X,X)),Y=f(X)+\\varepsilon\\sim\\mathcal{N}(\\mu(X),k(X,X)+\\sigma^2\\mathbb{I})\\) \u3002\u9884\u6d4b\u4efb\u52a1\u7684\u76ee\u7684\u662f\u7ed9\u5b9a\u4e00\u4e2a\u65b0\u6570\u636e\u5e8f\u5217 \\(X^*=(x_1^*,\\cdots,x_M^*)^T\\) \uff0c\u5f97\u5230 \\(Y^*=f(X^*)+\\varepsilon\\) \u3002\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\uff1a $$ \\begin{pmatrix}Y\\f(X^ )\\end{pmatrix}\\sim\\mathcal{N}\\left(\\begin{pmatrix}\\mu(X)\\\\mu(X^ )\\end{pmatrix},\\begin{pmatrix}k(X,X)+\\sigma^2\\mathbb{I}&k(X,X^ )\\k(X^ ,X)&k(X^ ,X^ )\\end{pmatrix}\\right) $$ \u6839\u636e\u9ad8\u65af\u5206\u5e03\u7684\u65b9\u6cd5\uff1a $$ \\begin{align}x=\\begin{pmatrix}x_a\\x_b\\end{pmatrix}\\sim\\mathcal{N}\\left(\\begin{pmatrix}\\mu_a\\\\mu_b\\end{pmatrix},\\begin{pmatrix}\\Sigma_{aa}&\\Sigma_{ab}\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\right)\\ x_b|x_a\\sim\\mathcal{N}(\\mu_{b|a},\\Sigma_{b|a})\\ \\mu_{b|a}=\\Sigma_{ba}\\Sigma_{aa}^{-1}(x_a-\\mu_a)+\\mu_b\\ \\Sigma_{b|a}=\\Sigma_{bb}-\\Sigma_{ba}\\Sigma_{aa}^{-1}\\Sigma_{ab} \\end{align} $$ \u53ef\u4ee5\u76f4\u63a5\u5199\u51fa\uff1a $$ p(f(X^ )|X,Y,X^ )=p(f(X^ )|Y)\\ =\\mathcal{N}(k(X^ ,X)[k(X,X)+\\sigma^2\\mathbb{I}]^{-1}(Y-\\mu(X))+\\mu(X^ ),\\ k(X^ ,X^ )-k(X^ ,X)[k(X,X)+\\sigma^2\\mathbb{I}]^{1}k(X,X^ )) $$ \u6240\u4ee5\u5bf9\u4e8e \\(Y=f(X^*)+\\varepsilon\\) \uff1a $$ \\mathcal{N}(k(X^ ,X)[k(X,X)+\\sigma^2\\mathbb{I}]^{-1}(Y-\\mu(X))+\\mu(X^ ),\\ k(X^ ,X^ )-k(X^ ,X)[k(X,X)+\\sigma^2\\mathbb{I}]^{1}k(X,X^ )+\\sigma^2\\mathbb{I}) $$ \u6211\u4eec\u770b\u5230\uff0c\u51fd\u6570\u7a7a\u95f4\u7684\u89c2\u70b9\u66f4\u52a0\u7b80\u5355\u6613\u4e8e\u6c42\u89e3\u3002","title":"\u51fd\u6570\u7a7a\u95f4\u7684\u89c2\u70b9"},{"location":"Machine_Learning/19.RBM/","text":"\u53d7\u9650\u73bb\u5c14\u5179\u66fc\u673a \u73bb\u5c14\u5179\u66fc\u673a\u662f\u4e00\u79cd\u5b58\u5728\u9690\u8282\u70b9\u7684\u65e0\u5411\u56fe\u6a21\u578b\u3002\u5728\u56fe\u6a21\u578b\u4e2d\u6700\u7b80\u5355\u7684\u662f\u6734\u7d20\u8d1d\u53f6\u65af\u6a21\u578b\uff08\u6734\u7d20\u8d1d\u53f6\u65af\u5047\u8bbe\uff09\uff0c\u5f15\u5165\u5355\u4e2a\u9690\u53d8\u91cf\u540e\uff0c\u53d1\u5c55\u51fa\u4e86 GMM\uff0c\u5982\u679c\u5355\u4e2a\u9690\u53d8\u91cf\u53d8\u6210\u5e8f\u5217\u7684\u9690\u53d8\u91cf\uff0c\u5c31\u5f97\u5230\u4e86\u72b6\u6001\u7a7a\u95f4\u6a21\u578b\uff08\u5f15\u5165\u9f50\u6b21\u9a6c\u5c14\u53ef\u592b\u5047\u8bbe\u548c\u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\u5c31\u6709HMM\uff0cKalman Filter\uff0cParticle Filter\uff09\uff0c\u4e3a\u4e86\u5f15\u5165\u89c2\u6d4b\u53d8\u91cf\u4e4b\u95f4\u7684\u5173\u8054\uff0c\u5f15\u5165\u4e86\u4e00\u79cd\u6700\u5927\u71b5\u6a21\u578b-MEMM\uff0c\u4e3a\u4e86\u514b\u670d MEMM \u4e2d\u7684\u5c40\u57df\u95ee\u9898\uff0c\u53c8\u5f15\u5165\u4e86 CRF\uff0cCRF \u662f\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u5176\u4e2d\uff0c\u7834\u574f\u4e86\u9f50\u6b21\u9a6c\u5c14\u53ef\u592b\u5047\u8bbe\uff0c\u5982\u679c\u9690\u53d8\u91cf\u662f\u4e00\u4e2a\u94fe\u5f0f\u7ed3\u6784\uff0c\u90a3\u4e48\u53c8\u53eb\u7ebf\u6027\u94fe CRF\u3002 \u5728\u65e0\u5411\u56fe\u7684\u57fa\u7840\u4e0a\uff0c\u5f15\u5165\u9690\u53d8\u91cf\u5f97\u5230\u4e86\u73bb\u5c14\u5179\u66fc\u673a\uff0c\u8fd9\u4e2a\u56fe\u6a21\u578b\u7684\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u662f\u4e00\u4e2a\u6307\u6570\u65cf\u5206\u5e03\u3002\u5bf9\u9690\u53d8\u91cf\u548c\u89c2\u6d4b\u53d8\u91cf\u4f5c\u51fa\u4e00\u5b9a\u7684\u9650\u5236\uff0c\u5c31\u5f97\u5230\u4e86\u53d7\u9650\u73bb\u5c14\u5179\u66fc\u673a\uff08RBM\uff09\u3002 \u6211\u4eec\u770b\u5230\uff0c\u4e0d\u540c\u7684\u6982\u7387\u56fe\u6a21\u578b\u5bf9\u4e0b\u9762\u51e0\u4e2a\u7279\u70b9\u4f5c\u51fa\u5047\u8bbe\uff1a \u65b9\u5411-\u8fb9\u7684\u6027\u8d28 \u79bb\u6563/\u8fde\u7eed/\u6df7\u5408-\u70b9\u7684\u6027\u8d28 \u6761\u4ef6\u72ec\u7acb\u6027-\u8fb9\u7684\u6027\u8d28 \u9690\u53d8\u91cf-\u8282\u70b9\u7684\u6027\u8d28 \u6307\u6570\u65cf-\u7ed3\u6784\u7279\u70b9 \u5c06\u89c2\u6d4b\u53d8\u91cf\u548c\u9690\u53d8\u91cf\u5206\u522b\u8bb0\u4e3a \\(v,h,h=\\{h_1,\\cdots,h_m\\},v=\\{v_1,\\cdots,v_n\\}\\) \u3002\u6211\u4eec\u77e5\u9053\uff0c\u65e0\u5411\u56fe\u6839\u636e\u6700\u5927\u56e2\u7684\u5206\u89e3\uff0c\u53ef\u4ee5\u5199\u4e3a\u73bb\u5c14\u5179\u66fc\u5206\u5e03\u7684\u5f62\u5f0f \\(p(x)=\\frac{1}{Z}\\prod\\limits_{i=1}^K\\psi_i(x_{ci})=\\frac{1}{Z}\\exp(-\\sum\\limits_{i=1}^KE(x_{ci}))\\) \uff0c\u8fd9\u4e5f\u662f\u4e00\u4e2a\u6307\u6570\u65cf\u5206\u5e03\u3002 \u4e00\u4e2a\u73bb\u5c14\u5179\u66fc\u673a\u5b58\u5728\u4e00\u7cfb\u5217\u7684\u95ee\u9898\uff0c\u5728\u5176\u63a8\u65ad\u4efb\u52a1\u4e2d\uff0c\u60f3\u8981\u7cbe\u786e\u63a8\u65ad\uff0c\u662f\u65e0\u6cd5\u8fdb\u884c\u7684\uff0c\u60f3\u8981\u8fd1\u4f3c\u63a8\u65ad\uff0c\u8ba1\u7b97\u91cf\u8fc7\u5927\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e00\u79cd\u7b80\u5316\u7684\u73bb\u5c14\u5179\u66fc\u673a-\u53d7\u9650\u73bb\u5c14\u5179\u66fc\u673a\u4f5c\u51fa\u4e86\u5047\u8bbe\uff0c\u6240\u6709\u9690\u53d8\u91cf\u5185\u90e8\u4ee5\u53ca\u89c2\u6d4b\u53d8\u91cf\u5185\u90e8\u6ca1\u6709\u8fde\u63a5\uff0c\u53ea\u5728\u9690\u53d8\u91cf\u548c\u89c2\u6d4b\u53d8\u91cf\u4e4b\u95f4\u6709\u8fde\u63a5\uff0c\u8fd9\u6837\u4e00\u6765\uff1a $$ p(x)=p(h,v)=\\frac{1}{Z}\\exp(-E(v,h)) $$ \u5176\u4e2d\u80fd\u91cf\u51fd\u6570 \\(E(v,h)\\) \u53ef\u4ee5\u5199\u51fa\u4e09\u4e2a\u90e8\u5206\uff0c\u5305\u62ec\u4e0e\u8282\u70b9\u96c6\u5408\u76f8\u5173\u7684\u4e24\u9879\u4ee5\u53ca\u4e0e\u8fb9 \\(w\\) \u76f8\u5173\u7684\u4e00\u9879\uff0c\u8bb0\u4e3a\uff1a $$ E(v,h)=-(h^Twv+\\alpha^T v+\\beta^T h) $$ \u6240\u4ee5\uff1a $$ p(x)=\\frac{1}{Z}\\exp(h^Twv)\\exp(\\alpha^T v)\\exp(\\beta^T h)=\\frac{1}{Z}\\prod_{i=1}^m\\prod_{j=1}^n\\exp(h_iw_{ij}v_j)\\prod_{j=1}^n\\exp(\\alpha_jv_j)\\prod_{i=1}^m\\exp(\\beta_ih_i) $$ \u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u4e5f\u548c RBM \u7684\u56e0\u5b50\u56fe\u4e00\u4e00\u5bf9\u5e94\u3002 \u63a8\u65ad \u63a8\u65ad\u4efb\u52a1\u5305\u62ec\u6c42\u540e\u9a8c\u6982\u7387 \\(p(v|h),p(h|v)\\) \u4ee5\u53ca\u6c42\u8fb9\u7f18\u6982\u7387 \\(p(v)\\) \u3002 \\(p(h|v)\\) \u5bf9\u4e8e\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u6ee1\u8db3\u5c40\u57df\u7684 Markov \u6027\u8d28\uff0c\u5373 \\(p(h_1|h-\\{h_1\\},v)=p(h_1|Neighbour(h_1))=p(h_1|v)\\) \u3002\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a $$ p(h|v)=\\prod_{i=1}^mp(h_i|v) $$ \u8003\u8651 Binary RBM\uff0c\u6240\u6709\u7684\u9690\u53d8\u91cf\u53ea\u6709\u4e24\u4e2a\u53d6\u503c \\(0,1\\) \uff1a $$ p(h_l=1|v)=\\frac{p(h_l=1,h_{-l},v)}{p(h_{-l},v)}=\\frac{p(h_l=1,h_{-l},v)}{p(h_l=1,h_{-l},v)+p(h_l=0,h_{-l},v)} $$ \u5c06\u80fd\u91cf\u51fd\u6570\u5199\u6210\u548c \\(l\\) \u76f8\u5173\u6216\u4e0d\u76f8\u5173\u7684\u4e24\u9879\uff1a $$ E(v,h)=-(\\sum\\limits_{i=1,i\\ne l}^m\\sum\\limits_{j=1}^nh_iw_{ij}v_j+h_l\\sum\\limits_{j=1}^nw_{lj}v_j+\\sum\\limits_{j=1}^n\\alpha_j v_j+\\sum\\limits_{i=1,i\\ne l}^m\\beta_ih_i+\\beta_lh_l) $$ \u5b9a\u4e49\uff1a \\(h_lH_l(v)=h_l\\sum\\limits_{j=1}^nw_{lj}v_j+\\beta_lh_l,\\overline{H}(h_{-l},v)=\\sum\\limits_{i=1,i\\ne l}^m\\sum\\limits_{j=1}^nh_iw_{ij}v_j+\\sum\\limits_{j=1}^n\\alpha_j v_j+\\sum\\limits_{i=1,i\\ne l}^m\\beta_ih_i\\) \u3002 \u4ee3\u5165\uff0c\u6709\uff1a $$ p(h_l=1|v)=\\frac{\\exp(H_l(v)+\\overline{H}(h_{-l},v))}{\\exp(H_l(v)+\\overline{H}(h_{-l},v))+\\exp(\\overline{H}(h_{-l},v))}=\\frac{1}{1+\\exp(-H_l(v))}=\\sigma(H_l(v)) $$ \u4e8e\u662f\u5c31\u5f97\u5230\u4e86\u540e\u9a8c\u6982\u7387\u3002\u5bf9\u4e8e \\(v\\) \u7684\u540e\u9a8c\u662f\u5bf9\u79f0\u7684\uff0c\u6240\u4ee5\u7c7b\u4f3c\u7684\u53ef\u4ee5\u6c42\u89e3\u3002 \\(p(v)\\) \\[ \\begin{align}p(v)&=\\sum\\limits_hp(h,v)=\\sum\\limits_h\\frac{1}{Z}\\exp(h^Twv+\\alpha^Tv+\\beta^Th)\\nonumber\\\\ &=\\exp(\\alpha^Tv)\\frac{1}{Z}\\sum\\limits_{h_1}\\exp(h_1w_1v+\\beta_1h_1)\\cdots\\sum\\limits_{h_m}\\exp(h_mw_mv+\\beta_mh_m)\\nonumber\\\\ &=\\exp(\\alpha^Tv)\\frac{1}{Z}(1+\\exp(w_1v+\\beta_1))\\cdots(1+\\exp(w_mv+\\beta_m))\\nonumber\\\\ &=\\frac{1}{Z}\\exp(\\alpha^Tv+\\sum\\limits_{i=1}^m\\log(1+\\exp(w_iv+\\beta_i))) \\end{align} \\] \u5176\u4e2d\uff0c \\(\\log(1+\\exp(x))\\) \u53eb\u505a Softplus \u51fd\u6570\u3002","title":"\u53d7\u9650\u73bb\u5c14\u5179\u66fc\u673a"},{"location":"Machine_Learning/19.RBM/#_1","text":"\u73bb\u5c14\u5179\u66fc\u673a\u662f\u4e00\u79cd\u5b58\u5728\u9690\u8282\u70b9\u7684\u65e0\u5411\u56fe\u6a21\u578b\u3002\u5728\u56fe\u6a21\u578b\u4e2d\u6700\u7b80\u5355\u7684\u662f\u6734\u7d20\u8d1d\u53f6\u65af\u6a21\u578b\uff08\u6734\u7d20\u8d1d\u53f6\u65af\u5047\u8bbe\uff09\uff0c\u5f15\u5165\u5355\u4e2a\u9690\u53d8\u91cf\u540e\uff0c\u53d1\u5c55\u51fa\u4e86 GMM\uff0c\u5982\u679c\u5355\u4e2a\u9690\u53d8\u91cf\u53d8\u6210\u5e8f\u5217\u7684\u9690\u53d8\u91cf\uff0c\u5c31\u5f97\u5230\u4e86\u72b6\u6001\u7a7a\u95f4\u6a21\u578b\uff08\u5f15\u5165\u9f50\u6b21\u9a6c\u5c14\u53ef\u592b\u5047\u8bbe\u548c\u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\u5c31\u6709HMM\uff0cKalman Filter\uff0cParticle Filter\uff09\uff0c\u4e3a\u4e86\u5f15\u5165\u89c2\u6d4b\u53d8\u91cf\u4e4b\u95f4\u7684\u5173\u8054\uff0c\u5f15\u5165\u4e86\u4e00\u79cd\u6700\u5927\u71b5\u6a21\u578b-MEMM\uff0c\u4e3a\u4e86\u514b\u670d MEMM \u4e2d\u7684\u5c40\u57df\u95ee\u9898\uff0c\u53c8\u5f15\u5165\u4e86 CRF\uff0cCRF \u662f\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u5176\u4e2d\uff0c\u7834\u574f\u4e86\u9f50\u6b21\u9a6c\u5c14\u53ef\u592b\u5047\u8bbe\uff0c\u5982\u679c\u9690\u53d8\u91cf\u662f\u4e00\u4e2a\u94fe\u5f0f\u7ed3\u6784\uff0c\u90a3\u4e48\u53c8\u53eb\u7ebf\u6027\u94fe CRF\u3002 \u5728\u65e0\u5411\u56fe\u7684\u57fa\u7840\u4e0a\uff0c\u5f15\u5165\u9690\u53d8\u91cf\u5f97\u5230\u4e86\u73bb\u5c14\u5179\u66fc\u673a\uff0c\u8fd9\u4e2a\u56fe\u6a21\u578b\u7684\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u662f\u4e00\u4e2a\u6307\u6570\u65cf\u5206\u5e03\u3002\u5bf9\u9690\u53d8\u91cf\u548c\u89c2\u6d4b\u53d8\u91cf\u4f5c\u51fa\u4e00\u5b9a\u7684\u9650\u5236\uff0c\u5c31\u5f97\u5230\u4e86\u53d7\u9650\u73bb\u5c14\u5179\u66fc\u673a\uff08RBM\uff09\u3002 \u6211\u4eec\u770b\u5230\uff0c\u4e0d\u540c\u7684\u6982\u7387\u56fe\u6a21\u578b\u5bf9\u4e0b\u9762\u51e0\u4e2a\u7279\u70b9\u4f5c\u51fa\u5047\u8bbe\uff1a \u65b9\u5411-\u8fb9\u7684\u6027\u8d28 \u79bb\u6563/\u8fde\u7eed/\u6df7\u5408-\u70b9\u7684\u6027\u8d28 \u6761\u4ef6\u72ec\u7acb\u6027-\u8fb9\u7684\u6027\u8d28 \u9690\u53d8\u91cf-\u8282\u70b9\u7684\u6027\u8d28 \u6307\u6570\u65cf-\u7ed3\u6784\u7279\u70b9 \u5c06\u89c2\u6d4b\u53d8\u91cf\u548c\u9690\u53d8\u91cf\u5206\u522b\u8bb0\u4e3a \\(v,h,h=\\{h_1,\\cdots,h_m\\},v=\\{v_1,\\cdots,v_n\\}\\) \u3002\u6211\u4eec\u77e5\u9053\uff0c\u65e0\u5411\u56fe\u6839\u636e\u6700\u5927\u56e2\u7684\u5206\u89e3\uff0c\u53ef\u4ee5\u5199\u4e3a\u73bb\u5c14\u5179\u66fc\u5206\u5e03\u7684\u5f62\u5f0f \\(p(x)=\\frac{1}{Z}\\prod\\limits_{i=1}^K\\psi_i(x_{ci})=\\frac{1}{Z}\\exp(-\\sum\\limits_{i=1}^KE(x_{ci}))\\) \uff0c\u8fd9\u4e5f\u662f\u4e00\u4e2a\u6307\u6570\u65cf\u5206\u5e03\u3002 \u4e00\u4e2a\u73bb\u5c14\u5179\u66fc\u673a\u5b58\u5728\u4e00\u7cfb\u5217\u7684\u95ee\u9898\uff0c\u5728\u5176\u63a8\u65ad\u4efb\u52a1\u4e2d\uff0c\u60f3\u8981\u7cbe\u786e\u63a8\u65ad\uff0c\u662f\u65e0\u6cd5\u8fdb\u884c\u7684\uff0c\u60f3\u8981\u8fd1\u4f3c\u63a8\u65ad\uff0c\u8ba1\u7b97\u91cf\u8fc7\u5927\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e00\u79cd\u7b80\u5316\u7684\u73bb\u5c14\u5179\u66fc\u673a-\u53d7\u9650\u73bb\u5c14\u5179\u66fc\u673a\u4f5c\u51fa\u4e86\u5047\u8bbe\uff0c\u6240\u6709\u9690\u53d8\u91cf\u5185\u90e8\u4ee5\u53ca\u89c2\u6d4b\u53d8\u91cf\u5185\u90e8\u6ca1\u6709\u8fde\u63a5\uff0c\u53ea\u5728\u9690\u53d8\u91cf\u548c\u89c2\u6d4b\u53d8\u91cf\u4e4b\u95f4\u6709\u8fde\u63a5\uff0c\u8fd9\u6837\u4e00\u6765\uff1a $$ p(x)=p(h,v)=\\frac{1}{Z}\\exp(-E(v,h)) $$ \u5176\u4e2d\u80fd\u91cf\u51fd\u6570 \\(E(v,h)\\) \u53ef\u4ee5\u5199\u51fa\u4e09\u4e2a\u90e8\u5206\uff0c\u5305\u62ec\u4e0e\u8282\u70b9\u96c6\u5408\u76f8\u5173\u7684\u4e24\u9879\u4ee5\u53ca\u4e0e\u8fb9 \\(w\\) \u76f8\u5173\u7684\u4e00\u9879\uff0c\u8bb0\u4e3a\uff1a $$ E(v,h)=-(h^Twv+\\alpha^T v+\\beta^T h) $$ \u6240\u4ee5\uff1a $$ p(x)=\\frac{1}{Z}\\exp(h^Twv)\\exp(\\alpha^T v)\\exp(\\beta^T h)=\\frac{1}{Z}\\prod_{i=1}^m\\prod_{j=1}^n\\exp(h_iw_{ij}v_j)\\prod_{j=1}^n\\exp(\\alpha_jv_j)\\prod_{i=1}^m\\exp(\\beta_ih_i) $$ \u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u4e5f\u548c RBM \u7684\u56e0\u5b50\u56fe\u4e00\u4e00\u5bf9\u5e94\u3002","title":"\u53d7\u9650\u73bb\u5c14\u5179\u66fc\u673a"},{"location":"Machine_Learning/19.RBM/#_2","text":"\u63a8\u65ad\u4efb\u52a1\u5305\u62ec\u6c42\u540e\u9a8c\u6982\u7387 \\(p(v|h),p(h|v)\\) \u4ee5\u53ca\u6c42\u8fb9\u7f18\u6982\u7387 \\(p(v)\\) \u3002","title":"\u63a8\u65ad"},{"location":"Machine_Learning/19.RBM/#phv","text":"\u5bf9\u4e8e\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u6ee1\u8db3\u5c40\u57df\u7684 Markov \u6027\u8d28\uff0c\u5373 \\(p(h_1|h-\\{h_1\\},v)=p(h_1|Neighbour(h_1))=p(h_1|v)\\) \u3002\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a $$ p(h|v)=\\prod_{i=1}^mp(h_i|v) $$ \u8003\u8651 Binary RBM\uff0c\u6240\u6709\u7684\u9690\u53d8\u91cf\u53ea\u6709\u4e24\u4e2a\u53d6\u503c \\(0,1\\) \uff1a $$ p(h_l=1|v)=\\frac{p(h_l=1,h_{-l},v)}{p(h_{-l},v)}=\\frac{p(h_l=1,h_{-l},v)}{p(h_l=1,h_{-l},v)+p(h_l=0,h_{-l},v)} $$ \u5c06\u80fd\u91cf\u51fd\u6570\u5199\u6210\u548c \\(l\\) \u76f8\u5173\u6216\u4e0d\u76f8\u5173\u7684\u4e24\u9879\uff1a $$ E(v,h)=-(\\sum\\limits_{i=1,i\\ne l}^m\\sum\\limits_{j=1}^nh_iw_{ij}v_j+h_l\\sum\\limits_{j=1}^nw_{lj}v_j+\\sum\\limits_{j=1}^n\\alpha_j v_j+\\sum\\limits_{i=1,i\\ne l}^m\\beta_ih_i+\\beta_lh_l) $$ \u5b9a\u4e49\uff1a \\(h_lH_l(v)=h_l\\sum\\limits_{j=1}^nw_{lj}v_j+\\beta_lh_l,\\overline{H}(h_{-l},v)=\\sum\\limits_{i=1,i\\ne l}^m\\sum\\limits_{j=1}^nh_iw_{ij}v_j+\\sum\\limits_{j=1}^n\\alpha_j v_j+\\sum\\limits_{i=1,i\\ne l}^m\\beta_ih_i\\) \u3002 \u4ee3\u5165\uff0c\u6709\uff1a $$ p(h_l=1|v)=\\frac{\\exp(H_l(v)+\\overline{H}(h_{-l},v))}{\\exp(H_l(v)+\\overline{H}(h_{-l},v))+\\exp(\\overline{H}(h_{-l},v))}=\\frac{1}{1+\\exp(-H_l(v))}=\\sigma(H_l(v)) $$ \u4e8e\u662f\u5c31\u5f97\u5230\u4e86\u540e\u9a8c\u6982\u7387\u3002\u5bf9\u4e8e \\(v\\) \u7684\u540e\u9a8c\u662f\u5bf9\u79f0\u7684\uff0c\u6240\u4ee5\u7c7b\u4f3c\u7684\u53ef\u4ee5\u6c42\u89e3\u3002","title":"\\(p(h|v)\\)"},{"location":"Machine_Learning/19.RBM/#pv","text":"\\[ \\begin{align}p(v)&=\\sum\\limits_hp(h,v)=\\sum\\limits_h\\frac{1}{Z}\\exp(h^Twv+\\alpha^Tv+\\beta^Th)\\nonumber\\\\ &=\\exp(\\alpha^Tv)\\frac{1}{Z}\\sum\\limits_{h_1}\\exp(h_1w_1v+\\beta_1h_1)\\cdots\\sum\\limits_{h_m}\\exp(h_mw_mv+\\beta_mh_m)\\nonumber\\\\ &=\\exp(\\alpha^Tv)\\frac{1}{Z}(1+\\exp(w_1v+\\beta_1))\\cdots(1+\\exp(w_mv+\\beta_m))\\nonumber\\\\ &=\\frac{1}{Z}\\exp(\\alpha^Tv+\\sum\\limits_{i=1}^m\\log(1+\\exp(w_iv+\\beta_i))) \\end{align} \\] \u5176\u4e2d\uff0c \\(\\log(1+\\exp(x))\\) \u53eb\u505a Softplus \u51fd\u6570\u3002","title":"\\(p(v)\\)"},{"location":"Machine_Learning/2.LinearRegression/","text":"\u7ebf\u6027\u56de\u5f52 \u5047\u8bbe\u6570\u636e\u96c6\u4e3a\uff1a $$ \\mathcal{D}={(x_1, y_1),(x_2, y_2),\\cdots,(x_N, y_N)} $$ \u540e\u9762\u6211\u4eec\u8bb0\uff1a $$ X=(x_1,x_2,\\cdots,x_N)^T,Y=(y_1,y_2,\\cdots,y_N)^T $$ \u7ebf\u6027\u56de\u5f52\u5047\u8bbe\uff1a $$ f(w)=w^Tx $$ \u6700\u5c0f\u4e8c\u4e58\u6cd5 \u5bf9\u8fd9\u4e2a\u95ee\u9898\uff0c\u91c7\u7528\u4e8c\u8303\u6570\u5b9a\u4e49\u7684\u5e73\u65b9\u8bef\u5dee\u6765\u5b9a\u4e49\u635f\u5931\u51fd\u6570\uff1a $$ L(w)=\\sum\\limits_{i=1}^N||w^Tx_i-y_i||^2_2 $$ \u5c55\u5f00\u5f97\u5230\uff1a $$ \\begin{align} L(w)&=(w^Tx_1-y_1,\\cdots,w^Tx_N-y_N)\\cdot (w^Tx_1-y_1,\\cdots,w^Tx_N-y_N)^T\\nonumber\\ &=(w^TX^T-Y^T)\\cdot (Xw-Y)=w^TX^TXw-Y^TXw-w^TX^TY+Y^TY\\nonumber\\ &=w^TX^TXw-2w^TX^TY+Y^TY \\end{align} $$ \u6700\u5c0f\u5316\u8fd9\u4e2a\u503c\u7684 \\(\\hat{w}\\) \uff1a $$ \\begin{align} \\hat{w}=\\mathop{argmin}\\limits_wL(w)&\\longrightarrow\\frac{\\partial}{\\partial w}L(w)=0\\nonumber\\ &\\longrightarrow2X^TX\\hat{w}-2X^TY=0\\nonumber\\ &\\longrightarrow \\hat{w}=(X^TX)^{-1}X^TY=X^+Y \\end{align} $$ \u8fd9\u4e2a\u5f0f\u5b50\u4e2d \\((X^TX)^{-1}X^T\\) \u53c8\u88ab\u79f0\u4e3a\u4f2a\u9006\u3002\u5bf9\u4e8e\u884c\u6ee1\u79e9\u6216\u8005\u5217\u6ee1\u79e9\u7684 \\(X\\) \uff0c\u53ef\u4ee5\u76f4\u63a5\u6c42\u89e3\uff0c\u4f46\u662f\u5bf9\u4e8e\u975e\u6ee1\u79e9\u7684\u6837\u672c\u96c6\u5408\uff0c\u9700\u8981\u4f7f\u7528\u5947\u5f02\u503c\u5206\u89e3\uff08SVD\uff09\u7684\u65b9\u6cd5\uff0c\u5bf9 \\(X\\) \u6c42\u5947\u5f02\u503c\u5206\u89e3\uff0c\u5f97\u5230 $$ X=U\\Sigma V^T $$ \u4e8e\u662f\uff1a $$ X^+=V\\Sigma^{-1}U^T $$ \u5728\u51e0\u4f55\u4e0a\uff0c\u6700\u5c0f\u4e8c\u4e58\u6cd5\u76f8\u5f53\u4e8e\u6a21\u578b\uff08\u8fd9\u91cc\u5c31\u662f\u76f4\u7ebf\uff09\u548c\u8bd5\u9a8c\u503c\u7684\u8ddd\u79bb\u7684\u5e73\u65b9\u6c42\u548c\uff0c\u5047\u8bbe\u6211\u4eec\u7684\u8bd5\u9a8c\u6837\u672c\u5f20\u6210\u4e00\u4e2a \\(p\\) \u7ef4\u7a7a\u95f4\uff08\u6ee1\u79e9\u7684\u60c5\u51b5\uff09\uff1a \\(X=Span(x_1,\\cdots,x_N)\\) \uff0c\u800c\u6a21\u578b\u53ef\u4ee5\u5199\u6210 \\(f(w)=X\\beta\\) \uff0c\u4e5f\u5c31\u662f \\(x_1,\\cdots,x_N\\) \u7684\u67d0\u79cd\u7ec4\u5408\uff0c\u800c\u6700\u5c0f\u4e8c\u4e58\u6cd5\u5c31\u662f\u8bf4\u5e0c\u671b \\(Y\\) \u548c\u8fd9\u4e2a\u6a21\u578b\u8ddd\u79bb\u8d8a\u5c0f\u8d8a\u597d\uff0c\u4e8e\u662f\u5b83\u4eec\u7684\u5dee\u5e94\u8be5\u4e0e\u8fd9\u4e2a\u5f20\u6210\u7684\u7a7a\u95f4\u5782\u76f4\uff1a $$ X^T\\cdot(Y-X\\beta)=0\\longrightarrow\\beta=(X^TX)^{-1}X^TY $$ \u566a\u58f0\u4e3a\u9ad8\u65af\u5206\u5e03\u7684 MLE \u5bf9\u4e8e\u4e00\u7ef4\u7684\u60c5\u51b5\uff0c\u8bb0 \\(y=w^Tx+\\epsilon,\\epsilon\\sim\\mathcal{N}(0,\\sigma^2)\\) \uff0c\u90a3\u4e48 \\(y\\sim\\mathcal{N}(w^Tx,\\sigma^2)\\) \u3002\u4ee3\u5165\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u4e2d\uff1a $$ \\begin{align} L(w)=\\log p(Y|X,w)&=\\log\\prod\\limits_{i=1}^Np(y_i|x_i,w)\\nonumber\\ &=\\sum\\limits_{i=1}^N\\log(\\frac{1}{\\sqrt{2\\pi\\sigma}}e^{-\\frac{(y_i-w^Tx_i)^2}{2\\sigma^2}})\\ \\mathop{argmax}\\limits_wL(w)&=\\mathop{argmin}\\limits_w\\sum\\limits_{i=1^N}(y_i-w^Tx_i)^2 \\end{align} $$ \u8fd9\u4e2a\u8868\u8fbe\u5f0f\u548c\u6700\u5c0f\u4e8c\u4e58\u4f30\u8ba1\u5f97\u5230\u7684\u7ed3\u679c\u4e00\u6837\u3002 \u6743\u91cd\u5148\u9a8c\u4e5f\u4e3a\u9ad8\u65af\u5206\u5e03\u7684 MAP \u53d6\u5148\u9a8c\u5206\u5e03 \\(w\\sim\\mathcal{N}(0,\\sigma_0^2)\\) \u3002\u4e8e\u662f\uff1a $$ \\begin{align} \\hat{w}=\\mathop{argmax}\\limits_wp(w|Y)&=\\mathop{argmax}\\limits_wp(Y|w)p(w)\\nonumber\\ &=\\mathop{argmax}\\limits_w\\log p(Y|w)p(w)\\nonumber\\ &=\\mathop{argmax}\\limits_w(\\log p(Y|w)+\\log p(w))\\nonumber\\ &=\\mathop{argmin}\\limits_w[(y-w^Tx)^2+\\frac{\\sigma^2}{\\sigma_0^2}w^Tw] \\end{align} $$ \u8fd9\u91cc\u7701\u7565\u4e86 \\(X\\) \uff0c \\(p(Y)\\) \u548c \\(w\\) \u6ca1\u6709\u5173\u7cfb\uff0c\u540c\u65f6\u4e5f\u5229\u7528\u4e86\u4e0a\u9762\u9ad8\u65af\u5206\u5e03\u7684 MLE\u7684\u7ed3\u679c\u3002 \u6211\u4eec\u5c06\u4f1a\u770b\u5230\uff0c\u8d85\u53c2\u6570 \\(\\sigma_0\\) \u7684\u5b58\u5728\u548c\u4e0b\u9762\u4f1a\u4ecb\u7ecd\u7684 Ridge \u6b63\u5219\u9879\u53ef\u4ee5\u5bf9\u5e94\uff0c\u540c\u6837\u7684\u5982\u679c\u5c06\u5148\u9a8c\u5206\u5e03\u53d6\u4e3a Laplace \u5206\u5e03\uff0c\u90a3\u4e48\u5c31\u4f1a\u5f97\u5230\u548c L1 \u6b63\u5219\u7c7b\u4f3c\u7684\u7ed3\u679c\u3002 \u6b63\u5219\u5316 \u5728\u5b9e\u9645\u5e94\u7528\u65f6\uff0c\u5982\u679c\u6837\u672c\u5bb9\u91cf\u4e0d\u8fdc\u8fdc\u5927\u4e8e\u6837\u672c\u7684\u7279\u5f81\u7ef4\u5ea6\uff0c\u5f88\u53ef\u80fd\u9020\u6210\u8fc7\u62df\u5408\uff0c\u5bf9\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u6709\u4e0b\u9762\u4e09\u4e2a\u89e3\u51b3\u65b9\u5f0f\uff1a \u52a0\u6570\u636e \u7279\u5f81\u9009\u62e9\uff08\u964d\u4f4e\u7279\u5f81\u7ef4\u5ea6\uff09\u5982 PCA \u7b97\u6cd5\u3002 \u6b63\u5219\u5316 \u6b63\u5219\u5316\u4e00\u822c\u662f\u5728\u635f\u5931\u51fd\u6570\uff08\u5982\u4e0a\u9762\u4ecb\u7ecd\u7684\u6700\u5c0f\u4e8c\u4e58\u635f\u5931\uff09\u4e0a\u52a0\u5165\u6b63\u5219\u5316\u9879\uff08\u8868\u793a\u6a21\u578b\u7684\u590d\u6742\u5ea6\u5bf9\u6a21\u578b\u7684\u60e9\u7f5a\uff09\uff0c\u4e0b\u9762\u6211\u4eec\u4ecb\u7ecd\u4e00\u822c\u60c5\u51b5\u4e0b\u7684\u4e24\u79cd\u6b63\u5219\u5316\u6846\u67b6\u3002 $$ \\begin{align} L1&:\\mathop{argmin}\\limits_wL(w)+\\lambda||w||_1,\\lambda\\gt0\\ L2&:\\mathop{argmin}\\limits_wL(w)+\\lambda||w||^2_2,\\lambda \\gt 0 \\end{align} $$ \u4e0b\u9762\u5bf9\u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee\u5206\u522b\u5206\u6790\u8fd9\u4e24\u8005\u7684\u533a\u522b\u3002 L1 Lasso L1\u6b63\u5219\u5316\u53ef\u4ee5\u5f15\u8d77\u7a00\u758f\u89e3\u3002 \u4ece\u6700\u5c0f\u5316\u635f\u5931\u7684\u89d2\u5ea6\u770b\uff0c\u7531\u4e8e L1 \u9879\u6c42\u5bfc\u57280\u9644\u8fd1\u7684\u5de6\u53f3\u5bfc\u6570\u90fd\u4e0d\u662f0\uff0c\u56e0\u6b64\u66f4\u5bb9\u6613\u53d6\u52300\u89e3\u3002 \u4ece\u53e6\u4e00\u4e2a\u65b9\u9762\u770b\uff0cL1 \u6b63\u5219\u5316\u76f8\u5f53\u4e8e\uff1a $$ \\mathop{argmin}\\limits_wL(w)\\ s.t. ||w||_1\\lt C $$ \u6211\u4eec\u5df2\u7ecf\u770b\u5230\u5e73\u65b9\u8bef\u5dee\u635f\u5931\u51fd\u6570\u5728 \\(w\\) \u7a7a\u95f4\u662f\u4e00\u4e2a\u692d\u7403\uff0c\u56e0\u6b64\u4e0a\u5f0f\u6c42\u89e3\u5c31\u662f\u692d\u7403\u548c \\(||w||_1=C\\) \u7684\u5207\u70b9\uff0c\u56e0\u6b64\u66f4\u5bb9\u6613\u76f8\u5207\u5728\u5750\u6807\u8f74\u4e0a\u3002 L2 Ridge \\[ \\begin{align} \\hat{w}=\\mathop{argmin}\\limits_wL(w)+\\lambda w^Tw&\\longrightarrow\\frac{\\partial}{\\partial w}L(w)+2\\lambda w=0\\nonumber\\\\ &\\longrightarrow2X^TX\\hat{w}-2X^TY+2\\lambda \\hat w=0\\nonumber\\\\ &\\longrightarrow \\hat{w}=(X^TX+\\lambda \\mathbb{I})^{-1}X^TY \\end{align} \\] \u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u6b63\u5219\u5316\u53c2\u6570\u548c\u524d\u9762\u7684 MAP \u7ed3\u679c\u4e0d\u8c0b\u800c\u5408\u3002\u5229\u75282\u8303\u6570\u8fdb\u884c\u6b63\u5219\u5316\u4e0d\u4ec5\u53ef\u4ee5\u662f\u6a21\u578b\u9009\u62e9 \\(w\\) \u8f83\u5c0f\u7684\u53c2\u6570\uff0c\u540c\u65f6\u4e5f\u907f\u514d \\(X^TX\\) \u4e0d\u53ef\u9006\u7684\u95ee\u9898\u3002 \u5c0f\u7ed3 \u7ebf\u6027\u56de\u5f52\u6a21\u578b\u662f\u6700\u7b80\u5355\u7684\u6a21\u578b\uff0c\u4f46\u662f\u9ebb\u96c0\u867d\u5c0f\uff0c\u4e94\u810f\u4ff1\u5168\uff0c\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u5229\u7528\u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee\u5f97\u5230\u4e86\u95ed\u5f0f\u89e3\u3002\u540c\u65f6\u4e5f\u53d1\u73b0\uff0c\u5728\u566a\u58f0\u4e3a\u9ad8\u65af\u5206\u5e03\u7684\u65f6\u5019\uff0cMLE \u7684\u89e3\u7b49\u4ef7\u4e8e\u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee\uff0c\u800c\u589e\u52a0\u4e86\u6b63\u5219\u9879\u540e\uff0c\u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee\u52a0\u4e0a L2 \u6b63\u5219\u9879\u7b49\u4ef7\u4e8e\u9ad8\u65af\u566a\u58f0\u5148\u9a8c\u4e0b\u7684 MAP\u89e3\uff0c\u52a0\u4e0a L1 \u6b63\u5219\u9879\u540e\uff0c\u7b49\u4ef7\u4e8e Laplace \u566a\u58f0\u5148\u9a8c\u3002 \u4f20\u7edf\u7684\u673a\u5668\u5b66\u4e60\u65b9\u6cd5\u6216\u591a\u6216\u5c11\u90fd\u6709\u7ebf\u6027\u56de\u5f52\u6a21\u578b\u7684\u5f71\u5b50\uff1a \u7ebf\u6027\u6a21\u578b\u5f80\u5f80\u4e0d\u80fd\u5f88\u597d\u5730\u62df\u5408\u6570\u636e\uff0c\u56e0\u6b64\u6709\u4e09\u79cd\u65b9\u6848\u514b\u670d\u8fd9\u4e00\u52a3\u52bf\uff1a \u5bf9\u7279\u5f81\u7684\u7ef4\u6570\u8fdb\u884c\u53d8\u6362\uff0c\u4f8b\u5982\u591a\u9879\u5f0f\u56de\u5f52\u6a21\u578b\u5c31\u662f\u5728\u7ebf\u6027\u7279\u5f81\u7684\u57fa\u7840\u4e0a\u52a0\u5165\u9ad8\u6b21\u9879\u3002 \u5728\u7ebf\u6027\u65b9\u7a0b\u540e\u9762\u52a0\u5165\u4e00\u4e2a\u975e\u7ebf\u6027\u53d8\u6362\uff0c\u5373\u5f15\u5165\u4e00\u4e2a\u975e\u7ebf\u6027\u7684\u6fc0\u6d3b\u51fd\u6570\uff0c\u5178\u578b\u7684\u6709\u7ebf\u6027\u5206\u7c7b\u6a21\u578b\u5982\u611f\u77e5\u673a\u3002 \u5bf9\u4e8e\u4e00\u81f4\u7684\u7ebf\u6027\u7cfb\u6570\uff0c\u6211\u4eec\u8fdb\u884c\u591a\u6b21\u53d8\u6362\uff0c\u8fd9\u6837\u540c\u4e00\u4e2a\u7279\u5f81\u4e0d\u4ec5\u4ec5\u88ab\u5355\u4e2a\u7cfb\u6570\u5f71\u54cd\uff0c\u4f8b\u5982\u591a\u5c42\u611f\u77e5\u673a\uff08\u6df1\u5ea6\u524d\u9988\u7f51\u7edc\uff09\u3002 \u7ebf\u6027\u56de\u5f52\u5728\u6574\u4e2a\u6837\u672c\u7a7a\u95f4\u90fd\u662f\u7ebf\u6027\u7684\uff0c\u6211\u4eec\u4fee\u6539\u8fd9\u4e2a\u9650\u5236\uff0c\u5728\u4e0d\u540c\u533a\u57df\u5f15\u5165\u4e0d\u540c\u7684\u7ebf\u6027\u6216\u975e\u7ebf\u6027\uff0c\u4f8b\u5982\u7ebf\u6027\u6837\u6761\u56de\u5f52\u548c\u51b3\u7b56\u6811\u6a21\u578b\u3002 \u7ebf\u6027\u56de\u5f52\u4e2d\u4f7f\u7528\u4e86\u6240\u6709\u7684\u6837\u672c\uff0c\u4f46\u662f\u5bf9\u6570\u636e\u9884\u5148\u8fdb\u884c\u52a0\u5de5\u5b66\u4e60\u7684\u6548\u679c\u53ef\u80fd\u66f4\u597d\uff08\u6240\u8c13\u7684\u7ef4\u6570\u707e\u96be\uff0c\u9ad8\u7ef4\u5ea6\u6570\u636e\u66f4\u96be\u5b66\u4e60\uff09\uff0c\u4f8b\u5982 PCA \u7b97\u6cd5\u548c\u6d41\u5f62\u5b66\u4e60\u3002","title":"2.LinearRegression"},{"location":"Machine_Learning/2.LinearRegression/#_1","text":"\u5047\u8bbe\u6570\u636e\u96c6\u4e3a\uff1a $$ \\mathcal{D}={(x_1, y_1),(x_2, y_2),\\cdots,(x_N, y_N)} $$ \u540e\u9762\u6211\u4eec\u8bb0\uff1a $$ X=(x_1,x_2,\\cdots,x_N)^T,Y=(y_1,y_2,\\cdots,y_N)^T $$ \u7ebf\u6027\u56de\u5f52\u5047\u8bbe\uff1a $$ f(w)=w^Tx $$","title":"\u7ebf\u6027\u56de\u5f52"},{"location":"Machine_Learning/2.LinearRegression/#_2","text":"\u5bf9\u8fd9\u4e2a\u95ee\u9898\uff0c\u91c7\u7528\u4e8c\u8303\u6570\u5b9a\u4e49\u7684\u5e73\u65b9\u8bef\u5dee\u6765\u5b9a\u4e49\u635f\u5931\u51fd\u6570\uff1a $$ L(w)=\\sum\\limits_{i=1}^N||w^Tx_i-y_i||^2_2 $$ \u5c55\u5f00\u5f97\u5230\uff1a $$ \\begin{align} L(w)&=(w^Tx_1-y_1,\\cdots,w^Tx_N-y_N)\\cdot (w^Tx_1-y_1,\\cdots,w^Tx_N-y_N)^T\\nonumber\\ &=(w^TX^T-Y^T)\\cdot (Xw-Y)=w^TX^TXw-Y^TXw-w^TX^TY+Y^TY\\nonumber\\ &=w^TX^TXw-2w^TX^TY+Y^TY \\end{align} $$ \u6700\u5c0f\u5316\u8fd9\u4e2a\u503c\u7684 \\(\\hat{w}\\) \uff1a $$ \\begin{align} \\hat{w}=\\mathop{argmin}\\limits_wL(w)&\\longrightarrow\\frac{\\partial}{\\partial w}L(w)=0\\nonumber\\ &\\longrightarrow2X^TX\\hat{w}-2X^TY=0\\nonumber\\ &\\longrightarrow \\hat{w}=(X^TX)^{-1}X^TY=X^+Y \\end{align} $$ \u8fd9\u4e2a\u5f0f\u5b50\u4e2d \\((X^TX)^{-1}X^T\\) \u53c8\u88ab\u79f0\u4e3a\u4f2a\u9006\u3002\u5bf9\u4e8e\u884c\u6ee1\u79e9\u6216\u8005\u5217\u6ee1\u79e9\u7684 \\(X\\) \uff0c\u53ef\u4ee5\u76f4\u63a5\u6c42\u89e3\uff0c\u4f46\u662f\u5bf9\u4e8e\u975e\u6ee1\u79e9\u7684\u6837\u672c\u96c6\u5408\uff0c\u9700\u8981\u4f7f\u7528\u5947\u5f02\u503c\u5206\u89e3\uff08SVD\uff09\u7684\u65b9\u6cd5\uff0c\u5bf9 \\(X\\) \u6c42\u5947\u5f02\u503c\u5206\u89e3\uff0c\u5f97\u5230 $$ X=U\\Sigma V^T $$ \u4e8e\u662f\uff1a $$ X^+=V\\Sigma^{-1}U^T $$ \u5728\u51e0\u4f55\u4e0a\uff0c\u6700\u5c0f\u4e8c\u4e58\u6cd5\u76f8\u5f53\u4e8e\u6a21\u578b\uff08\u8fd9\u91cc\u5c31\u662f\u76f4\u7ebf\uff09\u548c\u8bd5\u9a8c\u503c\u7684\u8ddd\u79bb\u7684\u5e73\u65b9\u6c42\u548c\uff0c\u5047\u8bbe\u6211\u4eec\u7684\u8bd5\u9a8c\u6837\u672c\u5f20\u6210\u4e00\u4e2a \\(p\\) \u7ef4\u7a7a\u95f4\uff08\u6ee1\u79e9\u7684\u60c5\u51b5\uff09\uff1a \\(X=Span(x_1,\\cdots,x_N)\\) \uff0c\u800c\u6a21\u578b\u53ef\u4ee5\u5199\u6210 \\(f(w)=X\\beta\\) \uff0c\u4e5f\u5c31\u662f \\(x_1,\\cdots,x_N\\) \u7684\u67d0\u79cd\u7ec4\u5408\uff0c\u800c\u6700\u5c0f\u4e8c\u4e58\u6cd5\u5c31\u662f\u8bf4\u5e0c\u671b \\(Y\\) \u548c\u8fd9\u4e2a\u6a21\u578b\u8ddd\u79bb\u8d8a\u5c0f\u8d8a\u597d\uff0c\u4e8e\u662f\u5b83\u4eec\u7684\u5dee\u5e94\u8be5\u4e0e\u8fd9\u4e2a\u5f20\u6210\u7684\u7a7a\u95f4\u5782\u76f4\uff1a $$ X^T\\cdot(Y-X\\beta)=0\\longrightarrow\\beta=(X^TX)^{-1}X^TY $$","title":"\u6700\u5c0f\u4e8c\u4e58\u6cd5"},{"location":"Machine_Learning/2.LinearRegression/#mle","text":"\u5bf9\u4e8e\u4e00\u7ef4\u7684\u60c5\u51b5\uff0c\u8bb0 \\(y=w^Tx+\\epsilon,\\epsilon\\sim\\mathcal{N}(0,\\sigma^2)\\) \uff0c\u90a3\u4e48 \\(y\\sim\\mathcal{N}(w^Tx,\\sigma^2)\\) \u3002\u4ee3\u5165\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u4e2d\uff1a $$ \\begin{align} L(w)=\\log p(Y|X,w)&=\\log\\prod\\limits_{i=1}^Np(y_i|x_i,w)\\nonumber\\ &=\\sum\\limits_{i=1}^N\\log(\\frac{1}{\\sqrt{2\\pi\\sigma}}e^{-\\frac{(y_i-w^Tx_i)^2}{2\\sigma^2}})\\ \\mathop{argmax}\\limits_wL(w)&=\\mathop{argmin}\\limits_w\\sum\\limits_{i=1^N}(y_i-w^Tx_i)^2 \\end{align} $$ \u8fd9\u4e2a\u8868\u8fbe\u5f0f\u548c\u6700\u5c0f\u4e8c\u4e58\u4f30\u8ba1\u5f97\u5230\u7684\u7ed3\u679c\u4e00\u6837\u3002","title":"\u566a\u58f0\u4e3a\u9ad8\u65af\u5206\u5e03\u7684 MLE"},{"location":"Machine_Learning/2.LinearRegression/#map","text":"\u53d6\u5148\u9a8c\u5206\u5e03 \\(w\\sim\\mathcal{N}(0,\\sigma_0^2)\\) \u3002\u4e8e\u662f\uff1a $$ \\begin{align} \\hat{w}=\\mathop{argmax}\\limits_wp(w|Y)&=\\mathop{argmax}\\limits_wp(Y|w)p(w)\\nonumber\\ &=\\mathop{argmax}\\limits_w\\log p(Y|w)p(w)\\nonumber\\ &=\\mathop{argmax}\\limits_w(\\log p(Y|w)+\\log p(w))\\nonumber\\ &=\\mathop{argmin}\\limits_w[(y-w^Tx)^2+\\frac{\\sigma^2}{\\sigma_0^2}w^Tw] \\end{align} $$ \u8fd9\u91cc\u7701\u7565\u4e86 \\(X\\) \uff0c \\(p(Y)\\) \u548c \\(w\\) \u6ca1\u6709\u5173\u7cfb\uff0c\u540c\u65f6\u4e5f\u5229\u7528\u4e86\u4e0a\u9762\u9ad8\u65af\u5206\u5e03\u7684 MLE\u7684\u7ed3\u679c\u3002 \u6211\u4eec\u5c06\u4f1a\u770b\u5230\uff0c\u8d85\u53c2\u6570 \\(\\sigma_0\\) \u7684\u5b58\u5728\u548c\u4e0b\u9762\u4f1a\u4ecb\u7ecd\u7684 Ridge \u6b63\u5219\u9879\u53ef\u4ee5\u5bf9\u5e94\uff0c\u540c\u6837\u7684\u5982\u679c\u5c06\u5148\u9a8c\u5206\u5e03\u53d6\u4e3a Laplace \u5206\u5e03\uff0c\u90a3\u4e48\u5c31\u4f1a\u5f97\u5230\u548c L1 \u6b63\u5219\u7c7b\u4f3c\u7684\u7ed3\u679c\u3002","title":"\u6743\u91cd\u5148\u9a8c\u4e5f\u4e3a\u9ad8\u65af\u5206\u5e03\u7684 MAP"},{"location":"Machine_Learning/2.LinearRegression/#_3","text":"\u5728\u5b9e\u9645\u5e94\u7528\u65f6\uff0c\u5982\u679c\u6837\u672c\u5bb9\u91cf\u4e0d\u8fdc\u8fdc\u5927\u4e8e\u6837\u672c\u7684\u7279\u5f81\u7ef4\u5ea6\uff0c\u5f88\u53ef\u80fd\u9020\u6210\u8fc7\u62df\u5408\uff0c\u5bf9\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u6709\u4e0b\u9762\u4e09\u4e2a\u89e3\u51b3\u65b9\u5f0f\uff1a \u52a0\u6570\u636e \u7279\u5f81\u9009\u62e9\uff08\u964d\u4f4e\u7279\u5f81\u7ef4\u5ea6\uff09\u5982 PCA \u7b97\u6cd5\u3002 \u6b63\u5219\u5316 \u6b63\u5219\u5316\u4e00\u822c\u662f\u5728\u635f\u5931\u51fd\u6570\uff08\u5982\u4e0a\u9762\u4ecb\u7ecd\u7684\u6700\u5c0f\u4e8c\u4e58\u635f\u5931\uff09\u4e0a\u52a0\u5165\u6b63\u5219\u5316\u9879\uff08\u8868\u793a\u6a21\u578b\u7684\u590d\u6742\u5ea6\u5bf9\u6a21\u578b\u7684\u60e9\u7f5a\uff09\uff0c\u4e0b\u9762\u6211\u4eec\u4ecb\u7ecd\u4e00\u822c\u60c5\u51b5\u4e0b\u7684\u4e24\u79cd\u6b63\u5219\u5316\u6846\u67b6\u3002 $$ \\begin{align} L1&:\\mathop{argmin}\\limits_wL(w)+\\lambda||w||_1,\\lambda\\gt0\\ L2&:\\mathop{argmin}\\limits_wL(w)+\\lambda||w||^2_2,\\lambda \\gt 0 \\end{align} $$ \u4e0b\u9762\u5bf9\u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee\u5206\u522b\u5206\u6790\u8fd9\u4e24\u8005\u7684\u533a\u522b\u3002","title":"\u6b63\u5219\u5316"},{"location":"Machine_Learning/2.LinearRegression/#l1-lasso","text":"L1\u6b63\u5219\u5316\u53ef\u4ee5\u5f15\u8d77\u7a00\u758f\u89e3\u3002 \u4ece\u6700\u5c0f\u5316\u635f\u5931\u7684\u89d2\u5ea6\u770b\uff0c\u7531\u4e8e L1 \u9879\u6c42\u5bfc\u57280\u9644\u8fd1\u7684\u5de6\u53f3\u5bfc\u6570\u90fd\u4e0d\u662f0\uff0c\u56e0\u6b64\u66f4\u5bb9\u6613\u53d6\u52300\u89e3\u3002 \u4ece\u53e6\u4e00\u4e2a\u65b9\u9762\u770b\uff0cL1 \u6b63\u5219\u5316\u76f8\u5f53\u4e8e\uff1a $$ \\mathop{argmin}\\limits_wL(w)\\ s.t. ||w||_1\\lt C $$ \u6211\u4eec\u5df2\u7ecf\u770b\u5230\u5e73\u65b9\u8bef\u5dee\u635f\u5931\u51fd\u6570\u5728 \\(w\\) \u7a7a\u95f4\u662f\u4e00\u4e2a\u692d\u7403\uff0c\u56e0\u6b64\u4e0a\u5f0f\u6c42\u89e3\u5c31\u662f\u692d\u7403\u548c \\(||w||_1=C\\) \u7684\u5207\u70b9\uff0c\u56e0\u6b64\u66f4\u5bb9\u6613\u76f8\u5207\u5728\u5750\u6807\u8f74\u4e0a\u3002","title":"L1 Lasso"},{"location":"Machine_Learning/2.LinearRegression/#l2-ridge","text":"\\[ \\begin{align} \\hat{w}=\\mathop{argmin}\\limits_wL(w)+\\lambda w^Tw&\\longrightarrow\\frac{\\partial}{\\partial w}L(w)+2\\lambda w=0\\nonumber\\\\ &\\longrightarrow2X^TX\\hat{w}-2X^TY+2\\lambda \\hat w=0\\nonumber\\\\ &\\longrightarrow \\hat{w}=(X^TX+\\lambda \\mathbb{I})^{-1}X^TY \\end{align} \\] \u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u6b63\u5219\u5316\u53c2\u6570\u548c\u524d\u9762\u7684 MAP \u7ed3\u679c\u4e0d\u8c0b\u800c\u5408\u3002\u5229\u75282\u8303\u6570\u8fdb\u884c\u6b63\u5219\u5316\u4e0d\u4ec5\u53ef\u4ee5\u662f\u6a21\u578b\u9009\u62e9 \\(w\\) \u8f83\u5c0f\u7684\u53c2\u6570\uff0c\u540c\u65f6\u4e5f\u907f\u514d \\(X^TX\\) \u4e0d\u53ef\u9006\u7684\u95ee\u9898\u3002","title":"L2 Ridge"},{"location":"Machine_Learning/2.LinearRegression/#_4","text":"\u7ebf\u6027\u56de\u5f52\u6a21\u578b\u662f\u6700\u7b80\u5355\u7684\u6a21\u578b\uff0c\u4f46\u662f\u9ebb\u96c0\u867d\u5c0f\uff0c\u4e94\u810f\u4ff1\u5168\uff0c\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u5229\u7528\u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee\u5f97\u5230\u4e86\u95ed\u5f0f\u89e3\u3002\u540c\u65f6\u4e5f\u53d1\u73b0\uff0c\u5728\u566a\u58f0\u4e3a\u9ad8\u65af\u5206\u5e03\u7684\u65f6\u5019\uff0cMLE \u7684\u89e3\u7b49\u4ef7\u4e8e\u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee\uff0c\u800c\u589e\u52a0\u4e86\u6b63\u5219\u9879\u540e\uff0c\u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee\u52a0\u4e0a L2 \u6b63\u5219\u9879\u7b49\u4ef7\u4e8e\u9ad8\u65af\u566a\u58f0\u5148\u9a8c\u4e0b\u7684 MAP\u89e3\uff0c\u52a0\u4e0a L1 \u6b63\u5219\u9879\u540e\uff0c\u7b49\u4ef7\u4e8e Laplace \u566a\u58f0\u5148\u9a8c\u3002 \u4f20\u7edf\u7684\u673a\u5668\u5b66\u4e60\u65b9\u6cd5\u6216\u591a\u6216\u5c11\u90fd\u6709\u7ebf\u6027\u56de\u5f52\u6a21\u578b\u7684\u5f71\u5b50\uff1a \u7ebf\u6027\u6a21\u578b\u5f80\u5f80\u4e0d\u80fd\u5f88\u597d\u5730\u62df\u5408\u6570\u636e\uff0c\u56e0\u6b64\u6709\u4e09\u79cd\u65b9\u6848\u514b\u670d\u8fd9\u4e00\u52a3\u52bf\uff1a \u5bf9\u7279\u5f81\u7684\u7ef4\u6570\u8fdb\u884c\u53d8\u6362\uff0c\u4f8b\u5982\u591a\u9879\u5f0f\u56de\u5f52\u6a21\u578b\u5c31\u662f\u5728\u7ebf\u6027\u7279\u5f81\u7684\u57fa\u7840\u4e0a\u52a0\u5165\u9ad8\u6b21\u9879\u3002 \u5728\u7ebf\u6027\u65b9\u7a0b\u540e\u9762\u52a0\u5165\u4e00\u4e2a\u975e\u7ebf\u6027\u53d8\u6362\uff0c\u5373\u5f15\u5165\u4e00\u4e2a\u975e\u7ebf\u6027\u7684\u6fc0\u6d3b\u51fd\u6570\uff0c\u5178\u578b\u7684\u6709\u7ebf\u6027\u5206\u7c7b\u6a21\u578b\u5982\u611f\u77e5\u673a\u3002 \u5bf9\u4e8e\u4e00\u81f4\u7684\u7ebf\u6027\u7cfb\u6570\uff0c\u6211\u4eec\u8fdb\u884c\u591a\u6b21\u53d8\u6362\uff0c\u8fd9\u6837\u540c\u4e00\u4e2a\u7279\u5f81\u4e0d\u4ec5\u4ec5\u88ab\u5355\u4e2a\u7cfb\u6570\u5f71\u54cd\uff0c\u4f8b\u5982\u591a\u5c42\u611f\u77e5\u673a\uff08\u6df1\u5ea6\u524d\u9988\u7f51\u7edc\uff09\u3002 \u7ebf\u6027\u56de\u5f52\u5728\u6574\u4e2a\u6837\u672c\u7a7a\u95f4\u90fd\u662f\u7ebf\u6027\u7684\uff0c\u6211\u4eec\u4fee\u6539\u8fd9\u4e2a\u9650\u5236\uff0c\u5728\u4e0d\u540c\u533a\u57df\u5f15\u5165\u4e0d\u540c\u7684\u7ebf\u6027\u6216\u975e\u7ebf\u6027\uff0c\u4f8b\u5982\u7ebf\u6027\u6837\u6761\u56de\u5f52\u548c\u51b3\u7b56\u6811\u6a21\u578b\u3002 \u7ebf\u6027\u56de\u5f52\u4e2d\u4f7f\u7528\u4e86\u6240\u6709\u7684\u6837\u672c\uff0c\u4f46\u662f\u5bf9\u6570\u636e\u9884\u5148\u8fdb\u884c\u52a0\u5de5\u5b66\u4e60\u7684\u6548\u679c\u53ef\u80fd\u66f4\u597d\uff08\u6240\u8c13\u7684\u7ef4\u6570\u707e\u96be\uff0c\u9ad8\u7ef4\u5ea6\u6570\u636e\u66f4\u96be\u5b66\u4e60\uff09\uff0c\u4f8b\u5982 PCA \u7b97\u6cd5\u548c\u6d41\u5f62\u5b66\u4e60\u3002","title":"\u5c0f\u7ed3"},{"location":"Machine_Learning/20.Spectral/","text":"\u8c31\u805a\u7c7b \u805a\u7c7b\u95ee\u9898\u53ef\u4ee5\u5206\u4e3a\u4e24\u79cd\u601d\u8def\uff1a Compactness\uff0c\u8fd9\u7c7b\u6709 K-means\uff0cGMM \u7b49\uff0c\u4f46\u662f\u8fd9\u7c7b\u7b97\u6cd5\u53ea\u80fd\u5904\u7406\u51f8\u96c6\uff0c\u4e3a\u4e86\u5904\u7406\u975e\u51f8\u7684\u6837\u672c\u96c6\uff0c\u5fc5\u987b\u5f15\u5165\u6838\u6280\u5de7\u3002 Connectivity\uff0c\u8fd9\u7c7b\u4ee5\u8c31\u805a\u7c7b\u4e3a\u4ee3\u8868\u3002 \u8c31\u805a\u7c7b\u662f\u4e00\u79cd\u57fa\u4e8e\u65e0\u5411\u5e26\u6743\u56fe\u7684\u805a\u7c7b\u65b9\u6cd5\u3002\u8fd9\u4e2a\u56fe\u7528 \\(G=(V,E)\\) \u8868\u793a\uff0c\u5176\u4e2d \\(V=\\{1,2,\\cdots,N\\}\\) \uff0c \\(E=\\{w_{ij}\\}\\) \uff0c\u8fd9\u91cc \\(w_{ij}\\) \u5c31\u662f\u8fb9\u7684\u6743\u91cd\uff0c\u8fd9\u91cc\u6743\u91cd\u53d6\u4e3a\u76f8\u4f3c\u5ea6\uff0c \\(W=(w_{ij})\\) \u662f\u76f8\u4f3c\u5ea6\u77e9\u9635\uff0c\u5b9a\u4e49\u76f8\u4f3c\u5ea6\uff08\u5f84\u5411\u6838\uff09\uff1a $$ w_{ij}=k(x_i,x_j)=\\exp(-\\frac{||x_i-x_j|| 2^2}{2\\sigma^2}),(i,j)\\in E\\ w =0,(i,j)\\notin E $$ \u4e0b\u9762\u5b9a\u4e49\u56fe\u7684\u5206\u5272\uff0c\u8fd9\u79cd\u5206\u5272\u5c31\u76f8\u5f53\u4e8e\u805a\u7c7b\u7684\u7ed3\u679c\u3002\u5b9a\u4e49 \\(w(A,B)\\) \uff1a $$ A \\in V,B\\in V,A\\cap B=\\emptyset,w(A,B)=\\sum\\limits_{i\\in A,j\\in B}w_{ij} $$ \u5047\u8bbe\u4e00\u5171\u6709 \\(K\\) \u4e2a\u7c7b\u522b\uff0c\u5bf9\u8fd9\u4e2a\u56fe\u7684\u5206\u5272 \\(CUT(V)=CUT(A_1,A_2,\\cdots,A_K)=\\sum\\limits_{k=1}^Kw(A_k,\\overline{A_k})=\\sum\\limits_{k=1}^K[w(A_k,V)-w(A_k,A_k)]\\) \u4e8e\u662f\uff0c\u6211\u4eec\u7684\u76ee\u6807\u5c31\u662f \\(\\min\\limits_{A_k}CUT(V)\\) \u3002 \u4e3a\u4e86\u5e73\u8861\u6bcf\u4e00\u7c7b\u5185\u90e8\u7684\u6743\u91cd\u4e0d\u540c\uff0c\u6211\u4eec\u505a\u5f52\u4e00\u5316\u7684\u64cd\u4f5c\uff0c\u5b9a\u4e49\u6bcf\u4e00\u4e2a\u96c6\u5408\u7684\u5ea6\uff0c\u9996\u5148\uff0c\u5bf9\u5355\u4e2a\u8282\u70b9\u7684\u5ea6\u5b9a\u4e49\uff1a $$ d_i=\\sum\\limits_{j=1}^Nw_{ij} $$ \u5176\u6b21\uff0c\u6bcf\u4e2a\u96c6\u5408\uff1a $$ \\Delta_k=degree(A_k)=\\sum\\limits_{i\\in A_k}d_i $$ \u4e8e\u662f\uff1a $$ N(CUT)=\\sum\\limits_{k=1}^K\\frac{w(A_k,\\overline{A_k})}{\\sum\\limits_{i\\in A_k}d_i} $$ \u6240\u4ee5\u76ee\u6807\u51fd\u6570\u5c31\u662f\u6700\u5c0f\u5316\u8fd9\u4e2a\u5f0f\u5b50\u3002 \u8c31\u805a\u7c7b\u7684\u6a21\u578b\u5c31\u662f\uff1a $$ {\\hat{A} k} ^K=\\mathop{argmin} {A_k}N(CUT) $$ \u5f15\u5165\u6307\u793a\u5411\u91cf\uff1a $$ \\left{ \\begin{align}y_i\\in {0,1}^K\\ \\sum\\limits ^Ky_{ij}=1\\end{align} \\right. $$ \u5176\u4e2d\uff0c \\(y_{ij}\\) \u8868\u793a\u7b2c \\(i\\) \u4e2a\u6837\u672c\u5c5e\u4e8e \\(j\\) \u4e2a\u7c7b\u522b\uff0c\u8bb0\uff1a \\(Y=(y_1,y_2,\\cdots,y_N)^T\\) \u3002\u6240\u4ee5\uff1a $$ \\hat{Y}=\\mathop{argmin} YN(CUT) $$ \u5c06 \\(N(CUT)\\) \u5199\u6210\u5bf9\u89d2\u77e9\u9635\u7684\u5f62\u5f0f\uff0c\u4e8e\u662f\uff1a $$ \\begin{align}N(CUT)&=Trace[diag(\\frac{w(A_1,\\overline{A_1})}{\\sum\\limits d_i},\\frac{w(A_2,\\overline{A_2})}{\\sum\\limits_{i\\in A_2}d_i},\\cdots,\\frac{w(A_K,\\overline{A_K})}{\\sum\\limits_{i\\in A_K}d_i})]\\nonumber\\ &=Trace[diag(w(A_1,\\overline{A_1}),w(A_2,\\overline{A_2}),\\cdots,w(A_K,\\overline{A_K}))\\cdot diag(\\sum\\limits_{i\\in A_1}d_i,\\cdots,\\sum\\limits_{i\\in A_K}d_i)^{-1}]\\nonumber\\ &=Trace[O\\cdot P^{-1}] \\end{align} $$ \u6211\u4eec\u5df2\u7ecf\u77e5\u9053 \\(Y,w\\) \u8fd9\u4e24\u4e2a\u77e9\u9635\uff0c\u6211\u4eec\u5e0c\u671b\u6c42\u5f97 \\(O,P\\) \u3002 \u7531\u4e8e\uff1a $$ Y^TY=\\sum\\limits_{i=1}^Ny_iy_i^T $$ \u5bf9\u4e8e \\(y_iy_i^T\\) \uff0c\u53ea\u5728\u5bf9\u89d2\u7ebf\u4e0a\u7684 \\(k\\times k\\) \u5904\u4e3a 1\uff0c\u6240\u4ee5\uff1a $$ Y^TY=diag(N_1,N_2,\\cdots,N_K) $$ \u5176\u4e2d\uff0c \\(N_i\\) \u8868\u793a\u6709 \\(N_i\\) \u4e2a\u6837\u672c\u5c5e\u4e8e \\(i\\) \uff0c\u5373 \\(N_k=\\sum\\limits_{k\\in A_k}1\\) \u3002 \u5f15\u5165\u5bf9\u89d2\u77e9\u9635\uff0c\u6839\u636e \\(d_i\\) \u7684\u5b9a\u4e49\uff0c \\(D=diag(d_1,d_2,\\cdots,d_N)=diag(w_{NN}\\mathbb{I}_{N1})\\) \uff0c\u4e8e\u662f\uff1a $$ P=Y^TDY $$ \u5bf9\u53e6\u4e00\u9879 \\(O=diag(w(A_1,\\overline{A_1}),w(A_2,\\overline{A_2}),\\cdots,w(A_K,\\overline{A_K})\\) \uff1a $$ O=diag(w(A_i,V))-diag(w(A_i,A_i))=diag(\\sum\\limits_{j\\in A_i}d_j)-diag(w(A_i,A_i)) $$ \u5176\u4e2d\uff0c\u7b2c\u4e00\u9879\u5df2\u77e5\uff0c\u7b2c\u4e8c\u9879\u53ef\u4ee5\u5199\u6210 \\(Y^TwY\\) \uff0c\u8fd9\u662f\u7531\u4e8e\uff1a $$ Y^TwY=\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^Ny_iy_j^Tw_{ij} $$ \u4e8e\u662f\u8fd9\u4e2a\u77e9\u9635\u7684\u7b2c \\(lm\\) \u9879\u53ef\u4ee5\u5199\u4e3a\uff1a $$ \\sum\\limits_{i\\in A_l,j\\in A_m}w_{ij} $$ \u8fd9\u4e2a\u77e9\u9635\u7684\u5bf9\u89d2\u7ebf\u4e0a\u7684\u9879\u548c \\(w(A_i,A_i)\\) \u76f8\u540c\uff0c\u6240\u4ee5\u53d6\u8ff9\u540e\u7684\u53d6\u503c\u4e0d\u4f1a\u53d8\u5316\u3002 \u6240\u4ee5\uff1a $$ N(CUT)=Trace[(Y^T(D-w))Y)\\cdot(Y^TDY)^{-1}] $$ \u5176\u4e2d\uff0c \\(L=D-w\\) \u53eb\u505a\u62c9\u666e\u62c9\u65af\u77e9\u9635\u3002","title":"\u8c31\u805a\u7c7b"},{"location":"Machine_Learning/20.Spectral/#_1","text":"\u805a\u7c7b\u95ee\u9898\u53ef\u4ee5\u5206\u4e3a\u4e24\u79cd\u601d\u8def\uff1a Compactness\uff0c\u8fd9\u7c7b\u6709 K-means\uff0cGMM \u7b49\uff0c\u4f46\u662f\u8fd9\u7c7b\u7b97\u6cd5\u53ea\u80fd\u5904\u7406\u51f8\u96c6\uff0c\u4e3a\u4e86\u5904\u7406\u975e\u51f8\u7684\u6837\u672c\u96c6\uff0c\u5fc5\u987b\u5f15\u5165\u6838\u6280\u5de7\u3002 Connectivity\uff0c\u8fd9\u7c7b\u4ee5\u8c31\u805a\u7c7b\u4e3a\u4ee3\u8868\u3002 \u8c31\u805a\u7c7b\u662f\u4e00\u79cd\u57fa\u4e8e\u65e0\u5411\u5e26\u6743\u56fe\u7684\u805a\u7c7b\u65b9\u6cd5\u3002\u8fd9\u4e2a\u56fe\u7528 \\(G=(V,E)\\) \u8868\u793a\uff0c\u5176\u4e2d \\(V=\\{1,2,\\cdots,N\\}\\) \uff0c \\(E=\\{w_{ij}\\}\\) \uff0c\u8fd9\u91cc \\(w_{ij}\\) \u5c31\u662f\u8fb9\u7684\u6743\u91cd\uff0c\u8fd9\u91cc\u6743\u91cd\u53d6\u4e3a\u76f8\u4f3c\u5ea6\uff0c \\(W=(w_{ij})\\) \u662f\u76f8\u4f3c\u5ea6\u77e9\u9635\uff0c\u5b9a\u4e49\u76f8\u4f3c\u5ea6\uff08\u5f84\u5411\u6838\uff09\uff1a $$ w_{ij}=k(x_i,x_j)=\\exp(-\\frac{||x_i-x_j|| 2^2}{2\\sigma^2}),(i,j)\\in E\\ w =0,(i,j)\\notin E $$ \u4e0b\u9762\u5b9a\u4e49\u56fe\u7684\u5206\u5272\uff0c\u8fd9\u79cd\u5206\u5272\u5c31\u76f8\u5f53\u4e8e\u805a\u7c7b\u7684\u7ed3\u679c\u3002\u5b9a\u4e49 \\(w(A,B)\\) \uff1a $$ A \\in V,B\\in V,A\\cap B=\\emptyset,w(A,B)=\\sum\\limits_{i\\in A,j\\in B}w_{ij} $$ \u5047\u8bbe\u4e00\u5171\u6709 \\(K\\) \u4e2a\u7c7b\u522b\uff0c\u5bf9\u8fd9\u4e2a\u56fe\u7684\u5206\u5272 \\(CUT(V)=CUT(A_1,A_2,\\cdots,A_K)=\\sum\\limits_{k=1}^Kw(A_k,\\overline{A_k})=\\sum\\limits_{k=1}^K[w(A_k,V)-w(A_k,A_k)]\\) \u4e8e\u662f\uff0c\u6211\u4eec\u7684\u76ee\u6807\u5c31\u662f \\(\\min\\limits_{A_k}CUT(V)\\) \u3002 \u4e3a\u4e86\u5e73\u8861\u6bcf\u4e00\u7c7b\u5185\u90e8\u7684\u6743\u91cd\u4e0d\u540c\uff0c\u6211\u4eec\u505a\u5f52\u4e00\u5316\u7684\u64cd\u4f5c\uff0c\u5b9a\u4e49\u6bcf\u4e00\u4e2a\u96c6\u5408\u7684\u5ea6\uff0c\u9996\u5148\uff0c\u5bf9\u5355\u4e2a\u8282\u70b9\u7684\u5ea6\u5b9a\u4e49\uff1a $$ d_i=\\sum\\limits_{j=1}^Nw_{ij} $$ \u5176\u6b21\uff0c\u6bcf\u4e2a\u96c6\u5408\uff1a $$ \\Delta_k=degree(A_k)=\\sum\\limits_{i\\in A_k}d_i $$ \u4e8e\u662f\uff1a $$ N(CUT)=\\sum\\limits_{k=1}^K\\frac{w(A_k,\\overline{A_k})}{\\sum\\limits_{i\\in A_k}d_i} $$ \u6240\u4ee5\u76ee\u6807\u51fd\u6570\u5c31\u662f\u6700\u5c0f\u5316\u8fd9\u4e2a\u5f0f\u5b50\u3002 \u8c31\u805a\u7c7b\u7684\u6a21\u578b\u5c31\u662f\uff1a $$ {\\hat{A} k} ^K=\\mathop{argmin} {A_k}N(CUT) $$ \u5f15\u5165\u6307\u793a\u5411\u91cf\uff1a $$ \\left{ \\begin{align}y_i\\in {0,1}^K\\ \\sum\\limits ^Ky_{ij}=1\\end{align} \\right. $$ \u5176\u4e2d\uff0c \\(y_{ij}\\) \u8868\u793a\u7b2c \\(i\\) \u4e2a\u6837\u672c\u5c5e\u4e8e \\(j\\) \u4e2a\u7c7b\u522b\uff0c\u8bb0\uff1a \\(Y=(y_1,y_2,\\cdots,y_N)^T\\) \u3002\u6240\u4ee5\uff1a $$ \\hat{Y}=\\mathop{argmin} YN(CUT) $$ \u5c06 \\(N(CUT)\\) \u5199\u6210\u5bf9\u89d2\u77e9\u9635\u7684\u5f62\u5f0f\uff0c\u4e8e\u662f\uff1a $$ \\begin{align}N(CUT)&=Trace[diag(\\frac{w(A_1,\\overline{A_1})}{\\sum\\limits d_i},\\frac{w(A_2,\\overline{A_2})}{\\sum\\limits_{i\\in A_2}d_i},\\cdots,\\frac{w(A_K,\\overline{A_K})}{\\sum\\limits_{i\\in A_K}d_i})]\\nonumber\\ &=Trace[diag(w(A_1,\\overline{A_1}),w(A_2,\\overline{A_2}),\\cdots,w(A_K,\\overline{A_K}))\\cdot diag(\\sum\\limits_{i\\in A_1}d_i,\\cdots,\\sum\\limits_{i\\in A_K}d_i)^{-1}]\\nonumber\\ &=Trace[O\\cdot P^{-1}] \\end{align} $$ \u6211\u4eec\u5df2\u7ecf\u77e5\u9053 \\(Y,w\\) \u8fd9\u4e24\u4e2a\u77e9\u9635\uff0c\u6211\u4eec\u5e0c\u671b\u6c42\u5f97 \\(O,P\\) \u3002 \u7531\u4e8e\uff1a $$ Y^TY=\\sum\\limits_{i=1}^Ny_iy_i^T $$ \u5bf9\u4e8e \\(y_iy_i^T\\) \uff0c\u53ea\u5728\u5bf9\u89d2\u7ebf\u4e0a\u7684 \\(k\\times k\\) \u5904\u4e3a 1\uff0c\u6240\u4ee5\uff1a $$ Y^TY=diag(N_1,N_2,\\cdots,N_K) $$ \u5176\u4e2d\uff0c \\(N_i\\) \u8868\u793a\u6709 \\(N_i\\) \u4e2a\u6837\u672c\u5c5e\u4e8e \\(i\\) \uff0c\u5373 \\(N_k=\\sum\\limits_{k\\in A_k}1\\) \u3002 \u5f15\u5165\u5bf9\u89d2\u77e9\u9635\uff0c\u6839\u636e \\(d_i\\) \u7684\u5b9a\u4e49\uff0c \\(D=diag(d_1,d_2,\\cdots,d_N)=diag(w_{NN}\\mathbb{I}_{N1})\\) \uff0c\u4e8e\u662f\uff1a $$ P=Y^TDY $$ \u5bf9\u53e6\u4e00\u9879 \\(O=diag(w(A_1,\\overline{A_1}),w(A_2,\\overline{A_2}),\\cdots,w(A_K,\\overline{A_K})\\) \uff1a $$ O=diag(w(A_i,V))-diag(w(A_i,A_i))=diag(\\sum\\limits_{j\\in A_i}d_j)-diag(w(A_i,A_i)) $$ \u5176\u4e2d\uff0c\u7b2c\u4e00\u9879\u5df2\u77e5\uff0c\u7b2c\u4e8c\u9879\u53ef\u4ee5\u5199\u6210 \\(Y^TwY\\) \uff0c\u8fd9\u662f\u7531\u4e8e\uff1a $$ Y^TwY=\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^Ny_iy_j^Tw_{ij} $$ \u4e8e\u662f\u8fd9\u4e2a\u77e9\u9635\u7684\u7b2c \\(lm\\) \u9879\u53ef\u4ee5\u5199\u4e3a\uff1a $$ \\sum\\limits_{i\\in A_l,j\\in A_m}w_{ij} $$ \u8fd9\u4e2a\u77e9\u9635\u7684\u5bf9\u89d2\u7ebf\u4e0a\u7684\u9879\u548c \\(w(A_i,A_i)\\) \u76f8\u540c\uff0c\u6240\u4ee5\u53d6\u8ff9\u540e\u7684\u53d6\u503c\u4e0d\u4f1a\u53d8\u5316\u3002 \u6240\u4ee5\uff1a $$ N(CUT)=Trace[(Y^T(D-w))Y)\\cdot(Y^TDY)^{-1}] $$ \u5176\u4e2d\uff0c \\(L=D-w\\) \u53eb\u505a\u62c9\u666e\u62c9\u65af\u77e9\u9635\u3002","title":"\u8c31\u805a\u7c7b"},{"location":"Machine_Learning/21.NN/","text":"\u524d\u9988\u795e\u7ecf\u7f51\u7edc \u673a\u5668\u5b66\u4e60\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u53ef\u4ee5\u5206\u4e3a\u4e24\u5927\u6d41\u6d3e\uff1a \u9891\u7387\u6d3e\uff0c\u8fd9\u4e2a\u6d41\u6d3e\u7684\u65b9\u6cd5\u53eb\u505a\u7edf\u8ba1\u5b66\u4e60\uff0c\u6839\u636e\u5177\u4f53\u95ee\u9898\u6709\u4e0b\u9762\u7684\u7b97\u6cd5\uff1a \u6b63\u5219\u5316\uff0cL1\uff0cL2 \u7b49 \u6838\u5316\uff0c\u5982\u6838\u652f\u6491\u5411\u91cf\u673a \u96c6\u6210\u5316\uff0cAdaBoost\uff0cRandomForest \u5c42\u6b21\u5316\uff0c\u795e\u7ecf\u7f51\u7edc\uff0c\u795e\u7ecf\u7f51\u7edc\u6709\u5404\u79cd\u4e0d\u540c\u7684\u6a21\u578b\uff0c\u6709\u4ee3\u8868\u6027\u7684\u6709\uff1a \u591a\u5c42\u611f\u77e5\u673a Autoencoder CNN RNN \u8fd9\u51e0\u79cd\u6a21\u578b\u53c8\u53eb\u505a\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\u3002 \u8d1d\u53f6\u65af\u6d3e\uff0c\u8fd9\u4e2a\u6d41\u6d3e\u7684\u65b9\u6cd5\u53eb\u6982\u7387\u56fe\u6a21\u578b\uff0c\u6839\u636e\u56fe\u7279\u70b9\u5206\u4e3a\uff1a \u6709\u5411\u56fe-\u8d1d\u53f6\u65af\u7f51\u7edc\uff0c\u52a0\u5165\u5c42\u6b21\u5316\u540e\u6709\u6df1\u5ea6\u6709\u5411\u7f51\u7edc\uff0c\u5305\u62ec Sigmoid Belief Network Variational Autoencoder GAN \u65e0\u5411\u56fe-\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc\uff0c\u52a0\u5165\u5c42\u6b21\u5316\u540e\u6709\u6df1\u5ea6\u73bb\u5c14\u5179\u66fc\u673a\u3002 \u6df7\u5408\uff0c\u52a0\u5165\u5c42\u6b21\u5316\u540e\u6709\u6df1\u5ea6\u4fe1\u5ff5\u7f51\u7edc \u8fd9\u51e0\u4e2a\u52a0\u5165\u5c42\u6b21\u5316\u540e\u7684\u6a21\u578b\u53eb\u505a\u6df1\u5ea6\u751f\u6210\u7f51\u7edc\u3002 \u4ece\u5e7f\u4e49\u6765\u8bf4\uff0c\u6df1\u5ea6\u5b66\u4e60\u5305\u62ec\u6df1\u5ea6\u751f\u6210\u7f51\u7edc\u548c\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\u3002 From PLA to DL 1958\uff0cPLA 1969\uff0cPLA \u4e0d\u80fd\u89e3\u51b3 XOR \u7b49\u975e\u7ebf\u6027\u6570\u636e 1981\uff0cMLP\uff0c\u591a\u5c42\u611f\u77e5\u673a\u7684\u51fa\u73b0\u89e3\u51b3\u4e86\u4e0a\u9762\u7684\u95ee\u9898 1986\uff0cBP \u7b97\u6cd5\u5e94\u7528\u5728 MLP \u4e0a\uff0cRNN 1989\uff0cCNN\uff0cUniveral Approximation Theorem\uff0c\u4f46\u662f\u4e8e\u6b64\u540c\u65f6\uff0c\u7531\u4e8e\u6df1\u5ea6\u548c\u5bbd\u5ea6\u7684\u76f8\u5bf9\u6548\u7387\u4e0d\u77e5\u9053\uff0c\u5e76\u4e14\u65e0\u6cd5\u89e3\u51b3 BP \u7b97\u6cd5\u7684\u68af\u5ea6\u6d88\u5931\u95ee\u9898 1993\uff0c1995\uff0cSVM + kernel\uff0cAdaBoost\uff0cRandomForest\uff0c\u8fd9\u4e9b\u7b97\u6cd5\u7684\u53d1\u5c55\uff0cDL \u9010\u6e10\u6ca1\u843d 1997\uff0cLSTM 2006\uff0c\u57fa\u4e8e RBM \u7684 \u6df1\u5ea6\u4fe1\u5ff5\u7f51\u7edc\u548c\u6df1\u5ea6\u81ea\u7f16\u7801 2009\uff0cGPU\u7684\u53d1\u5c55 2011\uff0c\u5728\u8bed\u97f3\u65b9\u9762\u7684\u5e94\u7528 2012\uff0cImageNet 2013\uff0cVAE 2014\uff0cGAN 2016\uff0cAlphaGo 2018\uff0cGNN DL \u4e0d\u662f\u4e00\u4e2a\u65b0\u7684\u4e1c\u897f\uff0c\u5176\u8fd1\u5e74\u6765\u7684\u5927\u53d1\u5c55\u4e3b\u8981\u539f\u56e0\u5982\u4e0b\uff1a \u6570\u636e\u91cf\u53d8\u5927 \u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u53d1\u5c55 \u786c\u4ef6\u7b97\u529b\u7684\u53d1\u5c55 \u975e\u7ebf\u6027\u95ee\u9898 \u5bf9\u4e8e\u975e\u7ebf\u6027\u7684\u95ee\u9898\uff0c\u6709\u4e09\u79cd\u65b9\u6cd5\uff1a \u975e\u7ebf\u6027\u8f6c\u6362\uff0c\u5c06\u4f4e\u7ef4\u7a7a\u95f4\u8f6c\u6362\u5230\u9ad8\u7ef4\u7a7a\u95f4\uff08Cover \u5b9a\u7406\uff09\uff0c\u4ece\u800c\u53d8\u4e3a\u4e00\u4e2a\u7ebf\u6027\u95ee\u9898\u3002 \u6838\u65b9\u6cd5\uff0c\u7531\u4e8e\u975e\u7ebf\u6027\u8f6c\u6362\u662f\u53d8\u6362\u4e3a\u9ad8\u7ef4\u7a7a\u95f4\uff0c\u56e0\u6b64\u53ef\u80fd\u5bfc\u81f4\u7ef4\u5ea6\u707e\u96be\uff0c\u5e76\u4e14\u53ef\u80fd\u5f88\u96be\u5f97\u5230\u8fd9\u4e2a\u53d8\u6362\u51fd\u6570\uff0c\u6838\u65b9\u6cd5\u4e0d\u76f4\u63a5\u5bfb\u627e\u8fd9\u4e2a\u8f6c\u6362\uff0c\u800c\u662f\u5bfb\u627e\u4e00\u4e2a\u5185\u79ef\u3002 \u795e\u7ecf\u7f51\u7edc\u65b9\u6cd5\uff0c\u5c06\u590d\u5408\u8fd0\u7b97\u53d8\u4e3a\u57fa\u672c\u7684\u7ebf\u6027\u8fd0\u7b97\u7684\u7ec4\u5408\u3002","title":"\u524d\u9988\u795e\u7ecf\u7f51\u7edc"},{"location":"Machine_Learning/21.NN/#_1","text":"\u673a\u5668\u5b66\u4e60\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u53ef\u4ee5\u5206\u4e3a\u4e24\u5927\u6d41\u6d3e\uff1a \u9891\u7387\u6d3e\uff0c\u8fd9\u4e2a\u6d41\u6d3e\u7684\u65b9\u6cd5\u53eb\u505a\u7edf\u8ba1\u5b66\u4e60\uff0c\u6839\u636e\u5177\u4f53\u95ee\u9898\u6709\u4e0b\u9762\u7684\u7b97\u6cd5\uff1a \u6b63\u5219\u5316\uff0cL1\uff0cL2 \u7b49 \u6838\u5316\uff0c\u5982\u6838\u652f\u6491\u5411\u91cf\u673a \u96c6\u6210\u5316\uff0cAdaBoost\uff0cRandomForest \u5c42\u6b21\u5316\uff0c\u795e\u7ecf\u7f51\u7edc\uff0c\u795e\u7ecf\u7f51\u7edc\u6709\u5404\u79cd\u4e0d\u540c\u7684\u6a21\u578b\uff0c\u6709\u4ee3\u8868\u6027\u7684\u6709\uff1a \u591a\u5c42\u611f\u77e5\u673a Autoencoder CNN RNN \u8fd9\u51e0\u79cd\u6a21\u578b\u53c8\u53eb\u505a\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\u3002 \u8d1d\u53f6\u65af\u6d3e\uff0c\u8fd9\u4e2a\u6d41\u6d3e\u7684\u65b9\u6cd5\u53eb\u6982\u7387\u56fe\u6a21\u578b\uff0c\u6839\u636e\u56fe\u7279\u70b9\u5206\u4e3a\uff1a \u6709\u5411\u56fe-\u8d1d\u53f6\u65af\u7f51\u7edc\uff0c\u52a0\u5165\u5c42\u6b21\u5316\u540e\u6709\u6df1\u5ea6\u6709\u5411\u7f51\u7edc\uff0c\u5305\u62ec Sigmoid Belief Network Variational Autoencoder GAN \u65e0\u5411\u56fe-\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc\uff0c\u52a0\u5165\u5c42\u6b21\u5316\u540e\u6709\u6df1\u5ea6\u73bb\u5c14\u5179\u66fc\u673a\u3002 \u6df7\u5408\uff0c\u52a0\u5165\u5c42\u6b21\u5316\u540e\u6709\u6df1\u5ea6\u4fe1\u5ff5\u7f51\u7edc \u8fd9\u51e0\u4e2a\u52a0\u5165\u5c42\u6b21\u5316\u540e\u7684\u6a21\u578b\u53eb\u505a\u6df1\u5ea6\u751f\u6210\u7f51\u7edc\u3002 \u4ece\u5e7f\u4e49\u6765\u8bf4\uff0c\u6df1\u5ea6\u5b66\u4e60\u5305\u62ec\u6df1\u5ea6\u751f\u6210\u7f51\u7edc\u548c\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc\u3002","title":"\u524d\u9988\u795e\u7ecf\u7f51\u7edc"},{"location":"Machine_Learning/21.NN/#from-pla-to-dl","text":"1958\uff0cPLA 1969\uff0cPLA \u4e0d\u80fd\u89e3\u51b3 XOR \u7b49\u975e\u7ebf\u6027\u6570\u636e 1981\uff0cMLP\uff0c\u591a\u5c42\u611f\u77e5\u673a\u7684\u51fa\u73b0\u89e3\u51b3\u4e86\u4e0a\u9762\u7684\u95ee\u9898 1986\uff0cBP \u7b97\u6cd5\u5e94\u7528\u5728 MLP \u4e0a\uff0cRNN 1989\uff0cCNN\uff0cUniveral Approximation Theorem\uff0c\u4f46\u662f\u4e8e\u6b64\u540c\u65f6\uff0c\u7531\u4e8e\u6df1\u5ea6\u548c\u5bbd\u5ea6\u7684\u76f8\u5bf9\u6548\u7387\u4e0d\u77e5\u9053\uff0c\u5e76\u4e14\u65e0\u6cd5\u89e3\u51b3 BP \u7b97\u6cd5\u7684\u68af\u5ea6\u6d88\u5931\u95ee\u9898 1993\uff0c1995\uff0cSVM + kernel\uff0cAdaBoost\uff0cRandomForest\uff0c\u8fd9\u4e9b\u7b97\u6cd5\u7684\u53d1\u5c55\uff0cDL \u9010\u6e10\u6ca1\u843d 1997\uff0cLSTM 2006\uff0c\u57fa\u4e8e RBM \u7684 \u6df1\u5ea6\u4fe1\u5ff5\u7f51\u7edc\u548c\u6df1\u5ea6\u81ea\u7f16\u7801 2009\uff0cGPU\u7684\u53d1\u5c55 2011\uff0c\u5728\u8bed\u97f3\u65b9\u9762\u7684\u5e94\u7528 2012\uff0cImageNet 2013\uff0cVAE 2014\uff0cGAN 2016\uff0cAlphaGo 2018\uff0cGNN DL \u4e0d\u662f\u4e00\u4e2a\u65b0\u7684\u4e1c\u897f\uff0c\u5176\u8fd1\u5e74\u6765\u7684\u5927\u53d1\u5c55\u4e3b\u8981\u539f\u56e0\u5982\u4e0b\uff1a \u6570\u636e\u91cf\u53d8\u5927 \u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u53d1\u5c55 \u786c\u4ef6\u7b97\u529b\u7684\u53d1\u5c55","title":"From PLA to DL"},{"location":"Machine_Learning/21.NN/#_2","text":"\u5bf9\u4e8e\u975e\u7ebf\u6027\u7684\u95ee\u9898\uff0c\u6709\u4e09\u79cd\u65b9\u6cd5\uff1a \u975e\u7ebf\u6027\u8f6c\u6362\uff0c\u5c06\u4f4e\u7ef4\u7a7a\u95f4\u8f6c\u6362\u5230\u9ad8\u7ef4\u7a7a\u95f4\uff08Cover \u5b9a\u7406\uff09\uff0c\u4ece\u800c\u53d8\u4e3a\u4e00\u4e2a\u7ebf\u6027\u95ee\u9898\u3002 \u6838\u65b9\u6cd5\uff0c\u7531\u4e8e\u975e\u7ebf\u6027\u8f6c\u6362\u662f\u53d8\u6362\u4e3a\u9ad8\u7ef4\u7a7a\u95f4\uff0c\u56e0\u6b64\u53ef\u80fd\u5bfc\u81f4\u7ef4\u5ea6\u707e\u96be\uff0c\u5e76\u4e14\u53ef\u80fd\u5f88\u96be\u5f97\u5230\u8fd9\u4e2a\u53d8\u6362\u51fd\u6570\uff0c\u6838\u65b9\u6cd5\u4e0d\u76f4\u63a5\u5bfb\u627e\u8fd9\u4e2a\u8f6c\u6362\uff0c\u800c\u662f\u5bfb\u627e\u4e00\u4e2a\u5185\u79ef\u3002 \u795e\u7ecf\u7f51\u7edc\u65b9\u6cd5\uff0c\u5c06\u590d\u5408\u8fd0\u7b97\u53d8\u4e3a\u57fa\u672c\u7684\u7ebf\u6027\u8fd0\u7b97\u7684\u7ec4\u5408\u3002","title":"\u975e\u7ebf\u6027\u95ee\u9898"},{"location":"Machine_Learning/22.PartitionFunction/","text":"\u914d\u5206\u51fd\u6570 \u5728\u5b66\u4e60\u548c\u63a8\u65ad\u4e2d\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6982\u7387\u7684\u5f52\u4e00\u5316\u56e0\u5b50\u5f88\u96be\u5904\u7406\uff0c\u8fd9\u4e2a\u5f52\u4e00\u5316\u56e0\u5b50\u548c\u914d\u5206\u51fd\u6570\u76f8\u5173\u3002\u5047\u8bbe\u4e00\u4e2a\u6982\u7387\u5206\u5e03\uff1a $$ p(x|\\theta)=\\frac{1}{Z(\\theta)}\\hat{p}(x|\\theta),Z(\\theta)=\\int\\hat{p}(x|\\theta)dx $$ \u5305\u542b\u914d\u5206\u51fd\u6570\u7684 MLE \u5728\u5b66\u4e60\u4efb\u52a1\u4e2d\uff0c\u91c7\u7528\u6700\u5927\u4f3c\u7136\uff1a $$ \\begin{align} \\hat{\\theta}&=\\mathop{argmax} {\\theta}p(x|\\theta)=\\mathop{argmax} \\theta\\sum\\limits_{i=1}^N\\log p(x_i|\\theta)\\nonumber\\ &=\\mathop{argmax} \\theta\\sum\\limits ^N\\log \\hat{p}(x|\\theta)-N\\log Z(\\theta)\\nonumber\\ &=\\mathop{argmax} {\\theta}\\frac{1}{N}\\sum\\limits ^N\\log \\hat{p}(x|\\theta)-\\log Z(\\theta)=\\mathop{argmax} \\theta l(\\theta) \\end{align} $$ \u6c42\u5bfc\uff1a $$ \\begin{align}\\nabla \\theta\\log Z(\\theta)&=\\frac{1}{Z(\\theta)}\\nabla_\\theta Z(\\theta)\\nonumber\\ &=\\frac{p(x|\\theta)}{\\hat{p}(x|\\theta)}\\int\\nabla_\\theta \\hat{p}(x|\\theta)dx\\nonumber\\ &=\\int\\frac{p(x|\\theta)}{\\hat{p}(x|\\theta)}\\nabla_\\theta\\hat{p}(x|\\theta)dx\\nonumber\\ &=\\mathbb{E} {p(x|\\theta)}[\\nabla \\theta\\log\\hat{p}(x|\\theta)] \\end{align} $$ \u7531\u4e8e\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u548c\u672a\u77e5\u7684\u6982\u7387\u76f8\u5173\uff0c\u4e8e\u662f\u65e0\u6cd5\u76f4\u63a5\u7cbe\u786e\u6c42\u89e3\uff0c\u9700\u8981\u8fd1\u4f3c\u91c7\u6837\uff0c\u5982\u679c\u6ca1\u6709\u8fd9\u4e00\u9879\uff0c\u90a3\u4e48\u53ef\u4ee5\u91c7\u7528\u68af\u5ea6\u4e0b\u964d\uff0c\u4f46\u662f\u5b58\u5728\u914d\u5206\u51fd\u6570\u5c31\u65e0\u6cd5\u76f4\u63a5\u91c7\u7528\u68af\u5ea6\u4e0b\u964d\u4e86\u3002 \u4e0a\u9762\u8fd9\u4e2a\u671f\u671b\u503c\uff0c\u662f\u5bf9\u6a21\u578b\u5047\u8bbe\u7684\u6982\u7387\u5206\u5e03\uff0c\u5b9a\u4e49\u771f\u5b9e\u6982\u7387\u5206\u5e03\u4e3a \\(p_{data}\\) \uff0c\u4e8e\u662f\uff0c \\(l(\\theta)\\) \u4e2d\u7684\u7b2c\u4e00\u9879\u7684\u68af\u5ea6\u53ef\u4ee5\u770b\u6210\u662f\u4ece\u8fd9\u4e2a\u6982\u7387\u5206\u5e03\u4e2d\u91c7\u6837\u51fa\u6765\u7684 \\(N\\) \u4e2a\u70b9\u6c42\u548c\u5e73\u5747\uff0c\u53ef\u4ee5\u8fd1\u4f3c\u671f\u671b\u503c\u3002 $$ \\nabla_\\theta l(\\theta)=\\mathbb{E} {p }[\\nabla_\\theta\\log\\hat{p}(x|\\theta)]-\\mathbb{E} {p(x|\\theta)}[\\nabla \\theta\\log\\hat{p}(x|\\theta)] $$ \u4e8e\u662f\uff0c\u76f8\u5f53\u4e8e\u771f\u5b9e\u5206\u5e03\u548c\u6a21\u578b\u5047\u8bbe\u8d8a\u63a5\u8fd1\u8d8a\u597d\u3002\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u7b2c\u4e00\u9879\u53eb\u505a\u6b63\u76f8\uff0c\u7b2c\u4e8c\u9879\u53eb\u505a\u8d1f\u76f8\u3002\u4e3a\u4e86\u5f97\u5230\u8d1f\u76f8\u7684\u503c\uff0c\u9700\u8981\u91c7\u7528\u5404\u79cd\u91c7\u6837\u65b9\u6cd5\uff0c\u5982 MCMC\u3002 \u91c7\u6837\u5f97\u5230 \\(\\hat{x}_{1-m}\\sim p_{model}(x|\\theta^t)\\) \uff0c\u90a3\u4e48\uff1a $$ \\theta^{t+1}=\\theta^t+\\eta(\\sum\\limits_{i=1}^m\\nabla_\\theta \\log \\hat{p}(x_i|\\theta^t)-\\sum\\limits_{i=1}^m\\nabla_\\theta\\log \\hat{p}(\\hat{x_i}|\\theta^t)) $$ \u8fd9\u4e2a\u7b97\u6cd5\u4e5f\u53eb\u505a\u57fa\u4e8e MCMC \u91c7\u6837\u7684\u68af\u5ea6\u4e0a\u5347\u3002\u6bcf\u6b21\u901a\u8fc7\u91c7\u6837\u5f97\u5230\u7684\u6837\u672c\u53eb\u505a\u5e7b\u60f3\u7c92\u5b50\uff0c\u5982\u679c\u8fd9\u4e9b\u5e7b\u60f3\u7c92\u5b50\u533a\u57df\u7684\u6982\u7387\u9ad8\u4e8e\u5b9e\u9645\u5206\u5e03\uff0c\u90a3\u4e48\u6700\u5927\u5316\u53c2\u6570\u7684\u7ed3\u679c\u5c31\u662f\u964d\u4f4e\u8fd9\u4e9b\u90e8\u5206\u7684\u6982\u7387\u3002 \u5bf9\u6bd4\u6563\u5ea6-CD Learning \u4e0a\u9762\u5bf9\u4e8e\u8d1f\u76f8\u7684\u91c7\u6837\uff0c\u6700\u5927\u7684\u95ee\u9898\u662f\uff0c\u91c7\u6837\u5230\u8fbe\u5e73\u7a33\u5206\u5e03\u7684\u6b65\u9aa4\u6570\u91cf\u662f\u672a\u77e5\u7684\u3002\u5bf9\u6bd4\u6563\u5ea6\u7684\u65b9\u6cd5\uff0c\u662f\u5bf9\u4e0a\u8ff0\u7684\u91c7\u6837\u662f\u7684\u521d\u59cb\u503c\u4f5c\u51fa\u9650\u5236\uff0c\u76f4\u63a5\u91c7\u6837 \\(\\hat{x}_i=x_i\\) \uff0c\u8fd9\u6837\u53ef\u4ee5\u7f29\u77ed\u91c7\u6837\u7684\u6df7\u5408\u65f6\u95f4\u3002\u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a CD-k \u7b97\u6cd5\uff0c \\(k\\) \u5c31\u662f\u521d\u59cb\u5316\u540e\u8fdb\u884c\u7684\u6f14\u5316\u65f6\u95f4\uff0c\u5f88\u591a\u65f6\u5019\uff0c\u5373\u4f7f \\(k=1\\) \u4e5f\u662f\u53ef\u4ee5\u7684\u3002 \u6211\u4eec\u770b MLE \u7684\u8868\u8fbe\u5f0f\uff1a $$ \\begin{align}\\hat{\\theta}&=\\mathop{argmax} {\\theta}p(x|\\theta)=\\mathop{argmax} \\frac{1}{N}\\sum\\limits_{i=1}^N\\log p(x_i|\\theta)=\\mathbb{E} {p }[\\log p_{model}(x|\\theta)]\\nonumber\\ &=\\mathop{argmax} \\theta\\int p \\log p_{model}dx\\nonumber\\ &=\\mathop{argmax} \\theta\\int p \\log \\frac{p_{model}}{p_{data}}dx\\nonumber\\ &=\\mathop{argmin} \\theta KL(p ||p_{model}) \\end{align} $$ \u5bf9\u4e8e CD-k \u7684\u91c7\u6837\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u5c06\u521d\u59cb\u503c\u8fd9\u4e9b\u70b9\u8868\u793a\u4e3a\uff1a $$ p^0=p_{data} $$ \u800c\u6211\u4eec\u7684\u6a21\u578b\u9700\u8981\u91c7\u6837\u8fc7\u7a0b\u8fbe\u5230\u5e73\u7a33\u5206\u5e03\uff1a $$ p^\\infty=p_{model} $$ \u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u7684\u662f \\(KL(p^0||p^\\infty)\\) \u3002\u5b9a\u4e49 CD\uff1a $$ KL(p^0||p^\\infty)-KL(p^k||p^\\infty) $$ \u8fd9\u5c31\u662f CD-k \u7b97\u6cd5\u7b2c \\(k\\) \u6b21\u91c7\u6837\u7684\u76ee\u6807\u51fd\u6570\u3002 RBM \u7684\u5b66\u4e60\u95ee\u9898 RBM \u7684\u53c2\u6570\u4e3a\uff1a $$ \\begin{align} h=(h_1,\\cdots,h_m)^T\\ v=(v_1,\\cdots,v_n)^T\\ w=(w_{ij}) {mn}\\ \\alpha=(\\alpha_1,\\cdots,\\alpha_n)^T\\ \\beta=(\\beta_1,\\cdots,\\beta_m)^T \\end{align} $$ \u5b66\u4e60\u95ee\u9898\u5173\u6ce8\u7684\u6982\u7387\u5206\u5e03\u4e3a\uff1a $$ \\begin{align} \\log p(v)&=\\log\\sum\\limits p(h,v)\\nonumber\\ &=\\log\\sum\\limits_h\\frac{1}{Z}\\exp(-E(v,h))\\nonumber\\ &=\\log\\sum\\limits_{h}\\exp(-E(v,h))-\\log\\sum\\limits_{v,h}\\exp(-E(h,v)) \\end{align} $$ \u5bf9\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u6c42\u5bfc\u7b2c\u4e00\u9879\uff1a $$ \\frac{\\partial \\log\\sum\\limits_{h}\\exp(-E(v,h))}{\\partial\\theta}=-\\frac{\\sum\\limits_h\\exp(-E(v,h))\\frac{\\partial E(v,h)}{\\partial\\theta}}{\\sum\\limits_{h}\\exp(-E(v,h))}\\ =-\\sum\\limits_h\\frac{\\exp(-E(v,h))\\frac{\\partial E(v,h)}{\\partial\\theta}}{\\sum\\limits_{h}\\exp(-E(v,h))}=-\\sum\\limits_hp(h|v)\\frac{\\partial E(v,h)}{\\partial\\theta} $$ \u7b2c\u4e8c\u9879\uff1a $$ \\frac{\\partial \\log\\sum\\limits_{v,h}\\exp(-E(h,v))}{\\partial\\theta}=-\\sum\\limits_{h,v}\\frac{\\exp(-E(v,h))\\frac{\\partial E(v,h)}{\\partial\\theta}}{\\sum\\limits_{h,v}\\exp(-E(v,h))}=-\\sum\\limits_{v,h}p(v,h)\\frac{\\partial E(v,h)}{\\partial\\theta} $$ \u6240\u4ee5\u6709\uff1a $$ \\frac{\\partial}{\\partial\\theta}\\log p(v)=-\\sum\\limits_hp(h|v)\\frac{\\partial E(v,h)}{\\partial\\theta}+\\sum\\limits_{v,h}p(v,h)\\frac{\\partial E(v,h)}{\\partial\\theta} $$ \u5c06 RBM \u7684\u6a21\u578b\u5047\u8bbe\u4ee3\u5165\uff1a $$ E(v,h)=-(h^Twv+\\alpha^Tv+\\beta^Th) $$ \\(w_{ij}\\) \uff1a $$ \\frac{\\partial}{\\partial w_{ij}}E(v,h)=-h_iv_j $$ \u4e8e\u662f\uff1a $$ \\frac{\\partial}{\\partial\\theta}\\log p(v)=\\sum\\limits_{h}p(h|v)h_iv_j-\\sum\\limits_{h,v}p(h,v)h_iv_j $$ \u7b2c\u4e00\u9879\uff1a $$ \\sum\\limits_{h_1,h_2,\\cdots,h_m}p(h_1,h_2,\\cdots,h_m|v)h_iv_j=\\sum\\limits_{h_i}p(h_i|v)h_iv_j=p(h_i=1|v)v_j $$ \u8fd9\u91cc\u5047\u8bbe\u4e86 \\(h_i\\) \u662f\u4e8c\u5143\u53d8\u91cf\u3002 \u7b2c\u4e8c\u9879\uff1a $$ \\sum\\limits_{h,v}p(h,v)h_iv_j=\\sum\\limits_{h,v}p(v)p(h|v)h_iv_j=\\sum\\limits_vp(v)p(h_i=1|v)v_j $$ \u8fd9\u4e2a\u6c42\u548c\u662f\u6307\u6570\u9636\u7684\uff0c\u4e8e\u662f\u9700\u8981\u91c7\u6837\u89e3\u51b3\uff0c\u6211\u4e48\u4f7f\u7528 CD-k \u65b9\u6cd5\u3002 \u5bf9\u4e8e\u7b2c\u4e00\u9879\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u8bad\u7ec3\u6837\u672c\u5f97\u5230\uff0c\u7b2c\u4e8c\u9879\u91c7\u7528 CD-k \u91c7\u6837\u65b9\u6cd5\uff0c\u9996\u5148\u4f7f\u7528\u6837\u672c \\(v^0=v\\) \uff0c\u7136\u540e\u91c7\u6837\u5f97\u5230 \\(h^0\\) \uff0c\u7136\u540e\u91c7\u6837\u5f97\u5230 \\(v^1\\) \uff0c\u8fd9\u6837\u987a\u6b21\u8fdb\u884c\uff0c\u6700\u7ec8\u5f97\u5230 \\(v^k\\) \uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6837\u672c\u90fd\u5f97\u5230\u4e00\u4e2a \\(v^k\\) \uff0c\u6700\u7ec8\u91c7\u6837\u5f97\u5230 \\(N\\) \u4e2a $v^k $\uff0c\u4e8e\u662f\u7b2c\u4e8c\u9879\u5c31\u662f\uff1a $$ p(h_i=1|v^k)v_j^k $$ \u5177\u4f53\u7684\u7b97\u6cd5\u4e3a\uff1a \u5bf9\u6bcf\u4e00\u4e2a\u6837\u672c\u4e2d\u7684 \\(v\\) \uff0c\u8fdb\u884c\u91c7\u6837\uff1a \u4f7f\u7528\u8fd9\u4e2a\u6837\u672c\u521d\u59cb\u5316\u91c7\u6837 \u8fdb\u884c \\(k\\) \u6b21\u91c7\u6837\uff080-k-1\uff09\uff1a \\(h_i^l\\sim p(h_i|v^l)\\) \\(v_i^{l+1}\\sim p(v_i|h^l)\\) \u5c06\u8fd9\u4e9b\u91c7\u6837\u51fa\u6765\u7684\u7ed3\u679c\u7d2f\u52a0\u8fdb\u68af\u5ea6\u4e2d \u91cd\u590d\u8fdb\u884c\u4e0a\u8ff0\u8fc7\u7a0b\uff0c\u6700\u7ec8\u7684\u68af\u5ea6\u9664\u4ee5 \\(N\\)","title":"\u914d\u5206\u51fd\u6570"},{"location":"Machine_Learning/22.PartitionFunction/#_1","text":"\u5728\u5b66\u4e60\u548c\u63a8\u65ad\u4e2d\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6982\u7387\u7684\u5f52\u4e00\u5316\u56e0\u5b50\u5f88\u96be\u5904\u7406\uff0c\u8fd9\u4e2a\u5f52\u4e00\u5316\u56e0\u5b50\u548c\u914d\u5206\u51fd\u6570\u76f8\u5173\u3002\u5047\u8bbe\u4e00\u4e2a\u6982\u7387\u5206\u5e03\uff1a $$ p(x|\\theta)=\\frac{1}{Z(\\theta)}\\hat{p}(x|\\theta),Z(\\theta)=\\int\\hat{p}(x|\\theta)dx $$","title":"\u914d\u5206\u51fd\u6570"},{"location":"Machine_Learning/22.PartitionFunction/#mle","text":"\u5728\u5b66\u4e60\u4efb\u52a1\u4e2d\uff0c\u91c7\u7528\u6700\u5927\u4f3c\u7136\uff1a $$ \\begin{align} \\hat{\\theta}&=\\mathop{argmax} {\\theta}p(x|\\theta)=\\mathop{argmax} \\theta\\sum\\limits_{i=1}^N\\log p(x_i|\\theta)\\nonumber\\ &=\\mathop{argmax} \\theta\\sum\\limits ^N\\log \\hat{p}(x|\\theta)-N\\log Z(\\theta)\\nonumber\\ &=\\mathop{argmax} {\\theta}\\frac{1}{N}\\sum\\limits ^N\\log \\hat{p}(x|\\theta)-\\log Z(\\theta)=\\mathop{argmax} \\theta l(\\theta) \\end{align} $$ \u6c42\u5bfc\uff1a $$ \\begin{align}\\nabla \\theta\\log Z(\\theta)&=\\frac{1}{Z(\\theta)}\\nabla_\\theta Z(\\theta)\\nonumber\\ &=\\frac{p(x|\\theta)}{\\hat{p}(x|\\theta)}\\int\\nabla_\\theta \\hat{p}(x|\\theta)dx\\nonumber\\ &=\\int\\frac{p(x|\\theta)}{\\hat{p}(x|\\theta)}\\nabla_\\theta\\hat{p}(x|\\theta)dx\\nonumber\\ &=\\mathbb{E} {p(x|\\theta)}[\\nabla \\theta\\log\\hat{p}(x|\\theta)] \\end{align} $$ \u7531\u4e8e\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u548c\u672a\u77e5\u7684\u6982\u7387\u76f8\u5173\uff0c\u4e8e\u662f\u65e0\u6cd5\u76f4\u63a5\u7cbe\u786e\u6c42\u89e3\uff0c\u9700\u8981\u8fd1\u4f3c\u91c7\u6837\uff0c\u5982\u679c\u6ca1\u6709\u8fd9\u4e00\u9879\uff0c\u90a3\u4e48\u53ef\u4ee5\u91c7\u7528\u68af\u5ea6\u4e0b\u964d\uff0c\u4f46\u662f\u5b58\u5728\u914d\u5206\u51fd\u6570\u5c31\u65e0\u6cd5\u76f4\u63a5\u91c7\u7528\u68af\u5ea6\u4e0b\u964d\u4e86\u3002 \u4e0a\u9762\u8fd9\u4e2a\u671f\u671b\u503c\uff0c\u662f\u5bf9\u6a21\u578b\u5047\u8bbe\u7684\u6982\u7387\u5206\u5e03\uff0c\u5b9a\u4e49\u771f\u5b9e\u6982\u7387\u5206\u5e03\u4e3a \\(p_{data}\\) \uff0c\u4e8e\u662f\uff0c \\(l(\\theta)\\) \u4e2d\u7684\u7b2c\u4e00\u9879\u7684\u68af\u5ea6\u53ef\u4ee5\u770b\u6210\u662f\u4ece\u8fd9\u4e2a\u6982\u7387\u5206\u5e03\u4e2d\u91c7\u6837\u51fa\u6765\u7684 \\(N\\) \u4e2a\u70b9\u6c42\u548c\u5e73\u5747\uff0c\u53ef\u4ee5\u8fd1\u4f3c\u671f\u671b\u503c\u3002 $$ \\nabla_\\theta l(\\theta)=\\mathbb{E} {p }[\\nabla_\\theta\\log\\hat{p}(x|\\theta)]-\\mathbb{E} {p(x|\\theta)}[\\nabla \\theta\\log\\hat{p}(x|\\theta)] $$ \u4e8e\u662f\uff0c\u76f8\u5f53\u4e8e\u771f\u5b9e\u5206\u5e03\u548c\u6a21\u578b\u5047\u8bbe\u8d8a\u63a5\u8fd1\u8d8a\u597d\u3002\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u7b2c\u4e00\u9879\u53eb\u505a\u6b63\u76f8\uff0c\u7b2c\u4e8c\u9879\u53eb\u505a\u8d1f\u76f8\u3002\u4e3a\u4e86\u5f97\u5230\u8d1f\u76f8\u7684\u503c\uff0c\u9700\u8981\u91c7\u7528\u5404\u79cd\u91c7\u6837\u65b9\u6cd5\uff0c\u5982 MCMC\u3002 \u91c7\u6837\u5f97\u5230 \\(\\hat{x}_{1-m}\\sim p_{model}(x|\\theta^t)\\) \uff0c\u90a3\u4e48\uff1a $$ \\theta^{t+1}=\\theta^t+\\eta(\\sum\\limits_{i=1}^m\\nabla_\\theta \\log \\hat{p}(x_i|\\theta^t)-\\sum\\limits_{i=1}^m\\nabla_\\theta\\log \\hat{p}(\\hat{x_i}|\\theta^t)) $$ \u8fd9\u4e2a\u7b97\u6cd5\u4e5f\u53eb\u505a\u57fa\u4e8e MCMC \u91c7\u6837\u7684\u68af\u5ea6\u4e0a\u5347\u3002\u6bcf\u6b21\u901a\u8fc7\u91c7\u6837\u5f97\u5230\u7684\u6837\u672c\u53eb\u505a\u5e7b\u60f3\u7c92\u5b50\uff0c\u5982\u679c\u8fd9\u4e9b\u5e7b\u60f3\u7c92\u5b50\u533a\u57df\u7684\u6982\u7387\u9ad8\u4e8e\u5b9e\u9645\u5206\u5e03\uff0c\u90a3\u4e48\u6700\u5927\u5316\u53c2\u6570\u7684\u7ed3\u679c\u5c31\u662f\u964d\u4f4e\u8fd9\u4e9b\u90e8\u5206\u7684\u6982\u7387\u3002","title":"\u5305\u542b\u914d\u5206\u51fd\u6570\u7684 MLE"},{"location":"Machine_Learning/22.PartitionFunction/#-cd-learning","text":"\u4e0a\u9762\u5bf9\u4e8e\u8d1f\u76f8\u7684\u91c7\u6837\uff0c\u6700\u5927\u7684\u95ee\u9898\u662f\uff0c\u91c7\u6837\u5230\u8fbe\u5e73\u7a33\u5206\u5e03\u7684\u6b65\u9aa4\u6570\u91cf\u662f\u672a\u77e5\u7684\u3002\u5bf9\u6bd4\u6563\u5ea6\u7684\u65b9\u6cd5\uff0c\u662f\u5bf9\u4e0a\u8ff0\u7684\u91c7\u6837\u662f\u7684\u521d\u59cb\u503c\u4f5c\u51fa\u9650\u5236\uff0c\u76f4\u63a5\u91c7\u6837 \\(\\hat{x}_i=x_i\\) \uff0c\u8fd9\u6837\u53ef\u4ee5\u7f29\u77ed\u91c7\u6837\u7684\u6df7\u5408\u65f6\u95f4\u3002\u8fd9\u4e2a\u7b97\u6cd5\u53eb\u505a CD-k \u7b97\u6cd5\uff0c \\(k\\) \u5c31\u662f\u521d\u59cb\u5316\u540e\u8fdb\u884c\u7684\u6f14\u5316\u65f6\u95f4\uff0c\u5f88\u591a\u65f6\u5019\uff0c\u5373\u4f7f \\(k=1\\) \u4e5f\u662f\u53ef\u4ee5\u7684\u3002 \u6211\u4eec\u770b MLE \u7684\u8868\u8fbe\u5f0f\uff1a $$ \\begin{align}\\hat{\\theta}&=\\mathop{argmax} {\\theta}p(x|\\theta)=\\mathop{argmax} \\frac{1}{N}\\sum\\limits_{i=1}^N\\log p(x_i|\\theta)=\\mathbb{E} {p }[\\log p_{model}(x|\\theta)]\\nonumber\\ &=\\mathop{argmax} \\theta\\int p \\log p_{model}dx\\nonumber\\ &=\\mathop{argmax} \\theta\\int p \\log \\frac{p_{model}}{p_{data}}dx\\nonumber\\ &=\\mathop{argmin} \\theta KL(p ||p_{model}) \\end{align} $$ \u5bf9\u4e8e CD-k \u7684\u91c7\u6837\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u5c06\u521d\u59cb\u503c\u8fd9\u4e9b\u70b9\u8868\u793a\u4e3a\uff1a $$ p^0=p_{data} $$ \u800c\u6211\u4eec\u7684\u6a21\u578b\u9700\u8981\u91c7\u6837\u8fc7\u7a0b\u8fbe\u5230\u5e73\u7a33\u5206\u5e03\uff1a $$ p^\\infty=p_{model} $$ \u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u7684\u662f \\(KL(p^0||p^\\infty)\\) \u3002\u5b9a\u4e49 CD\uff1a $$ KL(p^0||p^\\infty)-KL(p^k||p^\\infty) $$ \u8fd9\u5c31\u662f CD-k \u7b97\u6cd5\u7b2c \\(k\\) \u6b21\u91c7\u6837\u7684\u76ee\u6807\u51fd\u6570\u3002","title":"\u5bf9\u6bd4\u6563\u5ea6-CD Learning"},{"location":"Machine_Learning/22.PartitionFunction/#rbm","text":"RBM \u7684\u53c2\u6570\u4e3a\uff1a $$ \\begin{align} h=(h_1,\\cdots,h_m)^T\\ v=(v_1,\\cdots,v_n)^T\\ w=(w_{ij}) {mn}\\ \\alpha=(\\alpha_1,\\cdots,\\alpha_n)^T\\ \\beta=(\\beta_1,\\cdots,\\beta_m)^T \\end{align} $$ \u5b66\u4e60\u95ee\u9898\u5173\u6ce8\u7684\u6982\u7387\u5206\u5e03\u4e3a\uff1a $$ \\begin{align} \\log p(v)&=\\log\\sum\\limits p(h,v)\\nonumber\\ &=\\log\\sum\\limits_h\\frac{1}{Z}\\exp(-E(v,h))\\nonumber\\ &=\\log\\sum\\limits_{h}\\exp(-E(v,h))-\\log\\sum\\limits_{v,h}\\exp(-E(h,v)) \\end{align} $$ \u5bf9\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u6c42\u5bfc\u7b2c\u4e00\u9879\uff1a $$ \\frac{\\partial \\log\\sum\\limits_{h}\\exp(-E(v,h))}{\\partial\\theta}=-\\frac{\\sum\\limits_h\\exp(-E(v,h))\\frac{\\partial E(v,h)}{\\partial\\theta}}{\\sum\\limits_{h}\\exp(-E(v,h))}\\ =-\\sum\\limits_h\\frac{\\exp(-E(v,h))\\frac{\\partial E(v,h)}{\\partial\\theta}}{\\sum\\limits_{h}\\exp(-E(v,h))}=-\\sum\\limits_hp(h|v)\\frac{\\partial E(v,h)}{\\partial\\theta} $$ \u7b2c\u4e8c\u9879\uff1a $$ \\frac{\\partial \\log\\sum\\limits_{v,h}\\exp(-E(h,v))}{\\partial\\theta}=-\\sum\\limits_{h,v}\\frac{\\exp(-E(v,h))\\frac{\\partial E(v,h)}{\\partial\\theta}}{\\sum\\limits_{h,v}\\exp(-E(v,h))}=-\\sum\\limits_{v,h}p(v,h)\\frac{\\partial E(v,h)}{\\partial\\theta} $$ \u6240\u4ee5\u6709\uff1a $$ \\frac{\\partial}{\\partial\\theta}\\log p(v)=-\\sum\\limits_hp(h|v)\\frac{\\partial E(v,h)}{\\partial\\theta}+\\sum\\limits_{v,h}p(v,h)\\frac{\\partial E(v,h)}{\\partial\\theta} $$ \u5c06 RBM \u7684\u6a21\u578b\u5047\u8bbe\u4ee3\u5165\uff1a $$ E(v,h)=-(h^Twv+\\alpha^Tv+\\beta^Th) $$ \\(w_{ij}\\) \uff1a $$ \\frac{\\partial}{\\partial w_{ij}}E(v,h)=-h_iv_j $$ \u4e8e\u662f\uff1a $$ \\frac{\\partial}{\\partial\\theta}\\log p(v)=\\sum\\limits_{h}p(h|v)h_iv_j-\\sum\\limits_{h,v}p(h,v)h_iv_j $$ \u7b2c\u4e00\u9879\uff1a $$ \\sum\\limits_{h_1,h_2,\\cdots,h_m}p(h_1,h_2,\\cdots,h_m|v)h_iv_j=\\sum\\limits_{h_i}p(h_i|v)h_iv_j=p(h_i=1|v)v_j $$ \u8fd9\u91cc\u5047\u8bbe\u4e86 \\(h_i\\) \u662f\u4e8c\u5143\u53d8\u91cf\u3002 \u7b2c\u4e8c\u9879\uff1a $$ \\sum\\limits_{h,v}p(h,v)h_iv_j=\\sum\\limits_{h,v}p(v)p(h|v)h_iv_j=\\sum\\limits_vp(v)p(h_i=1|v)v_j $$ \u8fd9\u4e2a\u6c42\u548c\u662f\u6307\u6570\u9636\u7684\uff0c\u4e8e\u662f\u9700\u8981\u91c7\u6837\u89e3\u51b3\uff0c\u6211\u4e48\u4f7f\u7528 CD-k \u65b9\u6cd5\u3002 \u5bf9\u4e8e\u7b2c\u4e00\u9879\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u8bad\u7ec3\u6837\u672c\u5f97\u5230\uff0c\u7b2c\u4e8c\u9879\u91c7\u7528 CD-k \u91c7\u6837\u65b9\u6cd5\uff0c\u9996\u5148\u4f7f\u7528\u6837\u672c \\(v^0=v\\) \uff0c\u7136\u540e\u91c7\u6837\u5f97\u5230 \\(h^0\\) \uff0c\u7136\u540e\u91c7\u6837\u5f97\u5230 \\(v^1\\) \uff0c\u8fd9\u6837\u987a\u6b21\u8fdb\u884c\uff0c\u6700\u7ec8\u5f97\u5230 \\(v^k\\) \uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6837\u672c\u90fd\u5f97\u5230\u4e00\u4e2a \\(v^k\\) \uff0c\u6700\u7ec8\u91c7\u6837\u5f97\u5230 \\(N\\) \u4e2a $v^k $\uff0c\u4e8e\u662f\u7b2c\u4e8c\u9879\u5c31\u662f\uff1a $$ p(h_i=1|v^k)v_j^k $$ \u5177\u4f53\u7684\u7b97\u6cd5\u4e3a\uff1a \u5bf9\u6bcf\u4e00\u4e2a\u6837\u672c\u4e2d\u7684 \\(v\\) \uff0c\u8fdb\u884c\u91c7\u6837\uff1a \u4f7f\u7528\u8fd9\u4e2a\u6837\u672c\u521d\u59cb\u5316\u91c7\u6837 \u8fdb\u884c \\(k\\) \u6b21\u91c7\u6837\uff080-k-1\uff09\uff1a \\(h_i^l\\sim p(h_i|v^l)\\) \\(v_i^{l+1}\\sim p(v_i|h^l)\\) \u5c06\u8fd9\u4e9b\u91c7\u6837\u51fa\u6765\u7684\u7ed3\u679c\u7d2f\u52a0\u8fdb\u68af\u5ea6\u4e2d \u91cd\u590d\u8fdb\u884c\u4e0a\u8ff0\u8fc7\u7a0b\uff0c\u6700\u7ec8\u7684\u68af\u5ea6\u9664\u4ee5 \\(N\\)","title":"RBM \u7684\u5b66\u4e60\u95ee\u9898"},{"location":"Machine_Learning/23.ApproInference/","text":"\u8fd1\u4f3c\u63a8\u65ad \u8fd9\u4e00\u8bb2\u4e2d\u7684\u8fd1\u4f3c\u63a8\u65ad\u5177\u4f53\u63cf\u8ff0\u5728\u6df1\u5ea6\u751f\u6210\u6a21\u578b\u4e2d\u7684\u8fd1\u4f3c\u63a8\u65ad\u3002\u63a8\u65ad\u7684\u76ee\u7684\u6709\u4e0b\u9762\u51e0\u4e2a\u90e8\u5206\uff1a \u63a8\u65ad\u672c\u8eab\uff0c\u6839\u636e\u7ed3\u679c\uff08\u89c2\u6d4b\uff09\u5f97\u5230\u539f\u56e0\uff08\u9690\u53d8\u91cf\uff09\u3002 \u4e3a\u53c2\u6570\u7684\u5b66\u4e60\u63d0\u4f9b\u5e2e\u52a9\u3002 \u4f46\u662f\u63a8\u65ad\u672c\u8eab\u662f\u4e00\u4e2a\u56f0\u96be\u7684\u989d\u4efb\u52a1\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6\u5f80\u5f80\u5f88\u9ad8\uff0c\u5bf9\u4e8e\u65e0\u5411\u56fe\uff0c\u7531\u4e8e\u8282\u70b9\u4e4b\u95f4\u7684\u8054\u7cfb\u8fc7\u591a\uff0c\u90a3\u4e48\u56e0\u5b50\u5206\u89e3\u5f88\u96be\u8fdb\u884c\uff0c\u5e76\u4e14\u76f8\u4e92\u4e4b\u95f4\u90fd\u6709\u8026\u5408\uff0c\u4e8e\u662f\u5f88\u96be\u6c42\u89e3\uff0c\u4ec5\u4ec5\u5728\u67d0\u4e9b\u60c5\u51b5\u5982 RBM \u4e2d\u53ef\u89e3\uff0c\u5728\u6709\u5411\u56fe\u4e2d\uff0c\u5e38\u5e38\u7531\u4e8e\u6761\u4ef6\u72ec\u7acb\u6027\u95ee\u9898\uff0c\u5982\u4e24\u4e2a\u8282\u70b9\u4e4b\u95f4\u6761\u4ef6\u76f8\u5173\uff08explain away\uff09\uff0c\u4e8e\u662f\u6c42\u89e3\u8fd9\u4e9b\u8282\u70b9\u7684\u6761\u4ef6\u6982\u7387\u5c31\u5f88\u56f0\u96be\uff0c\u4ec5\u4ec5\u5728\u67d0\u4e9b\u6982\u7387\u5047\u8bbe\u60c5\u51b5\u4e0b\u53ef\u89e3\u5982\u9ad8\u65af\u6a21\u578b\uff0c\u4e8e\u662f\u9700\u8981\u8fd1\u4f3c\u63a8\u65ad\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u5e38\u5e38\u8bb2\u63a8\u65ad\u95ee\u9898\u53d8\u4e3a\u4f18\u5316\u95ee\u9898\uff0c\u5373\uff1a $$ Log-likehood:\\sum\\limits_{v\\in V}\\log p(v) $$ \u5bf9\u4e0a\u9762\u8fd9\u4e2a\u95ee\u9898\uff0c\u7531\u4e8e\uff1a $$ \\log p(v)=\\log\\frac{p(v,h)}{p(h|v)}=\\log\\frac{p(v,h)}{q(h|v)}+\\log\\frac{q(h|v)}{p(h|v)} $$ \u5de6\u53f3\u4e24\u8fb9\u5bf9 \\(h\\) \u79ef\u5206\uff1a $$ \\int_h\\log p(v)\\cdot q(h|v)dh=\\log p(v) $$ \u53f3\u8fb9\u79ef\u5206\u6709\uff1a $$ \\mathbb{E} {q(h|v)}[\\log\\frac{p(v,h)}{q(h|v)}]+KL(q(h|v)||p(h|v))=\\mathbb{E} [\\log p(v,h)]+H(q)+KL(q||p) $$ \u5176\u4e2d\u524d\u4e24\u9879\u662f ELBO\uff0c\u4e8e\u662f\u8fd9\u5c31\u53d8\u6210\u4e00\u4e2a\u4f18\u5316 ELBO \u7684\u95ee\u9898\u3002","title":"\u8fd1\u4f3c\u63a8\u65ad"},{"location":"Machine_Learning/23.ApproInference/#_1","text":"\u8fd9\u4e00\u8bb2\u4e2d\u7684\u8fd1\u4f3c\u63a8\u65ad\u5177\u4f53\u63cf\u8ff0\u5728\u6df1\u5ea6\u751f\u6210\u6a21\u578b\u4e2d\u7684\u8fd1\u4f3c\u63a8\u65ad\u3002\u63a8\u65ad\u7684\u76ee\u7684\u6709\u4e0b\u9762\u51e0\u4e2a\u90e8\u5206\uff1a \u63a8\u65ad\u672c\u8eab\uff0c\u6839\u636e\u7ed3\u679c\uff08\u89c2\u6d4b\uff09\u5f97\u5230\u539f\u56e0\uff08\u9690\u53d8\u91cf\uff09\u3002 \u4e3a\u53c2\u6570\u7684\u5b66\u4e60\u63d0\u4f9b\u5e2e\u52a9\u3002 \u4f46\u662f\u63a8\u65ad\u672c\u8eab\u662f\u4e00\u4e2a\u56f0\u96be\u7684\u989d\u4efb\u52a1\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6\u5f80\u5f80\u5f88\u9ad8\uff0c\u5bf9\u4e8e\u65e0\u5411\u56fe\uff0c\u7531\u4e8e\u8282\u70b9\u4e4b\u95f4\u7684\u8054\u7cfb\u8fc7\u591a\uff0c\u90a3\u4e48\u56e0\u5b50\u5206\u89e3\u5f88\u96be\u8fdb\u884c\uff0c\u5e76\u4e14\u76f8\u4e92\u4e4b\u95f4\u90fd\u6709\u8026\u5408\uff0c\u4e8e\u662f\u5f88\u96be\u6c42\u89e3\uff0c\u4ec5\u4ec5\u5728\u67d0\u4e9b\u60c5\u51b5\u5982 RBM \u4e2d\u53ef\u89e3\uff0c\u5728\u6709\u5411\u56fe\u4e2d\uff0c\u5e38\u5e38\u7531\u4e8e\u6761\u4ef6\u72ec\u7acb\u6027\u95ee\u9898\uff0c\u5982\u4e24\u4e2a\u8282\u70b9\u4e4b\u95f4\u6761\u4ef6\u76f8\u5173\uff08explain away\uff09\uff0c\u4e8e\u662f\u6c42\u89e3\u8fd9\u4e9b\u8282\u70b9\u7684\u6761\u4ef6\u6982\u7387\u5c31\u5f88\u56f0\u96be\uff0c\u4ec5\u4ec5\u5728\u67d0\u4e9b\u6982\u7387\u5047\u8bbe\u60c5\u51b5\u4e0b\u53ef\u89e3\u5982\u9ad8\u65af\u6a21\u578b\uff0c\u4e8e\u662f\u9700\u8981\u8fd1\u4f3c\u63a8\u65ad\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u5e38\u5e38\u8bb2\u63a8\u65ad\u95ee\u9898\u53d8\u4e3a\u4f18\u5316\u95ee\u9898\uff0c\u5373\uff1a $$ Log-likehood:\\sum\\limits_{v\\in V}\\log p(v) $$ \u5bf9\u4e0a\u9762\u8fd9\u4e2a\u95ee\u9898\uff0c\u7531\u4e8e\uff1a $$ \\log p(v)=\\log\\frac{p(v,h)}{p(h|v)}=\\log\\frac{p(v,h)}{q(h|v)}+\\log\\frac{q(h|v)}{p(h|v)} $$ \u5de6\u53f3\u4e24\u8fb9\u5bf9 \\(h\\) \u79ef\u5206\uff1a $$ \\int_h\\log p(v)\\cdot q(h|v)dh=\\log p(v) $$ \u53f3\u8fb9\u79ef\u5206\u6709\uff1a $$ \\mathbb{E} {q(h|v)}[\\log\\frac{p(v,h)}{q(h|v)}]+KL(q(h|v)||p(h|v))=\\mathbb{E} [\\log p(v,h)]+H(q)+KL(q||p) $$ \u5176\u4e2d\u524d\u4e24\u9879\u662f ELBO\uff0c\u4e8e\u662f\u8fd9\u5c31\u53d8\u6210\u4e00\u4e2a\u4f18\u5316 ELBO \u7684\u95ee\u9898\u3002","title":"\u8fd1\u4f3c\u63a8\u65ad"},{"location":"Machine_Learning/3.LinearClassification/","text":"\u7ebf\u6027\u5206\u7c7b \u5bf9\u4e8e\u5206\u7c7b\u4efb\u52a1\uff0c\u7ebf\u6027\u56de\u5f52\u6a21\u578b\u5c31\u65e0\u80fd\u4e3a\u529b\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5728\u7ebf\u6027\u6a21\u578b\u7684\u51fd\u6570\u8fdb\u884c\u540e\u518d\u52a0\u5165\u4e00\u5c42\u6fc0\u6d3b\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u662f\u975e\u7ebf\u6027\u7684\uff0c\u6fc0\u6d3b\u51fd\u6570\u7684\u53cd\u51fd\u6570\u53eb\u505a\u94fe\u63a5\u51fd\u6570\u3002\u6211\u4eec\u6709\u4e24\u79cd\u7ebf\u6027\u5206\u7c7b\u7684\u65b9\u5f0f\uff1a \u786c\u5206\u7c7b\uff0c\u6211\u4eec\u76f4\u63a5\u9700\u8981\u8f93\u51fa\u89c2\u6d4b\u5bf9\u5e94\u7684\u5206\u7c7b\u3002\u8fd9\u7c7b\u6a21\u578b\u7684\u4ee3\u8868\u4e3a\uff1a \u7ebf\u6027\u5224\u522b\u5206\u6790\uff08Fisher \u5224\u522b\uff09 \u611f\u77e5\u673a \u8f6f\u5206\u7c7b\uff0c\u4ea7\u751f\u4e0d\u540c\u7c7b\u522b\u7684\u6982\u7387\uff0c\u8fd9\u7c7b\u7b97\u6cd5\u6839\u636e\u6982\u7387\u65b9\u6cd5\u7684\u4e0d\u540c\u5206\u4e3a\u4e24\u79cd \u751f\u6210\u5f0f\uff08\u6839\u636e\u8d1d\u53f6\u65af\u5b9a\u7406\u5148\u8ba1\u7b97\u53c2\u6570\u540e\u9a8c\uff0c\u518d\u8fdb\u884c\u63a8\u65ad\uff09\uff1a\u9ad8\u65af\u5224\u522b\u5206\u6790\uff08GDA\uff09\u548c\u6734\u7d20\u8d1d\u53f6\u65af\u7b49\u4e3a\u4ee3\u8868 GDA Naive Bayes \u5224\u522b\u5f0f\uff08\u76f4\u63a5\u5bf9\u6761\u4ef6\u6982\u7387\u8fdb\u884c\u5efa\u6a21\uff09\uff1aLogistic \u56de\u5f52 \u4e24\u5206\u7c7b-\u786c\u5206\u7c7b-\u611f\u77e5\u673a\u7b97\u6cd5 \u6211\u4eec\u9009\u53d6\u6fc0\u6d3b\u51fd\u6570\u4e3a\uff1a $$ sign(a)=\\left{\\begin{matrix}+1,a\\ge0\\-1,a\\lt0\\end{matrix}\\right. $$ \u8fd9\u6837\u5c31\u53ef\u4ee5\u5c06\u7ebf\u6027\u56de\u5f52\u7684\u7ed3\u679c\u6620\u5c04\u5230\u4e24\u5206\u7c7b\u7684\u7ed3\u679c\u4e0a\u4e86\u3002 \u5b9a\u4e49\u635f\u5931\u51fd\u6570\u4e3a\u9519\u8bef\u5206\u7c7b\u7684\u6570\u76ee\uff0c\u6bd4\u8f83\u76f4\u89c2\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u6307\u793a\u51fd\u6570\uff0c\u4f46\u662f\u6307\u793a\u51fd\u6570\u4e0d\u53ef\u5bfc\uff0c\u56e0\u6b64\u53ef\u4ee5\u5b9a\u4e49\uff1a $$ L(w)=\\sum\\limits_{x_i\\in\\mathcal{D} {wrong}}-y_iw^Tx_i $$ \u5176\u4e2d\uff0c \\(\\mathcal{D}_{wrong}\\) \u662f\u9519\u8bef\u5206\u7c7b\u96c6\u5408\uff0c\u5b9e\u9645\u5728\u6bcf\u4e00\u6b21\u8bad\u7ec3\u7684\u65f6\u5019\uff0c\u6211\u4eec\u91c7\u7528\u68af\u5ea6\u4e0b\u964d\u7684\u7b97\u6cd5\u3002\u635f\u5931\u51fd\u6570\u5bf9 \\(w\\) \u7684\u504f\u5bfc\u4e3a\uff1a $$ \\frac{\\partial}{\\partial w}L(w)=\\sum\\limits {wrong}}-y_ix_i $$ \u4f46\u662f\u5982\u679c\u6837\u672c\u975e\u5e38\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6\u8f83\u9ad8\uff0c\u4f46\u662f\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u7edd\u5bf9\u7684\u635f\u5931\u51fd\u6570\u4e0b\u964d\u7684\u65b9\u5411\uff0c\u6211\u4eec\u53ea\u9700\u8981\u635f\u5931\u51fd\u6570\u7684\u671f\u671b\u503c\u4e0b\u964d\uff0c\u4f46\u662f\u8ba1\u7b97\u671f\u671b\u9700\u8981\u77e5\u9053\u771f\u5b9e\u7684\u6982\u7387\u5206\u5e03\uff0c\u6211\u4eec\u5b9e\u9645\u53ea\u80fd\u6839\u636e\u8bad\u7ec3\u6570\u636e\u62bd\u6837\u6765\u4f30\u7b97\u8fd9\u4e2a\u6982\u7387\u5206\u5e03\uff08\u7ecf\u9a8c\u98ce\u9669\uff09\uff1a $$ \\mathbb{E} [\\mathbb{E} \\hat{p}[\\nabla_wL(w)]]=\\mathbb{E} [\\frac{1}{N}\\sum\\limits_{i=1}^N\\nabla_wL(w)] $$ \u6211\u4eec\u77e5\u9053\uff0c \\(N\\) \u8d8a\u5927\uff0c\u6837\u672c\u8fd1\u4f3c\u771f\u5b9e\u5206\u5e03\u8d8a\u51c6\u786e\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e2a\u6807\u51c6\u5dee\u4e3a \\(\\sigma\\) \u7684\u6570\u636e\uff0c\u53ef\u4ee5\u786e\u5b9a\u7684\u6807\u51c6\u5dee\u4ec5\u548c \\(\\sqrt{N}\\) \u6210\u53cd\u6bd4\uff0c\u800c\u8ba1\u7b97\u901f\u5ea6\u5374\u548c \\(N\\) \u6210\u6b63\u6bd4\u3002\u56e0\u6b64\u53ef\u4ee5\u6bcf\u6b21\u4f7f\u7528\u8f83\u5c11\u6837\u672c\uff0c\u5219\u5728\u6570\u5b66\u671f\u671b\u7684\u610f\u4e49\u4e0a\u635f\u5931\u964d\u4f4e\u7684\u540c\u65f6\uff0c\u6709\u53ef\u4ee5\u63d0\u9ad8\u8ba1\u7b97\u901f\u5ea6\uff0c\u5982\u679c\u6bcf\u6b21\u53ea\u4f7f\u7528\u4e00\u4e2a\u9519\u8bef\u6837\u672c\uff0c\u6211\u4eec\u6709\u4e0b\u9762\u7684\u66f4\u65b0\u7b56\u7565\uff08\u6839\u636e\u6cf0\u52d2\u516c\u5f0f\uff0c\u5728\u8d1f\u65b9\u5411\uff09\uff1a $$ w^{t+1}\\leftarrow w^{t}+\\lambda y_ix_i $$ \u662f\u53ef\u4ee5\u6536\u655b\u7684\uff0c\u540c\u65f6\u4f7f\u7528\u5355\u4e2a\u89c2\u6d4b\u66f4\u65b0\u4e5f\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u589e\u52a0\u4e0d\u786e\u5b9a\u5ea6\uff0c\u4ece\u800c\u51cf\u8f7b\u9677\u5165\u5c40\u90e8\u6700\u5c0f\u7684\u53ef\u80fd\u3002\u5728\u66f4\u5927\u89c4\u6a21\u7684\u6570\u636e\u4e0a\uff0c\u5e38\u7528\u7684\u662f\u5c0f\u6279\u91cf\u968f\u673a\u68af\u5ea6\u4e0b\u964d\u6cd5\u3002 \u4e24\u5206\u7c7b-\u786c\u5206\u7c7b-\u7ebf\u6027\u5224\u522b\u5206\u6790 LDA \u5728 LDA \u4e2d\uff0c\u6211\u4eec\u7684\u57fa\u672c\u60f3\u6cd5\u662f\u9009\u5b9a\u4e00\u4e2a\u65b9\u5411\uff0c\u5c06\u8bd5\u9a8c\u6837\u672c\u987a\u7740\u8fd9\u4e2a\u65b9\u5411\u6295\u5f71\uff0c\u6295\u5f71\u540e\u7684\u6570\u636e\u9700\u8981\u6ee1\u8db3\u4e24\u4e2a\u6761\u4ef6\uff0c\u4ece\u800c\u53ef\u4ee5\u66f4\u597d\u5730\u5206\u7c7b\uff1a \u76f8\u540c\u7c7b\u5185\u90e8\u7684\u8bd5\u9a8c\u6837\u672c\u8ddd\u79bb\u63a5\u8fd1\u3002 \u4e0d\u540c\u7c7b\u522b\u4e4b\u95f4\u7684\u8ddd\u79bb\u8f83\u5927\u3002 \u9996\u5148\u662f\u6295\u5f71\uff0c\u6211\u4eec\u5047\u5b9a\u539f\u6765\u7684\u6570\u636e\u662f\u5411\u91cf \\(x\\) \uff0c\u90a3\u4e48\u987a\u7740 \\(w\\) \u65b9\u5411\u7684\u6295\u5f71\u5c31\u662f\u6807\u91cf\uff1a $$ z=w^T\\cdot x(=|w|\\cdot|x|\\cos\\theta) $$ \u5bf9\u7b2c\u4e00\u70b9\uff0c\u76f8\u540c\u7c7b\u5185\u90e8\u7684\u6837\u672c\u66f4\u4e3a\u63a5\u8fd1\uff0c\u6211\u4eec\u5047\u8bbe\u5c5e\u4e8e\u4e24\u7c7b\u7684\u8bd5\u9a8c\u6837\u672c\u6570\u91cf\u5206\u522b\u662f \\(N_1\\) \u548c \\(N_2\\) \uff0c\u90a3\u4e48\u6211\u4eec\u91c7\u7528\u65b9\u5dee\u77e9\u9635\u6765\u8868\u5f81\u6bcf\u4e00\u4e2a\u7c7b\u5185\u7684\u603b\u4f53\u5206\u5e03\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e86\u534f\u65b9\u5dee\u7684\u5b9a\u4e49\uff0c\u7528 \\(S\\) \u8868\u793a\u539f\u6570\u636e\u7684\u534f\u65b9\u5dee\uff1a $$ \\begin{align} C_1:Var_z[C_1]&=\\frac{1}{N_1}\\sum\\limits_{i=1}^{N_1}(z_i-\\overline{z_{c1}})(z_i-\\overline{z_{c1}})^T\\nonumber\\ &=\\frac{1}{N_1}\\sum\\limits_{i=1}^{N_1}(w^Tx_i-\\frac{1}{N_1}\\sum\\limits_{j=1}^{N_1}w^Tx_j)(w^Tx_i-\\frac{1}{N_1}\\sum\\limits_{j=1}^{N_1}w^Tx_j)^T\\nonumber\\ &=w^T\\frac{1}{N_1}\\sum\\limits_{i=1}^{N_1}(x_i-\\overline{x_{c1}})(x_i-\\overline{x_{c1}})^Tw\\nonumber\\ &=w^TS_1w\\ C_2:Var_z[C_2]&=\\frac{1}{N_2}\\sum\\limits_{i=1}^{N_2}(z_i-\\overline{z_{c2}})(z_i-\\overline{z_{c2}})^T\\nonumber\\ &=w^TS_2w \\end{align} $$ \u6240\u4ee5\u7c7b\u5185\u8ddd\u79bb\u53ef\u4ee5\u8bb0\u4e3a\uff1a $$ \\begin{align} Var_z[C_1]+Var_z[C_2]=w^T(S_1+S_2)w \\end{align} $$ \u5bf9\u4e8e\u7b2c\u4e8c\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u7c7b\u7684\u5747\u503c\u8868\u793a\u8fd9\u4e2a\u8ddd\u79bb\uff1a $$ \\begin{align} (\\overline{z_{c1}}-\\overline{z_{c2}})^2&=(\\frac{1}{N_1}\\sum\\limits_{i=1}^{N_1}w^Tx_i-\\frac{1}{N_2}\\sum\\limits_{i=1}^{N_2}w^Tx_i)^2\\nonumber\\ &=(w^T(\\overline{x_{c1}}-\\overline{x_{c2}}))^2\\nonumber\\ &=w^T(\\overline{x_{c1}}-\\overline{x_{c2}})(\\overline{x_{c1}}-\\overline{x_{c2}})^Tw \\end{align} $$ \u7efc\u5408\u8fd9\u4e24\u70b9\uff0c\u7531\u4e8e\u534f\u65b9\u5dee\u662f\u4e00\u4e2a\u77e9\u9635\uff0c\u4e8e\u662f\u6211\u4eec\u7528\u5c06\u8fd9\u4e24\u4e2a\u503c\u76f8\u9664\u6765\u5f97\u5230\u6211\u4eec\u7684\u635f\u5931\u51fd\u6570\uff0c\u5e76\u6700\u5927\u5316\u8fd9\u4e2a\u503c\uff1a $$ \\begin{align} \\hat{w}=\\mathop{argmax}\\limits_wJ(w)&=\\mathop{argmax}\\limits_w\\frac{(\\overline{z_{c1}}-\\overline{z_{c2}})^2}{Var_z[C_1]+Var_z[C_2]}\\nonumber\\ &=\\mathop{argmax}\\limits_w\\frac{w^T(\\overline{x_{c1}}-\\overline{x_{c2}})(\\overline{x_{c1}}-\\overline{x_{c2}})^Tw}{w^T(S_1+S_2)w}\\nonumber\\ &=\\mathop{argmax}\\limits_w\\frac{w^TS_bw}{w^TS_ww} \\end{align} $$ \u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u628a\u635f\u5931\u51fd\u6570\u548c\u539f\u6570\u636e\u96c6\u4ee5\u53ca\u53c2\u6570\u7ed3\u5408\u8d77\u6765\u4e86\u3002\u4e0b\u9762\u5bf9\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u6c42\u504f\u5bfc\uff0c\u6ce8\u610f\u6211\u4eec\u5176\u5b9e\u5bf9 \\(w\\) \u7684\u7edd\u5bf9\u503c\u6ca1\u6709\u4efb\u4f55\u8981\u6c42\uff0c\u53ea\u5bf9\u65b9\u5411\u6709\u8981\u6c42\uff0c\u56e0\u6b64\u53ea\u8981\u4e00\u4e2a\u65b9\u7a0b\u5c31\u53ef\u4ee5\u6c42\u89e3\u4e86\uff1a $$ \\begin{align} &\\frac{\\partial}{\\partial w}J(w)=2S_bw(w^TS_ww)^{-1}-2w^TS_bw(w^TS_ww)^{-2}S_ww=0\\nonumber\\ &\\Longrightarrow S_bw(w^TS_ww)=(w^TS_bw)S_ww\\nonumber\\ &\\Longrightarrow w\\propto S_w^{-1}S_bw=S_w^{-1}(\\overline{x_{c1}}-\\overline{x_{c2}})(\\overline{x_{c1}}-\\overline{x_{c2}})^Tw\\propto S_w^{-1}(\\overline{x_{c1}}-\\overline{x_{c2}}) \\end{align} $$ \u4e8e\u662f \\(S_w^{-1}(\\overline{x_{c1}}-\\overline{x_{c2}})\\) \u5c31\u662f\u6211\u4eec\u9700\u8981\u5bfb\u627e\u7684\u65b9\u5411\u3002\u6700\u540e\u53ef\u4ee5\u5f52\u4e00\u5316\u6c42\u5f97\u5355\u4f4d\u7684 \\(w\\) \u503c\u3002 \u4e24\u5206\u7c7b-\u8f6f\u5206\u7c7b-\u6982\u7387\u5224\u522b\u6a21\u578b-Logistic \u56de\u5f52 \u6709\u65f6\u5019\u6211\u4eec\u53ea\u8981\u5f97\u5230\u4e00\u4e2a\u7c7b\u522b\u7684\u6982\u7387\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u4e00\u79cd\u80fd\u8f93\u51fa \\([0,1]\\) \u533a\u95f4\u7684\u503c\u7684\u51fd\u6570\u3002\u8003\u8651\u4e24\u5206\u7c7b\u6a21\u578b\uff0c\u6211\u4eec\u5229\u7528\u5224\u522b\u6a21\u578b\uff0c\u5e0c\u671b\u5bf9 \\(p(C|x)\\) \u5efa\u6a21\uff0c\u5229\u7528\u8d1d\u53f6\u65af\u5b9a\u7406\uff1a $$ p(C_1|x)=\\frac{p(x|C_1)p(C_1)}{p(x|C_1)p(C_1)+p(x|C_2)p(C_2)} $$ \u53d6 \\(a=\\ln\\frac{p(x|C_1)p(C_1)}{p(x|C_2)p(C_2)}\\) \uff0c\u4e8e\u662f\uff1a $$ p(C_1|x)=\\frac{1}{1+\\exp(-a)} $$ \u4e0a\u9762\u7684\u5f0f\u5b50\u53eb Logistic Sigmoid \u51fd\u6570\uff0c\u5176\u53c2\u6570\u8868\u793a\u4e86\u4e24\u7c7b\u8054\u5408\u6982\u7387\u6bd4\u503c\u7684\u5bf9\u6570\u3002\u5728\u5224\u522b\u5f0f\u4e2d\uff0c\u4e0d\u5173\u5fc3\u8fd9\u4e2a\u53c2\u6570\u7684\u5177\u4f53\u503c\uff0c\u6a21\u578b\u5047\u8bbe\u76f4\u63a5\u5bf9 \\(a\\) \u8fdb\u884c\u3002 Logistic \u56de\u5f52\u7684\u6a21\u578b\u5047\u8bbe\u662f\uff1a $$ a=w^Tx $$ \u4e8e\u662f\uff0c\u901a\u8fc7\u5bfb\u627e $ w$\u7684\u6700\u4f73\u503c\u53ef\u4ee5\u5f97\u5230\u5728\u8fd9\u4e2a\u6a21\u578b\u5047\u8bbe\u4e0b\u7684\u6700\u4f73\u6a21\u578b\u3002\u6982\u7387\u5224\u522b\u6a21\u578b\u5e38\u7528\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u7684\u65b9\u5f0f\u6765\u786e\u5b9a\u53c2\u6570\u3002 \u5bf9\u4e8e\u4e00\u6b21\u89c2\u6d4b\uff0c\u83b7\u5f97\u5206\u7c7b \\(y\\) \u7684\u6982\u7387\u4e3a\uff08\u5047\u5b9a \\(C_1=1,C_2=0\\) \uff09\uff1a $$ p(y|x)=p_1^yp_0^{1-y} $$ \u90a3\u4e48\u5bf9\u4e8e \\(N\\) \u6b21\u72ec\u7acb\u5168\u540c\u7684\u89c2\u6d4b MLE\u4e3a\uff1a $$ \\hat{w}=\\mathop{argmax} wJ(w)=\\mathop{argmax}_w\\sum\\limits ^N(y_i\\log p_1+(1-y_i)\\log p_0) $$ \u6ce8\u610f\u5230\uff0c\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u662f\u4ea4\u53c9\u71b5\u8868\u8fbe\u5f0f\u7684\u76f8\u53cd\u6570\u4e58 \\(N\\) \uff0cMLE \u4e2d\u7684\u5bf9\u6570\u4e5f\u4fdd\u8bc1\u4e86\u53ef\u4ee5\u548c\u6307\u6570\u51fd\u6570\u76f8\u5339\u914d\uff0c\u4ece\u800c\u5728\u5927\u7684\u533a\u95f4\u6c47\u603b\u83b7\u53d6\u7a33\u5b9a\u7684\u68af\u5ea6\u3002 \u5bf9\u8fd9\u4e2a\u51fd\u6570\u6c42\u5bfc\u6570\uff0c\u6ce8\u610f\u5230\uff1a $$ p_1'=(\\frac{1}{1+\\exp(-a)})'=p_1(1-p_1) $$ \u5219\uff1a $$ J'(w)=\\sum\\limits_{i=1}^Ny_i(1-p_1)x_i-p_1x_i+y_ip_1x_i=\\sum\\limits_{i=1}^N(y_i-p_1)x_i $$ \u7531\u4e8e\u6982\u7387\u503c\u7684\u975e\u7ebf\u6027\uff0c\u653e\u5728\u6c42\u548c\u7b26\u53f7\u4e2d\u65f6\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u65e0\u6cd5\u76f4\u63a5\u6c42\u89e3\u3002\u4e8e\u662f\u5728\u5b9e\u9645\u8bad\u7ec3\u7684\u65f6\u5019\uff0c\u548c\u611f\u77e5\u673a\u7c7b\u4f3c\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u5927\u5c0f\u7684\u6279\u91cf\u968f\u673a\u68af\u5ea6\u4e0a\u5347\uff08\u5bf9\u4e8e\u6700\u5c0f\u5316\u5c31\u662f\u68af\u5ea6\u4e0b\u964d\uff09\u6765\u83b7\u5f97\u8fd9\u4e2a\u51fd\u6570\u7684\u6781\u5927\u503c\u3002 \u4e24\u5206\u7c7b-\u8f6f\u5206\u7c7b-\u6982\u7387\u751f\u6210\u6a21\u578b-\u9ad8\u65af\u5224\u522b\u5206\u6790 GDA \u751f\u6210\u6a21\u578b\u4e2d\uff0c\u6211\u4eec\u5bf9\u8054\u5408\u6982\u7387\u5206\u5e03\u8fdb\u884c\u5efa\u6a21\uff0c\u7136\u540e\u91c7\u7528 MAP \u6765\u83b7\u5f97\u53c2\u6570\u7684\u6700\u4f73\u503c\u3002\u4e24\u5206\u7c7b\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u91c7\u7528\u7684\u5047\u8bbe\uff1a \\(y\\sim Bernoulli(\\phi)\\) \\(x|y=1\\sim\\mathcal{N}(\\mu_1,\\Sigma)\\) \\(x|y=0\\sim\\mathcal{N}(\\mu_0,\\Sigma)\\) \u90a3\u4e48\u72ec\u7acb\u5168\u540c\u7684\u6570\u636e\u96c6\u6700\u5927\u540e\u9a8c\u6982\u7387\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a $$ \\begin{align} \\mathop{argmax} {\\phi,\\mu_0,\\mu_1,\\Sigma}\\log p(X|Y)p(Y)=\\mathop{argmax} \\sum\\limits_{i=1}^N (\\log p(x_i|y_i)+\\log p(y_i))\\nonumber\\ =\\mathop{argmax} {\\phi,\\mu_0,\\mu_1,\\Sigma}\\sum\\limits ^N((1-y_i)\\log\\mathcal{N}(\\mu_0,\\Sigma)+y_i\\log \\mathcal{N}(\\mu_1,\\Sigma)+y_i\\log\\phi+(1-y_i)\\log(1-\\phi)) \\end{align} $$ \u9996\u5148\u5bf9 \\(\\phi\\) \u8fdb\u884c\u6c42\u89e3\uff0c\u5c06\u5f0f\u5b50\u5bf9 \\(\\phi\\) \u6c42\u504f\u5bfc\uff1a $$ \\begin{align}\\sum\\limits_{i=1}^N\\frac{y_i}{\\phi}+\\frac{y_i-1}{1-\\phi}=0\\nonumber\\ \\Longrightarrow\\phi=\\frac{\\sum\\limits_{i=1}^Ny_i}{N}=\\frac{N_1}{N} \\end{align} $$ \u7136\u540e\u6c42\u89e3 \\(\\mu_1\\) \uff1a $$ \\begin{align}\\hat{\\mu_1}&=\\mathop{argmax} {\\mu_1}\\sum\\limits ^Ny_i\\log\\mathcal{N}(\\mu_1,\\Sigma)\\nonumber\\ &=\\mathop{argmin} {\\mu_1}\\sum\\limits ^Ny_i(x_i-\\mu_1)^T\\Sigma^{-1}(x_i-\\mu_1) \\end{align} $$ \u7531\u4e8e\uff1a $$ \\sum\\limits_{i=1}^Ny_i(x_i-\\mu_1)^T\\Sigma^{-1}(x_i-\\mu_1)=\\sum\\limits_{i=1}^Ny_ix_i^T\\Sigma^{-1}x_i-2y_i\\mu_1^T\\Sigma^{-1}x_i+y_i\\mu_1^T\\Sigma^{-1}\\mu_1 $$ \u6c42\u5fae\u5206\u5de6\u8fb9\u4e58\u4ee5 \\(\\Sigma\\) \u53ef\u4ee5\u5f97\u5230\uff1a $$ \\begin{align}\\sum\\limits_{i=1}^N-2y_i\\Sigma^{-1}x_i+2y_i\\Sigma^{-1}\\mu_1=0\\nonumber\\ \\Longrightarrow\\mu_1=\\frac{\\sum\\limits_{i=1}^Ny_ix_i}{\\sum\\limits_{i=1}^Ny_i}=\\frac{\\sum\\limits_{i=1}^Ny_ix_i}{N_1} \\end{align} $$ \u6c42\u89e3 \\(\\mu_0\\) \uff0c\u7531\u4e8e\u6b63\u53cd\u4f8b\u662f\u5bf9\u79f0\u7684\uff0c\u6240\u4ee5\uff1a $$ \\mu_0=\\frac{\\sum\\limits_{i=1}^N(1-y_i)x_i}{N_0} $$ \u6700\u4e3a\u56f0\u96be\u7684\u662f\u6c42\u89e3 \\(\\Sigma\\) \uff0c\u6211\u4eec\u7684\u6a21\u578b\u5047\u8bbe\u5bf9\u6b63\u53cd\u4f8b\u91c7\u7528\u76f8\u540c\u7684\u534f\u65b9\u5dee\u77e9\u9635\uff0c\u5f53\u7136\u4ece\u4e0a\u9762\u7684\u6c42\u89e3\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u5373\u4f7f\u91c7\u7528\u4e0d\u540c\u7684\u77e9\u9635\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u4e4b\u524d\u7684\u4e09\u4e2a\u53c2\u6570\u3002\u9996\u5148\u6211\u4eec\u6709\uff1a $$ \\begin{align} \\sum\\limits_{i=1}^N\\log\\mathcal{N}(\\mu,\\Sigma)&=\\sum\\limits_{i=1}^N\\log(\\frac{1}{(2\\pi)^{p/2}|\\Sigma|^{1/2}})+(-\\frac{1}{2}(x_i-\\mu)^T\\Sigma^{-1}(x_i-\\mu))\\nonumber\\ &=Const-\\frac{1}{2}N\\log|\\Sigma|-\\frac{1}{2}Trace((x_i-\\mu)^T\\Sigma^{-1}(x_i-\\mu))\\nonumber\\ &=Const-\\frac{1}{2}N\\log|\\Sigma|-\\frac{1}{2}Trace((x_i-\\mu)(x_i-\\mu)^T\\Sigma^{-1})\\nonumber\\ &=Const-\\frac{1}{2}N\\log|\\Sigma|-\\frac{1}{2}NTrace(S\\Sigma^{-1}) \\end{align} $$ \u5728\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u4e2d\uff0c\u6211\u4eec\u5728\u6807\u91cf\u4e0a\u52a0\u5165\u8ff9\u4ece\u800c\u53ef\u4ee5\u4ea4\u6362\u77e9\u9635\u7684\u987a\u5e8f\uff0c\u5bf9\u4e8e\u5305\u542b\u7edd\u5bf9\u503c\u548c\u8ff9\u7684\u8868\u8fbe\u5f0f\u7684\u5bfc\u6570\uff0c\u6211\u4eec\u6709\uff1a $$ \\begin{align} \\frac{\\partial}{\\partial A}(|A|)&=|A|A^{-1}\\ \\frac{\\partial}{\\partial A}Trace(AB)&=B^T \\end{align} $$ \u56e0\u6b64\uff1a $$ \\begin{align}[\\sum\\limits_{i=1}^N((1-y_i)\\log\\mathcal{N}(\\mu_0,\\Sigma)+y_i\\log \\mathcal{N}(\\mu_1,\\Sigma)]' \\nonumber\\=Const-\\frac{1}{2}N\\log|\\Sigma|-\\frac{1}{2}N_1Trace(S_1\\Sigma^{-1})-\\frac{1}{2}N_2Trace(S_2\\Sigma^{-1}) \\end{align} $$ \u5176\u4e2d\uff0c \\(S_1,S_2\\) \u5206\u522b\u4e3a\u4e24\u4e2a\u7c7b\u6570\u636e\u5185\u90e8\u7684\u534f\u65b9\u5dee\u77e9\u9635\uff0c\u4e8e\u662f\uff1a $$ \\begin{align}N\\Sigma^{-1}-N_1S_1^T\\Sigma^{-2}-N_2S_2^T\\Sigma^{-2}=0\\nonumber \\\\Longrightarrow\\Sigma=\\frac{N_1S_1+N_2S_2}{N} \\end{align} $$ \u8fd9\u91cc\u5e94\u7528\u4e86\u7c7b\u534f\u65b9\u5dee\u77e9\u9635\u7684\u5bf9\u79f0\u6027\u3002 \u4e8e\u662f\u6211\u4eec\u5c31\u5229\u7528\u6700\u5927\u540e\u9a8c\u7684\u65b9\u6cd5\u6c42\u5f97\u4e86\u6211\u4eec\u6a21\u578b\u5047\u8bbe\u91cc\u9762\u7684\u6240\u6709\u53c2\u6570\uff0c\u6839\u636e\u6a21\u578b\uff0c\u53ef\u4ee5\u5f97\u5230\u8054\u5408\u5206\u5e03\uff0c\u4e5f\u5c31\u53ef\u4ee5\u5f97\u5230\u7528\u4e8e\u63a8\u65ad\u7684\u6761\u4ef6\u5206\u5e03\u4e86\u3002 \u4e24\u5206\u7c7b-\u8f6f\u5206\u7c7b-\u6982\u7387\u751f\u6210\u6a21\u578b-\u6734\u7d20\u8d1d\u53f6\u65af \u4e0a\u9762\u7684\u9ad8\u65af\u5224\u522b\u5206\u6790\u7684\u662f\u5bf9\u6570\u636e\u96c6\u7684\u5206\u5e03\u4f5c\u51fa\u4e86\u9ad8\u65af\u5206\u5e03\u7684\u5047\u8bbe\uff0c\u540c\u65f6\u5f15\u5165\u4f2f\u52aa\u5229\u5206\u5e03\u4f5c\u4e3a\u7c7b\u5148\u9a8c\uff0c\u4ece\u800c\u5229\u7528\u6700\u5927\u540e\u9a8c\u6c42\u5f97\u8fd9\u4e9b\u5047\u8bbe\u4e2d\u7684\u53c2\u6570\u3002 \u6734\u7d20\u8d1d\u53f6\u65af\u961f\u6570\u636e\u7684\u5c5e\u6027\u4e4b\u95f4\u7684\u5173\u7cfb\u4f5c\u51fa\u4e86\u5047\u8bbe\uff0c\u4e00\u822c\u5730\uff0c\u6211\u4eec\u6709\u9700\u8981\u5f97\u5230 \\(p(x|y)\\) \u8fd9\u4e2a\u6982\u7387\u503c\uff0c\u7531\u4e8e \\(x\\) \u6709 \\(p\\) \u4e2a\u7ef4\u5ea6\uff0c\u56e0\u6b64\u9700\u8981\u5bf9\u8fd9\u4e48\u591a\u7684\u7ef4\u5ea6\u7684\u8054\u5408\u6982\u7387\u8fdb\u884c\u91c7\u6837\uff0c\u4f46\u662f\u6211\u4eec\u77e5\u9053\u8fd9\u4e48\u9ad8\u7ef4\u5ea6\u7684\u7a7a\u95f4\u4e2d\u91c7\u6837\u9700\u8981\u7684\u6837\u672c\u6570\u91cf\u975e\u5e38\u5927\u624d\u80fd\u83b7\u5f97\u8f83\u4e3a\u51c6\u786e\u7684\u6982\u7387\u8fd1\u4f3c\u3002 \u5728\u4e00\u822c\u7684\u6709\u5411\u6982\u7387\u56fe\u6a21\u578b\u4e2d\uff0c\u5bf9\u5404\u4e2a\u5c5e\u6027\u7ef4\u5ea6\u4e4b\u95f4\u7684\u6761\u4ef6\u72ec\u7acb\u5173\u7cfb\u4f5c\u51fa\u4e86\u4e0d\u540c\u7684\u5047\u8bbe\uff0c\u5176\u4e2d\u6700\u4e3a\u7b80\u5355\u7684\u4e00\u4e2a\u5047\u8bbe\u5c31\u662f\u5728\u6734\u7d20\u8d1d\u53f6\u65af\u6a21\u578b\u63cf\u8ff0\u4e2d\u7684\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\u3002 $$ p(x|y)=\\prod\\limits_{i=1}^pp(x_i|y) $$ \u5373\uff1a $$ x_i\\perp x_j|y,\\forall\\ i\\ne j $$ \u4e8e\u662f\u5229\u7528\u8d1d\u53f6\u65af\u5b9a\u7406\uff0c\u5bf9\u4e8e\u5355\u6b21\u89c2\u6d4b\uff1a $$ p(y|x)=\\frac{p(x|y)p(y)}{p(x)}=\\frac{\\prod\\limits_{i=1}^pp(x_i|y)p(y)}{p(x)} $$ \u5bf9\u4e8e\u5355\u4e2a\u7ef4\u5ea6\u7684\u6761\u4ef6\u6982\u7387\u4ee5\u53ca\u7c7b\u5148\u9a8c\u4f5c\u51fa\u8fdb\u4e00\u6b65\u7684\u5047\u8bbe\uff1a \\(x_i\\) \u4e3a\u8fde\u7eed\u53d8\u91cf\uff1a \\(p(x_i|y)=\\mathcal{N}(\\mu_i,\\sigma_i^2)\\) \\(x_i\\) \u4e3a\u79bb\u6563\u53d8\u91cf\uff1a\u7c7b\u522b\u5206\u5e03\uff08Categorical\uff09\uff1a \\(p(x_i=i|y)=\\theta_i,\\sum\\limits_{i=1}^K\\theta_i=1\\) \\(p(y)=\\phi^y(1-\\phi)^{1-y}\\) \u5bf9\u8fd9\u4e9b\u53c2\u6570\u7684\u4f30\u8ba1\uff0c\u5e38\u7528 MLE \u7684\u65b9\u6cd5\u76f4\u63a5\u5728\u6570\u636e\u96c6\u4e0a\u4f30\u8ba1\uff0c\u7531\u4e8e\u4e0d\u9700\u8981\u77e5\u9053\u5404\u4e2a\u7ef4\u5ea6\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u56e0\u6b64\uff0c\u6240\u9700\u6570\u636e\u91cf\u5927\u5927\u51cf\u5c11\u4e86\u3002\u4f30\u7b97\u5b8c\u8fd9\u4e9b\u53c2\u6570\uff0c\u518d\u4ee3\u5165\u8d1d\u53f6\u65af\u5b9a\u7406\u4e2d\u5f97\u5230\u7c7b\u522b\u7684\u540e\u9a8c\u5206\u5e03\u3002 \u5c0f\u7ed3 \u5206\u7c7b\u4efb\u52a1\u5206\u4e3a\u4e24\u7c7b\uff0c\u5bf9\u4e8e\u9700\u8981\u76f4\u63a5\u8f93\u51fa\u7c7b\u522b\u7684\u4efb\u52a1\uff0c\u611f\u77e5\u673a\u7b97\u6cd5\u4e2d\u6211\u4eec\u5728\u7ebf\u6027\u6a21\u578b\u7684\u57fa\u7840\u4e0a\u52a0\u5165\u7b26\u53f7\u51fd\u6570\u4f5c\u4e3a\u6fc0\u6d3b\u51fd\u6570\uff0c\u90a3\u4e48\u5c31\u80fd\u5f97\u5230\u8fd9\u4e2a\u7c7b\u522b\uff0c\u4f46\u662f\u7b26\u53f7\u51fd\u6570\u4e0d\u5149\u6ed1\uff0c\u4e8e\u662f\u6211\u4eec\u91c7\u7528\u9519\u8bef\u9a71\u52a8\u7684\u65b9\u5f0f\uff0c\u5f15\u5165 \\(\\sum\\limits_{x_i\\in\\mathcal{D}_{wrong}}-y_iw^Tx_i\\) \u4f5c\u4e3a\u635f\u5931\u51fd\u6570\uff0c\u7136\u540e\u6700\u5c0f\u5316\u8fd9\u4e2a\u8bef\u5dee\uff0c\u91c7\u7528\u6279\u91cf\u968f\u673a\u68af\u5ea6\u4e0b\u964d\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u6700\u4f73\u7684\u53c2\u6570\u503c\u3002\u800c\u5728\u7ebf\u6027\u5224\u522b\u5206\u6790\u4e2d\uff0c\u6211\u4eec\u5c06\u7ebf\u6027\u6a21\u578b\u770b\u4f5c\u662f\u6570\u636e\u70b9\u5728\u67d0\u4e00\u4e2a\u65b9\u5411\u7684\u6295\u5f71\uff0c\u91c7\u7528\u7c7b\u5185\u5c0f\uff0c\u7c7b\u95f4\u5927\u7684\u601d\u8def\u6765\u5b9a\u4e49\u635f\u5931\u51fd\u6570\uff0c\u5176\u4e2d\u7c7b\u5185\u5c0f\u5b9a\u4e49\u4e3a\u4e24\u7c7b\u6570\u636e\u7684\u65b9\u5dee\u4e4b\u548c\uff0c\u7c7b\u95f4\u5927\u5b9a\u4e49\u4e3a\u4e24\u7c7b\u6570\u636e\u4e2d\u5fc3\u70b9\u7684\u95f4\u8ddd\uff0c\u5bf9\u635f\u5931\u51fd\u6570\u6c42\u5bfc\u5f97\u5230\u53c2\u6570\u7684\u65b9\u5411\uff0c\u8fd9\u4e2a\u65b9\u5411\u5c31\u662f \\(S_w^{-1}(\\overline x_{c1}-\\overline x_{c2})\\) \uff0c\u5176\u4e2d \\(S_w\\) \u4e3a\u539f\u6570\u636e\u96c6\u4e24\u7c7b\u7684\u65b9\u5dee\u4e4b\u548c\u3002 \u53e6\u4e00\u79cd\u4efb\u52a1\u662f\u8f93\u51fa\u5206\u7c7b\u7684\u6982\u7387\uff0c\u5bf9\u4e8e\u6982\u7387\u6a21\u578b\uff0c\u6211\u4eec\u6709\u4e24\u79cd\u65b9\u6848\uff0c\u7b2c\u4e00\u79cd\u662f\u5224\u522b\u6a21\u578b\uff0c\u4e5f\u5c31\u662f\u76f4\u63a5\u5bf9\u7c7b\u522b\u7684\u6761\u4ef6\u6982\u7387\u5efa\u6a21\uff0c\u5c06\u7ebf\u6027\u6a21\u578b\u5957\u5165 Logistic \u51fd\u6570\u4e2d\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86 Logistic \u56de\u5f52\u6a21\u578b\uff0c\u8fd9\u91cc\u7684\u6982\u7387\u89e3\u91ca\u662f\u4e24\u7c7b\u7684\u8054\u5408\u6982\u7387\u6bd4\u503c\u7684\u5bf9\u6570\u662f\u7ebf\u6027\u7684\uff0c\u6211\u4eec\u5b9a\u4e49\u7684\u635f\u5931\u51fd\u6570\u662f\u4ea4\u53c9\u71b5\uff08\u7b49\u4ef7\u4e8e MLE\uff09\uff0c\u5bf9\u8fd9\u4e2a\u51fd\u6570\u6c42\u5bfc\u5f97\u5230 \\(\\frac{1}{N}\\sum\\limits_{i=1}^N(y_i-p_1)x_i\\) \uff0c\u540c\u6837\u5229\u7528\u6279\u91cf\u968f\u673a\u68af\u5ea6\uff08\u4e0a\u5347\uff09\u7684\u65b9\u6cd5\u8fdb\u884c\u4f18\u5316\u3002\u7b2c\u4e8c\u79cd\u662f\u751f\u6210\u6a21\u578b\uff0c\u751f\u6210\u6a21\u578b\u5f15\u5165\u4e86\u7c7b\u522b\u7684\u5148\u9a8c\uff0c\u5728\u9ad8\u65af\u5224\u522b\u5206\u6790\u4e2d\uff0c\u6211\u4eec\u5bf9\u6570\u636e\u96c6\u7684\u6570\u636e\u5206\u5e03\u4f5c\u51fa\u4e86\u5047\u8bbe\uff0c\u5176\u4e2d\u7c7b\u5148\u9a8c\u662f\u4e8c\u9879\u5206\u5e03\uff0c\u800c\u6bcf\u4e00\u7c7b\u7684\u4f3c\u7136\u662f\u9ad8\u65af\u5206\u5e03\uff0c\u5bf9\u8fd9\u4e2a\u8054\u5408\u5206\u5e03\u7684\u5bf9\u6570\u4f3c\u7136\u8fdb\u884c\u6700\u5927\u5316\u5c31\u5f97\u5230\u4e86\u53c2\u6570\uff0c \\(\\frac{\\sum\\limits_{i=1}^Ny_ix_i}{N_1},\\frac{\\sum\\limits_{i=1}^N(1-y_i)x_i}{N_0},\\frac{N_1S_1+N_2S_2}{N},\\frac{N_1}{N}\\) \u3002\u5728\u6734\u7d20\u8d1d\u53f6\u65af\u4e2d\uff0c\u6211\u4eec\u8fdb\u4e00\u6b65\u5bf9\u5c5e\u6027\u7684\u5404\u4e2a\u7ef4\u5ea6\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u4f5c\u51fa\u5047\u8bbe\uff0c\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\u5927\u5927\u51cf\u5c11\u4e86\u6570\u636e\u91cf\u7684\u9700\u6c42\u3002","title":"3.LinearClassification"},{"location":"Machine_Learning/3.LinearClassification/#_1","text":"\u5bf9\u4e8e\u5206\u7c7b\u4efb\u52a1\uff0c\u7ebf\u6027\u56de\u5f52\u6a21\u578b\u5c31\u65e0\u80fd\u4e3a\u529b\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5728\u7ebf\u6027\u6a21\u578b\u7684\u51fd\u6570\u8fdb\u884c\u540e\u518d\u52a0\u5165\u4e00\u5c42\u6fc0\u6d3b\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u662f\u975e\u7ebf\u6027\u7684\uff0c\u6fc0\u6d3b\u51fd\u6570\u7684\u53cd\u51fd\u6570\u53eb\u505a\u94fe\u63a5\u51fd\u6570\u3002\u6211\u4eec\u6709\u4e24\u79cd\u7ebf\u6027\u5206\u7c7b\u7684\u65b9\u5f0f\uff1a \u786c\u5206\u7c7b\uff0c\u6211\u4eec\u76f4\u63a5\u9700\u8981\u8f93\u51fa\u89c2\u6d4b\u5bf9\u5e94\u7684\u5206\u7c7b\u3002\u8fd9\u7c7b\u6a21\u578b\u7684\u4ee3\u8868\u4e3a\uff1a \u7ebf\u6027\u5224\u522b\u5206\u6790\uff08Fisher \u5224\u522b\uff09 \u611f\u77e5\u673a \u8f6f\u5206\u7c7b\uff0c\u4ea7\u751f\u4e0d\u540c\u7c7b\u522b\u7684\u6982\u7387\uff0c\u8fd9\u7c7b\u7b97\u6cd5\u6839\u636e\u6982\u7387\u65b9\u6cd5\u7684\u4e0d\u540c\u5206\u4e3a\u4e24\u79cd \u751f\u6210\u5f0f\uff08\u6839\u636e\u8d1d\u53f6\u65af\u5b9a\u7406\u5148\u8ba1\u7b97\u53c2\u6570\u540e\u9a8c\uff0c\u518d\u8fdb\u884c\u63a8\u65ad\uff09\uff1a\u9ad8\u65af\u5224\u522b\u5206\u6790\uff08GDA\uff09\u548c\u6734\u7d20\u8d1d\u53f6\u65af\u7b49\u4e3a\u4ee3\u8868 GDA Naive Bayes \u5224\u522b\u5f0f\uff08\u76f4\u63a5\u5bf9\u6761\u4ef6\u6982\u7387\u8fdb\u884c\u5efa\u6a21\uff09\uff1aLogistic \u56de\u5f52","title":"\u7ebf\u6027\u5206\u7c7b"},{"location":"Machine_Learning/3.LinearClassification/#-","text":"\u6211\u4eec\u9009\u53d6\u6fc0\u6d3b\u51fd\u6570\u4e3a\uff1a $$ sign(a)=\\left{\\begin{matrix}+1,a\\ge0\\-1,a\\lt0\\end{matrix}\\right. $$ \u8fd9\u6837\u5c31\u53ef\u4ee5\u5c06\u7ebf\u6027\u56de\u5f52\u7684\u7ed3\u679c\u6620\u5c04\u5230\u4e24\u5206\u7c7b\u7684\u7ed3\u679c\u4e0a\u4e86\u3002 \u5b9a\u4e49\u635f\u5931\u51fd\u6570\u4e3a\u9519\u8bef\u5206\u7c7b\u7684\u6570\u76ee\uff0c\u6bd4\u8f83\u76f4\u89c2\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u6307\u793a\u51fd\u6570\uff0c\u4f46\u662f\u6307\u793a\u51fd\u6570\u4e0d\u53ef\u5bfc\uff0c\u56e0\u6b64\u53ef\u4ee5\u5b9a\u4e49\uff1a $$ L(w)=\\sum\\limits_{x_i\\in\\mathcal{D} {wrong}}-y_iw^Tx_i $$ \u5176\u4e2d\uff0c \\(\\mathcal{D}_{wrong}\\) \u662f\u9519\u8bef\u5206\u7c7b\u96c6\u5408\uff0c\u5b9e\u9645\u5728\u6bcf\u4e00\u6b21\u8bad\u7ec3\u7684\u65f6\u5019\uff0c\u6211\u4eec\u91c7\u7528\u68af\u5ea6\u4e0b\u964d\u7684\u7b97\u6cd5\u3002\u635f\u5931\u51fd\u6570\u5bf9 \\(w\\) \u7684\u504f\u5bfc\u4e3a\uff1a $$ \\frac{\\partial}{\\partial w}L(w)=\\sum\\limits {wrong}}-y_ix_i $$ \u4f46\u662f\u5982\u679c\u6837\u672c\u975e\u5e38\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u8ba1\u7b97\u590d\u6742\u5ea6\u8f83\u9ad8\uff0c\u4f46\u662f\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u7edd\u5bf9\u7684\u635f\u5931\u51fd\u6570\u4e0b\u964d\u7684\u65b9\u5411\uff0c\u6211\u4eec\u53ea\u9700\u8981\u635f\u5931\u51fd\u6570\u7684\u671f\u671b\u503c\u4e0b\u964d\uff0c\u4f46\u662f\u8ba1\u7b97\u671f\u671b\u9700\u8981\u77e5\u9053\u771f\u5b9e\u7684\u6982\u7387\u5206\u5e03\uff0c\u6211\u4eec\u5b9e\u9645\u53ea\u80fd\u6839\u636e\u8bad\u7ec3\u6570\u636e\u62bd\u6837\u6765\u4f30\u7b97\u8fd9\u4e2a\u6982\u7387\u5206\u5e03\uff08\u7ecf\u9a8c\u98ce\u9669\uff09\uff1a $$ \\mathbb{E} [\\mathbb{E} \\hat{p}[\\nabla_wL(w)]]=\\mathbb{E} [\\frac{1}{N}\\sum\\limits_{i=1}^N\\nabla_wL(w)] $$ \u6211\u4eec\u77e5\u9053\uff0c \\(N\\) \u8d8a\u5927\uff0c\u6837\u672c\u8fd1\u4f3c\u771f\u5b9e\u5206\u5e03\u8d8a\u51c6\u786e\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e2a\u6807\u51c6\u5dee\u4e3a \\(\\sigma\\) \u7684\u6570\u636e\uff0c\u53ef\u4ee5\u786e\u5b9a\u7684\u6807\u51c6\u5dee\u4ec5\u548c \\(\\sqrt{N}\\) \u6210\u53cd\u6bd4\uff0c\u800c\u8ba1\u7b97\u901f\u5ea6\u5374\u548c \\(N\\) \u6210\u6b63\u6bd4\u3002\u56e0\u6b64\u53ef\u4ee5\u6bcf\u6b21\u4f7f\u7528\u8f83\u5c11\u6837\u672c\uff0c\u5219\u5728\u6570\u5b66\u671f\u671b\u7684\u610f\u4e49\u4e0a\u635f\u5931\u964d\u4f4e\u7684\u540c\u65f6\uff0c\u6709\u53ef\u4ee5\u63d0\u9ad8\u8ba1\u7b97\u901f\u5ea6\uff0c\u5982\u679c\u6bcf\u6b21\u53ea\u4f7f\u7528\u4e00\u4e2a\u9519\u8bef\u6837\u672c\uff0c\u6211\u4eec\u6709\u4e0b\u9762\u7684\u66f4\u65b0\u7b56\u7565\uff08\u6839\u636e\u6cf0\u52d2\u516c\u5f0f\uff0c\u5728\u8d1f\u65b9\u5411\uff09\uff1a $$ w^{t+1}\\leftarrow w^{t}+\\lambda y_ix_i $$ \u662f\u53ef\u4ee5\u6536\u655b\u7684\uff0c\u540c\u65f6\u4f7f\u7528\u5355\u4e2a\u89c2\u6d4b\u66f4\u65b0\u4e5f\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u589e\u52a0\u4e0d\u786e\u5b9a\u5ea6\uff0c\u4ece\u800c\u51cf\u8f7b\u9677\u5165\u5c40\u90e8\u6700\u5c0f\u7684\u53ef\u80fd\u3002\u5728\u66f4\u5927\u89c4\u6a21\u7684\u6570\u636e\u4e0a\uff0c\u5e38\u7528\u7684\u662f\u5c0f\u6279\u91cf\u968f\u673a\u68af\u5ea6\u4e0b\u964d\u6cd5\u3002","title":"\u4e24\u5206\u7c7b-\u786c\u5206\u7c7b-\u611f\u77e5\u673a\u7b97\u6cd5"},{"location":"Machine_Learning/3.LinearClassification/#-lda","text":"\u5728 LDA \u4e2d\uff0c\u6211\u4eec\u7684\u57fa\u672c\u60f3\u6cd5\u662f\u9009\u5b9a\u4e00\u4e2a\u65b9\u5411\uff0c\u5c06\u8bd5\u9a8c\u6837\u672c\u987a\u7740\u8fd9\u4e2a\u65b9\u5411\u6295\u5f71\uff0c\u6295\u5f71\u540e\u7684\u6570\u636e\u9700\u8981\u6ee1\u8db3\u4e24\u4e2a\u6761\u4ef6\uff0c\u4ece\u800c\u53ef\u4ee5\u66f4\u597d\u5730\u5206\u7c7b\uff1a \u76f8\u540c\u7c7b\u5185\u90e8\u7684\u8bd5\u9a8c\u6837\u672c\u8ddd\u79bb\u63a5\u8fd1\u3002 \u4e0d\u540c\u7c7b\u522b\u4e4b\u95f4\u7684\u8ddd\u79bb\u8f83\u5927\u3002 \u9996\u5148\u662f\u6295\u5f71\uff0c\u6211\u4eec\u5047\u5b9a\u539f\u6765\u7684\u6570\u636e\u662f\u5411\u91cf \\(x\\) \uff0c\u90a3\u4e48\u987a\u7740 \\(w\\) \u65b9\u5411\u7684\u6295\u5f71\u5c31\u662f\u6807\u91cf\uff1a $$ z=w^T\\cdot x(=|w|\\cdot|x|\\cos\\theta) $$ \u5bf9\u7b2c\u4e00\u70b9\uff0c\u76f8\u540c\u7c7b\u5185\u90e8\u7684\u6837\u672c\u66f4\u4e3a\u63a5\u8fd1\uff0c\u6211\u4eec\u5047\u8bbe\u5c5e\u4e8e\u4e24\u7c7b\u7684\u8bd5\u9a8c\u6837\u672c\u6570\u91cf\u5206\u522b\u662f \\(N_1\\) \u548c \\(N_2\\) \uff0c\u90a3\u4e48\u6211\u4eec\u91c7\u7528\u65b9\u5dee\u77e9\u9635\u6765\u8868\u5f81\u6bcf\u4e00\u4e2a\u7c7b\u5185\u7684\u603b\u4f53\u5206\u5e03\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4e86\u534f\u65b9\u5dee\u7684\u5b9a\u4e49\uff0c\u7528 \\(S\\) \u8868\u793a\u539f\u6570\u636e\u7684\u534f\u65b9\u5dee\uff1a $$ \\begin{align} C_1:Var_z[C_1]&=\\frac{1}{N_1}\\sum\\limits_{i=1}^{N_1}(z_i-\\overline{z_{c1}})(z_i-\\overline{z_{c1}})^T\\nonumber\\ &=\\frac{1}{N_1}\\sum\\limits_{i=1}^{N_1}(w^Tx_i-\\frac{1}{N_1}\\sum\\limits_{j=1}^{N_1}w^Tx_j)(w^Tx_i-\\frac{1}{N_1}\\sum\\limits_{j=1}^{N_1}w^Tx_j)^T\\nonumber\\ &=w^T\\frac{1}{N_1}\\sum\\limits_{i=1}^{N_1}(x_i-\\overline{x_{c1}})(x_i-\\overline{x_{c1}})^Tw\\nonumber\\ &=w^TS_1w\\ C_2:Var_z[C_2]&=\\frac{1}{N_2}\\sum\\limits_{i=1}^{N_2}(z_i-\\overline{z_{c2}})(z_i-\\overline{z_{c2}})^T\\nonumber\\ &=w^TS_2w \\end{align} $$ \u6240\u4ee5\u7c7b\u5185\u8ddd\u79bb\u53ef\u4ee5\u8bb0\u4e3a\uff1a $$ \\begin{align} Var_z[C_1]+Var_z[C_2]=w^T(S_1+S_2)w \\end{align} $$ \u5bf9\u4e8e\u7b2c\u4e8c\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u7c7b\u7684\u5747\u503c\u8868\u793a\u8fd9\u4e2a\u8ddd\u79bb\uff1a $$ \\begin{align} (\\overline{z_{c1}}-\\overline{z_{c2}})^2&=(\\frac{1}{N_1}\\sum\\limits_{i=1}^{N_1}w^Tx_i-\\frac{1}{N_2}\\sum\\limits_{i=1}^{N_2}w^Tx_i)^2\\nonumber\\ &=(w^T(\\overline{x_{c1}}-\\overline{x_{c2}}))^2\\nonumber\\ &=w^T(\\overline{x_{c1}}-\\overline{x_{c2}})(\\overline{x_{c1}}-\\overline{x_{c2}})^Tw \\end{align} $$ \u7efc\u5408\u8fd9\u4e24\u70b9\uff0c\u7531\u4e8e\u534f\u65b9\u5dee\u662f\u4e00\u4e2a\u77e9\u9635\uff0c\u4e8e\u662f\u6211\u4eec\u7528\u5c06\u8fd9\u4e24\u4e2a\u503c\u76f8\u9664\u6765\u5f97\u5230\u6211\u4eec\u7684\u635f\u5931\u51fd\u6570\uff0c\u5e76\u6700\u5927\u5316\u8fd9\u4e2a\u503c\uff1a $$ \\begin{align} \\hat{w}=\\mathop{argmax}\\limits_wJ(w)&=\\mathop{argmax}\\limits_w\\frac{(\\overline{z_{c1}}-\\overline{z_{c2}})^2}{Var_z[C_1]+Var_z[C_2]}\\nonumber\\ &=\\mathop{argmax}\\limits_w\\frac{w^T(\\overline{x_{c1}}-\\overline{x_{c2}})(\\overline{x_{c1}}-\\overline{x_{c2}})^Tw}{w^T(S_1+S_2)w}\\nonumber\\ &=\\mathop{argmax}\\limits_w\\frac{w^TS_bw}{w^TS_ww} \\end{align} $$ \u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u628a\u635f\u5931\u51fd\u6570\u548c\u539f\u6570\u636e\u96c6\u4ee5\u53ca\u53c2\u6570\u7ed3\u5408\u8d77\u6765\u4e86\u3002\u4e0b\u9762\u5bf9\u8fd9\u4e2a\u635f\u5931\u51fd\u6570\u6c42\u504f\u5bfc\uff0c\u6ce8\u610f\u6211\u4eec\u5176\u5b9e\u5bf9 \\(w\\) \u7684\u7edd\u5bf9\u503c\u6ca1\u6709\u4efb\u4f55\u8981\u6c42\uff0c\u53ea\u5bf9\u65b9\u5411\u6709\u8981\u6c42\uff0c\u56e0\u6b64\u53ea\u8981\u4e00\u4e2a\u65b9\u7a0b\u5c31\u53ef\u4ee5\u6c42\u89e3\u4e86\uff1a $$ \\begin{align} &\\frac{\\partial}{\\partial w}J(w)=2S_bw(w^TS_ww)^{-1}-2w^TS_bw(w^TS_ww)^{-2}S_ww=0\\nonumber\\ &\\Longrightarrow S_bw(w^TS_ww)=(w^TS_bw)S_ww\\nonumber\\ &\\Longrightarrow w\\propto S_w^{-1}S_bw=S_w^{-1}(\\overline{x_{c1}}-\\overline{x_{c2}})(\\overline{x_{c1}}-\\overline{x_{c2}})^Tw\\propto S_w^{-1}(\\overline{x_{c1}}-\\overline{x_{c2}}) \\end{align} $$ \u4e8e\u662f \\(S_w^{-1}(\\overline{x_{c1}}-\\overline{x_{c2}})\\) \u5c31\u662f\u6211\u4eec\u9700\u8981\u5bfb\u627e\u7684\u65b9\u5411\u3002\u6700\u540e\u53ef\u4ee5\u5f52\u4e00\u5316\u6c42\u5f97\u5355\u4f4d\u7684 \\(w\\) \u503c\u3002","title":"\u4e24\u5206\u7c7b-\u786c\u5206\u7c7b-\u7ebf\u6027\u5224\u522b\u5206\u6790 LDA"},{"location":"Machine_Learning/3.LinearClassification/#-logistic","text":"\u6709\u65f6\u5019\u6211\u4eec\u53ea\u8981\u5f97\u5230\u4e00\u4e2a\u7c7b\u522b\u7684\u6982\u7387\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u4e00\u79cd\u80fd\u8f93\u51fa \\([0,1]\\) \u533a\u95f4\u7684\u503c\u7684\u51fd\u6570\u3002\u8003\u8651\u4e24\u5206\u7c7b\u6a21\u578b\uff0c\u6211\u4eec\u5229\u7528\u5224\u522b\u6a21\u578b\uff0c\u5e0c\u671b\u5bf9 \\(p(C|x)\\) \u5efa\u6a21\uff0c\u5229\u7528\u8d1d\u53f6\u65af\u5b9a\u7406\uff1a $$ p(C_1|x)=\\frac{p(x|C_1)p(C_1)}{p(x|C_1)p(C_1)+p(x|C_2)p(C_2)} $$ \u53d6 \\(a=\\ln\\frac{p(x|C_1)p(C_1)}{p(x|C_2)p(C_2)}\\) \uff0c\u4e8e\u662f\uff1a $$ p(C_1|x)=\\frac{1}{1+\\exp(-a)} $$ \u4e0a\u9762\u7684\u5f0f\u5b50\u53eb Logistic Sigmoid \u51fd\u6570\uff0c\u5176\u53c2\u6570\u8868\u793a\u4e86\u4e24\u7c7b\u8054\u5408\u6982\u7387\u6bd4\u503c\u7684\u5bf9\u6570\u3002\u5728\u5224\u522b\u5f0f\u4e2d\uff0c\u4e0d\u5173\u5fc3\u8fd9\u4e2a\u53c2\u6570\u7684\u5177\u4f53\u503c\uff0c\u6a21\u578b\u5047\u8bbe\u76f4\u63a5\u5bf9 \\(a\\) \u8fdb\u884c\u3002 Logistic \u56de\u5f52\u7684\u6a21\u578b\u5047\u8bbe\u662f\uff1a $$ a=w^Tx $$ \u4e8e\u662f\uff0c\u901a\u8fc7\u5bfb\u627e $ w$\u7684\u6700\u4f73\u503c\u53ef\u4ee5\u5f97\u5230\u5728\u8fd9\u4e2a\u6a21\u578b\u5047\u8bbe\u4e0b\u7684\u6700\u4f73\u6a21\u578b\u3002\u6982\u7387\u5224\u522b\u6a21\u578b\u5e38\u7528\u6700\u5927\u4f3c\u7136\u4f30\u8ba1\u7684\u65b9\u5f0f\u6765\u786e\u5b9a\u53c2\u6570\u3002 \u5bf9\u4e8e\u4e00\u6b21\u89c2\u6d4b\uff0c\u83b7\u5f97\u5206\u7c7b \\(y\\) \u7684\u6982\u7387\u4e3a\uff08\u5047\u5b9a \\(C_1=1,C_2=0\\) \uff09\uff1a $$ p(y|x)=p_1^yp_0^{1-y} $$ \u90a3\u4e48\u5bf9\u4e8e \\(N\\) \u6b21\u72ec\u7acb\u5168\u540c\u7684\u89c2\u6d4b MLE\u4e3a\uff1a $$ \\hat{w}=\\mathop{argmax} wJ(w)=\\mathop{argmax}_w\\sum\\limits ^N(y_i\\log p_1+(1-y_i)\\log p_0) $$ \u6ce8\u610f\u5230\uff0c\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u662f\u4ea4\u53c9\u71b5\u8868\u8fbe\u5f0f\u7684\u76f8\u53cd\u6570\u4e58 \\(N\\) \uff0cMLE \u4e2d\u7684\u5bf9\u6570\u4e5f\u4fdd\u8bc1\u4e86\u53ef\u4ee5\u548c\u6307\u6570\u51fd\u6570\u76f8\u5339\u914d\uff0c\u4ece\u800c\u5728\u5927\u7684\u533a\u95f4\u6c47\u603b\u83b7\u53d6\u7a33\u5b9a\u7684\u68af\u5ea6\u3002 \u5bf9\u8fd9\u4e2a\u51fd\u6570\u6c42\u5bfc\u6570\uff0c\u6ce8\u610f\u5230\uff1a $$ p_1'=(\\frac{1}{1+\\exp(-a)})'=p_1(1-p_1) $$ \u5219\uff1a $$ J'(w)=\\sum\\limits_{i=1}^Ny_i(1-p_1)x_i-p_1x_i+y_ip_1x_i=\\sum\\limits_{i=1}^N(y_i-p_1)x_i $$ \u7531\u4e8e\u6982\u7387\u503c\u7684\u975e\u7ebf\u6027\uff0c\u653e\u5728\u6c42\u548c\u7b26\u53f7\u4e2d\u65f6\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u65e0\u6cd5\u76f4\u63a5\u6c42\u89e3\u3002\u4e8e\u662f\u5728\u5b9e\u9645\u8bad\u7ec3\u7684\u65f6\u5019\uff0c\u548c\u611f\u77e5\u673a\u7c7b\u4f3c\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u5927\u5c0f\u7684\u6279\u91cf\u968f\u673a\u68af\u5ea6\u4e0a\u5347\uff08\u5bf9\u4e8e\u6700\u5c0f\u5316\u5c31\u662f\u68af\u5ea6\u4e0b\u964d\uff09\u6765\u83b7\u5f97\u8fd9\u4e2a\u51fd\u6570\u7684\u6781\u5927\u503c\u3002","title":"\u4e24\u5206\u7c7b-\u8f6f\u5206\u7c7b-\u6982\u7387\u5224\u522b\u6a21\u578b-Logistic \u56de\u5f52"},{"location":"Machine_Learning/3.LinearClassification/#-gda","text":"\u751f\u6210\u6a21\u578b\u4e2d\uff0c\u6211\u4eec\u5bf9\u8054\u5408\u6982\u7387\u5206\u5e03\u8fdb\u884c\u5efa\u6a21\uff0c\u7136\u540e\u91c7\u7528 MAP \u6765\u83b7\u5f97\u53c2\u6570\u7684\u6700\u4f73\u503c\u3002\u4e24\u5206\u7c7b\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u91c7\u7528\u7684\u5047\u8bbe\uff1a \\(y\\sim Bernoulli(\\phi)\\) \\(x|y=1\\sim\\mathcal{N}(\\mu_1,\\Sigma)\\) \\(x|y=0\\sim\\mathcal{N}(\\mu_0,\\Sigma)\\) \u90a3\u4e48\u72ec\u7acb\u5168\u540c\u7684\u6570\u636e\u96c6\u6700\u5927\u540e\u9a8c\u6982\u7387\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a $$ \\begin{align} \\mathop{argmax} {\\phi,\\mu_0,\\mu_1,\\Sigma}\\log p(X|Y)p(Y)=\\mathop{argmax} \\sum\\limits_{i=1}^N (\\log p(x_i|y_i)+\\log p(y_i))\\nonumber\\ =\\mathop{argmax} {\\phi,\\mu_0,\\mu_1,\\Sigma}\\sum\\limits ^N((1-y_i)\\log\\mathcal{N}(\\mu_0,\\Sigma)+y_i\\log \\mathcal{N}(\\mu_1,\\Sigma)+y_i\\log\\phi+(1-y_i)\\log(1-\\phi)) \\end{align} $$ \u9996\u5148\u5bf9 \\(\\phi\\) \u8fdb\u884c\u6c42\u89e3\uff0c\u5c06\u5f0f\u5b50\u5bf9 \\(\\phi\\) \u6c42\u504f\u5bfc\uff1a $$ \\begin{align}\\sum\\limits_{i=1}^N\\frac{y_i}{\\phi}+\\frac{y_i-1}{1-\\phi}=0\\nonumber\\ \\Longrightarrow\\phi=\\frac{\\sum\\limits_{i=1}^Ny_i}{N}=\\frac{N_1}{N} \\end{align} $$ \u7136\u540e\u6c42\u89e3 \\(\\mu_1\\) \uff1a $$ \\begin{align}\\hat{\\mu_1}&=\\mathop{argmax} {\\mu_1}\\sum\\limits ^Ny_i\\log\\mathcal{N}(\\mu_1,\\Sigma)\\nonumber\\ &=\\mathop{argmin} {\\mu_1}\\sum\\limits ^Ny_i(x_i-\\mu_1)^T\\Sigma^{-1}(x_i-\\mu_1) \\end{align} $$ \u7531\u4e8e\uff1a $$ \\sum\\limits_{i=1}^Ny_i(x_i-\\mu_1)^T\\Sigma^{-1}(x_i-\\mu_1)=\\sum\\limits_{i=1}^Ny_ix_i^T\\Sigma^{-1}x_i-2y_i\\mu_1^T\\Sigma^{-1}x_i+y_i\\mu_1^T\\Sigma^{-1}\\mu_1 $$ \u6c42\u5fae\u5206\u5de6\u8fb9\u4e58\u4ee5 \\(\\Sigma\\) \u53ef\u4ee5\u5f97\u5230\uff1a $$ \\begin{align}\\sum\\limits_{i=1}^N-2y_i\\Sigma^{-1}x_i+2y_i\\Sigma^{-1}\\mu_1=0\\nonumber\\ \\Longrightarrow\\mu_1=\\frac{\\sum\\limits_{i=1}^Ny_ix_i}{\\sum\\limits_{i=1}^Ny_i}=\\frac{\\sum\\limits_{i=1}^Ny_ix_i}{N_1} \\end{align} $$ \u6c42\u89e3 \\(\\mu_0\\) \uff0c\u7531\u4e8e\u6b63\u53cd\u4f8b\u662f\u5bf9\u79f0\u7684\uff0c\u6240\u4ee5\uff1a $$ \\mu_0=\\frac{\\sum\\limits_{i=1}^N(1-y_i)x_i}{N_0} $$ \u6700\u4e3a\u56f0\u96be\u7684\u662f\u6c42\u89e3 \\(\\Sigma\\) \uff0c\u6211\u4eec\u7684\u6a21\u578b\u5047\u8bbe\u5bf9\u6b63\u53cd\u4f8b\u91c7\u7528\u76f8\u540c\u7684\u534f\u65b9\u5dee\u77e9\u9635\uff0c\u5f53\u7136\u4ece\u4e0a\u9762\u7684\u6c42\u89e3\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u5373\u4f7f\u91c7\u7528\u4e0d\u540c\u7684\u77e9\u9635\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u4e4b\u524d\u7684\u4e09\u4e2a\u53c2\u6570\u3002\u9996\u5148\u6211\u4eec\u6709\uff1a $$ \\begin{align} \\sum\\limits_{i=1}^N\\log\\mathcal{N}(\\mu,\\Sigma)&=\\sum\\limits_{i=1}^N\\log(\\frac{1}{(2\\pi)^{p/2}|\\Sigma|^{1/2}})+(-\\frac{1}{2}(x_i-\\mu)^T\\Sigma^{-1}(x_i-\\mu))\\nonumber\\ &=Const-\\frac{1}{2}N\\log|\\Sigma|-\\frac{1}{2}Trace((x_i-\\mu)^T\\Sigma^{-1}(x_i-\\mu))\\nonumber\\ &=Const-\\frac{1}{2}N\\log|\\Sigma|-\\frac{1}{2}Trace((x_i-\\mu)(x_i-\\mu)^T\\Sigma^{-1})\\nonumber\\ &=Const-\\frac{1}{2}N\\log|\\Sigma|-\\frac{1}{2}NTrace(S\\Sigma^{-1}) \\end{align} $$ \u5728\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u4e2d\uff0c\u6211\u4eec\u5728\u6807\u91cf\u4e0a\u52a0\u5165\u8ff9\u4ece\u800c\u53ef\u4ee5\u4ea4\u6362\u77e9\u9635\u7684\u987a\u5e8f\uff0c\u5bf9\u4e8e\u5305\u542b\u7edd\u5bf9\u503c\u548c\u8ff9\u7684\u8868\u8fbe\u5f0f\u7684\u5bfc\u6570\uff0c\u6211\u4eec\u6709\uff1a $$ \\begin{align} \\frac{\\partial}{\\partial A}(|A|)&=|A|A^{-1}\\ \\frac{\\partial}{\\partial A}Trace(AB)&=B^T \\end{align} $$ \u56e0\u6b64\uff1a $$ \\begin{align}[\\sum\\limits_{i=1}^N((1-y_i)\\log\\mathcal{N}(\\mu_0,\\Sigma)+y_i\\log \\mathcal{N}(\\mu_1,\\Sigma)]' \\nonumber\\=Const-\\frac{1}{2}N\\log|\\Sigma|-\\frac{1}{2}N_1Trace(S_1\\Sigma^{-1})-\\frac{1}{2}N_2Trace(S_2\\Sigma^{-1}) \\end{align} $$ \u5176\u4e2d\uff0c \\(S_1,S_2\\) \u5206\u522b\u4e3a\u4e24\u4e2a\u7c7b\u6570\u636e\u5185\u90e8\u7684\u534f\u65b9\u5dee\u77e9\u9635\uff0c\u4e8e\u662f\uff1a $$ \\begin{align}N\\Sigma^{-1}-N_1S_1^T\\Sigma^{-2}-N_2S_2^T\\Sigma^{-2}=0\\nonumber \\\\Longrightarrow\\Sigma=\\frac{N_1S_1+N_2S_2}{N} \\end{align} $$ \u8fd9\u91cc\u5e94\u7528\u4e86\u7c7b\u534f\u65b9\u5dee\u77e9\u9635\u7684\u5bf9\u79f0\u6027\u3002 \u4e8e\u662f\u6211\u4eec\u5c31\u5229\u7528\u6700\u5927\u540e\u9a8c\u7684\u65b9\u6cd5\u6c42\u5f97\u4e86\u6211\u4eec\u6a21\u578b\u5047\u8bbe\u91cc\u9762\u7684\u6240\u6709\u53c2\u6570\uff0c\u6839\u636e\u6a21\u578b\uff0c\u53ef\u4ee5\u5f97\u5230\u8054\u5408\u5206\u5e03\uff0c\u4e5f\u5c31\u53ef\u4ee5\u5f97\u5230\u7528\u4e8e\u63a8\u65ad\u7684\u6761\u4ef6\u5206\u5e03\u4e86\u3002","title":"\u4e24\u5206\u7c7b-\u8f6f\u5206\u7c7b-\u6982\u7387\u751f\u6210\u6a21\u578b-\u9ad8\u65af\u5224\u522b\u5206\u6790 GDA"},{"location":"Machine_Learning/3.LinearClassification/#-_1","text":"\u4e0a\u9762\u7684\u9ad8\u65af\u5224\u522b\u5206\u6790\u7684\u662f\u5bf9\u6570\u636e\u96c6\u7684\u5206\u5e03\u4f5c\u51fa\u4e86\u9ad8\u65af\u5206\u5e03\u7684\u5047\u8bbe\uff0c\u540c\u65f6\u5f15\u5165\u4f2f\u52aa\u5229\u5206\u5e03\u4f5c\u4e3a\u7c7b\u5148\u9a8c\uff0c\u4ece\u800c\u5229\u7528\u6700\u5927\u540e\u9a8c\u6c42\u5f97\u8fd9\u4e9b\u5047\u8bbe\u4e2d\u7684\u53c2\u6570\u3002 \u6734\u7d20\u8d1d\u53f6\u65af\u961f\u6570\u636e\u7684\u5c5e\u6027\u4e4b\u95f4\u7684\u5173\u7cfb\u4f5c\u51fa\u4e86\u5047\u8bbe\uff0c\u4e00\u822c\u5730\uff0c\u6211\u4eec\u6709\u9700\u8981\u5f97\u5230 \\(p(x|y)\\) \u8fd9\u4e2a\u6982\u7387\u503c\uff0c\u7531\u4e8e \\(x\\) \u6709 \\(p\\) \u4e2a\u7ef4\u5ea6\uff0c\u56e0\u6b64\u9700\u8981\u5bf9\u8fd9\u4e48\u591a\u7684\u7ef4\u5ea6\u7684\u8054\u5408\u6982\u7387\u8fdb\u884c\u91c7\u6837\uff0c\u4f46\u662f\u6211\u4eec\u77e5\u9053\u8fd9\u4e48\u9ad8\u7ef4\u5ea6\u7684\u7a7a\u95f4\u4e2d\u91c7\u6837\u9700\u8981\u7684\u6837\u672c\u6570\u91cf\u975e\u5e38\u5927\u624d\u80fd\u83b7\u5f97\u8f83\u4e3a\u51c6\u786e\u7684\u6982\u7387\u8fd1\u4f3c\u3002 \u5728\u4e00\u822c\u7684\u6709\u5411\u6982\u7387\u56fe\u6a21\u578b\u4e2d\uff0c\u5bf9\u5404\u4e2a\u5c5e\u6027\u7ef4\u5ea6\u4e4b\u95f4\u7684\u6761\u4ef6\u72ec\u7acb\u5173\u7cfb\u4f5c\u51fa\u4e86\u4e0d\u540c\u7684\u5047\u8bbe\uff0c\u5176\u4e2d\u6700\u4e3a\u7b80\u5355\u7684\u4e00\u4e2a\u5047\u8bbe\u5c31\u662f\u5728\u6734\u7d20\u8d1d\u53f6\u65af\u6a21\u578b\u63cf\u8ff0\u4e2d\u7684\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\u3002 $$ p(x|y)=\\prod\\limits_{i=1}^pp(x_i|y) $$ \u5373\uff1a $$ x_i\\perp x_j|y,\\forall\\ i\\ne j $$ \u4e8e\u662f\u5229\u7528\u8d1d\u53f6\u65af\u5b9a\u7406\uff0c\u5bf9\u4e8e\u5355\u6b21\u89c2\u6d4b\uff1a $$ p(y|x)=\\frac{p(x|y)p(y)}{p(x)}=\\frac{\\prod\\limits_{i=1}^pp(x_i|y)p(y)}{p(x)} $$ \u5bf9\u4e8e\u5355\u4e2a\u7ef4\u5ea6\u7684\u6761\u4ef6\u6982\u7387\u4ee5\u53ca\u7c7b\u5148\u9a8c\u4f5c\u51fa\u8fdb\u4e00\u6b65\u7684\u5047\u8bbe\uff1a \\(x_i\\) \u4e3a\u8fde\u7eed\u53d8\u91cf\uff1a \\(p(x_i|y)=\\mathcal{N}(\\mu_i,\\sigma_i^2)\\) \\(x_i\\) \u4e3a\u79bb\u6563\u53d8\u91cf\uff1a\u7c7b\u522b\u5206\u5e03\uff08Categorical\uff09\uff1a \\(p(x_i=i|y)=\\theta_i,\\sum\\limits_{i=1}^K\\theta_i=1\\) \\(p(y)=\\phi^y(1-\\phi)^{1-y}\\) \u5bf9\u8fd9\u4e9b\u53c2\u6570\u7684\u4f30\u8ba1\uff0c\u5e38\u7528 MLE \u7684\u65b9\u6cd5\u76f4\u63a5\u5728\u6570\u636e\u96c6\u4e0a\u4f30\u8ba1\uff0c\u7531\u4e8e\u4e0d\u9700\u8981\u77e5\u9053\u5404\u4e2a\u7ef4\u5ea6\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u56e0\u6b64\uff0c\u6240\u9700\u6570\u636e\u91cf\u5927\u5927\u51cf\u5c11\u4e86\u3002\u4f30\u7b97\u5b8c\u8fd9\u4e9b\u53c2\u6570\uff0c\u518d\u4ee3\u5165\u8d1d\u53f6\u65af\u5b9a\u7406\u4e2d\u5f97\u5230\u7c7b\u522b\u7684\u540e\u9a8c\u5206\u5e03\u3002","title":"\u4e24\u5206\u7c7b-\u8f6f\u5206\u7c7b-\u6982\u7387\u751f\u6210\u6a21\u578b-\u6734\u7d20\u8d1d\u53f6\u65af"},{"location":"Machine_Learning/3.LinearClassification/#_2","text":"\u5206\u7c7b\u4efb\u52a1\u5206\u4e3a\u4e24\u7c7b\uff0c\u5bf9\u4e8e\u9700\u8981\u76f4\u63a5\u8f93\u51fa\u7c7b\u522b\u7684\u4efb\u52a1\uff0c\u611f\u77e5\u673a\u7b97\u6cd5\u4e2d\u6211\u4eec\u5728\u7ebf\u6027\u6a21\u578b\u7684\u57fa\u7840\u4e0a\u52a0\u5165\u7b26\u53f7\u51fd\u6570\u4f5c\u4e3a\u6fc0\u6d3b\u51fd\u6570\uff0c\u90a3\u4e48\u5c31\u80fd\u5f97\u5230\u8fd9\u4e2a\u7c7b\u522b\uff0c\u4f46\u662f\u7b26\u53f7\u51fd\u6570\u4e0d\u5149\u6ed1\uff0c\u4e8e\u662f\u6211\u4eec\u91c7\u7528\u9519\u8bef\u9a71\u52a8\u7684\u65b9\u5f0f\uff0c\u5f15\u5165 \\(\\sum\\limits_{x_i\\in\\mathcal{D}_{wrong}}-y_iw^Tx_i\\) \u4f5c\u4e3a\u635f\u5931\u51fd\u6570\uff0c\u7136\u540e\u6700\u5c0f\u5316\u8fd9\u4e2a\u8bef\u5dee\uff0c\u91c7\u7528\u6279\u91cf\u968f\u673a\u68af\u5ea6\u4e0b\u964d\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u6700\u4f73\u7684\u53c2\u6570\u503c\u3002\u800c\u5728\u7ebf\u6027\u5224\u522b\u5206\u6790\u4e2d\uff0c\u6211\u4eec\u5c06\u7ebf\u6027\u6a21\u578b\u770b\u4f5c\u662f\u6570\u636e\u70b9\u5728\u67d0\u4e00\u4e2a\u65b9\u5411\u7684\u6295\u5f71\uff0c\u91c7\u7528\u7c7b\u5185\u5c0f\uff0c\u7c7b\u95f4\u5927\u7684\u601d\u8def\u6765\u5b9a\u4e49\u635f\u5931\u51fd\u6570\uff0c\u5176\u4e2d\u7c7b\u5185\u5c0f\u5b9a\u4e49\u4e3a\u4e24\u7c7b\u6570\u636e\u7684\u65b9\u5dee\u4e4b\u548c\uff0c\u7c7b\u95f4\u5927\u5b9a\u4e49\u4e3a\u4e24\u7c7b\u6570\u636e\u4e2d\u5fc3\u70b9\u7684\u95f4\u8ddd\uff0c\u5bf9\u635f\u5931\u51fd\u6570\u6c42\u5bfc\u5f97\u5230\u53c2\u6570\u7684\u65b9\u5411\uff0c\u8fd9\u4e2a\u65b9\u5411\u5c31\u662f \\(S_w^{-1}(\\overline x_{c1}-\\overline x_{c2})\\) \uff0c\u5176\u4e2d \\(S_w\\) \u4e3a\u539f\u6570\u636e\u96c6\u4e24\u7c7b\u7684\u65b9\u5dee\u4e4b\u548c\u3002 \u53e6\u4e00\u79cd\u4efb\u52a1\u662f\u8f93\u51fa\u5206\u7c7b\u7684\u6982\u7387\uff0c\u5bf9\u4e8e\u6982\u7387\u6a21\u578b\uff0c\u6211\u4eec\u6709\u4e24\u79cd\u65b9\u6848\uff0c\u7b2c\u4e00\u79cd\u662f\u5224\u522b\u6a21\u578b\uff0c\u4e5f\u5c31\u662f\u76f4\u63a5\u5bf9\u7c7b\u522b\u7684\u6761\u4ef6\u6982\u7387\u5efa\u6a21\uff0c\u5c06\u7ebf\u6027\u6a21\u578b\u5957\u5165 Logistic \u51fd\u6570\u4e2d\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86 Logistic \u56de\u5f52\u6a21\u578b\uff0c\u8fd9\u91cc\u7684\u6982\u7387\u89e3\u91ca\u662f\u4e24\u7c7b\u7684\u8054\u5408\u6982\u7387\u6bd4\u503c\u7684\u5bf9\u6570\u662f\u7ebf\u6027\u7684\uff0c\u6211\u4eec\u5b9a\u4e49\u7684\u635f\u5931\u51fd\u6570\u662f\u4ea4\u53c9\u71b5\uff08\u7b49\u4ef7\u4e8e MLE\uff09\uff0c\u5bf9\u8fd9\u4e2a\u51fd\u6570\u6c42\u5bfc\u5f97\u5230 \\(\\frac{1}{N}\\sum\\limits_{i=1}^N(y_i-p_1)x_i\\) \uff0c\u540c\u6837\u5229\u7528\u6279\u91cf\u968f\u673a\u68af\u5ea6\uff08\u4e0a\u5347\uff09\u7684\u65b9\u6cd5\u8fdb\u884c\u4f18\u5316\u3002\u7b2c\u4e8c\u79cd\u662f\u751f\u6210\u6a21\u578b\uff0c\u751f\u6210\u6a21\u578b\u5f15\u5165\u4e86\u7c7b\u522b\u7684\u5148\u9a8c\uff0c\u5728\u9ad8\u65af\u5224\u522b\u5206\u6790\u4e2d\uff0c\u6211\u4eec\u5bf9\u6570\u636e\u96c6\u7684\u6570\u636e\u5206\u5e03\u4f5c\u51fa\u4e86\u5047\u8bbe\uff0c\u5176\u4e2d\u7c7b\u5148\u9a8c\u662f\u4e8c\u9879\u5206\u5e03\uff0c\u800c\u6bcf\u4e00\u7c7b\u7684\u4f3c\u7136\u662f\u9ad8\u65af\u5206\u5e03\uff0c\u5bf9\u8fd9\u4e2a\u8054\u5408\u5206\u5e03\u7684\u5bf9\u6570\u4f3c\u7136\u8fdb\u884c\u6700\u5927\u5316\u5c31\u5f97\u5230\u4e86\u53c2\u6570\uff0c \\(\\frac{\\sum\\limits_{i=1}^Ny_ix_i}{N_1},\\frac{\\sum\\limits_{i=1}^N(1-y_i)x_i}{N_0},\\frac{N_1S_1+N_2S_2}{N},\\frac{N_1}{N}\\) \u3002\u5728\u6734\u7d20\u8d1d\u53f6\u65af\u4e2d\uff0c\u6211\u4eec\u8fdb\u4e00\u6b65\u5bf9\u5c5e\u6027\u7684\u5404\u4e2a\u7ef4\u5ea6\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u4f5c\u51fa\u5047\u8bbe\uff0c\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\u5927\u5927\u51cf\u5c11\u4e86\u6570\u636e\u91cf\u7684\u9700\u6c42\u3002","title":"\u5c0f\u7ed3"},{"location":"Machine_Learning/4.DimentionReduction/","text":"\u964d\u7ef4 \u6211\u4eec\u77e5\u9053\uff0c\u89e3\u51b3\u8fc7\u62df\u5408\u7684\u95ee\u9898\u9664\u4e86\u6b63\u5219\u5316\u548c\u6dfb\u52a0\u6570\u636e\u4e4b\u5916\uff0c\u964d\u7ef4\u5c31\u662f\u6700\u597d\u7684\u65b9\u6cd5\u3002\u964d\u7ef4\u7684\u601d\u8def\u6765\u6e90\u4e8e\u7ef4\u5ea6\u707e\u96be\u7684\u95ee\u9898\uff0c\u6211\u4eec\u77e5\u9053 \\(n\\) \u7ef4\u7403\u7684\u4f53\u79ef\u4e3a\uff1a $$ CR^n $$ \u90a3\u4e48\u5728\u7403\u4f53\u79ef\u4e0e\u8fb9\u957f\u4e3a \\(2R\\) \u7684\u8d85\u7acb\u65b9\u4f53\u6bd4\u503c\u4e3a\uff1a $$ \\lim\\limits_{n\\rightarrow0}\\frac{CR^n}{2^nR^n}=0 $$ \u8fd9\u5c31\u662f\u6240\u8c13\u7684\u7ef4\u5ea6\u707e\u96be\uff0c\u5728\u9ad8\u7ef4\u6570\u636e\u4e2d\uff0c\u4e3b\u8981\u6837\u672c\u90fd\u5206\u5e03\u5728\u7acb\u65b9\u4f53\u7684\u8fb9\u7f18\uff0c\u6240\u4ee5\u6570\u636e\u96c6\u66f4\u52a0\u7a00\u758f\u3002 \u964d\u7ef4\u7684\u7b97\u6cd5\u5206\u4e3a\uff1a \u76f4\u63a5\u964d\u7ef4\uff0c\u7279\u5f81\u9009\u62e9 \u7ebf\u6027\u964d\u7ef4\uff0cPCA\uff0cMDS\u7b49 \u5206\u7ebf\u6027\uff0c\u6d41\u5f62\u5305\u62ec Isomap\uff0cLLE \u7b49 \u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u9996\u5148\u5c06\u534f\u65b9\u5dee\u77e9\u9635\uff08\u6570\u636e\u96c6\uff09\u5199\u6210\u4e2d\u5fc3\u5316\u7684\u5f62\u5f0f\uff1a $$ \\begin{align}S&=\\frac{1}{N}\\sum\\limits_{i=1}^N(x_i-\\overline{x})(x_i-\\overline{x})^T\\nonumber\\ &=\\frac{1}{N}(x_1-\\overline{x},x_2-\\overline{x},\\cdots,x_N-\\overline{x})(x_1-\\overline{x},x_2-\\overline{x},\\cdots,x_N-\\overline{x})^T\\nonumber\\ &=\\frac{1}{N}(X^T-\\frac{1}{N}X^T\\mathbb{I} {N1}\\mathbb{I} ^T)(X^T-\\frac{1}{N}X^T\\mathbb{I} {N1}\\mathbb{I} ^T)^T\\nonumber\\ &=\\frac{1}{N}X^T(E_N-\\frac{1}{N}\\mathbb{I} {N1}\\mathbb{I} )(E_N-\\frac{1}{N}\\mathbb{I} {N1}\\mathbb{I} )^TX\\nonumber\\ &=\\frac{1}{N}X^TH_NH_N^TX\\nonumber\\ &=\\frac{1}{N}X^TH_NH_NX=\\frac{1}{N}X^THX \\end{align} $$ \u8fd9\u4e2a\u5f0f\u5b50\u5229\u7528\u4e86\u4e2d\u5fc3\u77e9\u9635 \\(H\\) \u7684\u5bf9\u79f0\u6027\uff0c\u8fd9\u4e5f\u662f\u4e00\u4e2a\u6295\u5f71\u77e9\u9635\u3002 \u7ebf\u6027\u964d\u7ef4-\u4e3b\u6210\u5206\u5206\u6790 PCA \u635f\u5931\u51fd\u6570 \u4e3b\u6210\u5206\u5206\u6790\u4e2d\uff0c\u6211\u4eec\u7684\u57fa\u672c\u60f3\u6cd5\u662f\u5c06\u6240\u6709\u6570\u636e\u6295\u5f71\u5230\u4e00\u4e2a\u5b57\u7a7a\u95f4\u4e2d\uff0c\u4ece\u800c\u8fbe\u5230\u964d\u7ef4\u7684\u76ee\u6807\uff0c\u4e3a\u4e86\u5bfb\u627e\u8fd9\u4e2a\u5b50\u7a7a\u95f4\uff0c\u6211\u4eec\u57fa\u672c\u60f3\u6cd5\u662f\uff1a \u6240\u6709\u6570\u636e\u5728\u5b50\u7a7a\u95f4\u4e2d\u66f4\u4e3a\u5206\u6563 \u635f\u5931\u7684\u4fe1\u606f\u6700\u5c0f\uff0c\u5373\uff1a\u5728\u8865\u7a7a\u95f4\u7684\u5206\u91cf\u5c11 \u539f\u6765\u7684\u6570\u636e\u5f88\u6709\u53ef\u80fd\u5404\u4e2a\u7ef4\u5ea6\u4e4b\u95f4\u662f\u76f8\u5173\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u7ec4 \\(p\\) \u4e2a\u65b0\u7684\u7ebf\u6027\u65e0\u5173\u7684\u5355\u4f4d\u57fa \\(u_i\\) \uff0c\u964d\u7ef4\u5c31\u662f\u53d6\u5176\u4e2d\u7684 \\(q\\) \u4e2a\u57fa\u3002\u4e8e\u662f\u5bf9\u4e8e\u4e00\u4e2a\u6837\u672c \\(x_i\\) \uff0c\u7ecf\u8fc7\u8fd9\u4e2a\u5750\u6807\u53d8\u6362\u540e\uff1a $$ \\hat{x_i}=\\sum\\limits_{i=1}^p(u_i^Tx_i)u_i=\\sum\\limits_{i=1}^q(u_i^Tx_i)u_i+\\sum\\limits_{i=q+1}^p(u_i^Tx_i)u_i $$ \u5bf9\u4e8e\u6570\u636e\u96c6\u6765\u8bf4\uff0c\u6211\u4eec\u9996\u5148\u5c06\u5176\u4e2d\u5fc3\u5316\u7136\u540e\u518d\u53bb\u4e0a\u9762\u7684\u5f0f\u5b50\u7684\u7b2c\u4e00\u9879\uff0c\u5e76\u4f7f\u7528\u5176\u7cfb\u6570\u7684\u5e73\u65b9\u5e73\u5747\u4f5c\u4e3a\u635f\u5931\u51fd\u6570\u5e76\u6700\u5927\u5316\uff1a $$ \\begin{align}J&=\\frac{1}{N}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^q((x_i-\\overline{x})^Tu_j)^2\\nonumber\\ &=\\sum\\limits_{j=1}^qu_j^TSu_j\\ ,\\ s.t.\\ u_j^Tu_j=1 \\end{align} $$ \u7531\u4e8e\u6bcf\u4e2a\u57fa\u90fd\u662f\u7ebf\u6027\u65e0\u5173\u7684\uff0c\u4e8e\u662f\u6bcf\u4e00\u4e2a \\(u_j\\) \u7684\u6c42\u89e3\u53ef\u4ee5\u5206\u522b\u8fdb\u884c\uff0c\u4f7f\u7528\u62c9\u683c\u6717\u65e5\u4e58\u5b50\u6cd5\uff1a $$ \\mathop{argmax} {u_j}L(u_j,\\lambda)=\\mathop{argmax} u_j^TSu_j+\\lambda(1-u_j^Tu_j) $$ \u4e8e\u662f\uff1a $$ Su_j=\\lambda u_j $$ \u53ef\u89c1\uff0c\u6211\u4eec\u9700\u8981\u7684\u57fa\u5c31\u662f\u534f\u65b9\u5dee\u77e9\u9635\u7684\u672c\u5f81\u77e2\u3002\u635f\u5931\u51fd\u6570\u6700\u5927\u53d6\u5728\u672c\u5f81\u503c\u524d \\(q\\) \u4e2a\u6700\u5927\u503c\u3002 \u4e0b\u9762\u770b\u5176\u635f\u5931\u7684\u4fe1\u606f\u6700\u5c11\u8fd9\u4e2a\u6761\u4ef6\uff0c\u540c\u6837\u9002\u7528\u7cfb\u6570\u7684\u5e73\u65b9\u5e73\u5747\u4f5c\u4e3a\u635f\u5931\u51fd\u6570\uff0c\u5e76\u6700\u5c0f\u5316\uff1a $$ \\begin{align}J&=\\frac{1}{N}\\sum\\limits_{i=1}^N\\sum\\limits_{j=q+1}^p((x_i-\\overline{x})^Tu_j)^2\\nonumber\\ &=\\sum\\limits_{j=q+1}^pu_j^TSu_j\\ ,\\ s.t.\\ u_j^Tu_j=1 \\end{align} $$ \u540c\u6837\u7684\uff1a $$ \\mathop{argmin} {u_j}L(u_j,\\lambda)=\\mathop{argmin} u_j^TSu_j+\\lambda(1-u_j^Tu_j) $$ \u635f\u5931\u51fd\u6570\u6700\u5c0f\u53d6\u5728\u672c\u5f81\u503c\u5269\u4e0b\u7684\u4e2a\u6700\u5c0f\u7684\u51e0\u4e2a\u503c\u3002\u6570\u636e\u96c6\u7684\u534f\u65b9\u5dee\u77e9\u9635\u53ef\u4ee5\u5199\u6210 \\(S=U\\Lambda U^T\\) \uff0c\u76f4\u63a5\u5bf9\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u5f53\u7136\u53ef\u4ee5\u5f97\u5230\u672c\u5f81\u77e2\u3002 SVD \u4e0e PCoA \u4e0b\u9762\u4f7f\u7528\u5b9e\u9645\u8bad\u7ec3\u65f6\u5e38\u5e38\u4f7f\u7528\u7684 SVD \u76f4\u63a5\u6c42\u5f97\u8fd9\u4e2a \\(q\\) \u4e2a\u672c\u5f81\u77e2\u3002 \u5bf9\u4e2d\u5fc3\u5316\u540e\u7684\u6570\u636e\u96c6\u8fdb\u884c\u5947\u5f02\u503c\u5206\u89e3\uff1a $$ HX=U\\Sigma V^T,U^TU=E_N,V^TV=E_p,\\Sigma:N\\times p $$ \u4e8e\u662f\uff1a $$ S=\\frac{1}{N}X^THX=\\frac{1}{N}X^TH^THX=\\frac{1}{N}V\\Sigma^T\\Sigma V^T $$ \u56e0\u6b64\uff0c\u6211\u4eec\u76f4\u63a5\u5bf9\u4e2d\u5fc3\u5316\u540e\u7684\u6570\u636e\u96c6\u8fdb\u884c SVD\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7279\u5f81\u503c\u548c\u7279\u5f81\u5411\u91cf \\(V\\) \uff0c\u5728\u65b0\u5750\u6807\u7cfb\u4e2d\u7684\u5750\u6807\u5c31\u662f\uff1a $$ HX\\cdot V $$ \u7531\u4e0a\u9762\u7684\u63a8\u5bfc\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5f97\u5230\u53e6\u4e00\u79cd\u65b9\u6cd5 PCoA \u4e3b\u5750\u6807\u5206\u6790\uff0c\u5b9a\u4e49\u5e76\u8fdb\u884c\u7279\u5f81\u503c\u5206\u89e3\uff1a $$ T=HXX^TH=U\\Sigma\\Sigma^TU^T $$ \u7531\u4e8e\uff1a $$ TU\\Sigma=U\\Sigma(\\Sigma^T\\Sigma) $$ \u4e8e\u662f\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u5750\u6807\u3002\u8fd9\u4e24\u79cd\u65b9\u6cd5\u90fd\u53ef\u4ee5\u5f97\u5230\u4e3b\u6210\u5206\uff0c\u4f46\u662f\u7531\u4e8e\u65b9\u5dee\u77e9\u9635\u662f \\(p\\times p\\) \u7684\uff0c\u800c \\(T\\) \u662f \\(N\\times N\\) \u7684\uff0c\u6240\u4ee5\u5bf9\u6837\u672c\u91cf\u8f83\u5c11\u7684\u65f6\u5019\u53ef\u4ee5\u91c7\u7528 PCoA\u7684\u65b9\u6cd5\u3002 p-PCA \u4e0b\u9762\u4ece\u6982\u7387\u7684\u89d2\u5ea6\u5bf9 PCA \u8fdb\u884c\u5206\u6790\uff0c\u6982\u7387\u65b9\u6cd5\u4e5f\u53eb p-PCA\u3002\u6211\u4eec\u4f7f\u7528\u7ebf\u6027\u6a21\u578b\uff0c\u7c7b\u4f3c\u4e4b\u524d LDA\uff0c\u6211\u4eec\u9009\u5b9a\u4e00\u4e2a\u65b9\u5411\uff0c\u5bf9\u539f\u6570\u636e \\(x\\in\\mathbb{R}^p\\) \uff0c\u964d\u7ef4\u540e\u7684\u6570\u636e\u4e3a \\(z\\in\\mathbb{R}^q,q<p\\) \u3002\u964d\u7ef4\u901a\u8fc7\u4e00\u4e2a\u77e9\u9635\u53d8\u6362\uff08\u6295\u5f71\uff09\u8fdb\u884c\uff1a $$ \\begin{align} z&\\sim\\mathcal{N}(\\mathbb{O} {q1},\\mathbb{I} )\\ x&=Wz+\\mu+\\varepsilon\\ \\varepsilon&\\sim\\mathcal{N}(0,\\sigma^2\\mathbb{I} {pp}) \\end{align} $$ \u5bf9\u4e8e\u8fd9\u4e2a\u6a21\u578b\uff0c\u6211\u4e48\u53ef\u4ee5\u4f7f\u7528\u671f\u671b-\u6700\u5927\uff08EM\uff09\u7684\u7b97\u6cd5\u8fdb\u884c\u5b66\u4e60\uff0c\u5728\u8fdb\u884c\u63a8\u65ad\u7684\u65f6\u5019\u9700\u8981\u6c42\u5f97 \\(p(z|x)\\) \uff0c\u63a8\u65ad\u7684\u6c42\u89e3\u8fc7\u7a0b\u548c\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\u7c7b\u4f3c\u3002 $$ \\begin{align} &p(z|x)=\\frac{p(x|z)p(z)}{p(x)}\\ &\\mathbb{E}[x]=\\mathbb{E}[Wz+\\mu+\\varepsilon]=\\mu\\ &Var[x]=WW^T+\\sigma^2\\mathbb{I} \\ \\Longrightarrow p(z|x)=\\mathcal{N}(W^T(WW^T+&\\sigma^2\\mathbb{I})^{-1}(x-\\mu),\\mathbb{I}-W^T(WW^T+\\sigma^2\\mathbb{I})^{-1}W) \\end{align} $$ \u5c0f\u7ed3 \u964d\u7ef4\u662f\u89e3\u51b3\u7ef4\u5ea6\u707e\u96be\u548c\u8fc7\u62df\u5408\u7684\u91cd\u8981\u65b9\u6cd5\uff0c\u9664\u4e86\u76f4\u63a5\u7684\u7279\u5f81\u9009\u62e9\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u91c7\u7528\u7b97\u6cd5\u7684\u9014\u5f84\u5bf9\u7279\u5f81\u8fdb\u884c\u7b5b\u9009\uff0c\u7ebf\u6027\u7684\u964d\u7ef4\u65b9\u6cd5\u4ee5 PCA \u4e3a\u4ee3\u8868\uff0c\u5728 PCA \u4e2d\uff0c\u6211\u4eec\u53ea\u8981\u76f4\u63a5\u5bf9\u6570\u636e\u77e9\u9635\u8fdb\u884c\u4e2d\u5fc3\u5316\u7136\u540e\u6c42\u5947\u5f02\u503c\u5206\u89e3\u6216\u8005\u5bf9\u6570\u636e\u7684\u534f\u65b9\u5dee\u77e9\u9635\u8fdb\u884c\u5206\u89e3\u5c31\u53ef\u4ee5\u5f97\u5230\u5176\u4e3b\u8981\u7ef4\u5ea6\u3002\u975e\u7ebf\u6027\u5b66\u4e60\u7684\u65b9\u6cd5\u5982\u6d41\u5f62\u5b66\u4e60\u5c06\u6295\u5f71\u9762\u4ece\u5e73\u9762\u6539\u4e3a\u8d85\u66f2\u9762\u3002","title":"4.DimentionReduction"},{"location":"Machine_Learning/4.DimentionReduction/#_1","text":"\u6211\u4eec\u77e5\u9053\uff0c\u89e3\u51b3\u8fc7\u62df\u5408\u7684\u95ee\u9898\u9664\u4e86\u6b63\u5219\u5316\u548c\u6dfb\u52a0\u6570\u636e\u4e4b\u5916\uff0c\u964d\u7ef4\u5c31\u662f\u6700\u597d\u7684\u65b9\u6cd5\u3002\u964d\u7ef4\u7684\u601d\u8def\u6765\u6e90\u4e8e\u7ef4\u5ea6\u707e\u96be\u7684\u95ee\u9898\uff0c\u6211\u4eec\u77e5\u9053 \\(n\\) \u7ef4\u7403\u7684\u4f53\u79ef\u4e3a\uff1a $$ CR^n $$ \u90a3\u4e48\u5728\u7403\u4f53\u79ef\u4e0e\u8fb9\u957f\u4e3a \\(2R\\) \u7684\u8d85\u7acb\u65b9\u4f53\u6bd4\u503c\u4e3a\uff1a $$ \\lim\\limits_{n\\rightarrow0}\\frac{CR^n}{2^nR^n}=0 $$ \u8fd9\u5c31\u662f\u6240\u8c13\u7684\u7ef4\u5ea6\u707e\u96be\uff0c\u5728\u9ad8\u7ef4\u6570\u636e\u4e2d\uff0c\u4e3b\u8981\u6837\u672c\u90fd\u5206\u5e03\u5728\u7acb\u65b9\u4f53\u7684\u8fb9\u7f18\uff0c\u6240\u4ee5\u6570\u636e\u96c6\u66f4\u52a0\u7a00\u758f\u3002 \u964d\u7ef4\u7684\u7b97\u6cd5\u5206\u4e3a\uff1a \u76f4\u63a5\u964d\u7ef4\uff0c\u7279\u5f81\u9009\u62e9 \u7ebf\u6027\u964d\u7ef4\uff0cPCA\uff0cMDS\u7b49 \u5206\u7ebf\u6027\uff0c\u6d41\u5f62\u5305\u62ec Isomap\uff0cLLE \u7b49 \u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u9996\u5148\u5c06\u534f\u65b9\u5dee\u77e9\u9635\uff08\u6570\u636e\u96c6\uff09\u5199\u6210\u4e2d\u5fc3\u5316\u7684\u5f62\u5f0f\uff1a $$ \\begin{align}S&=\\frac{1}{N}\\sum\\limits_{i=1}^N(x_i-\\overline{x})(x_i-\\overline{x})^T\\nonumber\\ &=\\frac{1}{N}(x_1-\\overline{x},x_2-\\overline{x},\\cdots,x_N-\\overline{x})(x_1-\\overline{x},x_2-\\overline{x},\\cdots,x_N-\\overline{x})^T\\nonumber\\ &=\\frac{1}{N}(X^T-\\frac{1}{N}X^T\\mathbb{I} {N1}\\mathbb{I} ^T)(X^T-\\frac{1}{N}X^T\\mathbb{I} {N1}\\mathbb{I} ^T)^T\\nonumber\\ &=\\frac{1}{N}X^T(E_N-\\frac{1}{N}\\mathbb{I} {N1}\\mathbb{I} )(E_N-\\frac{1}{N}\\mathbb{I} {N1}\\mathbb{I} )^TX\\nonumber\\ &=\\frac{1}{N}X^TH_NH_N^TX\\nonumber\\ &=\\frac{1}{N}X^TH_NH_NX=\\frac{1}{N}X^THX \\end{align} $$ \u8fd9\u4e2a\u5f0f\u5b50\u5229\u7528\u4e86\u4e2d\u5fc3\u77e9\u9635 \\(H\\) \u7684\u5bf9\u79f0\u6027\uff0c\u8fd9\u4e5f\u662f\u4e00\u4e2a\u6295\u5f71\u77e9\u9635\u3002","title":"\u964d\u7ef4"},{"location":"Machine_Learning/4.DimentionReduction/#-pca","text":"","title":"\u7ebf\u6027\u964d\u7ef4-\u4e3b\u6210\u5206\u5206\u6790 PCA"},{"location":"Machine_Learning/4.DimentionReduction/#_2","text":"\u4e3b\u6210\u5206\u5206\u6790\u4e2d\uff0c\u6211\u4eec\u7684\u57fa\u672c\u60f3\u6cd5\u662f\u5c06\u6240\u6709\u6570\u636e\u6295\u5f71\u5230\u4e00\u4e2a\u5b57\u7a7a\u95f4\u4e2d\uff0c\u4ece\u800c\u8fbe\u5230\u964d\u7ef4\u7684\u76ee\u6807\uff0c\u4e3a\u4e86\u5bfb\u627e\u8fd9\u4e2a\u5b50\u7a7a\u95f4\uff0c\u6211\u4eec\u57fa\u672c\u60f3\u6cd5\u662f\uff1a \u6240\u6709\u6570\u636e\u5728\u5b50\u7a7a\u95f4\u4e2d\u66f4\u4e3a\u5206\u6563 \u635f\u5931\u7684\u4fe1\u606f\u6700\u5c0f\uff0c\u5373\uff1a\u5728\u8865\u7a7a\u95f4\u7684\u5206\u91cf\u5c11 \u539f\u6765\u7684\u6570\u636e\u5f88\u6709\u53ef\u80fd\u5404\u4e2a\u7ef4\u5ea6\u4e4b\u95f4\u662f\u76f8\u5173\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u5e0c\u671b\u627e\u5230\u4e00\u7ec4 \\(p\\) \u4e2a\u65b0\u7684\u7ebf\u6027\u65e0\u5173\u7684\u5355\u4f4d\u57fa \\(u_i\\) \uff0c\u964d\u7ef4\u5c31\u662f\u53d6\u5176\u4e2d\u7684 \\(q\\) \u4e2a\u57fa\u3002\u4e8e\u662f\u5bf9\u4e8e\u4e00\u4e2a\u6837\u672c \\(x_i\\) \uff0c\u7ecf\u8fc7\u8fd9\u4e2a\u5750\u6807\u53d8\u6362\u540e\uff1a $$ \\hat{x_i}=\\sum\\limits_{i=1}^p(u_i^Tx_i)u_i=\\sum\\limits_{i=1}^q(u_i^Tx_i)u_i+\\sum\\limits_{i=q+1}^p(u_i^Tx_i)u_i $$ \u5bf9\u4e8e\u6570\u636e\u96c6\u6765\u8bf4\uff0c\u6211\u4eec\u9996\u5148\u5c06\u5176\u4e2d\u5fc3\u5316\u7136\u540e\u518d\u53bb\u4e0a\u9762\u7684\u5f0f\u5b50\u7684\u7b2c\u4e00\u9879\uff0c\u5e76\u4f7f\u7528\u5176\u7cfb\u6570\u7684\u5e73\u65b9\u5e73\u5747\u4f5c\u4e3a\u635f\u5931\u51fd\u6570\u5e76\u6700\u5927\u5316\uff1a $$ \\begin{align}J&=\\frac{1}{N}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^q((x_i-\\overline{x})^Tu_j)^2\\nonumber\\ &=\\sum\\limits_{j=1}^qu_j^TSu_j\\ ,\\ s.t.\\ u_j^Tu_j=1 \\end{align} $$ \u7531\u4e8e\u6bcf\u4e2a\u57fa\u90fd\u662f\u7ebf\u6027\u65e0\u5173\u7684\uff0c\u4e8e\u662f\u6bcf\u4e00\u4e2a \\(u_j\\) \u7684\u6c42\u89e3\u53ef\u4ee5\u5206\u522b\u8fdb\u884c\uff0c\u4f7f\u7528\u62c9\u683c\u6717\u65e5\u4e58\u5b50\u6cd5\uff1a $$ \\mathop{argmax} {u_j}L(u_j,\\lambda)=\\mathop{argmax} u_j^TSu_j+\\lambda(1-u_j^Tu_j) $$ \u4e8e\u662f\uff1a $$ Su_j=\\lambda u_j $$ \u53ef\u89c1\uff0c\u6211\u4eec\u9700\u8981\u7684\u57fa\u5c31\u662f\u534f\u65b9\u5dee\u77e9\u9635\u7684\u672c\u5f81\u77e2\u3002\u635f\u5931\u51fd\u6570\u6700\u5927\u53d6\u5728\u672c\u5f81\u503c\u524d \\(q\\) \u4e2a\u6700\u5927\u503c\u3002 \u4e0b\u9762\u770b\u5176\u635f\u5931\u7684\u4fe1\u606f\u6700\u5c11\u8fd9\u4e2a\u6761\u4ef6\uff0c\u540c\u6837\u9002\u7528\u7cfb\u6570\u7684\u5e73\u65b9\u5e73\u5747\u4f5c\u4e3a\u635f\u5931\u51fd\u6570\uff0c\u5e76\u6700\u5c0f\u5316\uff1a $$ \\begin{align}J&=\\frac{1}{N}\\sum\\limits_{i=1}^N\\sum\\limits_{j=q+1}^p((x_i-\\overline{x})^Tu_j)^2\\nonumber\\ &=\\sum\\limits_{j=q+1}^pu_j^TSu_j\\ ,\\ s.t.\\ u_j^Tu_j=1 \\end{align} $$ \u540c\u6837\u7684\uff1a $$ \\mathop{argmin} {u_j}L(u_j,\\lambda)=\\mathop{argmin} u_j^TSu_j+\\lambda(1-u_j^Tu_j) $$ \u635f\u5931\u51fd\u6570\u6700\u5c0f\u53d6\u5728\u672c\u5f81\u503c\u5269\u4e0b\u7684\u4e2a\u6700\u5c0f\u7684\u51e0\u4e2a\u503c\u3002\u6570\u636e\u96c6\u7684\u534f\u65b9\u5dee\u77e9\u9635\u53ef\u4ee5\u5199\u6210 \\(S=U\\Lambda U^T\\) \uff0c\u76f4\u63a5\u5bf9\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u5f53\u7136\u53ef\u4ee5\u5f97\u5230\u672c\u5f81\u77e2\u3002","title":"\u635f\u5931\u51fd\u6570"},{"location":"Machine_Learning/4.DimentionReduction/#svd-pcoa","text":"\u4e0b\u9762\u4f7f\u7528\u5b9e\u9645\u8bad\u7ec3\u65f6\u5e38\u5e38\u4f7f\u7528\u7684 SVD \u76f4\u63a5\u6c42\u5f97\u8fd9\u4e2a \\(q\\) \u4e2a\u672c\u5f81\u77e2\u3002 \u5bf9\u4e2d\u5fc3\u5316\u540e\u7684\u6570\u636e\u96c6\u8fdb\u884c\u5947\u5f02\u503c\u5206\u89e3\uff1a $$ HX=U\\Sigma V^T,U^TU=E_N,V^TV=E_p,\\Sigma:N\\times p $$ \u4e8e\u662f\uff1a $$ S=\\frac{1}{N}X^THX=\\frac{1}{N}X^TH^THX=\\frac{1}{N}V\\Sigma^T\\Sigma V^T $$ \u56e0\u6b64\uff0c\u6211\u4eec\u76f4\u63a5\u5bf9\u4e2d\u5fc3\u5316\u540e\u7684\u6570\u636e\u96c6\u8fdb\u884c SVD\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7279\u5f81\u503c\u548c\u7279\u5f81\u5411\u91cf \\(V\\) \uff0c\u5728\u65b0\u5750\u6807\u7cfb\u4e2d\u7684\u5750\u6807\u5c31\u662f\uff1a $$ HX\\cdot V $$ \u7531\u4e0a\u9762\u7684\u63a8\u5bfc\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5f97\u5230\u53e6\u4e00\u79cd\u65b9\u6cd5 PCoA \u4e3b\u5750\u6807\u5206\u6790\uff0c\u5b9a\u4e49\u5e76\u8fdb\u884c\u7279\u5f81\u503c\u5206\u89e3\uff1a $$ T=HXX^TH=U\\Sigma\\Sigma^TU^T $$ \u7531\u4e8e\uff1a $$ TU\\Sigma=U\\Sigma(\\Sigma^T\\Sigma) $$ \u4e8e\u662f\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u5750\u6807\u3002\u8fd9\u4e24\u79cd\u65b9\u6cd5\u90fd\u53ef\u4ee5\u5f97\u5230\u4e3b\u6210\u5206\uff0c\u4f46\u662f\u7531\u4e8e\u65b9\u5dee\u77e9\u9635\u662f \\(p\\times p\\) \u7684\uff0c\u800c \\(T\\) \u662f \\(N\\times N\\) \u7684\uff0c\u6240\u4ee5\u5bf9\u6837\u672c\u91cf\u8f83\u5c11\u7684\u65f6\u5019\u53ef\u4ee5\u91c7\u7528 PCoA\u7684\u65b9\u6cd5\u3002","title":"SVD \u4e0e PCoA"},{"location":"Machine_Learning/4.DimentionReduction/#p-pca","text":"\u4e0b\u9762\u4ece\u6982\u7387\u7684\u89d2\u5ea6\u5bf9 PCA \u8fdb\u884c\u5206\u6790\uff0c\u6982\u7387\u65b9\u6cd5\u4e5f\u53eb p-PCA\u3002\u6211\u4eec\u4f7f\u7528\u7ebf\u6027\u6a21\u578b\uff0c\u7c7b\u4f3c\u4e4b\u524d LDA\uff0c\u6211\u4eec\u9009\u5b9a\u4e00\u4e2a\u65b9\u5411\uff0c\u5bf9\u539f\u6570\u636e \\(x\\in\\mathbb{R}^p\\) \uff0c\u964d\u7ef4\u540e\u7684\u6570\u636e\u4e3a \\(z\\in\\mathbb{R}^q,q<p\\) \u3002\u964d\u7ef4\u901a\u8fc7\u4e00\u4e2a\u77e9\u9635\u53d8\u6362\uff08\u6295\u5f71\uff09\u8fdb\u884c\uff1a $$ \\begin{align} z&\\sim\\mathcal{N}(\\mathbb{O} {q1},\\mathbb{I} )\\ x&=Wz+\\mu+\\varepsilon\\ \\varepsilon&\\sim\\mathcal{N}(0,\\sigma^2\\mathbb{I} {pp}) \\end{align} $$ \u5bf9\u4e8e\u8fd9\u4e2a\u6a21\u578b\uff0c\u6211\u4e48\u53ef\u4ee5\u4f7f\u7528\u671f\u671b-\u6700\u5927\uff08EM\uff09\u7684\u7b97\u6cd5\u8fdb\u884c\u5b66\u4e60\uff0c\u5728\u8fdb\u884c\u63a8\u65ad\u7684\u65f6\u5019\u9700\u8981\u6c42\u5f97 \\(p(z|x)\\) \uff0c\u63a8\u65ad\u7684\u6c42\u89e3\u8fc7\u7a0b\u548c\u7ebf\u6027\u9ad8\u65af\u6a21\u578b\u7c7b\u4f3c\u3002 $$ \\begin{align} &p(z|x)=\\frac{p(x|z)p(z)}{p(x)}\\ &\\mathbb{E}[x]=\\mathbb{E}[Wz+\\mu+\\varepsilon]=\\mu\\ &Var[x]=WW^T+\\sigma^2\\mathbb{I} \\ \\Longrightarrow p(z|x)=\\mathcal{N}(W^T(WW^T+&\\sigma^2\\mathbb{I})^{-1}(x-\\mu),\\mathbb{I}-W^T(WW^T+\\sigma^2\\mathbb{I})^{-1}W) \\end{align} $$","title":"p-PCA"},{"location":"Machine_Learning/4.DimentionReduction/#_3","text":"\u964d\u7ef4\u662f\u89e3\u51b3\u7ef4\u5ea6\u707e\u96be\u548c\u8fc7\u62df\u5408\u7684\u91cd\u8981\u65b9\u6cd5\uff0c\u9664\u4e86\u76f4\u63a5\u7684\u7279\u5f81\u9009\u62e9\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u91c7\u7528\u7b97\u6cd5\u7684\u9014\u5f84\u5bf9\u7279\u5f81\u8fdb\u884c\u7b5b\u9009\uff0c\u7ebf\u6027\u7684\u964d\u7ef4\u65b9\u6cd5\u4ee5 PCA \u4e3a\u4ee3\u8868\uff0c\u5728 PCA \u4e2d\uff0c\u6211\u4eec\u53ea\u8981\u76f4\u63a5\u5bf9\u6570\u636e\u77e9\u9635\u8fdb\u884c\u4e2d\u5fc3\u5316\u7136\u540e\u6c42\u5947\u5f02\u503c\u5206\u89e3\u6216\u8005\u5bf9\u6570\u636e\u7684\u534f\u65b9\u5dee\u77e9\u9635\u8fdb\u884c\u5206\u89e3\u5c31\u53ef\u4ee5\u5f97\u5230\u5176\u4e3b\u8981\u7ef4\u5ea6\u3002\u975e\u7ebf\u6027\u5b66\u4e60\u7684\u65b9\u6cd5\u5982\u6d41\u5f62\u5b66\u4e60\u5c06\u6295\u5f71\u9762\u4ece\u5e73\u9762\u6539\u4e3a\u8d85\u66f2\u9762\u3002","title":"\u5c0f\u7ed3"},{"location":"Machine_Learning/5.SVM/","text":"\u652f\u6491\u5411\u91cf\u673a \u652f\u6491\u5411\u91cf\u673a\uff08SVM\uff09\u7b97\u6cd5\u5728\u5206\u7c7b\u95ee\u9898\u4e2d\u6709\u7740\u91cd\u8981\u5730\u4f4d\uff0c\u5176\u4e3b\u8981\u601d\u60f3\u662f\u6700\u5927\u5316\u4e24\u7c7b\u4e4b\u95f4\u7684\u95f4\u9694\u3002\u6309\u7167\u6570\u636e\u96c6\u7684\u7279\u70b9\uff1a \u7ebf\u6027\u53ef\u5206\u95ee\u9898\uff0c\u5982\u4e4b\u524d\u7684\u611f\u77e5\u673a\u7b97\u6cd5\u5904\u7406\u7684\u95ee\u9898 \u7ebf\u6027\u53ef\u5206\uff0c\u53ea\u6709\u4e00\u70b9\u70b9\u9519\u8bef\u70b9\uff0c\u5982\u611f\u77e5\u673a\u7b97\u6cd5\u53d1\u5c55\u51fa\u6765\u7684 Pocket \u7b97\u6cd5\u5904\u7406\u7684\u95ee\u9898 \u975e\u7ebf\u6027\u95ee\u9898\uff0c\u5b8c\u5168\u4e0d\u53ef\u5206\uff0c\u5982\u5728\u611f\u77e5\u673a\u95ee\u9898\u53d1\u5c55\u51fa\u6765\u7684\u591a\u5c42\u611f\u77e5\u673a\u548c\u6df1\u5ea6\u5b66\u4e60 \u8fd9\u4e09\u79cd\u60c5\u51b5\u5bf9\u4e8e SVM \u5206\u522b\u6709\u4e0b\u9762\u4e09\u79cd\u5904\u7406\u624b\u6bb5\uff1a hard-margin SVM soft-margin SVM kernel Method SVM \u7684\u6c42\u89e3\u4e2d\uff0c\u5927\u91cf\u7528\u5230\u4e86 Lagrange \u4e58\u5b50\u6cd5\uff0c\u9996\u5148\u5bf9\u8fd9\u79cd\u65b9\u6cd5\u8fdb\u884c\u4ecb\u7ecd\u3002 \u7ea6\u675f\u4f18\u5316\u95ee\u9898 \u4e00\u822c\u5730\uff0c\u7ea6\u675f\u4f18\u5316\u95ee\u9898\uff08\u539f\u95ee\u9898\uff09\u53ef\u4ee5\u5199\u6210\uff1a $$ \\begin{align} &\\min_{x\\in\\mathbb{R^p}}f(x)\\ &s.t.\\ m_i(x)\\le0,i=1,2,\\cdots,M\\ &\\ \\ \\ \\ \\ \\ \\ \\ n_j(x)=0,j=1,2,\\cdots,N \\end{align} $$ \u5b9a\u4e49 Lagrange \u51fd\u6570\uff1a $$ L(x,\\lambda,\\eta)=f(x)+\\sum\\limits_{i=1}^M\\lambda_im_i(x)+\\sum\\limits_{i=1}^N\\eta_in_i(x) $$ \u90a3\u4e48\u539f\u95ee\u9898\u53ef\u4ee5\u7b49\u4ef7\u4e8e\u65e0\u7ea6\u675f\u5f62\u5f0f\uff1a $$ \\min_{x\\in\\mathbb{R}^p}\\max_{\\lambda,\\eta}L(x,\\lambda,\\eta)\\ s.t.\\ \\lambda_i\\ge0 $$ \u8fd9\u662f\u7531\u4e8e\uff0c\u5f53\u6ee1\u8db3\u539f\u95ee\u9898\u7684\u4e0d\u7b49\u5f0f\u7ea6\u675f\u7684\u65f6\u5019\uff0c \\(\\lambda_i=0\\) \u624d\u80fd\u53d6\u5f97\u6700\u5927\u503c\uff0c\u76f4\u63a5\u7b49\u4ef7\u4e8e\u539f\u95ee\u9898\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u539f\u95ee\u9898\u7684\u4e0d\u7b49\u5f0f\u7ea6\u675f\uff0c\u90a3\u4e48\u6700\u5927\u503c\u5c31\u4e3a \\(+ \\infty\\) \uff0c\u7531\u4e8e\u9700\u8981\u53d6\u6700\u5c0f\u503c\uff0c\u4e8e\u662f\u4e0d\u4f1a\u53d6\u5230\u8fd9\u4e2a\u60c5\u51b5\u3002 \u8fd9\u4e2a\u95ee\u9898\u7684\u5bf9\u5076\u5f62\u5f0f\uff1a $$ \\max_{\\lambda,\\eta}\\min_{x\\in\\mathbb{R}^p}L(x,\\lambda,\\eta)\\ s.t.\\ \\lambda_i\\ge0 $$ \u5bf9\u5076\u95ee\u9898\u662f\u5173\u4e8e \\(\\lambda, \\eta\\) \u7684\u6700\u5927\u5316\u95ee\u9898\u3002 \u7531\u4e8e\uff1a $$ \\max_{\\lambda_i,\\eta_j}\\min_{x}L(x,\\lambda_i,\\eta_j)\\le\\min_{x}\\max_{\\lambda_i,\\eta_j}L(x,\\lambda_i,\\eta_j) $$ \u8bc1\u660e\uff1a\u663e\u7136\u6709 \\(\\min\\limits_{x}L\\le L\\le\\max\\limits_{\\lambda,\\eta}L\\) \uff0c\u4e8e\u662f\u663e\u7136\u6709 \\(\\max\\limits_{\\lambda,\\eta}\\min\\limits_{x}L\\le L\\) \uff0c\u4e14 \\(\\min\\limits_{x}\\max\\limits_{\\lambda,\\eta}L\\ge L\\) \u3002 \u5bf9\u5076\u95ee\u9898\u7684\u89e3\u5c0f\u4e8e\u539f\u95ee\u9898\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\uff1a \u5f3a\u5bf9\u5076\uff1a\u53ef\u4ee5\u53d6\u7b49\u4e8e\u53f7 \u5f31\u5bf9\u5076\uff1a\u4e0d\u53ef\u4ee5\u53d6\u7b49\u4e8e\u53f7 \u5176\u5b9e\u8fd9\u4e00\u70b9\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e00\u5f20\u56fe\u6765\u8bf4\u660e\uff1a \u5bf9\u4e8e\u4e00\u4e2a\u51f8\u4f18\u5316\u95ee\u9898\uff0c\u6709\u5982\u4e0b\u5b9a\u7406\uff1a \u5982\u679c\u51f8\u4f18\u5316\u95ee\u9898\u6ee1\u8db3\u67d0\u4e9b\u6761\u4ef6\u5982 Slater \u6761\u4ef6\uff0c\u90a3\u4e48\u5b83\u548c\u5176\u5bf9\u5076\u95ee\u9898\u6ee1\u8db3\u5f3a\u5bf9\u5076\u5173\u7cfb\u3002\u8bb0\u95ee\u9898\u7684\u5b9a\u4e49\u57df\u4e3a\uff1a \\(\\mathcal{D}=domf(x)\\cap dom m_i(x)\\cap domn_j(x)\\) \u3002\u4e8e\u662f Slater \u6761\u4ef6\u4e3a\uff1a $$ \\exist\\hat{x}\\in Relint\\mathcal{D}\\ s.t.\\ \\forall i=1,2,\\cdots,M,m_i(x)\\lt0 $$ \u5176\u4e2d Relint \u8868\u793a\u76f8\u5bf9\u5185\u90e8\uff08\u4e0d\u5305\u542b\u8fb9\u754c\u7684\u5185\u90e8\uff09\u3002 \u5bf9\u4e8e\u5927\u591a\u6570\u51f8\u4f18\u5316\u95ee\u9898\uff0cSlater \u6761\u4ef6\u6210\u7acb\u3002 \u677e\u5f1b Slater \u6761\u4ef6\uff0c\u5982\u679c M \u4e2a\u4e0d\u7b49\u5f0f\u7ea6\u675f\u4e2d\uff0c\u6709 K \u4e2a\u51fd\u6570\u4e3a\u4eff\u5c04\u51fd\u6570\uff0c\u90a3\u4e48\u53ea\u8981\u5176\u4f59\u7684\u51fd\u6570\u6ee1\u8db3 Slater \u6761\u4ef6\u5373\u53ef\u3002 \u4e0a\u9762\u4ecb\u7ecd\u4e86\u539f\u95ee\u9898\u548c\u5bf9\u5076\u95ee\u9898\u7684\u5bf9\u5076\u5173\u7cfb\uff0c\u4f46\u662f\u5b9e\u9645\u8fd8\u9700\u8981\u5bf9\u53c2\u6570\u8fdb\u884c\u6c42\u89e3\uff0c\u6c42\u89e3\u65b9\u6cd5\u4f7f\u7528 KKT \u6761\u4ef6\u8fdb\u884c\uff1a KKT \u6761\u4ef6\u548c\u5f3a\u5bf9\u5076\u5173\u7cfb\u662f\u7b49\u4ef7\u5173\u7cfb\u3002KKT \u6761\u4ef6\u5bf9\u6700\u4f18\u89e3\u7684\u6761\u4ef6\u4e3a\uff1a \u53ef\u884c\u57df\uff1a $$ \\begin{align} m_i(x^ )\\le0\\ n_j(x^ )=0\\ \\lambda^*\\ge0 \\end{align} $$ \u4e92\u8865\u677e\u5f1b \\(\\lambda^*m_i(x^*)=0,\\forall m_i\\) \uff0c\u5bf9\u5076\u95ee\u9898\u7684\u6700\u4f73\u503c\u4e3a \\(d^*\\) \uff0c\u539f\u95ee\u9898\u4e3a \\(p^*\\) $$ \\begin{align} d^ &=\\max_{\\lambda,\\eta}g(\\lambda,\\eta)=g(\\lambda^ ,\\eta^ )\\nonumber\\ &=\\min_{x}L(x,\\lambda^ ,\\eta^ )\\nonumber\\ &\\le L(x^ ,\\lambda^ ,\\eta^ )\\nonumber\\ &=f(x^ )+\\sum\\limits_{i=1}^M\\lambda^ m_i(x^ )\\nonumber\\ &\\le f(x^ )=p^* \\end{align} $$ \u4e3a\u4e86\u6ee1\u8db3\u76f8\u7b49\uff0c\u4e24\u4e2a\u4e0d\u7b49\u5f0f\u5fc5\u987b\u6210\u7acb\uff0c\u4e8e\u662f\uff0c\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u4e0d\u7b49\u4e8e\u53f7\uff0c\u9700\u8981\u6709\u68af\u5ea6\u4e3a0\u6761\u4ef6\uff0c\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u4e0d\u7b49\u4e8e\u53f7\u9700\u8981\u6ee1\u8db3\u4e92\u8865\u677e\u5f1b\u6761\u4ef6\u3002 \u68af\u5ea6\u4e3a0\uff1a \\(\\frac{\\partial L(x,\\lambda^*,\\eta^*)}{\\partial x}|_{x=x^*}=0\\) Hard-margin SVM \u652f\u6491\u5411\u91cf\u673a\u4e5f\u662f\u4e00\u79cd\u786c\u5206\u7c7b\u6a21\u578b\uff0c\u5728\u4e4b\u524d\u7684\u611f\u77e5\u673a\u6a21\u578b\u4e2d\uff0c\u6211\u4eec\u5728\u7ebf\u6027\u6a21\u578b\u7684\u57fa\u7840\u4e0a\u53e0\u52a0\u4e86\u7b26\u53f7\u51fd\u6570\uff0c\u5728\u51e0\u4f55\u76f4\u89c2\u4e0a\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u4e24\u7c7b\u5206\u7684\u5f88\u5f00\u7684\u8bdd\uff0c\u90a3\u4e48\u5176\u5b9e\u4f1a\u5b58\u5728\u65e0\u7a77\u591a\u6761\u7ebf\u53ef\u4ee5\u5c06\u4e24\u7c7b\u5206\u5f00\u3002\u5728 SVM \u4e2d\uff0c\u6211\u4eec\u5f15\u5165\u6700\u5927\u5316\u95f4\u9694\u8fd9\u4e2a\u6982\u5ff5\uff0c\u95f4\u9694\u6307\u7684\u662f\u6570\u636e\u548c\u76f4\u7ebf\u7684\u8ddd\u79bb\u7684\u6700\u5c0f\u503c\uff0c\u56e0\u6b64\u6700\u5927\u5316\u8fd9\u4e2a\u503c\u53cd\u6620\u4e86\u6211\u4eec\u7684\u6a21\u578b\u503e\u5411\u3002 \u5206\u5272\u7684\u8d85\u5e73\u9762\u53ef\u4ee5\u5199\u4e3a\uff1a $$ 0=w^Tx+b $$ \u90a3\u4e48\u6700\u5927\u5316\u95f4\u9694\uff08\u7ea6\u675f\u4e3a\u5206\u7c7b\u4efb\u52a1\u7684\u8981\u6c42\uff09\uff1a $$ \\mathop{argmax} {w,b}[\\min_i\\frac{|w^Tx_i+b|}{||w||}]\\ s.t.\\ y_i(w^Tx_i+b)>0\\ \\Longrightarrow\\mathop{argmax} [\\min_i\\frac{y_i(w^Tx_i+b)}{||w||}]\\ s.t.\\ y_i(w^Tx_i+b)>0 $$ \u5bf9\u4e8e\u8fd9\u4e2a\u7ea6\u675f \\(y_i(w^Tx_i+b)>0\\) \uff0c\u4e0d\u59a8\u56fa\u5b9a \\(\\min y_i(w^Tx_i+b)=1>0\\) \uff0c\u8fd9\u662f\u7531\u4e8e\u5206\u5f00\u4e24\u7c7b\u7684\u8d85\u5e73\u9762\u7684\u7cfb\u6570\u7ecf\u8fc7\u6bd4\u4f8b\u653e\u7f29\u4e0d\u4f1a\u6539\u53d8\u8fd9\u4e2a\u5e73\u9762\uff0c\u8fd9\u4e5f\u76f8\u5f53\u4e8e\u7ed9\u8d85\u5e73\u9762\u7684\u7cfb\u6570\u4f5c\u51fa\u4e86\u7ea6\u675f\u3002\u5316\u7b80\u540e\u7684\u5f0f\u5b50\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a $$ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw\\ s.t.\\ \\min_iy_i(w^Tx_i+b)=1\\ \\Rightarrow\\mathop{argmin} \\frac{1}{2}w^Tw\\ s.t.\\ y_i(w^Tx_i+b)\\ge1,i=1,2,\\cdots,N $$ \u8fd9\u5c31\u662f\u4e00\u4e2a\u5305\u542b \\(N\\) \u4e2a\u7ea6\u675f\u7684\u51f8\u4f18\u5316\u95ee\u9898\uff0c\u6709\u5f88\u591a\u6c42\u89e3\u8fd9\u79cd\u95ee\u9898\u7684\u8f6f\u4ef6\u3002 \u4f46\u662f\uff0c\u5982\u679c\u6837\u672c\u6570\u91cf\u6216\u7ef4\u5ea6\u975e\u5e38\u9ad8\uff0c\u76f4\u63a5\u6c42\u89e3\u56f0\u96be\u751a\u81f3\u4e0d\u53ef\u89e3\uff0c\u4e8e\u662f\u9700\u8981\u5bf9\u8fd9\u4e2a\u95ee\u9898\u8fdb\u4e00\u6b65\u5904\u7406\u3002\u5f15\u5165 Lagrange \u51fd\u6570\uff1a $$ L(w,b,\\lambda)=\\frac{1}{2}w^Tw+\\sum\\limits_{i=1}^N\\lambda_i(1-y_i(w^Tx_i+b)) $$ \u6211\u4eec\u6709\u539f\u95ee\u9898\u5c31\u7b49\u4ef7\u4e8e\uff1a $$ \\mathop{argmin} {w,b}\\max L(w,b,\\lambda_i)\\ s.t.\\ \\lambda_i\\ge0 $$ \u6211\u4eec\u4ea4\u6362\u6700\u5c0f\u548c\u6700\u5927\u503c\u7684\u7b26\u53f7\u5f97\u5230\u5bf9\u5076\u95ee\u9898\uff1a $$ \\max_{\\lambda_i}\\min_{w,b}L(w,b,\\lambda_i)\\ s.t.\\ \\lambda_i\\ge0 $$ \u7531\u4e8e\u4e0d\u7b49\u5f0f\u7ea6\u675f\u662f\u4eff\u5c04\u51fd\u6570\uff0c\u5bf9\u5076\u95ee\u9898\u548c\u539f\u95ee\u9898\u7b49\u4ef7\uff1a \\(b\\) \uff1a \\(\\frac{\\partial}{\\partial b}L=0\\Rightarrow\\sum\\limits_{i=1}^N\\lambda_iy_i=0\\) \\(w\\) \uff1a\u9996\u5148\u5c06 \\(b\\) \u4ee3\u5165\uff1a $$ L(w,b,\\lambda_i)=\\frac{1}{2}w^Tw+\\sum\\limits_{i=1}^N\\lambda_i(1-y_iw^Tx_i-y_ib)=\\frac{1}{2}w^Tw+\\sum\\limits_{i=1}^N\\lambda_i-\\sum\\limits_{i=1}^N\\lambda_iy_iw^Tx_i $$ \u6240\u4ee5\uff1a $$ \\frac{\\partial}{\\partial w}L=0\\Rightarrow w=\\sum\\limits_{i=1}^N\\lambda_iy_ix_i $$ \u5c06\u4e0a\u9762\u4e24\u4e2a\u53c2\u6570\u4ee3\u5165\uff1a $$ L(w,b,\\lambda_i)=-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i $$ \u56e0\u6b64\uff0c\u5bf9\u5076\u95ee\u9898\u5c31\u662f\uff1a $$ \\max_{\\lambda}-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i,\\ s.t.\\ \\lambda_i\\ge0 $$ \u4ece KKT \u6761\u4ef6\u5f97\u5230\u8d85\u5e73\u9762\u7684\u53c2\u6570\uff1a \u539f\u95ee\u9898\u548c\u5bf9\u5076\u95ee\u9898\u6ee1\u8db3\u5f3a\u5bf9\u5076\u5173\u7cfb\u7684\u5145\u8981\u6761\u4ef6\u4e3a\u5176\u6ee1\u8db3 KKT \u6761\u4ef6\uff1a $$ \\begin{align} &\\frac{\\partial L}{\\partial w}=0,\\frac{\\partial L}{\\partial b}=0 \\&\\lambda_k(1-y_k(w^Tx_k+b))=0(slackness\\ complementary)\\ &\\lambda_i\\ge0\\ &1-y_i(w^Tx_i+b)\\le0 \\end{align} $$ \u6839\u636e\u8fd9\u4e2a\u6761\u4ef6\u5c31\u5f97\u5230\u4e86\u5bf9\u5e94\u7684\u6700\u4f73\u53c2\u6570\uff1a $$ \\hat{w}=\\sum\\limits_{i=1}^N\\lambda_iy_ix_i\\ \\hat{b}=y_k-w^Tx_k=y_k-\\sum\\limits_{i=1}^N\\lambda_iy_ix_i^Tx_k,\\exist k,1-y_k(w^Tx_k+b)=0 $$ \u4e8e\u662f\u8fd9\u4e2a\u8d85\u5e73\u9762\u7684\u53c2\u6570 \\(w\\) \u5c31\u662f\u6570\u636e\u70b9\u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u6700\u7ec8\u7684\u53c2\u6570\u503c\u5c31\u662f\u90e8\u5206\u6ee1\u8db3 \\(y_i(w^Tx_i+b)=1\\) \u5411\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\uff08\u4e92\u8865\u677e\u5f1b\u6761\u4ef6\u7ed9\u51fa\uff09\uff0c\u8fd9\u4e9b\u5411\u91cf\u4e5f\u53eb\u652f\u6491\u5411\u91cf\u3002 Soft-margin SVM Hard-margin \u7684 SVM \u53ea\u5bf9\u53ef\u5206\u6570\u636e\u53ef\u89e3\uff0c\u5982\u679c\u4e0d\u53ef\u5206\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u7684\u57fa\u672c\u60f3\u6cd5\u662f\u5728\u635f\u5931\u51fd\u6570\u4e2d\u52a0\u5165\u9519\u8bef\u5206\u7c7b\u7684\u53ef\u80fd\u6027\u3002\u9519\u8bef\u5206\u7c7b\u7684\u4e2a\u6570\u53ef\u4ee5\u5199\u6210\uff1a $$ error=\\sum\\limits_{i=1}^N\\mathbb{I}{y_i(w^Tx_i+b)\\lt1} $$ \u8fd9\u4e2a\u51fd\u6570\u4e0d\u8fde\u7eed\uff0c\u53ef\u4ee5\u5c06\u5176\u6539\u5199\u4e3a\uff1a $$ error=\\sum\\limits_{i=1}^N\\max{0,1-y_i(w^Tx_i+b)} $$ \u6c42\u548c\u7b26\u53f7\u4e2d\u7684\u5f0f\u5b50\u53c8\u53eb\u505a Hinge Function\u3002 \u5c06\u8fd9\u4e2a\u9519\u8bef\u52a0\u5165 Hard-margin SVM \u4e2d\uff0c\u4e8e\u662f\uff1a $$ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw+C\\sum\\limits ^N\\max{0,1-y_i(w^Tx_i+b)}\\ s.t.\\ y_i(w^Tx_i+b)\\ge1-\\xi_i,i=1,2,\\cdots,N $$ \u8fd9\u4e2a\u5f0f\u5b50\u4e2d\uff0c\u5e38\u6570 \\(C\\) \u53ef\u4ee5\u770b\u4f5c\u5141\u8bb8\u7684\u9519\u8bef\u6c34\u5e73\uff0c\u540c\u65f6\u4e0a\u5f0f\u4e3a\u4e86\u8fdb\u4e00\u6b65\u6d88\u9664 \\(\\max\\) \u7b26\u53f7\uff0c\u5bf9\u6570\u636e\u96c6\u4e2d\u7684\u6bcf\u4e00\u4e2a\u89c2\u6d4b\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u5176\u5927\u90e8\u5206\u6ee1\u8db3\u7ea6\u675f\uff0c\u4f46\u662f\u5176\u4e2d\u90e8\u5206\u8fdd\u53cd\u7ea6\u675f\uff0c\u56e0\u6b64\u8fd9\u90e8\u5206\u7ea6\u675f\u53d8\u6210 \\(y_i(w^Tx+b)\\ge1-\\xi_i\\) \uff0c\u5176\u4e2d \\(\\xi_i=1-y_i(w^Tx_i+b)\\) \uff0c\u8fdb\u4e00\u6b65\u7684\u5316\u7b80\uff1a $$ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw+C\\sum\\limits ^N\\xi_i\\ s.t.\\ y_i(w^Tx_i+b)\\ge1-\\xi_i,\\xi_i\\ge0,i=1,2,\\cdots,N $$ Kernel Method \u6838\u65b9\u6cd5\u53ef\u4ee5\u5e94\u7528\u5728\u5f88\u591a\u95ee\u9898\u4e0a\uff0c\u5728\u5206\u7c7b\u95ee\u9898\u4e2d\uff0c\u5bf9\u4e8e\u4e25\u683c\u4e0d\u53ef\u5206\u95ee\u9898\uff0c\u6211\u4eec\u5f15\u5165\u4e00\u4e2a\u7279\u5f81\u8f6c\u6362\u51fd\u6570\u5c06\u539f\u6765\u7684\u4e0d\u53ef\u5206\u7684\u6570\u636e\u96c6\u53d8\u4e3a\u53ef\u5206\u7684\u6570\u636e\u96c6\uff0c\u7136\u540e\u518d\u6765\u5e94\u7528\u5df2\u6709\u7684\u6a21\u578b\u3002\u5f80\u5f80\u5c06\u4f4e\u7ef4\u7a7a\u95f4\u7684\u6570\u636e\u96c6\u53d8\u4e3a\u9ad8\u7ef4\u7a7a\u95f4\u7684\u6570\u636e\u96c6\u540e\uff0c\u6570\u636e\u4f1a\u53d8\u5f97\u53ef\u5206\uff08\u6570\u636e\u53d8\u5f97\u66f4\u4e3a\u7a00\u758f\uff09\uff1a Cover TH\uff1a\u9ad8\u7ef4\u7a7a\u95f4\u6bd4\u4f4e\u7ef4\u7a7a\u95f4\u66f4\u6613\u7ebf\u6027\u53ef\u5206\u3002 \u5e94\u7528\u5728 SVM \u4e2d\u65f6\uff0c\u89c2\u5bdf\u4e0a\u9762\u7684 SVM \u5bf9\u5076\u95ee\u9898\uff1a $$ \\max_{\\lambda}-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i,\\ s.t.\\ \\lambda_i\\ge0 $$ \u5728\u6c42\u89e3\u7684\u65f6\u5019\u9700\u8981\u6c42\u5f97\u5185\u79ef\uff0c\u4e8e\u662f\u4e0d\u53ef\u5206\u6570\u636e\u5728\u901a\u8fc7\u7279\u5f81\u53d8\u6362\u540e\uff0c\u9700\u8981\u6c42\u5f97\u53d8\u6362\u540e\u7684\u5185\u79ef\u3002\u6211\u4eec\u5e38\u5e38\u5f88\u96be\u6c42\u5f97\u53d8\u6362\u51fd\u6570\u7684\u5185\u79ef\u3002\u4e8e\u662f\u76f4\u63a5\u5f15\u5165\u5185\u79ef\u7684\u53d8\u6362\u51fd\u6570\uff1a $$ \\forall x,x'\\in\\mathcal{X},\\exist\\phi\\in\\mathcal{H}:x\\rightarrow z\\ s.t.\\ k(x,x')=\\phi(x)^T\\phi(x) $$ \u79f0 \\(k(x,x')\\) \u4e3a\u4e00\u4e2a\u6b63\u5b9a\u6838\u51fd\u6570\uff0c\u5176\u4e2d \\(\\mathcal{H}\\) \u662f Hilbert \u7a7a\u95f4\uff08\u5b8c\u5907\u7684\u7ebf\u6027\u5185\u79ef\u7a7a\u95f4\uff09\uff0c\u5982\u679c\u53bb\u6389\u5185\u79ef\u8fd9\u4e2a\u6761\u4ef6\u6211\u4eec\u7b80\u5355\u5730\u79f0\u4e3a\u6838\u51fd\u6570\u3002 \\(k(x,x')=\\exp(-\\frac{(x-x')^2}{2\\sigma^2})\\) \u662f\u4e00\u4e2a\u6838\u51fd\u6570\u3002 \u8bc1\u660e\uff1a $$ \\begin{align} \\exp(-\\frac{(x-x')^2}{2\\sigma^2})&=\\exp(-\\frac{x^2}{2\\sigma^2})\\exp(\\frac{xx'}{\\sigma^2})\\exp(-\\frac{x'^2}{2\\sigma^2})\\nonumber\\ &=\\exp(-\\frac{x^2}{2\\sigma^2})\\sum\\limits_{n=0}^{+\\infty}\\frac{x^nx'^n}{\\sigma^{2n}n!}\\exp(-\\frac{x'^2}{2\\sigma^2})\\nonumber\\ &=\\exp(-\\frac{x^2}{2\\sigma^2})\\varphi(x)\\varphi(x')\\exp(-\\frac{x'^2}{2\\sigma^2})\\nonumber\\ &=\\phi(x)\\phi(x') \\end{align} $$ \u6b63\u5b9a\u6838\u51fd\u6570\u6709\u4e0b\u9762\u7684\u7b49\u4ef7\u5b9a\u4e49\uff1a \u5982\u679c\u6838\u51fd\u6570\u6ee1\u8db3\uff1a \u5bf9\u79f0\u6027 \u6b63\u5b9a\u6027 \u90a3\u4e48\u8fd9\u4e2a\u6838\u51fd\u6570\u65f6\u6b63\u5b9a\u6838\u51fd\u6570\u3002 \u8bc1\u660e\uff1a \u5bf9\u79f0\u6027 \\(\\Leftrightarrow\\) \\(k(x,z)=k(z,x)\\) \uff0c\u663e\u7136\u6ee1\u8db3\u5185\u79ef\u7684\u5b9a\u4e49 \u6b63\u5b9a\u6027 \\(\\Leftrightarrow\\) \\(\\forall N,x_1,x_2,\\cdots,x_N\\in\\mathcal{X}\\) \uff0c\u5bf9\u5e94\u7684 Gram Matrix \\(K=[k(x_i,x_j)]\\) \u662f\u534a\u6b63\u5b9a\u7684\u3002 \u8981\u8bc1\uff1a \\(k(x,z)=\\phi(x)^T\\phi(z)\\Leftrightarrow K\\) \u534a\u6b63\u5b9a+\u5bf9\u79f0\u6027\u3002 \\(\\Rightarrow\\) \uff1a\u9996\u5148\uff0c\u5bf9\u79f0\u6027\u662f\u663e\u7136\u7684\uff0c\u5bf9\u4e8e\u6b63\u5b9a\u6027\uff1a $$ K=\\begin{pmatrix}k(x_1,x_2)&\\cdots&k(x_1,x_N)\\\\vdots&\\vdots&\\vdots\\k(x_N,x_1)&\\cdots&k(x_N,x_N)\\end{pmatrix} $$ \u4efb\u610f\u53d6 \\(\\alpha\\in\\mathbb{R}^N\\) \uff0c\u5373\u9700\u8981\u8bc1\u660e \\(\\alpha^TK\\alpha\\ge0\\) \uff1a $$ \\alpha^TK\\alpha=\\sum\\limits_{i,j}\\alpha_i\\alpha_jK_{ij}=\\sum\\limits_{i,j}\\alpha_i\\phi^T(x_i)\\phi(x_j)\\alpha_j=\\sum\\limits_{i}\\alpha_i\\phi^T(x_i)\\sum\\limits_{j}\\alpha_j\\phi(x_j) $$ \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u5185\u79ef\u7684\u5f62\u5f0f\uff0cHilbert \u7a7a\u95f4\u6ee1\u8db3\u7ebf\u6027\u6027\uff0c\u4e8e\u662f\u6b63\u5b9a\u6027\u7684\u8bc1\u3002 \\(\\Leftarrow\\) \uff1a\u5bf9\u4e8e \\(K\\) \u8fdb\u884c\u5206\u89e3\uff0c\u5bf9\u4e8e\u5bf9\u79f0\u77e9\u9635 \\(K=V\\Lambda V^T\\) \uff0c\u90a3\u4e48\u4ee4 \\(\\phi(x_i)=\\sqrt{\\lambda_i}V_i\\) \uff0c\u5176\u4e2d \\(V_i\\) \u662f\u7279\u5f81\u5411\u91cf\uff0c\u4e8e\u662f\u5c31\u6784\u9020\u4e86 \\(k(x,z)=\\sqrt{\\lambda_i\\lambda_j}V_i^TV_j\\) \u5c0f\u7ed3 \u5206\u7c7b\u95ee\u9898\u5728\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u90fd\u4f9d\u8d56 SVM\uff0c\u5bf9\u4e8e\u4e25\u683c\u53ef\u5206\u7684\u6570\u636e\u96c6\uff0cHard-margin SVM \u9009\u5b9a\u4e00\u4e2a\u8d85\u5e73\u9762\uff0c\u4fdd\u8bc1\u6240\u6709\u6570\u636e\u5230\u8fd9\u4e2a\u8d85\u5e73\u9762\u7684\u8ddd\u79bb\u6700\u5927\uff0c\u5bf9\u8fd9\u4e2a\u5e73\u9762\u65bd\u52a0\u7ea6\u675f\uff0c\u56fa\u5b9a \\(y_i(w^Tx_i+b)=1\\) \uff0c\u5f97\u5230\u4e86\u4e00\u4e2a\u51f8\u4f18\u5316\u95ee\u9898\u5e76\u4e14\u6240\u6709\u7684\u7ea6\u675f\u6761\u4ef6\u90fd\u662f\u4eff\u5c04\u51fd\u6570\uff0c\u4e8e\u662f\u6ee1\u8db3 Slater \u6761\u4ef6\uff0c\u5c06\u8fd9\u4e2a\u95ee\u9898\u53d8\u6362\u6210\u4e3a\u5bf9\u5076\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u5f97\u5230\u7b49\u4ef7\u7684\u89e3\uff0c\u5e76\u6c42\u51fa\u7ea6\u675f\u53c2\u6570\uff1a $$ \\max_{\\lambda}-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i,\\ s.t.\\ \\lambda_i\\ge0 $$ \u5bf9\u9700\u8981\u7684\u8d85\u5e73\u9762\u53c2\u6570\u7684\u6c42\u89e3\u91c7\u7528\u5f3a\u5bf9\u5076\u95ee\u9898\u7684 KKT \u6761\u4ef6\u8fdb\u884c\u3002 $$ \\begin{align} &\\frac{\\partial L}{\\partial w}=0,\\frac{\\partial L}{\\partial b}=0 \\&\\lambda_k(1-y_k(w^Tx_k+b))=0(slackness\\ complementary)\\ &\\lambda_i\\ge0\\ &1-y_i(w^Tx_i+b)\\le0 \\end{align} $$ \u89e3\u5c31\u662f\uff1a $$ \\hat{w}=\\sum\\limits_{i=1}^N\\lambda_iy_ix_i\\ \\hat{b}=y_k-w^Tx_k=y_k-\\sum\\limits_{i=1}^N\\lambda_iy_ix_i^Tx_k,\\exist k,1-y_k(w^Tx_k+b)=0 $$ \u5f53\u5141\u8bb8\u4e00\u70b9\u9519\u8bef\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728 Hard-margin SVM \u4e2d\u52a0\u5165\u9519\u8bef\u9879\u3002\u7528 Hinge Function \u8868\u793a\u9519\u8bef\u9879\u7684\u5927\u5c0f\uff0c\u5f97\u5230\uff1a $$ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw+C\\sum\\limits ^N\\xi_i\\ s.t.\\ y_i(w^Tx_i+b)\\ge1-\\xi_i,\\xi_i\\ge0,i=1,2,\\cdots,N $$ \u5bf9\u4e8e\u5b8c\u5168\u4e0d\u53ef\u5206\u7684\u95ee\u9898\uff0c\u6211\u4eec\u91c7\u7528\u7279\u5f81\u8f6c\u6362\u7684\u65b9\u5f0f\uff0c\u5728 SVM \u4e2d\uff0c\u6211\u4eec\u5f15\u5165\u6b63\u5b9a\u6838\u51fd\u6570\u6765\u76f4\u63a5\u5bf9\u5185\u79ef\u8fdb\u884c\u53d8\u6362\uff0c\u53ea\u8981\u8fd9\u4e2a\u53d8\u6362\u6ee1\u8db3\u5bf9\u79f0\u6027\u548c\u6b63\u5b9a\u6027\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u7528\u505a\u6838\u51fd\u6570\u3002","title":"5.SVM"},{"location":"Machine_Learning/5.SVM/#_1","text":"\u652f\u6491\u5411\u91cf\u673a\uff08SVM\uff09\u7b97\u6cd5\u5728\u5206\u7c7b\u95ee\u9898\u4e2d\u6709\u7740\u91cd\u8981\u5730\u4f4d\uff0c\u5176\u4e3b\u8981\u601d\u60f3\u662f\u6700\u5927\u5316\u4e24\u7c7b\u4e4b\u95f4\u7684\u95f4\u9694\u3002\u6309\u7167\u6570\u636e\u96c6\u7684\u7279\u70b9\uff1a \u7ebf\u6027\u53ef\u5206\u95ee\u9898\uff0c\u5982\u4e4b\u524d\u7684\u611f\u77e5\u673a\u7b97\u6cd5\u5904\u7406\u7684\u95ee\u9898 \u7ebf\u6027\u53ef\u5206\uff0c\u53ea\u6709\u4e00\u70b9\u70b9\u9519\u8bef\u70b9\uff0c\u5982\u611f\u77e5\u673a\u7b97\u6cd5\u53d1\u5c55\u51fa\u6765\u7684 Pocket \u7b97\u6cd5\u5904\u7406\u7684\u95ee\u9898 \u975e\u7ebf\u6027\u95ee\u9898\uff0c\u5b8c\u5168\u4e0d\u53ef\u5206\uff0c\u5982\u5728\u611f\u77e5\u673a\u95ee\u9898\u53d1\u5c55\u51fa\u6765\u7684\u591a\u5c42\u611f\u77e5\u673a\u548c\u6df1\u5ea6\u5b66\u4e60 \u8fd9\u4e09\u79cd\u60c5\u51b5\u5bf9\u4e8e SVM \u5206\u522b\u6709\u4e0b\u9762\u4e09\u79cd\u5904\u7406\u624b\u6bb5\uff1a hard-margin SVM soft-margin SVM kernel Method SVM \u7684\u6c42\u89e3\u4e2d\uff0c\u5927\u91cf\u7528\u5230\u4e86 Lagrange \u4e58\u5b50\u6cd5\uff0c\u9996\u5148\u5bf9\u8fd9\u79cd\u65b9\u6cd5\u8fdb\u884c\u4ecb\u7ecd\u3002","title":"\u652f\u6491\u5411\u91cf\u673a"},{"location":"Machine_Learning/5.SVM/#_2","text":"\u4e00\u822c\u5730\uff0c\u7ea6\u675f\u4f18\u5316\u95ee\u9898\uff08\u539f\u95ee\u9898\uff09\u53ef\u4ee5\u5199\u6210\uff1a $$ \\begin{align} &\\min_{x\\in\\mathbb{R^p}}f(x)\\ &s.t.\\ m_i(x)\\le0,i=1,2,\\cdots,M\\ &\\ \\ \\ \\ \\ \\ \\ \\ n_j(x)=0,j=1,2,\\cdots,N \\end{align} $$ \u5b9a\u4e49 Lagrange \u51fd\u6570\uff1a $$ L(x,\\lambda,\\eta)=f(x)+\\sum\\limits_{i=1}^M\\lambda_im_i(x)+\\sum\\limits_{i=1}^N\\eta_in_i(x) $$ \u90a3\u4e48\u539f\u95ee\u9898\u53ef\u4ee5\u7b49\u4ef7\u4e8e\u65e0\u7ea6\u675f\u5f62\u5f0f\uff1a $$ \\min_{x\\in\\mathbb{R}^p}\\max_{\\lambda,\\eta}L(x,\\lambda,\\eta)\\ s.t.\\ \\lambda_i\\ge0 $$ \u8fd9\u662f\u7531\u4e8e\uff0c\u5f53\u6ee1\u8db3\u539f\u95ee\u9898\u7684\u4e0d\u7b49\u5f0f\u7ea6\u675f\u7684\u65f6\u5019\uff0c \\(\\lambda_i=0\\) \u624d\u80fd\u53d6\u5f97\u6700\u5927\u503c\uff0c\u76f4\u63a5\u7b49\u4ef7\u4e8e\u539f\u95ee\u9898\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u539f\u95ee\u9898\u7684\u4e0d\u7b49\u5f0f\u7ea6\u675f\uff0c\u90a3\u4e48\u6700\u5927\u503c\u5c31\u4e3a \\(+ \\infty\\) \uff0c\u7531\u4e8e\u9700\u8981\u53d6\u6700\u5c0f\u503c\uff0c\u4e8e\u662f\u4e0d\u4f1a\u53d6\u5230\u8fd9\u4e2a\u60c5\u51b5\u3002 \u8fd9\u4e2a\u95ee\u9898\u7684\u5bf9\u5076\u5f62\u5f0f\uff1a $$ \\max_{\\lambda,\\eta}\\min_{x\\in\\mathbb{R}^p}L(x,\\lambda,\\eta)\\ s.t.\\ \\lambda_i\\ge0 $$ \u5bf9\u5076\u95ee\u9898\u662f\u5173\u4e8e \\(\\lambda, \\eta\\) \u7684\u6700\u5927\u5316\u95ee\u9898\u3002 \u7531\u4e8e\uff1a $$ \\max_{\\lambda_i,\\eta_j}\\min_{x}L(x,\\lambda_i,\\eta_j)\\le\\min_{x}\\max_{\\lambda_i,\\eta_j}L(x,\\lambda_i,\\eta_j) $$ \u8bc1\u660e\uff1a\u663e\u7136\u6709 \\(\\min\\limits_{x}L\\le L\\le\\max\\limits_{\\lambda,\\eta}L\\) \uff0c\u4e8e\u662f\u663e\u7136\u6709 \\(\\max\\limits_{\\lambda,\\eta}\\min\\limits_{x}L\\le L\\) \uff0c\u4e14 \\(\\min\\limits_{x}\\max\\limits_{\\lambda,\\eta}L\\ge L\\) \u3002 \u5bf9\u5076\u95ee\u9898\u7684\u89e3\u5c0f\u4e8e\u539f\u95ee\u9898\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\uff1a \u5f3a\u5bf9\u5076\uff1a\u53ef\u4ee5\u53d6\u7b49\u4e8e\u53f7 \u5f31\u5bf9\u5076\uff1a\u4e0d\u53ef\u4ee5\u53d6\u7b49\u4e8e\u53f7 \u5176\u5b9e\u8fd9\u4e00\u70b9\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e00\u5f20\u56fe\u6765\u8bf4\u660e\uff1a \u5bf9\u4e8e\u4e00\u4e2a\u51f8\u4f18\u5316\u95ee\u9898\uff0c\u6709\u5982\u4e0b\u5b9a\u7406\uff1a \u5982\u679c\u51f8\u4f18\u5316\u95ee\u9898\u6ee1\u8db3\u67d0\u4e9b\u6761\u4ef6\u5982 Slater \u6761\u4ef6\uff0c\u90a3\u4e48\u5b83\u548c\u5176\u5bf9\u5076\u95ee\u9898\u6ee1\u8db3\u5f3a\u5bf9\u5076\u5173\u7cfb\u3002\u8bb0\u95ee\u9898\u7684\u5b9a\u4e49\u57df\u4e3a\uff1a \\(\\mathcal{D}=domf(x)\\cap dom m_i(x)\\cap domn_j(x)\\) \u3002\u4e8e\u662f Slater \u6761\u4ef6\u4e3a\uff1a $$ \\exist\\hat{x}\\in Relint\\mathcal{D}\\ s.t.\\ \\forall i=1,2,\\cdots,M,m_i(x)\\lt0 $$ \u5176\u4e2d Relint \u8868\u793a\u76f8\u5bf9\u5185\u90e8\uff08\u4e0d\u5305\u542b\u8fb9\u754c\u7684\u5185\u90e8\uff09\u3002 \u5bf9\u4e8e\u5927\u591a\u6570\u51f8\u4f18\u5316\u95ee\u9898\uff0cSlater \u6761\u4ef6\u6210\u7acb\u3002 \u677e\u5f1b Slater \u6761\u4ef6\uff0c\u5982\u679c M \u4e2a\u4e0d\u7b49\u5f0f\u7ea6\u675f\u4e2d\uff0c\u6709 K \u4e2a\u51fd\u6570\u4e3a\u4eff\u5c04\u51fd\u6570\uff0c\u90a3\u4e48\u53ea\u8981\u5176\u4f59\u7684\u51fd\u6570\u6ee1\u8db3 Slater \u6761\u4ef6\u5373\u53ef\u3002 \u4e0a\u9762\u4ecb\u7ecd\u4e86\u539f\u95ee\u9898\u548c\u5bf9\u5076\u95ee\u9898\u7684\u5bf9\u5076\u5173\u7cfb\uff0c\u4f46\u662f\u5b9e\u9645\u8fd8\u9700\u8981\u5bf9\u53c2\u6570\u8fdb\u884c\u6c42\u89e3\uff0c\u6c42\u89e3\u65b9\u6cd5\u4f7f\u7528 KKT \u6761\u4ef6\u8fdb\u884c\uff1a KKT \u6761\u4ef6\u548c\u5f3a\u5bf9\u5076\u5173\u7cfb\u662f\u7b49\u4ef7\u5173\u7cfb\u3002KKT \u6761\u4ef6\u5bf9\u6700\u4f18\u89e3\u7684\u6761\u4ef6\u4e3a\uff1a \u53ef\u884c\u57df\uff1a $$ \\begin{align} m_i(x^ )\\le0\\ n_j(x^ )=0\\ \\lambda^*\\ge0 \\end{align} $$ \u4e92\u8865\u677e\u5f1b \\(\\lambda^*m_i(x^*)=0,\\forall m_i\\) \uff0c\u5bf9\u5076\u95ee\u9898\u7684\u6700\u4f73\u503c\u4e3a \\(d^*\\) \uff0c\u539f\u95ee\u9898\u4e3a \\(p^*\\) $$ \\begin{align} d^ &=\\max_{\\lambda,\\eta}g(\\lambda,\\eta)=g(\\lambda^ ,\\eta^ )\\nonumber\\ &=\\min_{x}L(x,\\lambda^ ,\\eta^ )\\nonumber\\ &\\le L(x^ ,\\lambda^ ,\\eta^ )\\nonumber\\ &=f(x^ )+\\sum\\limits_{i=1}^M\\lambda^ m_i(x^ )\\nonumber\\ &\\le f(x^ )=p^* \\end{align} $$ \u4e3a\u4e86\u6ee1\u8db3\u76f8\u7b49\uff0c\u4e24\u4e2a\u4e0d\u7b49\u5f0f\u5fc5\u987b\u6210\u7acb\uff0c\u4e8e\u662f\uff0c\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u4e0d\u7b49\u4e8e\u53f7\uff0c\u9700\u8981\u6709\u68af\u5ea6\u4e3a0\u6761\u4ef6\uff0c\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u4e0d\u7b49\u4e8e\u53f7\u9700\u8981\u6ee1\u8db3\u4e92\u8865\u677e\u5f1b\u6761\u4ef6\u3002 \u68af\u5ea6\u4e3a0\uff1a \\(\\frac{\\partial L(x,\\lambda^*,\\eta^*)}{\\partial x}|_{x=x^*}=0\\)","title":"\u7ea6\u675f\u4f18\u5316\u95ee\u9898"},{"location":"Machine_Learning/5.SVM/#hard-margin-svm","text":"\u652f\u6491\u5411\u91cf\u673a\u4e5f\u662f\u4e00\u79cd\u786c\u5206\u7c7b\u6a21\u578b\uff0c\u5728\u4e4b\u524d\u7684\u611f\u77e5\u673a\u6a21\u578b\u4e2d\uff0c\u6211\u4eec\u5728\u7ebf\u6027\u6a21\u578b\u7684\u57fa\u7840\u4e0a\u53e0\u52a0\u4e86\u7b26\u53f7\u51fd\u6570\uff0c\u5728\u51e0\u4f55\u76f4\u89c2\u4e0a\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u4e24\u7c7b\u5206\u7684\u5f88\u5f00\u7684\u8bdd\uff0c\u90a3\u4e48\u5176\u5b9e\u4f1a\u5b58\u5728\u65e0\u7a77\u591a\u6761\u7ebf\u53ef\u4ee5\u5c06\u4e24\u7c7b\u5206\u5f00\u3002\u5728 SVM \u4e2d\uff0c\u6211\u4eec\u5f15\u5165\u6700\u5927\u5316\u95f4\u9694\u8fd9\u4e2a\u6982\u5ff5\uff0c\u95f4\u9694\u6307\u7684\u662f\u6570\u636e\u548c\u76f4\u7ebf\u7684\u8ddd\u79bb\u7684\u6700\u5c0f\u503c\uff0c\u56e0\u6b64\u6700\u5927\u5316\u8fd9\u4e2a\u503c\u53cd\u6620\u4e86\u6211\u4eec\u7684\u6a21\u578b\u503e\u5411\u3002 \u5206\u5272\u7684\u8d85\u5e73\u9762\u53ef\u4ee5\u5199\u4e3a\uff1a $$ 0=w^Tx+b $$ \u90a3\u4e48\u6700\u5927\u5316\u95f4\u9694\uff08\u7ea6\u675f\u4e3a\u5206\u7c7b\u4efb\u52a1\u7684\u8981\u6c42\uff09\uff1a $$ \\mathop{argmax} {w,b}[\\min_i\\frac{|w^Tx_i+b|}{||w||}]\\ s.t.\\ y_i(w^Tx_i+b)>0\\ \\Longrightarrow\\mathop{argmax} [\\min_i\\frac{y_i(w^Tx_i+b)}{||w||}]\\ s.t.\\ y_i(w^Tx_i+b)>0 $$ \u5bf9\u4e8e\u8fd9\u4e2a\u7ea6\u675f \\(y_i(w^Tx_i+b)>0\\) \uff0c\u4e0d\u59a8\u56fa\u5b9a \\(\\min y_i(w^Tx_i+b)=1>0\\) \uff0c\u8fd9\u662f\u7531\u4e8e\u5206\u5f00\u4e24\u7c7b\u7684\u8d85\u5e73\u9762\u7684\u7cfb\u6570\u7ecf\u8fc7\u6bd4\u4f8b\u653e\u7f29\u4e0d\u4f1a\u6539\u53d8\u8fd9\u4e2a\u5e73\u9762\uff0c\u8fd9\u4e5f\u76f8\u5f53\u4e8e\u7ed9\u8d85\u5e73\u9762\u7684\u7cfb\u6570\u4f5c\u51fa\u4e86\u7ea6\u675f\u3002\u5316\u7b80\u540e\u7684\u5f0f\u5b50\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a $$ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw\\ s.t.\\ \\min_iy_i(w^Tx_i+b)=1\\ \\Rightarrow\\mathop{argmin} \\frac{1}{2}w^Tw\\ s.t.\\ y_i(w^Tx_i+b)\\ge1,i=1,2,\\cdots,N $$ \u8fd9\u5c31\u662f\u4e00\u4e2a\u5305\u542b \\(N\\) \u4e2a\u7ea6\u675f\u7684\u51f8\u4f18\u5316\u95ee\u9898\uff0c\u6709\u5f88\u591a\u6c42\u89e3\u8fd9\u79cd\u95ee\u9898\u7684\u8f6f\u4ef6\u3002 \u4f46\u662f\uff0c\u5982\u679c\u6837\u672c\u6570\u91cf\u6216\u7ef4\u5ea6\u975e\u5e38\u9ad8\uff0c\u76f4\u63a5\u6c42\u89e3\u56f0\u96be\u751a\u81f3\u4e0d\u53ef\u89e3\uff0c\u4e8e\u662f\u9700\u8981\u5bf9\u8fd9\u4e2a\u95ee\u9898\u8fdb\u4e00\u6b65\u5904\u7406\u3002\u5f15\u5165 Lagrange \u51fd\u6570\uff1a $$ L(w,b,\\lambda)=\\frac{1}{2}w^Tw+\\sum\\limits_{i=1}^N\\lambda_i(1-y_i(w^Tx_i+b)) $$ \u6211\u4eec\u6709\u539f\u95ee\u9898\u5c31\u7b49\u4ef7\u4e8e\uff1a $$ \\mathop{argmin} {w,b}\\max L(w,b,\\lambda_i)\\ s.t.\\ \\lambda_i\\ge0 $$ \u6211\u4eec\u4ea4\u6362\u6700\u5c0f\u548c\u6700\u5927\u503c\u7684\u7b26\u53f7\u5f97\u5230\u5bf9\u5076\u95ee\u9898\uff1a $$ \\max_{\\lambda_i}\\min_{w,b}L(w,b,\\lambda_i)\\ s.t.\\ \\lambda_i\\ge0 $$ \u7531\u4e8e\u4e0d\u7b49\u5f0f\u7ea6\u675f\u662f\u4eff\u5c04\u51fd\u6570\uff0c\u5bf9\u5076\u95ee\u9898\u548c\u539f\u95ee\u9898\u7b49\u4ef7\uff1a \\(b\\) \uff1a \\(\\frac{\\partial}{\\partial b}L=0\\Rightarrow\\sum\\limits_{i=1}^N\\lambda_iy_i=0\\) \\(w\\) \uff1a\u9996\u5148\u5c06 \\(b\\) \u4ee3\u5165\uff1a $$ L(w,b,\\lambda_i)=\\frac{1}{2}w^Tw+\\sum\\limits_{i=1}^N\\lambda_i(1-y_iw^Tx_i-y_ib)=\\frac{1}{2}w^Tw+\\sum\\limits_{i=1}^N\\lambda_i-\\sum\\limits_{i=1}^N\\lambda_iy_iw^Tx_i $$ \u6240\u4ee5\uff1a $$ \\frac{\\partial}{\\partial w}L=0\\Rightarrow w=\\sum\\limits_{i=1}^N\\lambda_iy_ix_i $$ \u5c06\u4e0a\u9762\u4e24\u4e2a\u53c2\u6570\u4ee3\u5165\uff1a $$ L(w,b,\\lambda_i)=-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i $$ \u56e0\u6b64\uff0c\u5bf9\u5076\u95ee\u9898\u5c31\u662f\uff1a $$ \\max_{\\lambda}-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i,\\ s.t.\\ \\lambda_i\\ge0 $$ \u4ece KKT \u6761\u4ef6\u5f97\u5230\u8d85\u5e73\u9762\u7684\u53c2\u6570\uff1a \u539f\u95ee\u9898\u548c\u5bf9\u5076\u95ee\u9898\u6ee1\u8db3\u5f3a\u5bf9\u5076\u5173\u7cfb\u7684\u5145\u8981\u6761\u4ef6\u4e3a\u5176\u6ee1\u8db3 KKT \u6761\u4ef6\uff1a $$ \\begin{align} &\\frac{\\partial L}{\\partial w}=0,\\frac{\\partial L}{\\partial b}=0 \\&\\lambda_k(1-y_k(w^Tx_k+b))=0(slackness\\ complementary)\\ &\\lambda_i\\ge0\\ &1-y_i(w^Tx_i+b)\\le0 \\end{align} $$ \u6839\u636e\u8fd9\u4e2a\u6761\u4ef6\u5c31\u5f97\u5230\u4e86\u5bf9\u5e94\u7684\u6700\u4f73\u53c2\u6570\uff1a $$ \\hat{w}=\\sum\\limits_{i=1}^N\\lambda_iy_ix_i\\ \\hat{b}=y_k-w^Tx_k=y_k-\\sum\\limits_{i=1}^N\\lambda_iy_ix_i^Tx_k,\\exist k,1-y_k(w^Tx_k+b)=0 $$ \u4e8e\u662f\u8fd9\u4e2a\u8d85\u5e73\u9762\u7684\u53c2\u6570 \\(w\\) \u5c31\u662f\u6570\u636e\u70b9\u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u6700\u7ec8\u7684\u53c2\u6570\u503c\u5c31\u662f\u90e8\u5206\u6ee1\u8db3 \\(y_i(w^Tx_i+b)=1\\) \u5411\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\uff08\u4e92\u8865\u677e\u5f1b\u6761\u4ef6\u7ed9\u51fa\uff09\uff0c\u8fd9\u4e9b\u5411\u91cf\u4e5f\u53eb\u652f\u6491\u5411\u91cf\u3002","title":"Hard-margin SVM"},{"location":"Machine_Learning/5.SVM/#soft-margin-svm","text":"Hard-margin \u7684 SVM \u53ea\u5bf9\u53ef\u5206\u6570\u636e\u53ef\u89e3\uff0c\u5982\u679c\u4e0d\u53ef\u5206\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u7684\u57fa\u672c\u60f3\u6cd5\u662f\u5728\u635f\u5931\u51fd\u6570\u4e2d\u52a0\u5165\u9519\u8bef\u5206\u7c7b\u7684\u53ef\u80fd\u6027\u3002\u9519\u8bef\u5206\u7c7b\u7684\u4e2a\u6570\u53ef\u4ee5\u5199\u6210\uff1a $$ error=\\sum\\limits_{i=1}^N\\mathbb{I}{y_i(w^Tx_i+b)\\lt1} $$ \u8fd9\u4e2a\u51fd\u6570\u4e0d\u8fde\u7eed\uff0c\u53ef\u4ee5\u5c06\u5176\u6539\u5199\u4e3a\uff1a $$ error=\\sum\\limits_{i=1}^N\\max{0,1-y_i(w^Tx_i+b)} $$ \u6c42\u548c\u7b26\u53f7\u4e2d\u7684\u5f0f\u5b50\u53c8\u53eb\u505a Hinge Function\u3002 \u5c06\u8fd9\u4e2a\u9519\u8bef\u52a0\u5165 Hard-margin SVM \u4e2d\uff0c\u4e8e\u662f\uff1a $$ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw+C\\sum\\limits ^N\\max{0,1-y_i(w^Tx_i+b)}\\ s.t.\\ y_i(w^Tx_i+b)\\ge1-\\xi_i,i=1,2,\\cdots,N $$ \u8fd9\u4e2a\u5f0f\u5b50\u4e2d\uff0c\u5e38\u6570 \\(C\\) \u53ef\u4ee5\u770b\u4f5c\u5141\u8bb8\u7684\u9519\u8bef\u6c34\u5e73\uff0c\u540c\u65f6\u4e0a\u5f0f\u4e3a\u4e86\u8fdb\u4e00\u6b65\u6d88\u9664 \\(\\max\\) \u7b26\u53f7\uff0c\u5bf9\u6570\u636e\u96c6\u4e2d\u7684\u6bcf\u4e00\u4e2a\u89c2\u6d4b\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u5176\u5927\u90e8\u5206\u6ee1\u8db3\u7ea6\u675f\uff0c\u4f46\u662f\u5176\u4e2d\u90e8\u5206\u8fdd\u53cd\u7ea6\u675f\uff0c\u56e0\u6b64\u8fd9\u90e8\u5206\u7ea6\u675f\u53d8\u6210 \\(y_i(w^Tx+b)\\ge1-\\xi_i\\) \uff0c\u5176\u4e2d \\(\\xi_i=1-y_i(w^Tx_i+b)\\) \uff0c\u8fdb\u4e00\u6b65\u7684\u5316\u7b80\uff1a $$ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw+C\\sum\\limits ^N\\xi_i\\ s.t.\\ y_i(w^Tx_i+b)\\ge1-\\xi_i,\\xi_i\\ge0,i=1,2,\\cdots,N $$","title":"Soft-margin SVM"},{"location":"Machine_Learning/5.SVM/#kernel-method","text":"\u6838\u65b9\u6cd5\u53ef\u4ee5\u5e94\u7528\u5728\u5f88\u591a\u95ee\u9898\u4e0a\uff0c\u5728\u5206\u7c7b\u95ee\u9898\u4e2d\uff0c\u5bf9\u4e8e\u4e25\u683c\u4e0d\u53ef\u5206\u95ee\u9898\uff0c\u6211\u4eec\u5f15\u5165\u4e00\u4e2a\u7279\u5f81\u8f6c\u6362\u51fd\u6570\u5c06\u539f\u6765\u7684\u4e0d\u53ef\u5206\u7684\u6570\u636e\u96c6\u53d8\u4e3a\u53ef\u5206\u7684\u6570\u636e\u96c6\uff0c\u7136\u540e\u518d\u6765\u5e94\u7528\u5df2\u6709\u7684\u6a21\u578b\u3002\u5f80\u5f80\u5c06\u4f4e\u7ef4\u7a7a\u95f4\u7684\u6570\u636e\u96c6\u53d8\u4e3a\u9ad8\u7ef4\u7a7a\u95f4\u7684\u6570\u636e\u96c6\u540e\uff0c\u6570\u636e\u4f1a\u53d8\u5f97\u53ef\u5206\uff08\u6570\u636e\u53d8\u5f97\u66f4\u4e3a\u7a00\u758f\uff09\uff1a Cover TH\uff1a\u9ad8\u7ef4\u7a7a\u95f4\u6bd4\u4f4e\u7ef4\u7a7a\u95f4\u66f4\u6613\u7ebf\u6027\u53ef\u5206\u3002 \u5e94\u7528\u5728 SVM \u4e2d\u65f6\uff0c\u89c2\u5bdf\u4e0a\u9762\u7684 SVM \u5bf9\u5076\u95ee\u9898\uff1a $$ \\max_{\\lambda}-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i,\\ s.t.\\ \\lambda_i\\ge0 $$ \u5728\u6c42\u89e3\u7684\u65f6\u5019\u9700\u8981\u6c42\u5f97\u5185\u79ef\uff0c\u4e8e\u662f\u4e0d\u53ef\u5206\u6570\u636e\u5728\u901a\u8fc7\u7279\u5f81\u53d8\u6362\u540e\uff0c\u9700\u8981\u6c42\u5f97\u53d8\u6362\u540e\u7684\u5185\u79ef\u3002\u6211\u4eec\u5e38\u5e38\u5f88\u96be\u6c42\u5f97\u53d8\u6362\u51fd\u6570\u7684\u5185\u79ef\u3002\u4e8e\u662f\u76f4\u63a5\u5f15\u5165\u5185\u79ef\u7684\u53d8\u6362\u51fd\u6570\uff1a $$ \\forall x,x'\\in\\mathcal{X},\\exist\\phi\\in\\mathcal{H}:x\\rightarrow z\\ s.t.\\ k(x,x')=\\phi(x)^T\\phi(x) $$ \u79f0 \\(k(x,x')\\) \u4e3a\u4e00\u4e2a\u6b63\u5b9a\u6838\u51fd\u6570\uff0c\u5176\u4e2d \\(\\mathcal{H}\\) \u662f Hilbert \u7a7a\u95f4\uff08\u5b8c\u5907\u7684\u7ebf\u6027\u5185\u79ef\u7a7a\u95f4\uff09\uff0c\u5982\u679c\u53bb\u6389\u5185\u79ef\u8fd9\u4e2a\u6761\u4ef6\u6211\u4eec\u7b80\u5355\u5730\u79f0\u4e3a\u6838\u51fd\u6570\u3002 \\(k(x,x')=\\exp(-\\frac{(x-x')^2}{2\\sigma^2})\\) \u662f\u4e00\u4e2a\u6838\u51fd\u6570\u3002 \u8bc1\u660e\uff1a $$ \\begin{align} \\exp(-\\frac{(x-x')^2}{2\\sigma^2})&=\\exp(-\\frac{x^2}{2\\sigma^2})\\exp(\\frac{xx'}{\\sigma^2})\\exp(-\\frac{x'^2}{2\\sigma^2})\\nonumber\\ &=\\exp(-\\frac{x^2}{2\\sigma^2})\\sum\\limits_{n=0}^{+\\infty}\\frac{x^nx'^n}{\\sigma^{2n}n!}\\exp(-\\frac{x'^2}{2\\sigma^2})\\nonumber\\ &=\\exp(-\\frac{x^2}{2\\sigma^2})\\varphi(x)\\varphi(x')\\exp(-\\frac{x'^2}{2\\sigma^2})\\nonumber\\ &=\\phi(x)\\phi(x') \\end{align} $$ \u6b63\u5b9a\u6838\u51fd\u6570\u6709\u4e0b\u9762\u7684\u7b49\u4ef7\u5b9a\u4e49\uff1a \u5982\u679c\u6838\u51fd\u6570\u6ee1\u8db3\uff1a \u5bf9\u79f0\u6027 \u6b63\u5b9a\u6027 \u90a3\u4e48\u8fd9\u4e2a\u6838\u51fd\u6570\u65f6\u6b63\u5b9a\u6838\u51fd\u6570\u3002 \u8bc1\u660e\uff1a \u5bf9\u79f0\u6027 \\(\\Leftrightarrow\\) \\(k(x,z)=k(z,x)\\) \uff0c\u663e\u7136\u6ee1\u8db3\u5185\u79ef\u7684\u5b9a\u4e49 \u6b63\u5b9a\u6027 \\(\\Leftrightarrow\\) \\(\\forall N,x_1,x_2,\\cdots,x_N\\in\\mathcal{X}\\) \uff0c\u5bf9\u5e94\u7684 Gram Matrix \\(K=[k(x_i,x_j)]\\) \u662f\u534a\u6b63\u5b9a\u7684\u3002 \u8981\u8bc1\uff1a \\(k(x,z)=\\phi(x)^T\\phi(z)\\Leftrightarrow K\\) \u534a\u6b63\u5b9a+\u5bf9\u79f0\u6027\u3002 \\(\\Rightarrow\\) \uff1a\u9996\u5148\uff0c\u5bf9\u79f0\u6027\u662f\u663e\u7136\u7684\uff0c\u5bf9\u4e8e\u6b63\u5b9a\u6027\uff1a $$ K=\\begin{pmatrix}k(x_1,x_2)&\\cdots&k(x_1,x_N)\\\\vdots&\\vdots&\\vdots\\k(x_N,x_1)&\\cdots&k(x_N,x_N)\\end{pmatrix} $$ \u4efb\u610f\u53d6 \\(\\alpha\\in\\mathbb{R}^N\\) \uff0c\u5373\u9700\u8981\u8bc1\u660e \\(\\alpha^TK\\alpha\\ge0\\) \uff1a $$ \\alpha^TK\\alpha=\\sum\\limits_{i,j}\\alpha_i\\alpha_jK_{ij}=\\sum\\limits_{i,j}\\alpha_i\\phi^T(x_i)\\phi(x_j)\\alpha_j=\\sum\\limits_{i}\\alpha_i\\phi^T(x_i)\\sum\\limits_{j}\\alpha_j\\phi(x_j) $$ \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u5185\u79ef\u7684\u5f62\u5f0f\uff0cHilbert \u7a7a\u95f4\u6ee1\u8db3\u7ebf\u6027\u6027\uff0c\u4e8e\u662f\u6b63\u5b9a\u6027\u7684\u8bc1\u3002 \\(\\Leftarrow\\) \uff1a\u5bf9\u4e8e \\(K\\) \u8fdb\u884c\u5206\u89e3\uff0c\u5bf9\u4e8e\u5bf9\u79f0\u77e9\u9635 \\(K=V\\Lambda V^T\\) \uff0c\u90a3\u4e48\u4ee4 \\(\\phi(x_i)=\\sqrt{\\lambda_i}V_i\\) \uff0c\u5176\u4e2d \\(V_i\\) \u662f\u7279\u5f81\u5411\u91cf\uff0c\u4e8e\u662f\u5c31\u6784\u9020\u4e86 \\(k(x,z)=\\sqrt{\\lambda_i\\lambda_j}V_i^TV_j\\)","title":"Kernel Method"},{"location":"Machine_Learning/5.SVM/#_3","text":"\u5206\u7c7b\u95ee\u9898\u5728\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u90fd\u4f9d\u8d56 SVM\uff0c\u5bf9\u4e8e\u4e25\u683c\u53ef\u5206\u7684\u6570\u636e\u96c6\uff0cHard-margin SVM \u9009\u5b9a\u4e00\u4e2a\u8d85\u5e73\u9762\uff0c\u4fdd\u8bc1\u6240\u6709\u6570\u636e\u5230\u8fd9\u4e2a\u8d85\u5e73\u9762\u7684\u8ddd\u79bb\u6700\u5927\uff0c\u5bf9\u8fd9\u4e2a\u5e73\u9762\u65bd\u52a0\u7ea6\u675f\uff0c\u56fa\u5b9a \\(y_i(w^Tx_i+b)=1\\) \uff0c\u5f97\u5230\u4e86\u4e00\u4e2a\u51f8\u4f18\u5316\u95ee\u9898\u5e76\u4e14\u6240\u6709\u7684\u7ea6\u675f\u6761\u4ef6\u90fd\u662f\u4eff\u5c04\u51fd\u6570\uff0c\u4e8e\u662f\u6ee1\u8db3 Slater \u6761\u4ef6\uff0c\u5c06\u8fd9\u4e2a\u95ee\u9898\u53d8\u6362\u6210\u4e3a\u5bf9\u5076\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u5f97\u5230\u7b49\u4ef7\u7684\u89e3\uff0c\u5e76\u6c42\u51fa\u7ea6\u675f\u53c2\u6570\uff1a $$ \\max_{\\lambda}-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i,\\ s.t.\\ \\lambda_i\\ge0 $$ \u5bf9\u9700\u8981\u7684\u8d85\u5e73\u9762\u53c2\u6570\u7684\u6c42\u89e3\u91c7\u7528\u5f3a\u5bf9\u5076\u95ee\u9898\u7684 KKT \u6761\u4ef6\u8fdb\u884c\u3002 $$ \\begin{align} &\\frac{\\partial L}{\\partial w}=0,\\frac{\\partial L}{\\partial b}=0 \\&\\lambda_k(1-y_k(w^Tx_k+b))=0(slackness\\ complementary)\\ &\\lambda_i\\ge0\\ &1-y_i(w^Tx_i+b)\\le0 \\end{align} $$ \u89e3\u5c31\u662f\uff1a $$ \\hat{w}=\\sum\\limits_{i=1}^N\\lambda_iy_ix_i\\ \\hat{b}=y_k-w^Tx_k=y_k-\\sum\\limits_{i=1}^N\\lambda_iy_ix_i^Tx_k,\\exist k,1-y_k(w^Tx_k+b)=0 $$ \u5f53\u5141\u8bb8\u4e00\u70b9\u9519\u8bef\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728 Hard-margin SVM \u4e2d\u52a0\u5165\u9519\u8bef\u9879\u3002\u7528 Hinge Function \u8868\u793a\u9519\u8bef\u9879\u7684\u5927\u5c0f\uff0c\u5f97\u5230\uff1a $$ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw+C\\sum\\limits ^N\\xi_i\\ s.t.\\ y_i(w^Tx_i+b)\\ge1-\\xi_i,\\xi_i\\ge0,i=1,2,\\cdots,N $$ \u5bf9\u4e8e\u5b8c\u5168\u4e0d\u53ef\u5206\u7684\u95ee\u9898\uff0c\u6211\u4eec\u91c7\u7528\u7279\u5f81\u8f6c\u6362\u7684\u65b9\u5f0f\uff0c\u5728 SVM \u4e2d\uff0c\u6211\u4eec\u5f15\u5165\u6b63\u5b9a\u6838\u51fd\u6570\u6765\u76f4\u63a5\u5bf9\u5185\u79ef\u8fdb\u884c\u53d8\u6362\uff0c\u53ea\u8981\u8fd9\u4e2a\u53d8\u6362\u6ee1\u8db3\u5bf9\u79f0\u6027\u548c\u6b63\u5b9a\u6027\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u7528\u505a\u6838\u51fd\u6570\u3002","title":"\u5c0f\u7ed3"},{"location":"Machine_Learning/6.Exponentialfamily/","text":"\u6307\u6570\u65cf\u5206\u5e03 \u6307\u6570\u65cf\u662f\u4e00\u7c7b\u5206\u5e03\uff0c\u5305\u62ec\u9ad8\u65af\u5206\u5e03\u3001\u4f2f\u52aa\u5229\u5206\u5e03\u3001\u4e8c\u9879\u5206\u5e03\u3001\u6cca\u677e\u5206\u5e03\u3001Beta \u5206\u5e03\u3001Dirichlet \u5206\u5e03\u3001Gamma \u5206\u5e03\u7b49\u4e00\u7cfb\u5217\u5206\u5e03\u3002\u6307\u6570\u65cf\u5206\u5e03\u53ef\u4ee5\u5199\u4e3a\u7edf\u4e00\u7684\u5f62\u5f0f\uff1a $$ p(x|\\eta)=h(x)\\exp(\\eta^T\\phi(x)-A(\\eta))=\\frac{1}{\\exp(A(\\eta))}h(x)\\exp(\\eta^T\\phi(x)) $$ \u5176\u4e2d\uff0c \\(\\eta\\) \u662f\u53c2\u6570\u5411\u91cf\uff0c \\(A(\\eta)\\) \u662f\u5bf9\u6570\u914d\u5206\u51fd\u6570\uff08\u5f52\u4e00\u5316\u56e0\u5b50\uff09\u3002 \u5728\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\uff0c \\(\\phi(x)\\) \u53eb\u505a\u5145\u5206\u7edf\u8ba1\u91cf\uff0c\u5305\u542b\u6837\u672c\u96c6\u5408\u6240\u6709\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u9ad8\u65af\u5206\u5e03\u4e2d\u7684\u5747\u503c\u548c\u65b9\u5dee\u3002\u5145\u5206\u7edf\u8ba1\u91cf\u5728\u5728\u7ebf\u5b66\u4e60\u4e2d\u6709\u5e94\u7528\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6570\u636e\u96c6\uff0c\u53ea\u9700\u8981\u8bb0\u5f55\u6837\u672c\u7684\u5145\u5206\u7edf\u8ba1\u91cf\u5373\u53ef\u3002 \u5bf9\u4e8e\u4e00\u4e2a\u6a21\u578b\u5206\u5e03\u5047\u8bbe\uff08\u4f3c\u7136\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u6c42\u89e3\u4e2d\uff0c\u5e38\u5e38\u9700\u8981\u5bfb\u627e\u4e00\u4e2a\u5171\u8f6d\u5148\u9a8c\uff0c\u4f7f\u5f97\u5148\u9a8c\u4e0e\u540e\u9a8c\u7684\u5f62\u5f0f\u76f8\u540c\uff0c\u4f8b\u5982\u9009\u53d6\u4f3c\u7136\u662f\u4e8c\u9879\u5206\u5e03\uff0c\u53ef\u53d6\u5148\u9a8c\u662f Beta \u5206\u5e03\uff0c\u90a3\u4e48\u540e\u9a8c\u4e5f\u662f Beta \u5206\u5e03\u3002\u6307\u6570\u65cf\u5206\u5e03\u5e38\u5e38\u5177\u6709\u5171\u8f6d\u7684\u6027\u8d28\uff0c\u4e8e\u662f\u6211\u4eec\u5728\u6a21\u578b\u9009\u62e9\u4ee5\u53ca\u63a8\u65ad\u5177\u6709\u5f88\u5927\u7684\u4fbf\u5229\u3002 \u5171\u8f6d\u5148\u9a8c\u7684\u6027\u8d28\u4fbf\u4e8e\u8ba1\u7b97\uff0c\u540c\u65f6\uff0c\u6307\u6570\u65cf\u5206\u5e03\u6ee1\u8db3\u6700\u5927\u71b5\u7684\u601d\u60f3\uff08\u65e0\u4fe1\u606f\u5148\u9a8c\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u7ecf\u9a8c\u5206\u5e03\u5229\u7528\u6700\u5927\u71b5\u539f\u7406\u5bfc\u51fa\u7684\u5206\u5e03\u5c31\u662f\u6307\u6570\u65cf\u5206\u5e03\u3002 \u89c2\u5bdf\u5230\u6307\u6570\u65cf\u5206\u5e03\u7684\u8868\u8fbe\u5f0f\u7c7b\u4f3c\u7ebf\u6027\u6a21\u578b\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u6307\u6570\u65cf\u5206\u5e03\u5f88\u81ea\u7136\u5730\u5bfc\u51fa\u5e7f\u4e49\u7ebf\u6027\u6a21\u578b\uff1a $$ y=f(w^Tx)\\ y|x\\sim Exp Family $$ \u5728\u66f4\u590d\u6742\u7684\u6982\u7387\u56fe\u6a21\u578b\u4e2d\uff0c\u4f8b\u5982\u5728\u65e0\u5411\u56fe\u6a21\u578b\u4e2d\u5982\u53d7\u9650\u73bb\u5c14\u5179\u66fc\u673a\u4e2d\uff0c\u6307\u6570\u65cf\u5206\u5e03\u4e5f\u626e\u6f14\u7740\u91cd\u8981\u4f5c\u7528\u3002 \u5728\u63a8\u65ad\u7684\u7b97\u6cd5\u4e2d\uff0c\u4f8b\u5982\u53d8\u5206\u63a8\u65ad\u4e2d\uff0c\u6307\u6570\u65cf\u5206\u5e03\u4e5f\u4f1a\u5927\u5927\u7b80\u5316\u8ba1\u7b97\u3002 \u4e00\u7ef4\u9ad8\u65af\u5206\u5e03 \u4e00\u7ef4\u9ad8\u65af\u5206\u5e03\u53ef\u4ee5\u5199\u6210\uff1a $$ p(x|\\theta)=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp(-\\frac{(x-\\mu)^2}{2\\sigma^2}) $$ \u5c06\u8fd9\u4e2a\u5f0f\u5b50\u6539\u5199\uff1a $$ \\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp(-\\frac{1}{2\\sigma^2}(x^2-2\\mu x+\\mu^2))\\ =\\exp(\\log(2\\pi\\sigma^2)^{-1/2})\\exp(-\\frac{1}{2\\sigma^2}\\begin{pmatrix}-2\\mu&1\\end{pmatrix}\\begin{pmatrix}x\\x^2\\end{pmatrix}-\\frac{\\mu^2}{2\\sigma^2}) $$ \u6240\u4ee5\uff1a $$ \\eta=\\begin{pmatrix}\\frac{\\mu}{\\sigma^2}\\-\\frac{1}{2\\sigma^2}\\end{pmatrix}=\\begin{pmatrix}\\eta_1\\\\eta_2\\end{pmatrix} $$ \u4e8e\u662f \\(A(\\eta)\\) \uff1a $$ A(\\eta)=-\\frac{\\eta_1^2}{4\\eta_2}+\\frac{1}{2}\\log(-\\frac{\\pi}{\\eta_2}) $$ \u5145\u5206\u7edf\u8ba1\u91cf\u548c\u5bf9\u6570\u914d\u5206\u51fd\u6570\u7684\u5173\u7cfb \u5bf9\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u6c42\u79ef\u5206\uff1a $$ \\begin{align} \\exp(A(\\eta))&=\\int h(x)\\exp(\\eta^T\\phi(x))dx\\nonumber \\end{align} $$ \u4e24\u8fb9\u5bf9\u53c2\u6570\u6c42\u5bfc\uff1a $$ \\exp(A(\\eta))A'(\\eta)=\\int h(x)\\exp(\\eta^T\\phi(x))\\phi(x)dx\\ \\Longrightarrow A'(\\eta)=\\mathbb{E} {p(x|\\eta)}[\\phi(x)] $$ \u7c7b\u4f3c\u7684\uff1a $$ A''(\\eta)=Var [\\phi(x)] $$ \u7531\u4e8e\u65b9\u5dee\u4e3a\u6b63\uff0c\u4e8e\u662f \\(A(\\eta)\\) \u4e00\u5b9a\u662f\u51f8\u51fd\u6570\u3002 \u5145\u5206\u7edf\u8ba1\u91cf\u548c\u6781\u5927\u4f3c\u7136\u4f30\u8ba1 \u5bf9\u4e8e\u72ec\u7acb\u5168\u540c\u91c7\u6837\u5f97\u5230\u7684\u6570\u636e\u96c6 \\(\\mathcal{D}=\\{x_1,x_2,\\cdots,x_N\\}\\) \u3002 $$ \\begin{align}\\eta_{MLE}&=\\mathop{argmax} \\eta\\sum\\limits ^N\\log p(x_i|\\eta)\\nonumber\\ &=\\mathop{argmax} \\eta\\sum\\limits ^N(\\eta^T\\phi(x_i)-A(\\eta))\\nonumber\\ &\\Longrightarrow A'(\\eta_{MLE})=\\frac{1}{N}\\sum\\limits_{i=1}^N\\phi(x_i) \\end{align} $$ \u7531\u6b64\u53ef\u4ee5\u770b\u5230\uff0c\u4e3a\u4e86\u4f30\u7b97\u53c2\u6570\uff0c\u53ea\u9700\u8981\u77e5\u9053\u5145\u5206\u7edf\u8ba1\u91cf\u5c31\u53ef\u4ee5\u4e86\u3002 \u6700\u5927\u71b5 \u4fe1\u606f\u71b5\u8bb0\u4e3a\uff1a $$ Entropy=\\int-p(x)\\log(p(x))dx $$ \u4e00\u822c\u5730\uff0c\u5bf9\u4e8e\u5b8c\u5168\u968f\u673a\u7684\u53d8\u91cf\uff08\u7b49\u53ef\u80fd\uff09\uff0c\u4fe1\u606f\u71b5\u6700\u5927\u3002 \u6211\u4eec\u7684\u5047\u8bbe\u4e3a\u6700\u5927\u71b5\u539f\u5219\uff0c\u5047\u8bbe\u6570\u636e\u662f\u79bb\u6563\u5206\u5e03\u7684\uff0c \\(k\\) \u4e2a\u7279\u5f81\u7684\u6982\u7387\u5206\u522b\u4e3a \\(p_k\\) \uff0c\u6700\u5927\u71b5\u539f\u7406\u53ef\u4ee5\u8868\u8ff0\u4e3a\uff1a $$ \\max{H(p)}=\\min{\\sum\\limits_{k=1}^Kp_k\\log p_k}\\ s.t.\\ \\sum\\limits_{k=1}^Kp_k=1 $$ \u5229\u7528 Lagrange \u4e58\u5b50\u6cd5\uff1a $$ L(p,\\lambda)=\\sum\\limits_{k=1}^Kp_k\\log p_k+\\lambda(1-\\sum\\limits_{k=1}^Kp_k) $$ \u4e8e\u662f\u53ef\u5f97\uff1a $$ p_1=p_2=\\cdots=p_K=\\frac{1}{K} $$ \u56e0\u6b64\u7b49\u53ef\u80fd\u7684\u60c5\u51b5\u71b5\u6700\u5927\u3002 \u4e00\u4e2a\u6570\u636e\u96c6 \\(\\mathcal{D}\\) \uff0c\u5728\u8fd9\u4e2a\u6570\u636e\u96c6\u4e0a\u7684\u7ecf\u9a8c\u5206\u5e03\u4e3a \\(\\hat{p}(x)=\\frac{Count(x)}{N}\\) \uff0c\u5b9e\u9645\u4e0d\u53ef\u80fd\u6ee1\u8db3\u6240\u6709\u7684\u7ecf\u9a8c\u6982\u7387\u76f8\u540c\uff0c\u4e8e\u662f\u5728\u4e0a\u9762\u7684\u6700\u5927\u71b5\u539f\u7406\u4e2d\u8fd8\u9700\u8981\u52a0\u5165\u8fd9\u4e2a\u7ecf\u9a8c\u5206\u5e03\u7684\u7ea6\u675f\u3002 \u5bf9\u4efb\u610f\u4e00\u4e2a\u51fd\u6570\uff0c\u7ecf\u9a8c\u5206\u5e03\u7684\u7ecf\u9a8c\u671f\u671b\u53ef\u4ee5\u6c42\u5f97\u4e3a\uff1a $$ \\mathbb{E} \\hat{p}[f(x)]=\\Delta $$ \u4e8e\u662f\uff1a $$ \\max{H(p)}=\\min{\\sum\\limits ^Np_k\\log p_k}\\ s.t.\\ \\sum\\limits_{k=1}^Np_k=1,\\mathbb{E} p[f(x)]=\\Delta $$ Lagrange \u51fd\u6570\u4e3a\uff1a $$ L(p,\\lambda_0,\\lambda)=\\sum\\limits ^Np_k\\log p_k+\\lambda_0(1-\\sum\\limits_{k=1}^Np_k)+\\lambda^T(\\Delta-\\mathbb{E} p[f(x)]) $$ \u6c42\u5bfc\u5f97\u5230\uff1a $$ \\frac{\\partial}{\\partial p(x)}L=\\sum\\limits ^N(\\log p(x)+1)-\\sum\\limits_{k=1}^N\\lambda_0-\\sum\\limits_{k=1}^N\\lambda^Tf(x)\\ \\Longrightarrow\\sum\\limits_{k=1}^N\\log p(x)+1-\\lambda_0-\\lambda^Tf(x)=0 $$ \u7531\u4e8e\u6570\u636e\u96c6\u662f\u4efb\u610f\u7684\uff0c\u5bf9\u6570\u636e\u96c6\u6c42\u548c\u4e5f\u610f\u5473\u7740\u6c42\u548c\u9879\u91cc\u9762\u7684\u6bcf\u4e00\u9879\u90fd\u662f0\uff1a $$ p(x)=\\exp(\\lambda^Tf(x)+\\lambda_0-1) $$ \u8fd9\u5c31\u662f\u6307\u6570\u65cf\u5206\u5e03\u3002","title":"6.Exponentialfamily"},{"location":"Machine_Learning/6.Exponentialfamily/#_1","text":"\u6307\u6570\u65cf\u662f\u4e00\u7c7b\u5206\u5e03\uff0c\u5305\u62ec\u9ad8\u65af\u5206\u5e03\u3001\u4f2f\u52aa\u5229\u5206\u5e03\u3001\u4e8c\u9879\u5206\u5e03\u3001\u6cca\u677e\u5206\u5e03\u3001Beta \u5206\u5e03\u3001Dirichlet \u5206\u5e03\u3001Gamma \u5206\u5e03\u7b49\u4e00\u7cfb\u5217\u5206\u5e03\u3002\u6307\u6570\u65cf\u5206\u5e03\u53ef\u4ee5\u5199\u4e3a\u7edf\u4e00\u7684\u5f62\u5f0f\uff1a $$ p(x|\\eta)=h(x)\\exp(\\eta^T\\phi(x)-A(\\eta))=\\frac{1}{\\exp(A(\\eta))}h(x)\\exp(\\eta^T\\phi(x)) $$ \u5176\u4e2d\uff0c \\(\\eta\\) \u662f\u53c2\u6570\u5411\u91cf\uff0c \\(A(\\eta)\\) \u662f\u5bf9\u6570\u914d\u5206\u51fd\u6570\uff08\u5f52\u4e00\u5316\u56e0\u5b50\uff09\u3002 \u5728\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\uff0c \\(\\phi(x)\\) \u53eb\u505a\u5145\u5206\u7edf\u8ba1\u91cf\uff0c\u5305\u542b\u6837\u672c\u96c6\u5408\u6240\u6709\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u9ad8\u65af\u5206\u5e03\u4e2d\u7684\u5747\u503c\u548c\u65b9\u5dee\u3002\u5145\u5206\u7edf\u8ba1\u91cf\u5728\u5728\u7ebf\u5b66\u4e60\u4e2d\u6709\u5e94\u7528\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6570\u636e\u96c6\uff0c\u53ea\u9700\u8981\u8bb0\u5f55\u6837\u672c\u7684\u5145\u5206\u7edf\u8ba1\u91cf\u5373\u53ef\u3002 \u5bf9\u4e8e\u4e00\u4e2a\u6a21\u578b\u5206\u5e03\u5047\u8bbe\uff08\u4f3c\u7136\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u6c42\u89e3\u4e2d\uff0c\u5e38\u5e38\u9700\u8981\u5bfb\u627e\u4e00\u4e2a\u5171\u8f6d\u5148\u9a8c\uff0c\u4f7f\u5f97\u5148\u9a8c\u4e0e\u540e\u9a8c\u7684\u5f62\u5f0f\u76f8\u540c\uff0c\u4f8b\u5982\u9009\u53d6\u4f3c\u7136\u662f\u4e8c\u9879\u5206\u5e03\uff0c\u53ef\u53d6\u5148\u9a8c\u662f Beta \u5206\u5e03\uff0c\u90a3\u4e48\u540e\u9a8c\u4e5f\u662f Beta \u5206\u5e03\u3002\u6307\u6570\u65cf\u5206\u5e03\u5e38\u5e38\u5177\u6709\u5171\u8f6d\u7684\u6027\u8d28\uff0c\u4e8e\u662f\u6211\u4eec\u5728\u6a21\u578b\u9009\u62e9\u4ee5\u53ca\u63a8\u65ad\u5177\u6709\u5f88\u5927\u7684\u4fbf\u5229\u3002 \u5171\u8f6d\u5148\u9a8c\u7684\u6027\u8d28\u4fbf\u4e8e\u8ba1\u7b97\uff0c\u540c\u65f6\uff0c\u6307\u6570\u65cf\u5206\u5e03\u6ee1\u8db3\u6700\u5927\u71b5\u7684\u601d\u60f3\uff08\u65e0\u4fe1\u606f\u5148\u9a8c\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u7ecf\u9a8c\u5206\u5e03\u5229\u7528\u6700\u5927\u71b5\u539f\u7406\u5bfc\u51fa\u7684\u5206\u5e03\u5c31\u662f\u6307\u6570\u65cf\u5206\u5e03\u3002 \u89c2\u5bdf\u5230\u6307\u6570\u65cf\u5206\u5e03\u7684\u8868\u8fbe\u5f0f\u7c7b\u4f3c\u7ebf\u6027\u6a21\u578b\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u6307\u6570\u65cf\u5206\u5e03\u5f88\u81ea\u7136\u5730\u5bfc\u51fa\u5e7f\u4e49\u7ebf\u6027\u6a21\u578b\uff1a $$ y=f(w^Tx)\\ y|x\\sim Exp Family $$ \u5728\u66f4\u590d\u6742\u7684\u6982\u7387\u56fe\u6a21\u578b\u4e2d\uff0c\u4f8b\u5982\u5728\u65e0\u5411\u56fe\u6a21\u578b\u4e2d\u5982\u53d7\u9650\u73bb\u5c14\u5179\u66fc\u673a\u4e2d\uff0c\u6307\u6570\u65cf\u5206\u5e03\u4e5f\u626e\u6f14\u7740\u91cd\u8981\u4f5c\u7528\u3002 \u5728\u63a8\u65ad\u7684\u7b97\u6cd5\u4e2d\uff0c\u4f8b\u5982\u53d8\u5206\u63a8\u65ad\u4e2d\uff0c\u6307\u6570\u65cf\u5206\u5e03\u4e5f\u4f1a\u5927\u5927\u7b80\u5316\u8ba1\u7b97\u3002","title":"\u6307\u6570\u65cf\u5206\u5e03"},{"location":"Machine_Learning/6.Exponentialfamily/#_2","text":"\u4e00\u7ef4\u9ad8\u65af\u5206\u5e03\u53ef\u4ee5\u5199\u6210\uff1a $$ p(x|\\theta)=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp(-\\frac{(x-\\mu)^2}{2\\sigma^2}) $$ \u5c06\u8fd9\u4e2a\u5f0f\u5b50\u6539\u5199\uff1a $$ \\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp(-\\frac{1}{2\\sigma^2}(x^2-2\\mu x+\\mu^2))\\ =\\exp(\\log(2\\pi\\sigma^2)^{-1/2})\\exp(-\\frac{1}{2\\sigma^2}\\begin{pmatrix}-2\\mu&1\\end{pmatrix}\\begin{pmatrix}x\\x^2\\end{pmatrix}-\\frac{\\mu^2}{2\\sigma^2}) $$ \u6240\u4ee5\uff1a $$ \\eta=\\begin{pmatrix}\\frac{\\mu}{\\sigma^2}\\-\\frac{1}{2\\sigma^2}\\end{pmatrix}=\\begin{pmatrix}\\eta_1\\\\eta_2\\end{pmatrix} $$ \u4e8e\u662f \\(A(\\eta)\\) \uff1a $$ A(\\eta)=-\\frac{\\eta_1^2}{4\\eta_2}+\\frac{1}{2}\\log(-\\frac{\\pi}{\\eta_2}) $$","title":"\u4e00\u7ef4\u9ad8\u65af\u5206\u5e03"},{"location":"Machine_Learning/6.Exponentialfamily/#_3","text":"\u5bf9\u6982\u7387\u5bc6\u5ea6\u51fd\u6570\u6c42\u79ef\u5206\uff1a $$ \\begin{align} \\exp(A(\\eta))&=\\int h(x)\\exp(\\eta^T\\phi(x))dx\\nonumber \\end{align} $$ \u4e24\u8fb9\u5bf9\u53c2\u6570\u6c42\u5bfc\uff1a $$ \\exp(A(\\eta))A'(\\eta)=\\int h(x)\\exp(\\eta^T\\phi(x))\\phi(x)dx\\ \\Longrightarrow A'(\\eta)=\\mathbb{E} {p(x|\\eta)}[\\phi(x)] $$ \u7c7b\u4f3c\u7684\uff1a $$ A''(\\eta)=Var [\\phi(x)] $$ \u7531\u4e8e\u65b9\u5dee\u4e3a\u6b63\uff0c\u4e8e\u662f \\(A(\\eta)\\) \u4e00\u5b9a\u662f\u51f8\u51fd\u6570\u3002","title":"\u5145\u5206\u7edf\u8ba1\u91cf\u548c\u5bf9\u6570\u914d\u5206\u51fd\u6570\u7684\u5173\u7cfb"},{"location":"Machine_Learning/6.Exponentialfamily/#_4","text":"\u5bf9\u4e8e\u72ec\u7acb\u5168\u540c\u91c7\u6837\u5f97\u5230\u7684\u6570\u636e\u96c6 \\(\\mathcal{D}=\\{x_1,x_2,\\cdots,x_N\\}\\) \u3002 $$ \\begin{align}\\eta_{MLE}&=\\mathop{argmax} \\eta\\sum\\limits ^N\\log p(x_i|\\eta)\\nonumber\\ &=\\mathop{argmax} \\eta\\sum\\limits ^N(\\eta^T\\phi(x_i)-A(\\eta))\\nonumber\\ &\\Longrightarrow A'(\\eta_{MLE})=\\frac{1}{N}\\sum\\limits_{i=1}^N\\phi(x_i) \\end{align} $$ \u7531\u6b64\u53ef\u4ee5\u770b\u5230\uff0c\u4e3a\u4e86\u4f30\u7b97\u53c2\u6570\uff0c\u53ea\u9700\u8981\u77e5\u9053\u5145\u5206\u7edf\u8ba1\u91cf\u5c31\u53ef\u4ee5\u4e86\u3002","title":"\u5145\u5206\u7edf\u8ba1\u91cf\u548c\u6781\u5927\u4f3c\u7136\u4f30\u8ba1"},{"location":"Machine_Learning/6.Exponentialfamily/#_5","text":"\u4fe1\u606f\u71b5\u8bb0\u4e3a\uff1a $$ Entropy=\\int-p(x)\\log(p(x))dx $$ \u4e00\u822c\u5730\uff0c\u5bf9\u4e8e\u5b8c\u5168\u968f\u673a\u7684\u53d8\u91cf\uff08\u7b49\u53ef\u80fd\uff09\uff0c\u4fe1\u606f\u71b5\u6700\u5927\u3002 \u6211\u4eec\u7684\u5047\u8bbe\u4e3a\u6700\u5927\u71b5\u539f\u5219\uff0c\u5047\u8bbe\u6570\u636e\u662f\u79bb\u6563\u5206\u5e03\u7684\uff0c \\(k\\) \u4e2a\u7279\u5f81\u7684\u6982\u7387\u5206\u522b\u4e3a \\(p_k\\) \uff0c\u6700\u5927\u71b5\u539f\u7406\u53ef\u4ee5\u8868\u8ff0\u4e3a\uff1a $$ \\max{H(p)}=\\min{\\sum\\limits_{k=1}^Kp_k\\log p_k}\\ s.t.\\ \\sum\\limits_{k=1}^Kp_k=1 $$ \u5229\u7528 Lagrange \u4e58\u5b50\u6cd5\uff1a $$ L(p,\\lambda)=\\sum\\limits_{k=1}^Kp_k\\log p_k+\\lambda(1-\\sum\\limits_{k=1}^Kp_k) $$ \u4e8e\u662f\u53ef\u5f97\uff1a $$ p_1=p_2=\\cdots=p_K=\\frac{1}{K} $$ \u56e0\u6b64\u7b49\u53ef\u80fd\u7684\u60c5\u51b5\u71b5\u6700\u5927\u3002 \u4e00\u4e2a\u6570\u636e\u96c6 \\(\\mathcal{D}\\) \uff0c\u5728\u8fd9\u4e2a\u6570\u636e\u96c6\u4e0a\u7684\u7ecf\u9a8c\u5206\u5e03\u4e3a \\(\\hat{p}(x)=\\frac{Count(x)}{N}\\) \uff0c\u5b9e\u9645\u4e0d\u53ef\u80fd\u6ee1\u8db3\u6240\u6709\u7684\u7ecf\u9a8c\u6982\u7387\u76f8\u540c\uff0c\u4e8e\u662f\u5728\u4e0a\u9762\u7684\u6700\u5927\u71b5\u539f\u7406\u4e2d\u8fd8\u9700\u8981\u52a0\u5165\u8fd9\u4e2a\u7ecf\u9a8c\u5206\u5e03\u7684\u7ea6\u675f\u3002 \u5bf9\u4efb\u610f\u4e00\u4e2a\u51fd\u6570\uff0c\u7ecf\u9a8c\u5206\u5e03\u7684\u7ecf\u9a8c\u671f\u671b\u53ef\u4ee5\u6c42\u5f97\u4e3a\uff1a $$ \\mathbb{E} \\hat{p}[f(x)]=\\Delta $$ \u4e8e\u662f\uff1a $$ \\max{H(p)}=\\min{\\sum\\limits ^Np_k\\log p_k}\\ s.t.\\ \\sum\\limits_{k=1}^Np_k=1,\\mathbb{E} p[f(x)]=\\Delta $$ Lagrange \u51fd\u6570\u4e3a\uff1a $$ L(p,\\lambda_0,\\lambda)=\\sum\\limits ^Np_k\\log p_k+\\lambda_0(1-\\sum\\limits_{k=1}^Np_k)+\\lambda^T(\\Delta-\\mathbb{E} p[f(x)]) $$ \u6c42\u5bfc\u5f97\u5230\uff1a $$ \\frac{\\partial}{\\partial p(x)}L=\\sum\\limits ^N(\\log p(x)+1)-\\sum\\limits_{k=1}^N\\lambda_0-\\sum\\limits_{k=1}^N\\lambda^Tf(x)\\ \\Longrightarrow\\sum\\limits_{k=1}^N\\log p(x)+1-\\lambda_0-\\lambda^Tf(x)=0 $$ \u7531\u4e8e\u6570\u636e\u96c6\u662f\u4efb\u610f\u7684\uff0c\u5bf9\u6570\u636e\u96c6\u6c42\u548c\u4e5f\u610f\u5473\u7740\u6c42\u548c\u9879\u91cc\u9762\u7684\u6bcf\u4e00\u9879\u90fd\u662f0\uff1a $$ p(x)=\\exp(\\lambda^Tf(x)+\\lambda_0-1) $$ \u8fd9\u5c31\u662f\u6307\u6570\u65cf\u5206\u5e03\u3002","title":"\u6700\u5927\u71b5"},{"location":"Machine_Learning/7.PGMIntro/","text":"\u6982\u7387\u56fe\u6a21\u578b \u6982\u7387\u56fe\u6a21\u578b\u4f7f\u7528\u56fe\u7684\u65b9\u5f0f\u8868\u793a\u6982\u7387\u5206\u5e03\u3002\u4e3a\u4e86\u5728\u56fe\u4e2d\u6dfb\u52a0\u5404\u79cd\u6982\u7387\uff0c\u9996\u5148\u603b\u7ed3\u4e00\u4e0b\u968f\u673a\u53d8\u91cf\u5206\u5e03\u7684\u4e00\u4e9b\u89c4\u5219\uff1a $$ \\begin{align} &Sum\\ Rule:p(x_1)=\\int p(x_1,x_2)dx_2\\ &Product\\ Rule:p(x_1,x_2)=p(x_1|x_2)p(x_2)\\ &Chain\\ Rule:p(x_1,x_2,\\cdots,x_p)=\\prod\\limits_{i=1}^pp(x_i|x_{i+1,x_{i+2} \\cdots}x_p)\\ &Bayesian\\ Rule:p(x_1|x_2)=\\frac{p(x_2|x_1)p(x_1)}{p(x_2)} \\end{align} $$ \u53ef\u4ee5\u770b\u5230\uff0c\u5728\u94fe\u5f0f\u6cd5\u5219\u4e2d\uff0c\u5982\u679c\u6570\u636e\u7ef4\u5ea6\u7279\u522b\u9ad8\uff0c\u90a3\u4e48\u7684\u91c7\u6837\u548c\u8ba1\u7b97\u975e\u5e38\u56f0\u96be\uff0c\u6211\u4eec\u9700\u8981\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u4f5c\u51fa\u7b80\u5316\uff0c\u5728\u6734\u7d20\u8d1d\u53f6\u65af\u4e2d\uff0c\u4f5c\u51fa\u4e86\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\u3002\u5728 Markov \u5047\u8bbe\u4e2d\uff0c\u7ed9\u5b9a\u6570\u636e\u7684\u7ef4\u5ea6\u662f\u4ee5\u65f6\u95f4\u987a\u5e8f\u51fa\u73b0\u7684\uff0c\u7ed9\u5b9a\u5f53\u524d\u65f6\u95f4\u7684\u7ef4\u5ea6\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u7ef4\u5ea6\u4e0e\u4e4b\u524d\u7684\u7ef4\u5ea6\u72ec\u7acb\u3002\u5728 HMM \u4e2d\uff0c\u91c7\u7528\u4e86\u9f50\u6b21 Markov \u5047\u8bbe\u3002\u5728 Markov \u5047\u8bbe\u4e4b\u4e0a\uff0c\u66f4\u4e00\u822c\u7684\uff0c\u52a0\u5165\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\uff0c\u5bf9\u7ef4\u5ea6\u5212\u5206\u96c6\u5408 \\(A,B,C\\) \uff0c\u4f7f\u5f97 \\(X_A\\perp X_B|X_C\\) \u3002 \u6982\u7387\u56fe\u6a21\u578b\u91c7\u7528\u56fe\u7684\u7279\u70b9\u8868\u793a\u4e0a\u8ff0\u7684\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\uff0c\u8282\u70b9\u8868\u793a\u968f\u673a\u53d8\u91cf\uff0c\u8fb9\u8868\u793a\u6761\u4ef6\u6982\u7387\u3002\u6982\u7387\u56fe\u6a21\u578b\u53ef\u4ee5\u5206\u4e3a\u4e09\u5927\u7406\u8bba\u90e8\u5206\uff1a \u8868\u793a\uff1a \u6709\u5411\u56fe\uff08\u79bb\u6563\uff09\uff1a\u8d1d\u53f6\u65af\u7f51\u7edc \u9ad8\u65af\u56fe\uff08\u8fde\u7eed\uff09\uff1a\u9ad8\u65af\u8d1d\u53f6\u65af\u548c\u9ad8\u65af\u9a6c\u5c14\u53ef\u592b\u7f51\u8def \u65e0\u5411\u56fe\uff08\u79bb\u6563\uff09\uff1a\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc \u63a8\u65ad \u7cbe\u786e\u63a8\u65ad \u8fd1\u4f3c\u63a8\u65ad \u786e\u5b9a\u6027\u8fd1\u4f3c\uff08\u5982\u53d8\u5206\u63a8\u65ad\uff09 \u968f\u673a\u8fd1\u4f3c\uff08\u5982 MCMC\uff09 \u5b66\u4e60 \u53c2\u6570\u5b66\u4e60 \u5b8c\u5907\u6570\u636e \u9690\u53d8\u91cf\uff1aE-M \u7b97\u6cd5 \u7ed3\u6784\u5b66\u4e60 \u6709\u5411\u56fe-\u8d1d\u53f6\u65af\u7f51\u7edc \u5df2\u77e5\u8054\u5408\u5206\u5e03\u4e2d\uff0c\u5404\u4e2a\u968f\u673a\u53d8\u91cf\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u90a3\u4e48\u53ef\u4ee5\u901a\u8fc7\u62d3\u6251\u6392\u5e8f\uff08\u6839\u636e\u4f9d\u8d56\u5173\u7cfb\uff09\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u6709\u5411\u56fe\u3002\u800c\u5982\u679c\u5df2\u77e5\u4e00\u4e2a\u56fe\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u8054\u5408\u6982\u7387\u5206\u5e03\u7684\u56e0\u5b50\u5206\u89e3\uff1a $$ p(x_1,x_2,\\cdots,x_p)=\\prod\\limits_{i=1}^pp(x_i|x_{parent(i)}) $$ \u90a3\u4e48\u5b9e\u9645\u7684\u56fe\u4e2d\u6761\u4ef6\u72ec\u7acb\u6027\u662f\u5982\u4f55\u4f53\u73b0\u7684\u5462\uff1f\u5728\u5c40\u90e8\u4efb\u4f55\u4e09\u4e2a\u8282\u70b9\uff0c\u53ef\u4ee5\u6709\u4e09\u79cd\u7ed3\u6784\uff1a mermaid graph TB; A((A))-->B((B)); B-->C((C)); \\[ p(A,B,C)=p(A)p(B|A)p(C|B)=p(A)p(B|A)p(C|B,A)\\\\ \\Longrightarrow p(C|B)=p(C|B,A)\\\\ \\Leftrightarrow p(C|B)p(A|B)=p(C|A,B)p(A|B)=p(C,A|B)\\\\ \\Longrightarrow C\\perp A|B \\] mermaid graph TB; B((B))-->A((A)); B-->C((C)); \\[ p(A,B,C)=p(A|B)p(B)p(C|B)=p(B)p(A|B)p(C|A,B)\\\\ \\Longrightarrow p(C|B)=p(C|B,A)\\\\ \\Leftrightarrow p(C|B)p(A|B)=p(C|A,B)p(A|B)=p(C,A|B)\\\\ \\Longrightarrow C\\perp A|B \\] mermaid graph TB; A((A))-->B((B)); C((C))-->B \\[ p(A,B,C)=p(A)p(C)p(B|C,A)=p(A)p(C|A)p(B|C,A)\\\\ \\Longrightarrow p(C)=p(C|A)\\\\ \\Leftrightarrow C\\perp A\\\\ \\] \u5bf9\u8fd9\u79cd\u7ed3\u6784\uff0c \\(A,C\\) \u4e0d\u4e0e \\(B\\) \u6761\u4ef6\u72ec\u7acb\u3002 \u4ece\u6574\u4f53\u7684\u56fe\u6765\u770b\uff0c\u53ef\u4ee5\u5f15\u5165 D \u5212\u5206\u7684\u6982\u5ff5\u3002\u5bf9\u4e8e\u7c7b\u4f3c\u4e0a\u9762\u56fe 1\u548c\u56fe 2\u7684\u5173\u7cfb\uff0c\u5f15\u5165\u96c6\u5408A\uff0cB\uff0c\u90a3\u4e48\u6ee1\u8db3 \\(A\\perp B|C\\) \u7684 \\(C\\) \u96c6\u5408\u4e2d\u7684\u70b9\u4e0e \\(A,B\\) \u4e2d\u7684\u70b9\u7684\u5173\u7cfb\u90fd\u6ee1\u8db3\u56fe 1\uff0c2\uff0c\u6ee1\u8db3\u56fe3 \u5173\u7cfb\u7684\u70b9\u90fd\u4e0d\u5728 \\(C\\) \u4e2d\u3002D \u5212\u5206\u5e94\u7528\u5728\u8d1d\u53f6\u65af\u5b9a\u7406\u4e2d\uff1a $$ p(x_i|x_{-i})=\\frac{p(x)}{\\int p(x)dx_{i}}=\\frac{\\prod\\limits_{j=1}^pp(x_j|x_{parents(j)})}{\\int\\prod\\limits_{j=1}^pp(x_j|x_{parents(j)})dx_i} $$ \u53ef\u4ee5\u53d1\u73b0\uff0c\u4e0a\u4e0b\u90e8\u5206\u53ef\u4ee5\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u4e00\u90e8\u5206\u662f\u548c \\(x_i\\) \u76f8\u5173\u7684\uff0c\u53e6\u4e00\u90e8\u5206\u662f\u548c \\(x_i\\) \u65e0\u5173\u7684\uff0c\u800c\u8fd9\u4e2a\u65e0\u5173\u7684\u90e8\u5206\u53ef\u4ee5\u76f8\u4e92\u7ea6\u6389\u3002\u4e8e\u662f\u8ba1\u7b97\u53ea\u6d89\u53ca\u548c \\(x_i\\) \u76f8\u5173\u7684\u90e8\u5206\u3002 \u4e0e \\(x_i\\) \u76f8\u5173\u7684\u90e8\u5206\u53ef\u4ee5\u5199\u6210\uff1a $$ p(x_i|x_{parents(i)})p(x_{child(i)}|x_i) $$ \u8fd9\u4e9b\u76f8\u5173\u7684\u90e8\u5206\u53c8\u53eb\u505a Markov \u6bef\u3002 \u5b9e\u9645\u5e94\u7528\u7684\u6a21\u578b\u4e2d\uff0c\u5bf9\u8fd9\u4e9b\u6761\u4ef6\u72ec\u7acb\u6027\u4f5c\u51fa\u4e86\u5047\u8bbe\uff0c\u4ece\u5355\u4e00\u5230\u6df7\u5408\uff0c\u4ece\u6709\u9650\u5230\u65e0\u9650\uff08\u65f6\u95f4\uff0c\u7a7a\u95f4\uff09\u53ef\u4ee5\u5206\u4e3a\uff1a \u6734\u7d20\u8d1d\u53f6\u65af\uff0c\u5355\u4e00\u7684\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe \\(p(x|y)=\\prod\\limits_{i=1}^pp(x_i|y)\\) \uff0c\u5728 D \u5212\u5206\u540e\uff0c\u6240\u6709\u6761\u4ef6\u4f9d\u8d56\u7684\u96c6\u5408\u5c31\u662f\u5355\u4e2a\u5143\u7d20\u3002 \u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff1a\u6df7\u5408\u7684\u6761\u4ef6\u72ec\u7acb\u3002\u5f15\u5165\u591a\u7c7b\u522b\u7684\u9690\u53d8\u91cf \\(z_1, z_2,\\cdots,z_k\\) \uff0c \\(p(x|z)=\\mathcal{N}(\\mu,\\Sigma)\\) \uff0c\u6761\u4ef6\u4f9d\u8d56\u96c6\u5408\u4e3a\u591a\u4e2a\u5143\u7d20\u3002 \u4e0e\u65f6\u95f4\u76f8\u5173\u7684\u6761\u4ef6\u4f9d\u8d56 Markov \u94fe \u9ad8\u65af\u8fc7\u7a0b\uff08\u65e0\u9650\u7ef4\u9ad8\u65af\u5206\u5e03\uff09 \u8fde\u7eed\uff1a\u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc \u7ec4\u5408\u4e0a\u9762\u7684\u5206\u7c7b GMM \u4e0e\u65f6\u5e8f\u7ed3\u5408\uff1a\u52a8\u6001\u6a21\u578b HMM\uff08\u79bb\u6563\uff09 \u7ebf\u6027\u52a8\u6001\u7cfb\u7edf LDS\uff08Kalman \u6ee4\u6ce2\uff09 \u7c92\u5b50\u6ee4\u6ce2\uff08\u975e\u9ad8\u65af\uff0c\u975e\u7ebf\u6027\uff09 \u65e0\u5411\u56fe-\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc\uff08\u9a6c\u5c14\u53ef\u592b\u968f\u673a\u573a\uff09 \u65e0\u5411\u56fe\u6ca1\u6709\u4e86\u7c7b\u4f3c\u6709\u5411\u56fe\u7684\u5c40\u90e8\u4e0d\u540c\u7ed3\u6784\uff0c\u5728\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc\u4e2d\uff0c\u4e5f\u5b58\u5728 D \u5212\u5206\u7684\u6982\u5ff5\u3002\u76f4\u63a5\u5c06\u6761\u4ef6\u72ec\u7acb\u7684\u96c6\u5408 \\(x_A\\perp x_B|x_C\\) \u5212\u5206\u4e3a\u4e09\u4e2a\u96c6\u5408\u3002\u8fd9\u4e2a\u4e5f\u53eb\u5168\u5c40 Markov\u3002\u5bf9\u5c40\u90e8\u7684\u8282\u70b9\uff0c \\(x\\perp (X-Neighbour(\\mathcal{x}))|Neighbour(x)\\) \u3002\u8fd9\u4e5f\u53eb\u5c40\u90e8 Markov\u3002\u5bf9\u4e8e\u6210\u5bf9\u7684\u8282\u70b9\uff1a \\(x_i\\perp x_j|x_{-i-j}\\) \uff0c\u5176\u4e2d \\(i,j\\) \u4e0d\u80fd\u76f8\u90bb\u3002\u8fd9\u4e5f\u53eb\u6210\u5bf9 Markov\u3002\u4e8b\u5b9e\u4e0a\u4e0a\u9762\u4e09\u4e2a\u70b9\u5c40\u90e8\u5168\u5c40\u6210\u5bf9\u662f\u76f8\u4e92\u7b49\u4ef7\u7684\u3002 \u6709\u4e86\u8fd9\u4e2a\u6761\u4ef6\u72ec\u7acb\u6027\u7684\u5212\u5206\uff0c\u8fd8\u9700\u8981\u56e0\u5b50\u5206\u89e3\u6765\u5b9e\u9645\u8ba1\u7b97\u3002\u5f15\u5165\u56e2\u7684\u6982\u5ff5\uff1a \u56e2\uff0c\u6700\u5927\u56e2\uff1a\u56fe\u4e2d\u8282\u70b9\u7684\u96c6\u5408\uff0c\u96c6\u5408\u4e2d\u7684\u8282\u70b9\u4e4b\u95f4\u76f8\u4e92\u90fd\u662f\u8fde\u63a5\u7684\u53eb\u505a\u56e2\uff0c\u5982\u679c\u4e0d\u80fd\u518d\u6dfb\u52a0\u8282\u70b9\uff0c\u90a3\u4e48\u53eb\u6700\u5927\u56e2\u3002 \u5229\u7528\u8fd9\u4e2a\u5b9a\u4e49\u8fdb\u884c\u7684 \\(x\\) \u6240\u6709\u7ef4\u5ea6\u7684\u8054\u5408\u6982\u7387\u5206\u5e03\u7684\u56e0\u5b50\u5206\u89e3\u4e3a\uff0c\u5047\u8bbe\u6709 \\(K\\) \u4e2a\u56e2\uff0c \\(Z\\) \u5c31\u662f\u5bf9\u6240\u6709\u53ef\u80fd\u53d6\u503c\u6c42\u548c\uff1a $$ \\begin{align}p(x)=\\frac{1}{Z}\\prod\\limits_{i=1}^{K}\\phi(x_{ci})\\ Z=\\sum\\limits_{x\\in\\mathcal{X}}\\prod\\limits_{i=1}^{K}\\phi(x_{ci}) \\end{align} $$ \u5176\u4e2d \\(\\phi(x_{ci})\\) \u53eb\u505a\u52bf\u51fd\u6570\uff0c\u5b83\u5fc5\u987b\u662f\u4e00\u4e2a\u6b63\u503c\uff0c\u53ef\u4ee5\u8bb0\u4e3a\uff1a $$ \\phi(x_{ci})=\\exp(-E(x_{ci})) $$ \u8fd9\u4e2a\u5206\u5e03\u53eb\u505a Gibbs \u5206\u5e03\uff08\u73bb\u5c14\u5179\u66fc\u5206\u5e03\uff09\u3002\u4e8e\u662f\u4e5f\u53ef\u4ee5\u8bb0\u4e3a\uff1a \\(p(x)=\\frac{1}{Z}\\exp(-\\sum\\limits_{i=1}^KE(x_{ci}))\\) \u3002\u8fd9\u4e2a\u5206\u89e3\u548c\u6761\u4ef6\u72ec\u7acb\u6027\u7b49\u4ef7\uff08Hammesley-Clifford \u5b9a\u7406\uff09\uff0c\u8fd9\u4e2a\u5206\u5e03\u7684\u5f62\u5f0f\u4e5f\u548c\u6307\u6570\u65cf\u5206\u5e03\u5f62\u5f0f\u4e0a\u76f8\u540c\uff0c\u4e8e\u662f\u6ee1\u8db3\u6700\u5927\u71b5\u539f\u7406\u3002 \u4e24\u79cd\u56fe\u7684\u8f6c\u6362-\u9053\u5fb7\u56fe \u6211\u4eec\u5e38\u5e38\u60f3\u5c06\u6709\u5411\u56fe\u8f6c\u4e3a\u65e0\u5411\u56fe\uff0c\u4ece\u800c\u5e94\u7528\u66f4\u4e00\u822c\u7684\u8868\u8fbe\u5f0f\u3002 \u94fe\u5f0f\uff1a 1 2 3 graph TB; A((A))-->B((B)); B-->C((C)); \u76f4\u63a5\u53bb\u6389\u7bad\u5934\uff0c \\(p(a,b,c)=p(a)p(b|a)p(c|b)=\\phi(a,b)\\phi(b,c)\\) \uff1a 1 2 3 graph TB; A((A))---B((B)); B---C((C)); V \u5f62\uff1a 1 2 3 graph TB; B((B))-->A((A)); B-->C((C)); \u7531\u4e8e \\(p(a,b,c)=p(b)p(a|b)p(c|b)=\\phi(a,b)\\phi(b,c)\\) \uff0c\u76f4\u63a5\u53bb\u6389\u7bad\u5934\uff1a 1 2 3 graph TB; B((B))---A((A)); B---C((C)); \u5012 V \u5f62\uff1a 1 2 3 graph TB; A((A))-->B((B)); C((C))-->B \u7531\u4e8e \\(p(a,b,c)=p(a)p(c)p(b|a,c)=\\phi(a,b,c)\\) \uff0c\u4e8e\u662f\u5728 \\(a,c\\) \u4e4b\u95f4\u6dfb\u52a0\u7ebf\uff1a 1 2 3 4 graph TD; a((a))---b((b)); b---c((c)); a---c; \u89c2\u5bdf\u7740\u4e09\u79cd\u60c5\u51b5\u53ef\u4ee5\u6982\u62ec\u4e3a\uff1a \u5c06\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u4e24\u4e24\u76f8\u8fde \u5c06\u6709\u5411\u8fb9\u66ff\u6362\u4e3a\u65e0\u5411\u8fb9 \u66f4\u7cbe\u7ec6\u7684\u5206\u89e3-\u56e0\u5b50\u56fe \u5bf9\u4e8e\u4e00\u4e2a\u6709\u5411\u56fe\uff0c\u53ef\u4ee5\u901a\u8fc7\u5f15\u5165\u73af\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5c06\u5176\u8f6c\u6362\u4e3a\u65e0\u5411\u56fe\uff08Tree-like graph\uff09\uff0c\u8fd9\u4e2a\u56fe\u5c31\u53eb\u505a\u9053\u5fb7\u56fe\u3002\u4f46\u662f\u6211\u4eec\u4e0a\u9762\u7684 BP \u7b97\u6cd5\u53ea\u5bf9\u65e0\u73af\u56fe\u6709\u6548\uff0c\u901a\u8fc7\u56e0\u5b50\u56fe\u53ef\u4ee5\u53d8\u4e3a\u65e0\u73af\u56fe\u3002 \u8003\u8651\u4e00\u4e2a\u65e0\u5411\u56fe\uff1a 1 2 3 4 graph TD; a((a))---b((b)); b---c((c)); a---c; \u53ef\u4ee5\u5c06\u5176\u8f6c\u4e3a\uff1a 1 2 3 4 graph TD; a((a))---f; f---b((b)); f---c((c)) \u5176\u4e2d \\(f=f(a,b,c)\\) \u3002\u56e0\u5b50\u56fe\u4e0d\u662f\u552f\u4e00\u7684\uff0c\u8fd9\u662f\u7531\u4e8e\u56e0\u5f0f\u5206\u89e3\u672c\u8eab\u5c31\u5bf9\u5e94\u4e00\u4e2a\u7279\u6b8a\u7684\u56e0\u5b50\u56fe\uff0c\u5c06\u56e0\u5f0f\u5206\u89e3\uff1a \\(p(x)=\\prod\\limits_{s}f_s(x_s)\\) \u53ef\u4ee5\u8fdb\u4e00\u6b65\u5206\u89e3\u5f97\u5230\u56e0\u5b50\u56fe\u3002 \u63a8\u65ad \u63a8\u65ad\u7684\u4e3b\u8981\u76ee\u7684\u662f\u6c42\u5404\u79cd\u6982\u7387\u5206\u5e03\uff0c\u5305\u62ec\u8fb9\u7f18\u6982\u7387\uff0c\u6761\u4ef6\u6982\u7387\uff0c\u4ee5\u53ca\u4f7f\u7528 MAP \u6765\u6c42\u5f97\u53c2\u6570\u3002\u901a\u5e38\u63a8\u65ad\u53ef\u4ee5\u5206\u4e3a\uff1a \u7cbe\u786e\u63a8\u65ad Variable Elimination(VE) Belief Propagation(BP, Sum-Product Algo)\uff0c\u4ece VE \u53d1\u5c55\u800c\u6765 Junction Tree\uff0c\u4e0a\u9762\u4e24\u79cd\u5728\u6811\u7ed3\u6784\u4e0a\u5e94\u7528\uff0cJunction Tree \u5728\u56fe\u7ed3\u6784\u4e0a\u5e94\u7528 \u8fd1\u4f3c\u63a8\u65ad Loop Belief Propagation\uff08\u9488\u5bf9\u6709\u73af\u56fe\uff09 Mente Carlo Interference\uff1a\u4f8b\u5982 Importance Sampling\uff0cMCMC Variational Inference \u63a8\u65ad-\u53d8\u91cf\u6d88\u9664\uff08VE\uff09 \u53d8\u91cf\u6d88\u9664\u7684\u65b9\u6cd5\u662f\u5728\u6c42\u89e3\u6982\u7387\u5206\u5e03\u7684\u65f6\u5019\uff0c\u5c06\u76f8\u5173\u7684\u6761\u4ef6\u6982\u7387\u5148\u884c\u6c42\u548c\u6216\u79ef\u5206\uff0c\u4ece\u800c\u4e00\u6b65\u6b65\u5730\u6d88\u9664\u53d8\u91cf\uff0c\u4f8b\u5982\u5728\u9a6c\u5c14\u53ef\u592b\u94fe\u4e2d\uff1a 1 2 3 4 graph LR; a((a))-->b((b)); b-->c((c)); c-->d((d)) \\[ p(d)=\\sum\\limits_{a,b,c}p(a,b,c,d)=\\sum\\limits_cp(d|c)\\sum\\limits_bp(c|b)\\sum\\limits_ap(b|a)p(a) \\] \u53d8\u91cf\u6d88\u9664\u7684\u7f3a\u70b9\u5f88\u660e\u663e\uff1a \u8ba1\u7b97\u6b65\u9aa4\u65e0\u6cd5\u5b58\u50a8 \u6d88\u9664\u7684\u6700\u4f18\u6b21\u5e8f\u662f\u4e00\u4e2a NP-hard \u95ee\u9898 \u63a8\u65ad-\u4fe1\u5ff5\u4f20\u64ad\uff08BP\uff09 \u4e3a\u4e86\u514b\u670d VE \u7684\u7b2c\u4e00\u4e2a\u7f3a\u9677-\u8ba1\u7b97\u6b65\u9aa4\u65e0\u6cd5\u5b58\u50a8\u3002\u6211\u4eec\u8fdb\u4e00\u6b65\u5730\u5bf9\u4e0a\u9762\u7684\u9a6c\u5c14\u53ef\u592b\u94fe\u8fdb\u884c\u89c2\u5bdf\uff1a 1 2 3 4 5 graph LR; a((a))-->b((b)); b-->c((c)); c-->d((d)); d-->e((e)); \u8981\u6c42 \\(p(e)\\) \uff0c\u5f53\u7136\u4f7f\u7528 VE\uff0c\u4ece \\(a\\) \u4e00\u76f4\u6d88\u9664\u5230 \\(d\\) \uff0c\u8bb0 \\(\\sum\\limits_ap(a)p(b|a)=m_{a\\to b(b)}\\) \uff0c\u8868\u793a\u8fd9\u662f\u6d88\u9664 \\(a\\) \u540e\u7684\u5173\u4e8e \\(b\\) \u7684\u6982\u7387\uff0c\u7c7b\u4f3c\u5730\uff0c\u8bb0 \\(\\sum\\limits_bp(c|b)m_{a\\to b}(b)=m_{b\\to c}(c)\\) \u3002\u4e8e\u662f \\(p(e)=\\sum\\limits_dp(e|d)m_{b\\to c}(c)\\) \u3002\u8fdb\u4e00\u6b65\u89c2\u5bdf\uff0c\u5bf9 \\(p(c)\\) \uff1a $$ p(c)=[\\sum\\limits_bp(c|b)\\sum\\limits_ap(b|a)p(a)]\\cdot[\\sum\\limits_dp(d|c)\\sum\\limits_ep(e)p(e|d)] $$ \u6211\u4eec\u53d1\u73b0\u4e86\u548c\u4e0a\u9762\u8ba1\u7b97 \\(p(e)\\) \u7c7b\u4f3c\u7684\u7ed3\u6784\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5206\u6210\u4e24\u4e2a\u90e8\u5206\uff0c\u4e00\u90e8\u5206\u662f\u4ece \\(a\\) \u4f20\u64ad\u8fc7\u6765\u7684\u6982\u7387\uff0c\u7b2c\u4e8c\u90e8\u5206\u662f\u4ece \\(e\\) \u4f20\u64ad\u8fc7\u6765\u7684\u6982\u7387\u3002 \u4e00\u822c\u5730\uff0c\u5bf9\u4e8e\u56fe\uff08\u53ea\u5bf9\u6811\u5f62\u72b6\u7684\u56fe\uff09\uff1a 1 2 3 4 graph TD; a((a))---b((b)); b---c((c)); b---d((d)); \u8fd9\u56db\u4e2a\u56e2\uff08\u5bf9\u4e8e\u65e0\u5411\u56fe\u662f\u56e2\uff0c\u5bf9\u4e8e\u6709\u5411\u56fe\u5c31\u662f\u6982\u7387\u4e3a\u9664\u4e86\u6839\u7684\u8282\u70b9\u4e3a1\uff09\uff0c\u6709\u56db\u4e2a\u8282\u70b9\uff0c\u4e09\u4e2a\u8fb9\uff1a $$ p(a,b,c,d)=\\frac{1}{Z}\\phi_a(a)\\phi_b(b)\\phi_c(c)\\phi_d(d)\\cdot\\phi_{ab}(a,b)\\phi_{bc}(c,b)\\phi_{bd}(d,b) $$ \u5957\u7528\u4e0a\u9762\u5173\u4e8e\u6709\u5411\u56fe\u7684\u89c2\u5bdf\uff0c\u5982\u679c\u6c42\u89e3\u8fb9\u7f18\u6982\u7387 \\(p(a)\\) \uff0c\u5b9a\u4e49 \\(m_{c\\to b}(b)=\\sum\\limits_c\\phi_c(c)\\phi_{bc}(bc)\\) \uff0c \\(m_{d\\to b}(b)=\\sum\\limits_d\\phi_d(d)\\phi_{bd}(bd)\\) \uff0c \\(m_{b\\to a}(a)=\\sum\\limits_b\\phi_{ba}(ba)\\phi_b(b)m_{c\\to b}(b)_{d\\to b}m(b)\\) \uff0c\u8fd9\u6837\u6982\u7387\u5c31\u4e00\u6b65\u6b65\u5730\u4f20\u64ad\u5230\u4e86 \\(a\\) \uff1a $$ p(a)=\\phi_a(a)m_{b\\to a}(a) $$ \u5199\u6210\u4e00\u822c\u7684\u5f62\u5f0f\uff0c\u5bf9\u4e8e\u76f8\u90bb\u8282\u70b9 \\(i,j\\) \uff1a $$ m_{j\\to i}(i)=\\sum\\limits_j\\phi_j(j)\\phi_{ij}(ij)\\prod\\limits_{k\\in Neighbour(j)-i}m_{k\\to j}(j) $$ \u8fd9\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5c31\u53ef\u4ee5\u4fdd\u5b58\u8ba1\u7b97\u8fc7\u7a0b\u4e86\uff0c\u53ea\u8981\u5bf9\u6bcf\u6761\u8fb9\u7684\u4f20\u64ad\u5206\u522b\u8ba1\u7b97\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u65e0\u5411\u6811\u5f62\u56fe\u53ef\u4ee5\u9012\u5f52\u5e76\u884c\u5b9e\u73b0\uff1a \u4efb\u53d6\u4e00\u4e2a\u8282\u70b9 \\(a\\) \u4f5c\u4e3a\u6839\u8282\u70b9 \u5bf9\u8fd9\u4e2a\u6839\u8282\u70b9\u7684\u90bb\u5c45\u4e2d\u7684\u6bcf\u4e00\u4e2a\u8282\u70b9\uff0c\u6536\u96c6\u4fe1\u606f\uff08\u8ba1\u7b97\u5165\u4fe1\u606f\uff09 \u5bf9\u6839\u8282\u70b9\u7684\u90bb\u5c45\uff0c\u5206\u53d1\u4fe1\u606f\uff08\u8ba1\u7b97\u51fa\u4fe1\u606f\uff09 \u63a8\u65ad-Max-Product \u7b97\u6cd5 \u5728\u63a8\u65ad\u4efb\u52a1\u4e2d\uff0cMAP \u4e5f\u662f\u5e38\u5e38\u9700\u8981\u7684\uff0cMAP \u7684\u76ee\u7684\u662f\u5bfb\u627e\u6700\u4f73\u53c2\u6570\uff1a $$ (\\hat{a},\\hat{b},\\hat{c},\\hat{d})=\\mathop{argmax} {a,b,c,d}p(a,b,c,d|E) $$ \u7c7b\u4f3c BP\uff0c\u6211\u4eec\u91c7\u7528\u4fe1\u606f\u4f20\u9012\u7684\u65b9\u5f0f\u6765\u6c42\u5f97\u6700\u4f18\u53c2\u6570\uff0c\u4e0d\u540c\u7684\u662f\uff0c\u6211\u4eec\u5728\u6240\u6709\u4fe1\u606f\u4f20\u9012\u4e2d\uff0c\u4f20\u9012\u7684\u662f\u6700\u5927\u5316\u53c2\u6570\u7684\u6982\u7387\uff0c\u800c\u4e0d\u662f\u5c06\u6240\u6709\u53ef\u80fd\u6c42\u548c\uff1a $$ m =\\max\\limits_{j}\\phi_j\\phi_{ij}\\prod\\limits_{k\\in Neighbour(j)-i}m_{k\\to j} $$ \u4e8e\u662f\u5bf9\u4e8e\u4e0a\u9762\u7684\u56fe\uff1a $$ \\max_a p(a,b,c,d)=\\max_a\\phi_a\\phi_{ab}m_{c\\to b}m_{d\\to b} $$ \u8fd9\u4e2a\u7b97\u6cd5\u662f Sum-Product \u7b97\u6cd5\u7684\u6539\u8fdb\uff0c\u4e5f\u662f\u5728 HMM \u4e2d\u5e94\u7528\u7ed9\u7684 Viterbi \u7b97\u6cd5\u7684\u63a8\u5e7f\u3002","title":"\u6982\u7387\u56fe\u6a21\u578b"},{"location":"Machine_Learning/7.PGMIntro/#_1","text":"\u6982\u7387\u56fe\u6a21\u578b\u4f7f\u7528\u56fe\u7684\u65b9\u5f0f\u8868\u793a\u6982\u7387\u5206\u5e03\u3002\u4e3a\u4e86\u5728\u56fe\u4e2d\u6dfb\u52a0\u5404\u79cd\u6982\u7387\uff0c\u9996\u5148\u603b\u7ed3\u4e00\u4e0b\u968f\u673a\u53d8\u91cf\u5206\u5e03\u7684\u4e00\u4e9b\u89c4\u5219\uff1a $$ \\begin{align} &Sum\\ Rule:p(x_1)=\\int p(x_1,x_2)dx_2\\ &Product\\ Rule:p(x_1,x_2)=p(x_1|x_2)p(x_2)\\ &Chain\\ Rule:p(x_1,x_2,\\cdots,x_p)=\\prod\\limits_{i=1}^pp(x_i|x_{i+1,x_{i+2} \\cdots}x_p)\\ &Bayesian\\ Rule:p(x_1|x_2)=\\frac{p(x_2|x_1)p(x_1)}{p(x_2)} \\end{align} $$ \u53ef\u4ee5\u770b\u5230\uff0c\u5728\u94fe\u5f0f\u6cd5\u5219\u4e2d\uff0c\u5982\u679c\u6570\u636e\u7ef4\u5ea6\u7279\u522b\u9ad8\uff0c\u90a3\u4e48\u7684\u91c7\u6837\u548c\u8ba1\u7b97\u975e\u5e38\u56f0\u96be\uff0c\u6211\u4eec\u9700\u8981\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u4f5c\u51fa\u7b80\u5316\uff0c\u5728\u6734\u7d20\u8d1d\u53f6\u65af\u4e2d\uff0c\u4f5c\u51fa\u4e86\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\u3002\u5728 Markov \u5047\u8bbe\u4e2d\uff0c\u7ed9\u5b9a\u6570\u636e\u7684\u7ef4\u5ea6\u662f\u4ee5\u65f6\u95f4\u987a\u5e8f\u51fa\u73b0\u7684\uff0c\u7ed9\u5b9a\u5f53\u524d\u65f6\u95f4\u7684\u7ef4\u5ea6\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u7ef4\u5ea6\u4e0e\u4e4b\u524d\u7684\u7ef4\u5ea6\u72ec\u7acb\u3002\u5728 HMM \u4e2d\uff0c\u91c7\u7528\u4e86\u9f50\u6b21 Markov \u5047\u8bbe\u3002\u5728 Markov \u5047\u8bbe\u4e4b\u4e0a\uff0c\u66f4\u4e00\u822c\u7684\uff0c\u52a0\u5165\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\uff0c\u5bf9\u7ef4\u5ea6\u5212\u5206\u96c6\u5408 \\(A,B,C\\) \uff0c\u4f7f\u5f97 \\(X_A\\perp X_B|X_C\\) \u3002 \u6982\u7387\u56fe\u6a21\u578b\u91c7\u7528\u56fe\u7684\u7279\u70b9\u8868\u793a\u4e0a\u8ff0\u7684\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe\uff0c\u8282\u70b9\u8868\u793a\u968f\u673a\u53d8\u91cf\uff0c\u8fb9\u8868\u793a\u6761\u4ef6\u6982\u7387\u3002\u6982\u7387\u56fe\u6a21\u578b\u53ef\u4ee5\u5206\u4e3a\u4e09\u5927\u7406\u8bba\u90e8\u5206\uff1a \u8868\u793a\uff1a \u6709\u5411\u56fe\uff08\u79bb\u6563\uff09\uff1a\u8d1d\u53f6\u65af\u7f51\u7edc \u9ad8\u65af\u56fe\uff08\u8fde\u7eed\uff09\uff1a\u9ad8\u65af\u8d1d\u53f6\u65af\u548c\u9ad8\u65af\u9a6c\u5c14\u53ef\u592b\u7f51\u8def \u65e0\u5411\u56fe\uff08\u79bb\u6563\uff09\uff1a\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc \u63a8\u65ad \u7cbe\u786e\u63a8\u65ad \u8fd1\u4f3c\u63a8\u65ad \u786e\u5b9a\u6027\u8fd1\u4f3c\uff08\u5982\u53d8\u5206\u63a8\u65ad\uff09 \u968f\u673a\u8fd1\u4f3c\uff08\u5982 MCMC\uff09 \u5b66\u4e60 \u53c2\u6570\u5b66\u4e60 \u5b8c\u5907\u6570\u636e \u9690\u53d8\u91cf\uff1aE-M \u7b97\u6cd5 \u7ed3\u6784\u5b66\u4e60","title":"\u6982\u7387\u56fe\u6a21\u578b"},{"location":"Machine_Learning/7.PGMIntro/#-","text":"\u5df2\u77e5\u8054\u5408\u5206\u5e03\u4e2d\uff0c\u5404\u4e2a\u968f\u673a\u53d8\u91cf\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u90a3\u4e48\u53ef\u4ee5\u901a\u8fc7\u62d3\u6251\u6392\u5e8f\uff08\u6839\u636e\u4f9d\u8d56\u5173\u7cfb\uff09\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u6709\u5411\u56fe\u3002\u800c\u5982\u679c\u5df2\u77e5\u4e00\u4e2a\u56fe\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u8054\u5408\u6982\u7387\u5206\u5e03\u7684\u56e0\u5b50\u5206\u89e3\uff1a $$ p(x_1,x_2,\\cdots,x_p)=\\prod\\limits_{i=1}^pp(x_i|x_{parent(i)}) $$ \u90a3\u4e48\u5b9e\u9645\u7684\u56fe\u4e2d\u6761\u4ef6\u72ec\u7acb\u6027\u662f\u5982\u4f55\u4f53\u73b0\u7684\u5462\uff1f\u5728\u5c40\u90e8\u4efb\u4f55\u4e09\u4e2a\u8282\u70b9\uff0c\u53ef\u4ee5\u6709\u4e09\u79cd\u7ed3\u6784\uff1a mermaid graph TB; A((A))-->B((B)); B-->C((C)); \\[ p(A,B,C)=p(A)p(B|A)p(C|B)=p(A)p(B|A)p(C|B,A)\\\\ \\Longrightarrow p(C|B)=p(C|B,A)\\\\ \\Leftrightarrow p(C|B)p(A|B)=p(C|A,B)p(A|B)=p(C,A|B)\\\\ \\Longrightarrow C\\perp A|B \\] mermaid graph TB; B((B))-->A((A)); B-->C((C)); \\[ p(A,B,C)=p(A|B)p(B)p(C|B)=p(B)p(A|B)p(C|A,B)\\\\ \\Longrightarrow p(C|B)=p(C|B,A)\\\\ \\Leftrightarrow p(C|B)p(A|B)=p(C|A,B)p(A|B)=p(C,A|B)\\\\ \\Longrightarrow C\\perp A|B \\] mermaid graph TB; A((A))-->B((B)); C((C))-->B \\[ p(A,B,C)=p(A)p(C)p(B|C,A)=p(A)p(C|A)p(B|C,A)\\\\ \\Longrightarrow p(C)=p(C|A)\\\\ \\Leftrightarrow C\\perp A\\\\ \\] \u5bf9\u8fd9\u79cd\u7ed3\u6784\uff0c \\(A,C\\) \u4e0d\u4e0e \\(B\\) \u6761\u4ef6\u72ec\u7acb\u3002 \u4ece\u6574\u4f53\u7684\u56fe\u6765\u770b\uff0c\u53ef\u4ee5\u5f15\u5165 D \u5212\u5206\u7684\u6982\u5ff5\u3002\u5bf9\u4e8e\u7c7b\u4f3c\u4e0a\u9762\u56fe 1\u548c\u56fe 2\u7684\u5173\u7cfb\uff0c\u5f15\u5165\u96c6\u5408A\uff0cB\uff0c\u90a3\u4e48\u6ee1\u8db3 \\(A\\perp B|C\\) \u7684 \\(C\\) \u96c6\u5408\u4e2d\u7684\u70b9\u4e0e \\(A,B\\) \u4e2d\u7684\u70b9\u7684\u5173\u7cfb\u90fd\u6ee1\u8db3\u56fe 1\uff0c2\uff0c\u6ee1\u8db3\u56fe3 \u5173\u7cfb\u7684\u70b9\u90fd\u4e0d\u5728 \\(C\\) \u4e2d\u3002D \u5212\u5206\u5e94\u7528\u5728\u8d1d\u53f6\u65af\u5b9a\u7406\u4e2d\uff1a $$ p(x_i|x_{-i})=\\frac{p(x)}{\\int p(x)dx_{i}}=\\frac{\\prod\\limits_{j=1}^pp(x_j|x_{parents(j)})}{\\int\\prod\\limits_{j=1}^pp(x_j|x_{parents(j)})dx_i} $$ \u53ef\u4ee5\u53d1\u73b0\uff0c\u4e0a\u4e0b\u90e8\u5206\u53ef\u4ee5\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u4e00\u90e8\u5206\u662f\u548c \\(x_i\\) \u76f8\u5173\u7684\uff0c\u53e6\u4e00\u90e8\u5206\u662f\u548c \\(x_i\\) \u65e0\u5173\u7684\uff0c\u800c\u8fd9\u4e2a\u65e0\u5173\u7684\u90e8\u5206\u53ef\u4ee5\u76f8\u4e92\u7ea6\u6389\u3002\u4e8e\u662f\u8ba1\u7b97\u53ea\u6d89\u53ca\u548c \\(x_i\\) \u76f8\u5173\u7684\u90e8\u5206\u3002 \u4e0e \\(x_i\\) \u76f8\u5173\u7684\u90e8\u5206\u53ef\u4ee5\u5199\u6210\uff1a $$ p(x_i|x_{parents(i)})p(x_{child(i)}|x_i) $$ \u8fd9\u4e9b\u76f8\u5173\u7684\u90e8\u5206\u53c8\u53eb\u505a Markov \u6bef\u3002 \u5b9e\u9645\u5e94\u7528\u7684\u6a21\u578b\u4e2d\uff0c\u5bf9\u8fd9\u4e9b\u6761\u4ef6\u72ec\u7acb\u6027\u4f5c\u51fa\u4e86\u5047\u8bbe\uff0c\u4ece\u5355\u4e00\u5230\u6df7\u5408\uff0c\u4ece\u6709\u9650\u5230\u65e0\u9650\uff08\u65f6\u95f4\uff0c\u7a7a\u95f4\uff09\u53ef\u4ee5\u5206\u4e3a\uff1a \u6734\u7d20\u8d1d\u53f6\u65af\uff0c\u5355\u4e00\u7684\u6761\u4ef6\u72ec\u7acb\u6027\u5047\u8bbe \\(p(x|y)=\\prod\\limits_{i=1}^pp(x_i|y)\\) \uff0c\u5728 D \u5212\u5206\u540e\uff0c\u6240\u6709\u6761\u4ef6\u4f9d\u8d56\u7684\u96c6\u5408\u5c31\u662f\u5355\u4e2a\u5143\u7d20\u3002 \u9ad8\u65af\u6df7\u5408\u6a21\u578b\uff1a\u6df7\u5408\u7684\u6761\u4ef6\u72ec\u7acb\u3002\u5f15\u5165\u591a\u7c7b\u522b\u7684\u9690\u53d8\u91cf \\(z_1, z_2,\\cdots,z_k\\) \uff0c \\(p(x|z)=\\mathcal{N}(\\mu,\\Sigma)\\) \uff0c\u6761\u4ef6\u4f9d\u8d56\u96c6\u5408\u4e3a\u591a\u4e2a\u5143\u7d20\u3002 \u4e0e\u65f6\u95f4\u76f8\u5173\u7684\u6761\u4ef6\u4f9d\u8d56 Markov \u94fe \u9ad8\u65af\u8fc7\u7a0b\uff08\u65e0\u9650\u7ef4\u9ad8\u65af\u5206\u5e03\uff09 \u8fde\u7eed\uff1a\u9ad8\u65af\u8d1d\u53f6\u65af\u7f51\u7edc \u7ec4\u5408\u4e0a\u9762\u7684\u5206\u7c7b GMM \u4e0e\u65f6\u5e8f\u7ed3\u5408\uff1a\u52a8\u6001\u6a21\u578b HMM\uff08\u79bb\u6563\uff09 \u7ebf\u6027\u52a8\u6001\u7cfb\u7edf LDS\uff08Kalman \u6ee4\u6ce2\uff09 \u7c92\u5b50\u6ee4\u6ce2\uff08\u975e\u9ad8\u65af\uff0c\u975e\u7ebf\u6027\uff09","title":"\u6709\u5411\u56fe-\u8d1d\u53f6\u65af\u7f51\u7edc"},{"location":"Machine_Learning/7.PGMIntro/#-_1","text":"\u65e0\u5411\u56fe\u6ca1\u6709\u4e86\u7c7b\u4f3c\u6709\u5411\u56fe\u7684\u5c40\u90e8\u4e0d\u540c\u7ed3\u6784\uff0c\u5728\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc\u4e2d\uff0c\u4e5f\u5b58\u5728 D \u5212\u5206\u7684\u6982\u5ff5\u3002\u76f4\u63a5\u5c06\u6761\u4ef6\u72ec\u7acb\u7684\u96c6\u5408 \\(x_A\\perp x_B|x_C\\) \u5212\u5206\u4e3a\u4e09\u4e2a\u96c6\u5408\u3002\u8fd9\u4e2a\u4e5f\u53eb\u5168\u5c40 Markov\u3002\u5bf9\u5c40\u90e8\u7684\u8282\u70b9\uff0c \\(x\\perp (X-Neighbour(\\mathcal{x}))|Neighbour(x)\\) \u3002\u8fd9\u4e5f\u53eb\u5c40\u90e8 Markov\u3002\u5bf9\u4e8e\u6210\u5bf9\u7684\u8282\u70b9\uff1a \\(x_i\\perp x_j|x_{-i-j}\\) \uff0c\u5176\u4e2d \\(i,j\\) \u4e0d\u80fd\u76f8\u90bb\u3002\u8fd9\u4e5f\u53eb\u6210\u5bf9 Markov\u3002\u4e8b\u5b9e\u4e0a\u4e0a\u9762\u4e09\u4e2a\u70b9\u5c40\u90e8\u5168\u5c40\u6210\u5bf9\u662f\u76f8\u4e92\u7b49\u4ef7\u7684\u3002 \u6709\u4e86\u8fd9\u4e2a\u6761\u4ef6\u72ec\u7acb\u6027\u7684\u5212\u5206\uff0c\u8fd8\u9700\u8981\u56e0\u5b50\u5206\u89e3\u6765\u5b9e\u9645\u8ba1\u7b97\u3002\u5f15\u5165\u56e2\u7684\u6982\u5ff5\uff1a \u56e2\uff0c\u6700\u5927\u56e2\uff1a\u56fe\u4e2d\u8282\u70b9\u7684\u96c6\u5408\uff0c\u96c6\u5408\u4e2d\u7684\u8282\u70b9\u4e4b\u95f4\u76f8\u4e92\u90fd\u662f\u8fde\u63a5\u7684\u53eb\u505a\u56e2\uff0c\u5982\u679c\u4e0d\u80fd\u518d\u6dfb\u52a0\u8282\u70b9\uff0c\u90a3\u4e48\u53eb\u6700\u5927\u56e2\u3002 \u5229\u7528\u8fd9\u4e2a\u5b9a\u4e49\u8fdb\u884c\u7684 \\(x\\) \u6240\u6709\u7ef4\u5ea6\u7684\u8054\u5408\u6982\u7387\u5206\u5e03\u7684\u56e0\u5b50\u5206\u89e3\u4e3a\uff0c\u5047\u8bbe\u6709 \\(K\\) \u4e2a\u56e2\uff0c \\(Z\\) \u5c31\u662f\u5bf9\u6240\u6709\u53ef\u80fd\u53d6\u503c\u6c42\u548c\uff1a $$ \\begin{align}p(x)=\\frac{1}{Z}\\prod\\limits_{i=1}^{K}\\phi(x_{ci})\\ Z=\\sum\\limits_{x\\in\\mathcal{X}}\\prod\\limits_{i=1}^{K}\\phi(x_{ci}) \\end{align} $$ \u5176\u4e2d \\(\\phi(x_{ci})\\) \u53eb\u505a\u52bf\u51fd\u6570\uff0c\u5b83\u5fc5\u987b\u662f\u4e00\u4e2a\u6b63\u503c\uff0c\u53ef\u4ee5\u8bb0\u4e3a\uff1a $$ \\phi(x_{ci})=\\exp(-E(x_{ci})) $$ \u8fd9\u4e2a\u5206\u5e03\u53eb\u505a Gibbs \u5206\u5e03\uff08\u73bb\u5c14\u5179\u66fc\u5206\u5e03\uff09\u3002\u4e8e\u662f\u4e5f\u53ef\u4ee5\u8bb0\u4e3a\uff1a \\(p(x)=\\frac{1}{Z}\\exp(-\\sum\\limits_{i=1}^KE(x_{ci}))\\) \u3002\u8fd9\u4e2a\u5206\u89e3\u548c\u6761\u4ef6\u72ec\u7acb\u6027\u7b49\u4ef7\uff08Hammesley-Clifford \u5b9a\u7406\uff09\uff0c\u8fd9\u4e2a\u5206\u5e03\u7684\u5f62\u5f0f\u4e5f\u548c\u6307\u6570\u65cf\u5206\u5e03\u5f62\u5f0f\u4e0a\u76f8\u540c\uff0c\u4e8e\u662f\u6ee1\u8db3\u6700\u5927\u71b5\u539f\u7406\u3002","title":"\u65e0\u5411\u56fe-\u9a6c\u5c14\u53ef\u592b\u7f51\u7edc\uff08\u9a6c\u5c14\u53ef\u592b\u968f\u673a\u573a\uff09"},{"location":"Machine_Learning/7.PGMIntro/#-_2","text":"\u6211\u4eec\u5e38\u5e38\u60f3\u5c06\u6709\u5411\u56fe\u8f6c\u4e3a\u65e0\u5411\u56fe\uff0c\u4ece\u800c\u5e94\u7528\u66f4\u4e00\u822c\u7684\u8868\u8fbe\u5f0f\u3002 \u94fe\u5f0f\uff1a 1 2 3 graph TB; A((A))-->B((B)); B-->C((C)); \u76f4\u63a5\u53bb\u6389\u7bad\u5934\uff0c \\(p(a,b,c)=p(a)p(b|a)p(c|b)=\\phi(a,b)\\phi(b,c)\\) \uff1a 1 2 3 graph TB; A((A))---B((B)); B---C((C)); V \u5f62\uff1a 1 2 3 graph TB; B((B))-->A((A)); B-->C((C)); \u7531\u4e8e \\(p(a,b,c)=p(b)p(a|b)p(c|b)=\\phi(a,b)\\phi(b,c)\\) \uff0c\u76f4\u63a5\u53bb\u6389\u7bad\u5934\uff1a 1 2 3 graph TB; B((B))---A((A)); B---C((C)); \u5012 V \u5f62\uff1a 1 2 3 graph TB; A((A))-->B((B)); C((C))-->B \u7531\u4e8e \\(p(a,b,c)=p(a)p(c)p(b|a,c)=\\phi(a,b,c)\\) \uff0c\u4e8e\u662f\u5728 \\(a,c\\) \u4e4b\u95f4\u6dfb\u52a0\u7ebf\uff1a 1 2 3 4 graph TD; a((a))---b((b)); b---c((c)); a---c; \u89c2\u5bdf\u7740\u4e09\u79cd\u60c5\u51b5\u53ef\u4ee5\u6982\u62ec\u4e3a\uff1a \u5c06\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u4e24\u4e24\u76f8\u8fde \u5c06\u6709\u5411\u8fb9\u66ff\u6362\u4e3a\u65e0\u5411\u8fb9","title":"\u4e24\u79cd\u56fe\u7684\u8f6c\u6362-\u9053\u5fb7\u56fe"},{"location":"Machine_Learning/7.PGMIntro/#-_3","text":"\u5bf9\u4e8e\u4e00\u4e2a\u6709\u5411\u56fe\uff0c\u53ef\u4ee5\u901a\u8fc7\u5f15\u5165\u73af\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5c06\u5176\u8f6c\u6362\u4e3a\u65e0\u5411\u56fe\uff08Tree-like graph\uff09\uff0c\u8fd9\u4e2a\u56fe\u5c31\u53eb\u505a\u9053\u5fb7\u56fe\u3002\u4f46\u662f\u6211\u4eec\u4e0a\u9762\u7684 BP \u7b97\u6cd5\u53ea\u5bf9\u65e0\u73af\u56fe\u6709\u6548\uff0c\u901a\u8fc7\u56e0\u5b50\u56fe\u53ef\u4ee5\u53d8\u4e3a\u65e0\u73af\u56fe\u3002 \u8003\u8651\u4e00\u4e2a\u65e0\u5411\u56fe\uff1a 1 2 3 4 graph TD; a((a))---b((b)); b---c((c)); a---c; \u53ef\u4ee5\u5c06\u5176\u8f6c\u4e3a\uff1a 1 2 3 4 graph TD; a((a))---f; f---b((b)); f---c((c)) \u5176\u4e2d \\(f=f(a,b,c)\\) \u3002\u56e0\u5b50\u56fe\u4e0d\u662f\u552f\u4e00\u7684\uff0c\u8fd9\u662f\u7531\u4e8e\u56e0\u5f0f\u5206\u89e3\u672c\u8eab\u5c31\u5bf9\u5e94\u4e00\u4e2a\u7279\u6b8a\u7684\u56e0\u5b50\u56fe\uff0c\u5c06\u56e0\u5f0f\u5206\u89e3\uff1a \\(p(x)=\\prod\\limits_{s}f_s(x_s)\\) \u53ef\u4ee5\u8fdb\u4e00\u6b65\u5206\u89e3\u5f97\u5230\u56e0\u5b50\u56fe\u3002","title":"\u66f4\u7cbe\u7ec6\u7684\u5206\u89e3-\u56e0\u5b50\u56fe"},{"location":"Machine_Learning/7.PGMIntro/#_2","text":"\u63a8\u65ad\u7684\u4e3b\u8981\u76ee\u7684\u662f\u6c42\u5404\u79cd\u6982\u7387\u5206\u5e03\uff0c\u5305\u62ec\u8fb9\u7f18\u6982\u7387\uff0c\u6761\u4ef6\u6982\u7387\uff0c\u4ee5\u53ca\u4f7f\u7528 MAP \u6765\u6c42\u5f97\u53c2\u6570\u3002\u901a\u5e38\u63a8\u65ad\u53ef\u4ee5\u5206\u4e3a\uff1a \u7cbe\u786e\u63a8\u65ad Variable Elimination(VE) Belief Propagation(BP, Sum-Product Algo)\uff0c\u4ece VE \u53d1\u5c55\u800c\u6765 Junction Tree\uff0c\u4e0a\u9762\u4e24\u79cd\u5728\u6811\u7ed3\u6784\u4e0a\u5e94\u7528\uff0cJunction Tree \u5728\u56fe\u7ed3\u6784\u4e0a\u5e94\u7528 \u8fd1\u4f3c\u63a8\u65ad Loop Belief Propagation\uff08\u9488\u5bf9\u6709\u73af\u56fe\uff09 Mente Carlo Interference\uff1a\u4f8b\u5982 Importance Sampling\uff0cMCMC Variational Inference","title":"\u63a8\u65ad"},{"location":"Machine_Learning/7.PGMIntro/#-ve","text":"\u53d8\u91cf\u6d88\u9664\u7684\u65b9\u6cd5\u662f\u5728\u6c42\u89e3\u6982\u7387\u5206\u5e03\u7684\u65f6\u5019\uff0c\u5c06\u76f8\u5173\u7684\u6761\u4ef6\u6982\u7387\u5148\u884c\u6c42\u548c\u6216\u79ef\u5206\uff0c\u4ece\u800c\u4e00\u6b65\u6b65\u5730\u6d88\u9664\u53d8\u91cf\uff0c\u4f8b\u5982\u5728\u9a6c\u5c14\u53ef\u592b\u94fe\u4e2d\uff1a 1 2 3 4 graph LR; a((a))-->b((b)); b-->c((c)); c-->d((d)) \\[ p(d)=\\sum\\limits_{a,b,c}p(a,b,c,d)=\\sum\\limits_cp(d|c)\\sum\\limits_bp(c|b)\\sum\\limits_ap(b|a)p(a) \\] \u53d8\u91cf\u6d88\u9664\u7684\u7f3a\u70b9\u5f88\u660e\u663e\uff1a \u8ba1\u7b97\u6b65\u9aa4\u65e0\u6cd5\u5b58\u50a8 \u6d88\u9664\u7684\u6700\u4f18\u6b21\u5e8f\u662f\u4e00\u4e2a NP-hard \u95ee\u9898","title":"\u63a8\u65ad-\u53d8\u91cf\u6d88\u9664\uff08VE\uff09"},{"location":"Machine_Learning/7.PGMIntro/#-bp","text":"\u4e3a\u4e86\u514b\u670d VE \u7684\u7b2c\u4e00\u4e2a\u7f3a\u9677-\u8ba1\u7b97\u6b65\u9aa4\u65e0\u6cd5\u5b58\u50a8\u3002\u6211\u4eec\u8fdb\u4e00\u6b65\u5730\u5bf9\u4e0a\u9762\u7684\u9a6c\u5c14\u53ef\u592b\u94fe\u8fdb\u884c\u89c2\u5bdf\uff1a 1 2 3 4 5 graph LR; a((a))-->b((b)); b-->c((c)); c-->d((d)); d-->e((e)); \u8981\u6c42 \\(p(e)\\) \uff0c\u5f53\u7136\u4f7f\u7528 VE\uff0c\u4ece \\(a\\) \u4e00\u76f4\u6d88\u9664\u5230 \\(d\\) \uff0c\u8bb0 \\(\\sum\\limits_ap(a)p(b|a)=m_{a\\to b(b)}\\) \uff0c\u8868\u793a\u8fd9\u662f\u6d88\u9664 \\(a\\) \u540e\u7684\u5173\u4e8e \\(b\\) \u7684\u6982\u7387\uff0c\u7c7b\u4f3c\u5730\uff0c\u8bb0 \\(\\sum\\limits_bp(c|b)m_{a\\to b}(b)=m_{b\\to c}(c)\\) \u3002\u4e8e\u662f \\(p(e)=\\sum\\limits_dp(e|d)m_{b\\to c}(c)\\) \u3002\u8fdb\u4e00\u6b65\u89c2\u5bdf\uff0c\u5bf9 \\(p(c)\\) \uff1a $$ p(c)=[\\sum\\limits_bp(c|b)\\sum\\limits_ap(b|a)p(a)]\\cdot[\\sum\\limits_dp(d|c)\\sum\\limits_ep(e)p(e|d)] $$ \u6211\u4eec\u53d1\u73b0\u4e86\u548c\u4e0a\u9762\u8ba1\u7b97 \\(p(e)\\) \u7c7b\u4f3c\u7684\u7ed3\u6784\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5206\u6210\u4e24\u4e2a\u90e8\u5206\uff0c\u4e00\u90e8\u5206\u662f\u4ece \\(a\\) \u4f20\u64ad\u8fc7\u6765\u7684\u6982\u7387\uff0c\u7b2c\u4e8c\u90e8\u5206\u662f\u4ece \\(e\\) \u4f20\u64ad\u8fc7\u6765\u7684\u6982\u7387\u3002 \u4e00\u822c\u5730\uff0c\u5bf9\u4e8e\u56fe\uff08\u53ea\u5bf9\u6811\u5f62\u72b6\u7684\u56fe\uff09\uff1a 1 2 3 4 graph TD; a((a))---b((b)); b---c((c)); b---d((d)); \u8fd9\u56db\u4e2a\u56e2\uff08\u5bf9\u4e8e\u65e0\u5411\u56fe\u662f\u56e2\uff0c\u5bf9\u4e8e\u6709\u5411\u56fe\u5c31\u662f\u6982\u7387\u4e3a\u9664\u4e86\u6839\u7684\u8282\u70b9\u4e3a1\uff09\uff0c\u6709\u56db\u4e2a\u8282\u70b9\uff0c\u4e09\u4e2a\u8fb9\uff1a $$ p(a,b,c,d)=\\frac{1}{Z}\\phi_a(a)\\phi_b(b)\\phi_c(c)\\phi_d(d)\\cdot\\phi_{ab}(a,b)\\phi_{bc}(c,b)\\phi_{bd}(d,b) $$ \u5957\u7528\u4e0a\u9762\u5173\u4e8e\u6709\u5411\u56fe\u7684\u89c2\u5bdf\uff0c\u5982\u679c\u6c42\u89e3\u8fb9\u7f18\u6982\u7387 \\(p(a)\\) \uff0c\u5b9a\u4e49 \\(m_{c\\to b}(b)=\\sum\\limits_c\\phi_c(c)\\phi_{bc}(bc)\\) \uff0c \\(m_{d\\to b}(b)=\\sum\\limits_d\\phi_d(d)\\phi_{bd}(bd)\\) \uff0c \\(m_{b\\to a}(a)=\\sum\\limits_b\\phi_{ba}(ba)\\phi_b(b)m_{c\\to b}(b)_{d\\to b}m(b)\\) \uff0c\u8fd9\u6837\u6982\u7387\u5c31\u4e00\u6b65\u6b65\u5730\u4f20\u64ad\u5230\u4e86 \\(a\\) \uff1a $$ p(a)=\\phi_a(a)m_{b\\to a}(a) $$ \u5199\u6210\u4e00\u822c\u7684\u5f62\u5f0f\uff0c\u5bf9\u4e8e\u76f8\u90bb\u8282\u70b9 \\(i,j\\) \uff1a $$ m_{j\\to i}(i)=\\sum\\limits_j\\phi_j(j)\\phi_{ij}(ij)\\prod\\limits_{k\\in Neighbour(j)-i}m_{k\\to j}(j) $$ \u8fd9\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5c31\u53ef\u4ee5\u4fdd\u5b58\u8ba1\u7b97\u8fc7\u7a0b\u4e86\uff0c\u53ea\u8981\u5bf9\u6bcf\u6761\u8fb9\u7684\u4f20\u64ad\u5206\u522b\u8ba1\u7b97\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u65e0\u5411\u6811\u5f62\u56fe\u53ef\u4ee5\u9012\u5f52\u5e76\u884c\u5b9e\u73b0\uff1a \u4efb\u53d6\u4e00\u4e2a\u8282\u70b9 \\(a\\) \u4f5c\u4e3a\u6839\u8282\u70b9 \u5bf9\u8fd9\u4e2a\u6839\u8282\u70b9\u7684\u90bb\u5c45\u4e2d\u7684\u6bcf\u4e00\u4e2a\u8282\u70b9\uff0c\u6536\u96c6\u4fe1\u606f\uff08\u8ba1\u7b97\u5165\u4fe1\u606f\uff09 \u5bf9\u6839\u8282\u70b9\u7684\u90bb\u5c45\uff0c\u5206\u53d1\u4fe1\u606f\uff08\u8ba1\u7b97\u51fa\u4fe1\u606f\uff09","title":"\u63a8\u65ad-\u4fe1\u5ff5\u4f20\u64ad\uff08BP\uff09"},{"location":"Machine_Learning/7.PGMIntro/#-max-product","text":"\u5728\u63a8\u65ad\u4efb\u52a1\u4e2d\uff0cMAP \u4e5f\u662f\u5e38\u5e38\u9700\u8981\u7684\uff0cMAP \u7684\u76ee\u7684\u662f\u5bfb\u627e\u6700\u4f73\u53c2\u6570\uff1a $$ (\\hat{a},\\hat{b},\\hat{c},\\hat{d})=\\mathop{argmax} {a,b,c,d}p(a,b,c,d|E) $$ \u7c7b\u4f3c BP\uff0c\u6211\u4eec\u91c7\u7528\u4fe1\u606f\u4f20\u9012\u7684\u65b9\u5f0f\u6765\u6c42\u5f97\u6700\u4f18\u53c2\u6570\uff0c\u4e0d\u540c\u7684\u662f\uff0c\u6211\u4eec\u5728\u6240\u6709\u4fe1\u606f\u4f20\u9012\u4e2d\uff0c\u4f20\u9012\u7684\u662f\u6700\u5927\u5316\u53c2\u6570\u7684\u6982\u7387\uff0c\u800c\u4e0d\u662f\u5c06\u6240\u6709\u53ef\u80fd\u6c42\u548c\uff1a $$ m =\\max\\limits_{j}\\phi_j\\phi_{ij}\\prod\\limits_{k\\in Neighbour(j)-i}m_{k\\to j} $$ \u4e8e\u662f\u5bf9\u4e8e\u4e0a\u9762\u7684\u56fe\uff1a $$ \\max_a p(a,b,c,d)=\\max_a\\phi_a\\phi_{ab}m_{c\\to b}m_{d\\to b} $$ \u8fd9\u4e2a\u7b97\u6cd5\u662f Sum-Product \u7b97\u6cd5\u7684\u6539\u8fdb\uff0c\u4e5f\u662f\u5728 HMM \u4e2d\u5e94\u7528\u7ed9\u7684 Viterbi \u7b97\u6cd5\u7684\u63a8\u5e7f\u3002","title":"\u63a8\u65ad-Max-Product \u7b97\u6cd5"},{"location":"Machine_Learning/8.EM/","text":"\u671f\u671b\u6700\u5927 \u671f\u671b\u6700\u5927\u7b97\u6cd5\u7684\u76ee\u7684\u662f\u89e3\u51b3\u5177\u6709\u9690\u53d8\u91cf\u7684\u6df7\u5408\u6a21\u578b\u7684\u53c2\u6570\u4f30\u8ba1\uff08\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\uff09\u3002MLE \u5bf9 \\(p(x|\\theta)\\) \u53c2\u6570\u7684\u4f30\u8ba1\u8bb0\u4e3a\uff1a \\(\\theta_{MLE}=\\mathop{argmax}\\limits_\\theta\\log p(x|\\theta)\\) \u3002EM \u7b97\u6cd5\u5bf9\u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u91c7\u7528\u8fed\u4ee3\u7684\u65b9\u6cd5\uff1a $$ \\theta^{t+1}=\\mathop{argmax}\\limits_{\\theta}\\int_z\\log [p(x,z|\\theta)]p(z|x,\\theta^t)dz=\\mathbb{E}_{z|x,\\theta^t}[\\log p(x,z|\\theta)] $$ \u8fd9\u4e2a\u516c\u5f0f\u5305\u542b\u4e86\u8fed\u4ee3\u7684\u4e24\u6b65\uff1a E step\uff1a\u8ba1\u7b97 \\(\\log p(x,z|\\theta)\\) \u5728\u6982\u7387\u5206\u5e03 \\(p(z|x,\\theta^t)\\) \u4e0b\u7684\u671f\u671b M step\uff1a\u8ba1\u7b97\u4f7f\u8fd9\u4e2a\u671f\u671b\u6700\u5927\u5316\u7684\u53c2\u6570\u5f97\u5230\u4e0b\u4e00\u4e2a EM \u6b65\u9aa4\u7684\u8f93\u5165 \u6c42\u8bc1\uff1a \\(\\log p(x|\\theta^t)\\le\\log p(x|\\theta^{t+1})\\) \u8bc1\u660e\uff1a \\(\\log p(x|\\theta)=\\log p(z,x|\\theta)-\\log p(z|x,\\theta)\\) \uff0c\u5bf9\u5de6\u53f3\u4e24\u8fb9\u6c42\u79ef\u5206\uff1a $$ Left:\\int_zp(z|x,\\theta^t)\\log p(x|\\theta)dz=\\log p(x|\\theta) $$ $$ Right:\\int_zp(z|x,\\theta^t)\\log p(x,z|\\theta)dz-\\int_zp(z|x,\\theta^t)\\log p(z|x,\\theta)dz=Q(\\theta,\\theta^t)-H(\\theta,\\theta^t) $$ \u6240\u4ee5\uff1a $$ \\log p(x|\\theta)=Q(\\theta,\\theta^t)-H(\\theta,\\theta^t) $$ \u7531\u4e8e \\(Q(\\theta,\\theta^t)=\\int_zp(z|x,\\theta^t)\\log p(x,z|\\theta)dz\\) \uff0c\u800c \\(\\theta^{t+1}=\\mathop{argmax}\\limits_{\\theta}\\int_z\\log [p(x,z|\\theta)]p(z|x,\\theta^t)dz\\) \uff0c\u6240\u4ee5 \\(Q(\\theta^{t+1},\\theta^t)\\ge Q(\\theta^t,\\theta^t)\\) \u3002\u8981\u8bc1 \\(\\log p(x|\\theta^t)\\le\\log p(x|\\theta^{t+1})\\) \uff0c\u9700\u8bc1\uff1a \\(H(\\theta^t,\\theta^t)\\ge H(\\theta^{t+1},\\theta^t)\\) \uff1a $$ \\begin{align}H(\\theta^{t+1},\\theta^t)-H(\\theta^{t},\\theta^t)&=\\int_zp(z|x,\\theta^{t})\\log p(z|x,\\theta^{t+1})dz-\\int_zp(z|x,\\theta^t)\\log p(z|x,\\theta^{t})dz\\nonumber\\ &=\\int_zp(z|x,\\theta^t)\\log\\frac{p(z|x,\\theta^{t+1})}{p(z|x,\\theta^t)}=-KL(p(z|x,\\theta^t),p(z|x,\\theta^{t+1}))\\le0 \\end{align} $$ \u7efc\u5408\u4e0a\u9762\u7684\u7ed3\u679c\uff1a $$ \\log p(x|\\theta^t)\\le\\log p(x|\\theta^{t+1}) $$ \u6839\u636e\u4e0a\u9762\u7684\u8bc1\u660e\uff0c\u6211\u4eec\u770b\u5230\uff0c\u4f3c\u7136\u51fd\u6570\u5728\u6bcf\u4e00\u6b65\u90fd\u4f1a\u589e\u5927\u3002\u8fdb\u4e00\u6b65\u7684\uff0c\u6211\u4eec\u770b EM \u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u7684\u5f0f\u5b50\u662f\u600e\u4e48\u6765\u7684\uff1a $$ \\log p(x|\\theta)=\\log p(z,x|\\theta)-\\log p(z|x,\\theta)=\\log \\frac{p(z,x|\\theta)}{q(z)}-\\log \\frac{p(z|x,\\theta)}{q(z)} $$ \u5206\u522b\u5bf9\u4e24\u8fb9\u6c42\u671f\u671b \\(\\mathbb{E}_{q(z)}\\) \uff1a $$ \\begin{align} &Left:\\int_zq(z)\\log p(x|\\theta)dz=\\log p(x|\\theta)\\ &Right:\\int_zq(z)\\log \\frac{p(z,x|\\theta)}{q(z)}dz-\\int_zq(z)\\log \\frac{p(z|x,\\theta)}{q(z)}dz=ELBO+KL(q(z),p(z|x,\\theta)) \\end{align} $$ \u4e0a\u5f0f\u4e2d\uff0cEvidence Lower Bound(ELBO)\uff0c\u662f\u4e00\u4e2a\u4e0b\u754c\uff0c\u6240\u4ee5 \\(\\log p(x|\\theta)\\ge ELBO\\) \uff0c\u7b49\u4e8e\u53f7\u53d6\u5728 KL \u6563\u5ea6\u4e3a0\u662f\uff0c\u5373\uff1a \\(q(z)=p(z|x,\\theta)\\) \uff0cEM \u7b97\u6cd5\u7684\u76ee\u7684\u662f\u5c06 ELBO \u6700\u5927\u5316\uff0c\u6839\u636e\u4e0a\u9762\u7684\u8bc1\u660e\u8fc7\u7a0b\uff0c\u5728\u6bcf\u4e00\u6b65 EM \u540e\uff0c\u6c42\u5f97\u4e86\u6700\u5927\u7684ELBO\uff0c\u5e76\u6839\u636e\u8fd9\u4e2a\u4f7f ELBO \u6700\u5927\u7684\u53c2\u6570\u4ee3\u5165\u4e0b\u4e00\u6b65\u4e2d\uff1a $$ \\hat{\\theta}=\\mathop{argmax} {\\theta}ELBO=\\mathop{argmax} \\theta\\int_zq(z)\\log\\frac{p(x,z|\\theta)}{q(z)}dz $$ \u7531\u4e8e \\(q(z)=p(z|x,\\theta^t)\\) \u7684\u65f6\u5019\uff0c\u8fd9\u4e00\u6b65\u7684\u6700\u5927\u503c\u624d\u80fd\u53d6\u7b49\u53f7\uff0c\u6240\u4ee5\uff1a $$ \\hat{\\theta}=\\mathop{argmax} {\\theta}ELBO=\\mathop{argmax} \\theta\\int_zq(z)\\log\\frac{p(x,z|\\theta)}{q(z)}dz=\\mathop{argmax} \\theta\\int_zp(z|x,\\theta^t)\\log\\frac{p(x,z|\\theta)}{p(z|x,\\theta^t)}d z\\ =\\mathop{argmax} \\theta\\int_z p(z|x,\\theta^t)\\log p(x,z|\\theta) $$ \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u4e0a\u9762 EM \u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u7684\u5f0f\u5b50\u3002 \u4ece Jensen \u4e0d\u7b49\u5f0f\u51fa\u53d1\uff0c\u4e5f\u53ef\u4ee5\u5bfc\u51fa\u8fd9\u4e2a\u5f0f\u5b50\uff1a $$ \\log p(x|\\theta)=\\log\\int_zp(x,z|\\theta)dz=\\log\\int_z\\frac{p(x,z|\\theta)q(z)}{q(z)}dz\\ =\\log \\mathbb{E} {q(z)}[\\frac{p(x,z|\\theta)}{q(z)}]\\ge \\mathbb{E} [\\log\\frac{p(x,z|\\theta)}{q(z)}] $$ \u5176\u4e2d\uff0c\u53f3\u8fb9\u7684\u5f0f\u5b50\u5c31\u662f ELBO\uff0c\u7b49\u53f7\u5728 \\(p(x,z|\\theta)=Cq(z)\\) \u65f6\u6210\u7acb\u3002\u4e8e\u662f\uff1a $$ \\int_zq(z)dz=\\frac{1}{C}\\int_zp(x,z|\\theta)dz=\\frac{1}{C}p(x|\\theta)=1\\ \\Rightarrow q(z)=\\frac{1}{p(x|\\theta)}p(x,z|\\theta)=p(z|x,\\theta) $$ \u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u662f\u4e0a\u9762\u7684\u6700\u5927\u503c\u53d6\u7b49\u53f7\u7684\u6761\u4ef6\u3002 \u5e7f\u4e49 EM EM \u6a21\u578b\u89e3\u51b3\u4e86\u6982\u7387\u751f\u6210\u6a21\u578b\u7684\u53c2\u6570\u4f30\u8ba1\u7684\u95ee\u9898\uff0c\u901a\u8fc7\u5f15\u5165\u9690\u53d8\u91cf \\(z\\) \uff0c\u6765\u5b66\u4e60 \\(\\theta\\) \uff0c\u5177\u4f53\u7684\u6a21\u578b\u5bf9 \\(z\\) \u6709\u4e0d\u540c\u7684\u5047\u8bbe\u3002\u5bf9\u5b66\u4e60\u4efb\u52a1 \\(p(x|\\theta)\\) \uff0c\u5c31\u662f\u5b66\u4e60\u4efb\u52a1 \\(\\frac{p(x,z|\\theta)}{p(z|x,\\theta)}\\) \u3002\u5728\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\uff0c\u6211\u4eec\u5047\u5b9a\u4e86\u5728 E \u6b65\u9aa4\u4e2d\uff0c \\(q(z)=p(z|x,\\theta)\\) \uff0c\u4f46\u662f\u8fd9\u4e2a \\(p(z|x,\\theta)\\) \u5982\u679c\u65e0\u6cd5\u6c42\u89e3\uff0c\u90a3\u4e48\u5fc5\u987b\u4f7f\u7528\u91c7\u6837\uff08MCMC\uff09\u6216\u8005\u53d8\u5206\u63a8\u65ad\u7b49\u65b9\u6cd5\u6765\u8fd1\u4f3c\u63a8\u65ad\u8fd9\u4e2a\u540e\u9a8c\u3002\u6211\u4eec\u89c2\u5bdf KL \u6563\u5ea6\u7684\u8868\u8fbe\u5f0f\uff0c\u4e3a\u4e86\u6700\u5927\u5316 ELBO\uff0c\u5728\u56fa\u5b9a\u7684 \\(\\theta\\) \u65f6\uff0c\u6211\u4eec\u9700\u8981\u6700\u5c0f\u5316 KL \u6563\u5ea6\uff0c\u4e8e\u662f\uff1a $$ \\hat{q}(z)=\\mathop{argmin}_qKL(p,q)=\\mathop{argmax}_qELBO $$ \u8fd9\u5c31\u662f\u5e7f\u4e49 EM \u7684\u57fa\u672c\u601d\u8def\uff1a E step\uff1a $$ \\hat{q}^{t+1}(z)=\\mathop{argmax}_q\\int_zq^t(z)\\log\\frac{p(x,z|\\theta)}{q^t(z)}dz,fixed\\ \\theta $$ M step\uff1a $$ \\hat{\\theta}=\\mathop{argmax}_\\theta \\int_zq^{t+1}(z)\\log\\frac{p(x,z|\\theta)}{q^{t+1}(z)}dz,fixed\\ \\hat{q} $$ \u5bf9\u4e8e\u4e0a\u9762\u7684\u79ef\u5206\uff1a $$ ELBO=\\int_zq(z)\\log\\frac{p(x,z|\\theta)}{q(z)}dz=\\mathbb{E}_{q(z)}[p(x,z|\\theta)]+Entropy(q(z)) $$ \u56e0\u6b64\uff0c\u6211\u4eec\u770b\u5230\uff0c\u5e7f\u4e49 EM \u76f8\u5f53\u4e8e\u5728\u539f\u6765\u7684\u5f0f\u5b50\u4e2d\u52a0\u5165\u71b5\u8fd9\u4e00\u9879\u3002 EM \u7684\u63a8\u5e7f EM \u7b97\u6cd5\u7c7b\u4f3c\u4e8e\u5750\u6807\u4e0a\u5347\u6cd5\uff0c\u56fa\u5b9a\u90e8\u5206\u5750\u6807\uff0c\u4f18\u5316\u5176\u4ed6\u5750\u6807\uff0c\u518d\u4e00\u904d\u4e00\u904d\u7684\u8fed\u4ee3\u3002\u5982\u679c\u5728 EM \u6846\u67b6\u4e2d\uff0c\u65e0\u6cd5\u6c42\u89e3 \\(z\\) \u540e\u9a8c\u6982\u7387\uff0c\u90a3\u4e48\u9700\u8981\u91c7\u7528\u4e00\u4e9b\u53d8\u79cd\u7684 EM \u6765\u4f30\u7b97\u8fd9\u4e2a\u540e\u9a8c\u3002 \u57fa\u4e8e\u5e73\u5747\u573a\u7684\u53d8\u5206\u63a8\u65ad\uff0cVBEM/VEM \u57fa\u4e8e\u8499\u7279\u5361\u6d1b\u7684EM\uff0cMCEM","title":"\u671f\u671b\u6700\u5927"},{"location":"Machine_Learning/8.EM/#_1","text":"\u671f\u671b\u6700\u5927\u7b97\u6cd5\u7684\u76ee\u7684\u662f\u89e3\u51b3\u5177\u6709\u9690\u53d8\u91cf\u7684\u6df7\u5408\u6a21\u578b\u7684\u53c2\u6570\u4f30\u8ba1\uff08\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\uff09\u3002MLE \u5bf9 \\(p(x|\\theta)\\) \u53c2\u6570\u7684\u4f30\u8ba1\u8bb0\u4e3a\uff1a \\(\\theta_{MLE}=\\mathop{argmax}\\limits_\\theta\\log p(x|\\theta)\\) \u3002EM \u7b97\u6cd5\u5bf9\u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u91c7\u7528\u8fed\u4ee3\u7684\u65b9\u6cd5\uff1a $$ \\theta^{t+1}=\\mathop{argmax}\\limits_{\\theta}\\int_z\\log [p(x,z|\\theta)]p(z|x,\\theta^t)dz=\\mathbb{E}_{z|x,\\theta^t}[\\log p(x,z|\\theta)] $$ \u8fd9\u4e2a\u516c\u5f0f\u5305\u542b\u4e86\u8fed\u4ee3\u7684\u4e24\u6b65\uff1a E step\uff1a\u8ba1\u7b97 \\(\\log p(x,z|\\theta)\\) \u5728\u6982\u7387\u5206\u5e03 \\(p(z|x,\\theta^t)\\) \u4e0b\u7684\u671f\u671b M step\uff1a\u8ba1\u7b97\u4f7f\u8fd9\u4e2a\u671f\u671b\u6700\u5927\u5316\u7684\u53c2\u6570\u5f97\u5230\u4e0b\u4e00\u4e2a EM \u6b65\u9aa4\u7684\u8f93\u5165 \u6c42\u8bc1\uff1a \\(\\log p(x|\\theta^t)\\le\\log p(x|\\theta^{t+1})\\) \u8bc1\u660e\uff1a \\(\\log p(x|\\theta)=\\log p(z,x|\\theta)-\\log p(z|x,\\theta)\\) \uff0c\u5bf9\u5de6\u53f3\u4e24\u8fb9\u6c42\u79ef\u5206\uff1a $$ Left:\\int_zp(z|x,\\theta^t)\\log p(x|\\theta)dz=\\log p(x|\\theta) $$ $$ Right:\\int_zp(z|x,\\theta^t)\\log p(x,z|\\theta)dz-\\int_zp(z|x,\\theta^t)\\log p(z|x,\\theta)dz=Q(\\theta,\\theta^t)-H(\\theta,\\theta^t) $$ \u6240\u4ee5\uff1a $$ \\log p(x|\\theta)=Q(\\theta,\\theta^t)-H(\\theta,\\theta^t) $$ \u7531\u4e8e \\(Q(\\theta,\\theta^t)=\\int_zp(z|x,\\theta^t)\\log p(x,z|\\theta)dz\\) \uff0c\u800c \\(\\theta^{t+1}=\\mathop{argmax}\\limits_{\\theta}\\int_z\\log [p(x,z|\\theta)]p(z|x,\\theta^t)dz\\) \uff0c\u6240\u4ee5 \\(Q(\\theta^{t+1},\\theta^t)\\ge Q(\\theta^t,\\theta^t)\\) \u3002\u8981\u8bc1 \\(\\log p(x|\\theta^t)\\le\\log p(x|\\theta^{t+1})\\) \uff0c\u9700\u8bc1\uff1a \\(H(\\theta^t,\\theta^t)\\ge H(\\theta^{t+1},\\theta^t)\\) \uff1a $$ \\begin{align}H(\\theta^{t+1},\\theta^t)-H(\\theta^{t},\\theta^t)&=\\int_zp(z|x,\\theta^{t})\\log p(z|x,\\theta^{t+1})dz-\\int_zp(z|x,\\theta^t)\\log p(z|x,\\theta^{t})dz\\nonumber\\ &=\\int_zp(z|x,\\theta^t)\\log\\frac{p(z|x,\\theta^{t+1})}{p(z|x,\\theta^t)}=-KL(p(z|x,\\theta^t),p(z|x,\\theta^{t+1}))\\le0 \\end{align} $$ \u7efc\u5408\u4e0a\u9762\u7684\u7ed3\u679c\uff1a $$ \\log p(x|\\theta^t)\\le\\log p(x|\\theta^{t+1}) $$ \u6839\u636e\u4e0a\u9762\u7684\u8bc1\u660e\uff0c\u6211\u4eec\u770b\u5230\uff0c\u4f3c\u7136\u51fd\u6570\u5728\u6bcf\u4e00\u6b65\u90fd\u4f1a\u589e\u5927\u3002\u8fdb\u4e00\u6b65\u7684\uff0c\u6211\u4eec\u770b EM \u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u7684\u5f0f\u5b50\u662f\u600e\u4e48\u6765\u7684\uff1a $$ \\log p(x|\\theta)=\\log p(z,x|\\theta)-\\log p(z|x,\\theta)=\\log \\frac{p(z,x|\\theta)}{q(z)}-\\log \\frac{p(z|x,\\theta)}{q(z)} $$ \u5206\u522b\u5bf9\u4e24\u8fb9\u6c42\u671f\u671b \\(\\mathbb{E}_{q(z)}\\) \uff1a $$ \\begin{align} &Left:\\int_zq(z)\\log p(x|\\theta)dz=\\log p(x|\\theta)\\ &Right:\\int_zq(z)\\log \\frac{p(z,x|\\theta)}{q(z)}dz-\\int_zq(z)\\log \\frac{p(z|x,\\theta)}{q(z)}dz=ELBO+KL(q(z),p(z|x,\\theta)) \\end{align} $$ \u4e0a\u5f0f\u4e2d\uff0cEvidence Lower Bound(ELBO)\uff0c\u662f\u4e00\u4e2a\u4e0b\u754c\uff0c\u6240\u4ee5 \\(\\log p(x|\\theta)\\ge ELBO\\) \uff0c\u7b49\u4e8e\u53f7\u53d6\u5728 KL \u6563\u5ea6\u4e3a0\u662f\uff0c\u5373\uff1a \\(q(z)=p(z|x,\\theta)\\) \uff0cEM \u7b97\u6cd5\u7684\u76ee\u7684\u662f\u5c06 ELBO \u6700\u5927\u5316\uff0c\u6839\u636e\u4e0a\u9762\u7684\u8bc1\u660e\u8fc7\u7a0b\uff0c\u5728\u6bcf\u4e00\u6b65 EM \u540e\uff0c\u6c42\u5f97\u4e86\u6700\u5927\u7684ELBO\uff0c\u5e76\u6839\u636e\u8fd9\u4e2a\u4f7f ELBO \u6700\u5927\u7684\u53c2\u6570\u4ee3\u5165\u4e0b\u4e00\u6b65\u4e2d\uff1a $$ \\hat{\\theta}=\\mathop{argmax} {\\theta}ELBO=\\mathop{argmax} \\theta\\int_zq(z)\\log\\frac{p(x,z|\\theta)}{q(z)}dz $$ \u7531\u4e8e \\(q(z)=p(z|x,\\theta^t)\\) \u7684\u65f6\u5019\uff0c\u8fd9\u4e00\u6b65\u7684\u6700\u5927\u503c\u624d\u80fd\u53d6\u7b49\u53f7\uff0c\u6240\u4ee5\uff1a $$ \\hat{\\theta}=\\mathop{argmax} {\\theta}ELBO=\\mathop{argmax} \\theta\\int_zq(z)\\log\\frac{p(x,z|\\theta)}{q(z)}dz=\\mathop{argmax} \\theta\\int_zp(z|x,\\theta^t)\\log\\frac{p(x,z|\\theta)}{p(z|x,\\theta^t)}d z\\ =\\mathop{argmax} \\theta\\int_z p(z|x,\\theta^t)\\log p(x,z|\\theta) $$ \u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u4e0a\u9762 EM \u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u7684\u5f0f\u5b50\u3002 \u4ece Jensen \u4e0d\u7b49\u5f0f\u51fa\u53d1\uff0c\u4e5f\u53ef\u4ee5\u5bfc\u51fa\u8fd9\u4e2a\u5f0f\u5b50\uff1a $$ \\log p(x|\\theta)=\\log\\int_zp(x,z|\\theta)dz=\\log\\int_z\\frac{p(x,z|\\theta)q(z)}{q(z)}dz\\ =\\log \\mathbb{E} {q(z)}[\\frac{p(x,z|\\theta)}{q(z)}]\\ge \\mathbb{E} [\\log\\frac{p(x,z|\\theta)}{q(z)}] $$ \u5176\u4e2d\uff0c\u53f3\u8fb9\u7684\u5f0f\u5b50\u5c31\u662f ELBO\uff0c\u7b49\u53f7\u5728 \\(p(x,z|\\theta)=Cq(z)\\) \u65f6\u6210\u7acb\u3002\u4e8e\u662f\uff1a $$ \\int_zq(z)dz=\\frac{1}{C}\\int_zp(x,z|\\theta)dz=\\frac{1}{C}p(x|\\theta)=1\\ \\Rightarrow q(z)=\\frac{1}{p(x|\\theta)}p(x,z|\\theta)=p(z|x,\\theta) $$ \u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u662f\u4e0a\u9762\u7684\u6700\u5927\u503c\u53d6\u7b49\u53f7\u7684\u6761\u4ef6\u3002","title":"\u671f\u671b\u6700\u5927"},{"location":"Machine_Learning/8.EM/#em","text":"EM \u6a21\u578b\u89e3\u51b3\u4e86\u6982\u7387\u751f\u6210\u6a21\u578b\u7684\u53c2\u6570\u4f30\u8ba1\u7684\u95ee\u9898\uff0c\u901a\u8fc7\u5f15\u5165\u9690\u53d8\u91cf \\(z\\) \uff0c\u6765\u5b66\u4e60 \\(\\theta\\) \uff0c\u5177\u4f53\u7684\u6a21\u578b\u5bf9 \\(z\\) \u6709\u4e0d\u540c\u7684\u5047\u8bbe\u3002\u5bf9\u5b66\u4e60\u4efb\u52a1 \\(p(x|\\theta)\\) \uff0c\u5c31\u662f\u5b66\u4e60\u4efb\u52a1 \\(\\frac{p(x,z|\\theta)}{p(z|x,\\theta)}\\) \u3002\u5728\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\uff0c\u6211\u4eec\u5047\u5b9a\u4e86\u5728 E \u6b65\u9aa4\u4e2d\uff0c \\(q(z)=p(z|x,\\theta)\\) \uff0c\u4f46\u662f\u8fd9\u4e2a \\(p(z|x,\\theta)\\) \u5982\u679c\u65e0\u6cd5\u6c42\u89e3\uff0c\u90a3\u4e48\u5fc5\u987b\u4f7f\u7528\u91c7\u6837\uff08MCMC\uff09\u6216\u8005\u53d8\u5206\u63a8\u65ad\u7b49\u65b9\u6cd5\u6765\u8fd1\u4f3c\u63a8\u65ad\u8fd9\u4e2a\u540e\u9a8c\u3002\u6211\u4eec\u89c2\u5bdf KL \u6563\u5ea6\u7684\u8868\u8fbe\u5f0f\uff0c\u4e3a\u4e86\u6700\u5927\u5316 ELBO\uff0c\u5728\u56fa\u5b9a\u7684 \\(\\theta\\) \u65f6\uff0c\u6211\u4eec\u9700\u8981\u6700\u5c0f\u5316 KL \u6563\u5ea6\uff0c\u4e8e\u662f\uff1a $$ \\hat{q}(z)=\\mathop{argmin}_qKL(p,q)=\\mathop{argmax}_qELBO $$ \u8fd9\u5c31\u662f\u5e7f\u4e49 EM \u7684\u57fa\u672c\u601d\u8def\uff1a E step\uff1a $$ \\hat{q}^{t+1}(z)=\\mathop{argmax}_q\\int_zq^t(z)\\log\\frac{p(x,z|\\theta)}{q^t(z)}dz,fixed\\ \\theta $$ M step\uff1a $$ \\hat{\\theta}=\\mathop{argmax}_\\theta \\int_zq^{t+1}(z)\\log\\frac{p(x,z|\\theta)}{q^{t+1}(z)}dz,fixed\\ \\hat{q} $$ \u5bf9\u4e8e\u4e0a\u9762\u7684\u79ef\u5206\uff1a $$ ELBO=\\int_zq(z)\\log\\frac{p(x,z|\\theta)}{q(z)}dz=\\mathbb{E}_{q(z)}[p(x,z|\\theta)]+Entropy(q(z)) $$ \u56e0\u6b64\uff0c\u6211\u4eec\u770b\u5230\uff0c\u5e7f\u4e49 EM \u76f8\u5f53\u4e8e\u5728\u539f\u6765\u7684\u5f0f\u5b50\u4e2d\u52a0\u5165\u71b5\u8fd9\u4e00\u9879\u3002","title":"\u5e7f\u4e49 EM"},{"location":"Machine_Learning/8.EM/#em_1","text":"EM \u7b97\u6cd5\u7c7b\u4f3c\u4e8e\u5750\u6807\u4e0a\u5347\u6cd5\uff0c\u56fa\u5b9a\u90e8\u5206\u5750\u6807\uff0c\u4f18\u5316\u5176\u4ed6\u5750\u6807\uff0c\u518d\u4e00\u904d\u4e00\u904d\u7684\u8fed\u4ee3\u3002\u5982\u679c\u5728 EM \u6846\u67b6\u4e2d\uff0c\u65e0\u6cd5\u6c42\u89e3 \\(z\\) \u540e\u9a8c\u6982\u7387\uff0c\u90a3\u4e48\u9700\u8981\u91c7\u7528\u4e00\u4e9b\u53d8\u79cd\u7684 EM \u6765\u4f30\u7b97\u8fd9\u4e2a\u540e\u9a8c\u3002 \u57fa\u4e8e\u5e73\u5747\u573a\u7684\u53d8\u5206\u63a8\u65ad\uff0cVBEM/VEM \u57fa\u4e8e\u8499\u7279\u5361\u6d1b\u7684EM\uff0cMCEM","title":"EM \u7684\u63a8\u5e7f"},{"location":"Machine_Learning/9.GMM/","text":"\u9ad8\u65af\u6df7\u5408\u6a21\u578b \u4e3a\u4e86\u89e3\u51b3\u9ad8\u65af\u6a21\u578b\u7684\u5355\u5cf0\u6027\u7684\u95ee\u9898\uff0c\u6211\u4eec\u5f15\u5165\u591a\u4e2a\u9ad8\u65af\u6a21\u578b\u7684\u52a0\u6743\u5e73\u5747\u6765\u62df\u5408\u591a\u5cf0\u6570\u636e\uff1a $$ p(x)=\\sum\\limits_{k=1}^K\\alpha_k\\mathcal{N}(\\mu_k,\\Sigma_k) $$ \u5f15\u5165\u9690\u53d8\u91cf \\(z\\) \uff0c\u8fd9\u4e2a\u53d8\u91cf\u8868\u793a\u5bf9\u5e94\u7684\u6837\u672c \\(x\\) \u5c5e\u4e8e\u54ea\u4e00\u4e2a\u9ad8\u65af\u5206\u5e03\uff0c\u8fd9\u4e2a\u53d8\u91cf\u662f\u4e00\u4e2a\u79bb\u6563\u7684\u968f\u673a\u53d8\u91cf\uff1a $$ p(z=i)=p_i,\\sum\\limits_{i=1}^kp(z=i)=1 $$ \u4f5c\u4e3a\u4e00\u4e2a\u751f\u6210\u5f0f\u6a21\u578b\uff0c\u9ad8\u65af\u6df7\u5408\u6a21\u578b\u901a\u8fc7\u9690\u53d8\u91cf \\(z\\) \u7684\u5206\u5e03\u6765\u751f\u6210\u6837\u672c\u3002\u7528\u6982\u7387\u56fe\u6765\u8868\u793a\uff1a 1 2 graph LR; z((z))-->x((x)) \u5176\u4e2d\uff0c\u8282\u70b9 \\(z\\) \u5c31\u662f\u4e0a\u9762\u7684\u6982\u7387\uff0c \\(x\\) \u5c31\u662f\u751f\u6210\u7684\u9ad8\u65af\u5206\u5e03\u3002\u4e8e\u662f\u5bf9 \\(p(x)\\) \uff1a $$ p(x)=\\sum\\limits_zp(x,z)=\\sum\\limits_{k=1}^Kp(x,z=k)=\\sum\\limits_{k=1}^Kp(z=k)p(x|z=k) $$ \u56e0\u6b64\uff1a $$ p(x)=\\sum\\limits_{k=1}^Kp_k\\mathcal{N}(x|\\mu_k,\\Sigma_k) $$ \u6781\u5927\u4f3c\u7136\u4f30\u8ba1 \u6837\u672c\u4e3a \\(X=(x_1,x_2,\\cdots,x_N)\\) \uff0c \\((X,Z)\\) \u4e3a\u5b8c\u5168\u53c2\u6570\uff0c\u53c2\u6570\u4e3a \\(\\theta=\\{p_1,p_2,\\cdots,p_K,\\mu_1,\\mu_2,\\cdots,\\mu_K\\Sigma_1,\\Sigma_2,\\cdots,\\Sigma_K\\}\\) \u3002\u6211\u4eec\u901a\u8fc7\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u5f97\u5230 \\(\\theta\\) \u7684\u503c\uff1a $$ \\begin{align}\\theta_{MLE}&=\\mathop{argmax}\\limits_{\\theta}\\log p(X)=\\mathop{argmax} {\\theta}\\sum\\limits ^N\\log p(x_i)\\nonumber\\ &=\\mathop{argmax} \\theta\\sum\\limits ^N\\log \\sum\\limits_{k=1}^Kp_k\\mathcal{N}(x_i|\\mu_k,\\Sigma_k) \\end{align} $$ \u8fd9\u4e2a\u8868\u8fbe\u5f0f\u76f4\u63a5\u901a\u8fc7\u6c42\u5bfc\uff0c\u7531\u4e8e\u8fde\u52a0\u53f7\u7684\u5b58\u5728\uff0c\u65e0\u6cd5\u5f97\u5230\u89e3\u6790\u89e3\u3002\u56e0\u6b64\u9700\u8981\u4f7f\u7528 EM \u7b97\u6cd5\u3002 EM \u6c42\u89e3 GMM EM \u7b97\u6cd5\u7684\u57fa\u672c\u8868\u8fbe\u5f0f\u4e3a\uff1a \\(\\theta^{t+1}=\\mathop{argmax}\\limits_{\\theta}\\mathbb{E}_{z|x,\\theta_t}[p(x,z|\\theta)]\\) \u3002\u5957\u7528 GMM \u7684\u8868\u8fbe\u5f0f\uff0c\u5bf9\u6570\u636e\u96c6\u6765\u8bf4\uff1a $$ \\begin{align}Q(\\theta,\\theta^t)&=\\sum\\limits_z[\\log\\prod\\limits_{i=1}^Np(x_i,z_i|\\theta)]\\prod \\limits_{i=1}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_z[\\sum\\limits_{i=1}^N\\log p(x_i,z_i|\\theta)]\\prod \\limits_{i=1}^Np(z_i|x_i,\\theta^t) \\end{align} $$ \u5bf9\u4e8e\u4e2d\u95f4\u7684\u90a3\u4e2a\u6c42\u548c\u53f7\uff0c\u5c55\u5f00\uff0c\u7b2c\u4e00\u9879\u4e3a\uff1a $$ \\begin{align} \\sum\\limits_z\\log p(x_1,z_1|\\theta)\\prod\\limits_{i=1}^Np(z_i|x_i,\\theta^t)&=\\sum\\limits_z\\log p(x_1,z_1|\\theta)p(z_1|x_1,\\theta^t)\\prod\\limits_{i=2}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_{z_1}\\log p(x_1,z_1|\\theta) p(z_1|x_1,\\theta^t)\\sum\\limits_{z_2,\\cdots,z_K}\\prod\\limits_{i=2}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_{z_1}\\log p(x_1,z_1|\\theta)p(z_1|x_1,\\theta^t)\\end{align} $$ \u7c7b\u4f3c\u5730\uff0c \\(Q\\) \u53ef\u4ee5\u5199\u4e3a\uff1a $$ Q(\\theta,\\theta^t)=\\sum\\limits_{i=1}^N\\sum\\limits_{z_i}\\log p(x_i,z_i|\\theta)p(z_i|x_i,\\theta^t) $$ \u5bf9\u4e8e \\(p(x,z|\\theta)\\) \uff1a $$ p(x,z|\\theta)=p(z|\\theta)p(x|z,\\theta)=p_z\\mathcal{N}(x|\\mu_z,\\Sigma_z) $$ \u5bf9 \\(p(z|x,\\theta^t)\\) \uff1a $$ p(z|x,\\theta^t)=\\frac{p(x,z|\\theta^t)}{p(x|\\theta^t)}=\\frac{p_z^t\\mathcal{N}(x|\\mu_z^t,\\Sigma_z^t)}{\\sum\\limits_kp_k^t\\mathcal{N}(x|\\mu_k^t,\\Sigma_k^t)} $$ \u4ee3\u5165 \\(Q\\) \uff1a $$ Q=\\sum\\limits_{i=1}^N\\sum\\limits_{z_i}\\log p_{z_i}\\mathcal{N(x_i|\\mu_{z_i},\\Sigma_{z_i})}\\frac{p_{z_i}^t\\mathcal{N}(x_i|\\mu_{z_i}^t,\\Sigma_{z_i}^t)}{\\sum\\limits_kp_k^t\\mathcal{N}(x_i|\\mu_k^t,\\Sigma_k^t)} $$ \u4e0b\u9762\u9700\u8981\u5bf9 \\(Q\\) \u503c\u6c42\u6700\u5927\u503c\uff1a $$ Q=\\sum\\limits_{k=1}^K\\sum\\limits_{i=1}^N[\\log p_k+\\log \\mathcal{N}(x_i|\\mu_k,\\Sigma_k)]p(z_i=k|x_i,\\theta^t) $$ \\(p_k^{t+1}\\) \uff1a $$ p_k^{t+1}=\\mathop{argmax} {p_k}\\sum\\limits ^K\\sum\\limits_{i=1}^N[\\log p_k+\\log \\mathcal{N}(x_i|\\mu_k,\\Sigma_k)]p(z_i=k|x_i,\\theta^t)\\ s.t.\\ \\sum\\limits_{k=1}^Kp_k=1 $$ \u5373\uff1a $$ p_k^{t+1}=\\mathop{argmax} {p_k}\\sum\\limits ^K\\sum\\limits_{i=1}^N\\log p_kp(z_i=k|x_i,\\theta^t)\\ s.t.\\ \\sum\\limits_{k=1}^Kp_k=1 $$ \u5f15\u5165 Lagrange \u4e58\u5b50\uff1a \\(L(p_k,\\lambda)=\\sum\\limits_{k=1}^K\\sum\\limits_{i=1}^N\\log p_kp(z_i=k|x_i,\\theta^t)-\\lambda(1-\\sum\\limits_{k=1}^Kp_k)\\) \u3002\u6240\u4ee5\uff1a $$ \\frac{\\partial}{\\partial p_k}L=\\sum\\limits_{i=1}^N\\frac{1}{p_k}p(z_i=k|x_i,\\theta^t)+\\lambda=0\\ \\Rightarrow \\sum\\limits_k\\sum\\limits_{i=1}^N\\frac{1}{p_k}p(z_i=k|x_i,\\theta^t)+\\lambda\\sum\\limits_kp_k=0\\ \\Rightarrow\\lambda=-N $$ \u4e8e\u662f\u6709\uff1a $$ p_k^{t+1}=\\frac{1}{N}\\sum\\limits_{i=1}^Np(z_i=k|x_i,\\theta^t) $$ \\(\\mu_k,\\Sigma_k\\) \uff0c\u8fd9\u4e24\u4e2a\u53c2\u6570\u662f\u65e0\u7ea6\u675f\u7684\uff0c\u76f4\u63a5\u6c42\u5bfc\u5373\u53ef\u3002","title":"\u9ad8\u65af\u6df7\u5408\u6a21\u578b"},{"location":"Machine_Learning/9.GMM/#_1","text":"\u4e3a\u4e86\u89e3\u51b3\u9ad8\u65af\u6a21\u578b\u7684\u5355\u5cf0\u6027\u7684\u95ee\u9898\uff0c\u6211\u4eec\u5f15\u5165\u591a\u4e2a\u9ad8\u65af\u6a21\u578b\u7684\u52a0\u6743\u5e73\u5747\u6765\u62df\u5408\u591a\u5cf0\u6570\u636e\uff1a $$ p(x)=\\sum\\limits_{k=1}^K\\alpha_k\\mathcal{N}(\\mu_k,\\Sigma_k) $$ \u5f15\u5165\u9690\u53d8\u91cf \\(z\\) \uff0c\u8fd9\u4e2a\u53d8\u91cf\u8868\u793a\u5bf9\u5e94\u7684\u6837\u672c \\(x\\) \u5c5e\u4e8e\u54ea\u4e00\u4e2a\u9ad8\u65af\u5206\u5e03\uff0c\u8fd9\u4e2a\u53d8\u91cf\u662f\u4e00\u4e2a\u79bb\u6563\u7684\u968f\u673a\u53d8\u91cf\uff1a $$ p(z=i)=p_i,\\sum\\limits_{i=1}^kp(z=i)=1 $$ \u4f5c\u4e3a\u4e00\u4e2a\u751f\u6210\u5f0f\u6a21\u578b\uff0c\u9ad8\u65af\u6df7\u5408\u6a21\u578b\u901a\u8fc7\u9690\u53d8\u91cf \\(z\\) \u7684\u5206\u5e03\u6765\u751f\u6210\u6837\u672c\u3002\u7528\u6982\u7387\u56fe\u6765\u8868\u793a\uff1a 1 2 graph LR; z((z))-->x((x)) \u5176\u4e2d\uff0c\u8282\u70b9 \\(z\\) \u5c31\u662f\u4e0a\u9762\u7684\u6982\u7387\uff0c \\(x\\) \u5c31\u662f\u751f\u6210\u7684\u9ad8\u65af\u5206\u5e03\u3002\u4e8e\u662f\u5bf9 \\(p(x)\\) \uff1a $$ p(x)=\\sum\\limits_zp(x,z)=\\sum\\limits_{k=1}^Kp(x,z=k)=\\sum\\limits_{k=1}^Kp(z=k)p(x|z=k) $$ \u56e0\u6b64\uff1a $$ p(x)=\\sum\\limits_{k=1}^Kp_k\\mathcal{N}(x|\\mu_k,\\Sigma_k) $$","title":"\u9ad8\u65af\u6df7\u5408\u6a21\u578b"},{"location":"Machine_Learning/9.GMM/#_2","text":"\u6837\u672c\u4e3a \\(X=(x_1,x_2,\\cdots,x_N)\\) \uff0c \\((X,Z)\\) \u4e3a\u5b8c\u5168\u53c2\u6570\uff0c\u53c2\u6570\u4e3a \\(\\theta=\\{p_1,p_2,\\cdots,p_K,\\mu_1,\\mu_2,\\cdots,\\mu_K\\Sigma_1,\\Sigma_2,\\cdots,\\Sigma_K\\}\\) \u3002\u6211\u4eec\u901a\u8fc7\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\u5f97\u5230 \\(\\theta\\) \u7684\u503c\uff1a $$ \\begin{align}\\theta_{MLE}&=\\mathop{argmax}\\limits_{\\theta}\\log p(X)=\\mathop{argmax} {\\theta}\\sum\\limits ^N\\log p(x_i)\\nonumber\\ &=\\mathop{argmax} \\theta\\sum\\limits ^N\\log \\sum\\limits_{k=1}^Kp_k\\mathcal{N}(x_i|\\mu_k,\\Sigma_k) \\end{align} $$ \u8fd9\u4e2a\u8868\u8fbe\u5f0f\u76f4\u63a5\u901a\u8fc7\u6c42\u5bfc\uff0c\u7531\u4e8e\u8fde\u52a0\u53f7\u7684\u5b58\u5728\uff0c\u65e0\u6cd5\u5f97\u5230\u89e3\u6790\u89e3\u3002\u56e0\u6b64\u9700\u8981\u4f7f\u7528 EM \u7b97\u6cd5\u3002","title":"\u6781\u5927\u4f3c\u7136\u4f30\u8ba1"},{"location":"Machine_Learning/9.GMM/#em-gmm","text":"EM \u7b97\u6cd5\u7684\u57fa\u672c\u8868\u8fbe\u5f0f\u4e3a\uff1a \\(\\theta^{t+1}=\\mathop{argmax}\\limits_{\\theta}\\mathbb{E}_{z|x,\\theta_t}[p(x,z|\\theta)]\\) \u3002\u5957\u7528 GMM \u7684\u8868\u8fbe\u5f0f\uff0c\u5bf9\u6570\u636e\u96c6\u6765\u8bf4\uff1a $$ \\begin{align}Q(\\theta,\\theta^t)&=\\sum\\limits_z[\\log\\prod\\limits_{i=1}^Np(x_i,z_i|\\theta)]\\prod \\limits_{i=1}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_z[\\sum\\limits_{i=1}^N\\log p(x_i,z_i|\\theta)]\\prod \\limits_{i=1}^Np(z_i|x_i,\\theta^t) \\end{align} $$ \u5bf9\u4e8e\u4e2d\u95f4\u7684\u90a3\u4e2a\u6c42\u548c\u53f7\uff0c\u5c55\u5f00\uff0c\u7b2c\u4e00\u9879\u4e3a\uff1a $$ \\begin{align} \\sum\\limits_z\\log p(x_1,z_1|\\theta)\\prod\\limits_{i=1}^Np(z_i|x_i,\\theta^t)&=\\sum\\limits_z\\log p(x_1,z_1|\\theta)p(z_1|x_1,\\theta^t)\\prod\\limits_{i=2}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_{z_1}\\log p(x_1,z_1|\\theta) p(z_1|x_1,\\theta^t)\\sum\\limits_{z_2,\\cdots,z_K}\\prod\\limits_{i=2}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_{z_1}\\log p(x_1,z_1|\\theta)p(z_1|x_1,\\theta^t)\\end{align} $$ \u7c7b\u4f3c\u5730\uff0c \\(Q\\) \u53ef\u4ee5\u5199\u4e3a\uff1a $$ Q(\\theta,\\theta^t)=\\sum\\limits_{i=1}^N\\sum\\limits_{z_i}\\log p(x_i,z_i|\\theta)p(z_i|x_i,\\theta^t) $$ \u5bf9\u4e8e \\(p(x,z|\\theta)\\) \uff1a $$ p(x,z|\\theta)=p(z|\\theta)p(x|z,\\theta)=p_z\\mathcal{N}(x|\\mu_z,\\Sigma_z) $$ \u5bf9 \\(p(z|x,\\theta^t)\\) \uff1a $$ p(z|x,\\theta^t)=\\frac{p(x,z|\\theta^t)}{p(x|\\theta^t)}=\\frac{p_z^t\\mathcal{N}(x|\\mu_z^t,\\Sigma_z^t)}{\\sum\\limits_kp_k^t\\mathcal{N}(x|\\mu_k^t,\\Sigma_k^t)} $$ \u4ee3\u5165 \\(Q\\) \uff1a $$ Q=\\sum\\limits_{i=1}^N\\sum\\limits_{z_i}\\log p_{z_i}\\mathcal{N(x_i|\\mu_{z_i},\\Sigma_{z_i})}\\frac{p_{z_i}^t\\mathcal{N}(x_i|\\mu_{z_i}^t,\\Sigma_{z_i}^t)}{\\sum\\limits_kp_k^t\\mathcal{N}(x_i|\\mu_k^t,\\Sigma_k^t)} $$ \u4e0b\u9762\u9700\u8981\u5bf9 \\(Q\\) \u503c\u6c42\u6700\u5927\u503c\uff1a $$ Q=\\sum\\limits_{k=1}^K\\sum\\limits_{i=1}^N[\\log p_k+\\log \\mathcal{N}(x_i|\\mu_k,\\Sigma_k)]p(z_i=k|x_i,\\theta^t) $$ \\(p_k^{t+1}\\) \uff1a $$ p_k^{t+1}=\\mathop{argmax} {p_k}\\sum\\limits ^K\\sum\\limits_{i=1}^N[\\log p_k+\\log \\mathcal{N}(x_i|\\mu_k,\\Sigma_k)]p(z_i=k|x_i,\\theta^t)\\ s.t.\\ \\sum\\limits_{k=1}^Kp_k=1 $$ \u5373\uff1a $$ p_k^{t+1}=\\mathop{argmax} {p_k}\\sum\\limits ^K\\sum\\limits_{i=1}^N\\log p_kp(z_i=k|x_i,\\theta^t)\\ s.t.\\ \\sum\\limits_{k=1}^Kp_k=1 $$ \u5f15\u5165 Lagrange \u4e58\u5b50\uff1a \\(L(p_k,\\lambda)=\\sum\\limits_{k=1}^K\\sum\\limits_{i=1}^N\\log p_kp(z_i=k|x_i,\\theta^t)-\\lambda(1-\\sum\\limits_{k=1}^Kp_k)\\) \u3002\u6240\u4ee5\uff1a $$ \\frac{\\partial}{\\partial p_k}L=\\sum\\limits_{i=1}^N\\frac{1}{p_k}p(z_i=k|x_i,\\theta^t)+\\lambda=0\\ \\Rightarrow \\sum\\limits_k\\sum\\limits_{i=1}^N\\frac{1}{p_k}p(z_i=k|x_i,\\theta^t)+\\lambda\\sum\\limits_kp_k=0\\ \\Rightarrow\\lambda=-N $$ \u4e8e\u662f\u6709\uff1a $$ p_k^{t+1}=\\frac{1}{N}\\sum\\limits_{i=1}^Np(z_i=k|x_i,\\theta^t) $$ \\(\\mu_k,\\Sigma_k\\) \uff0c\u8fd9\u4e24\u4e2a\u53c2\u6570\u662f\u65e0\u7ea6\u675f\u7684\uff0c\u76f4\u63a5\u6c42\u5bfc\u5373\u53ef\u3002","title":"EM \u6c42\u89e3 GMM"},{"location":"Machine_Learning/cheatsheet/","text":"\u603b\u7ed3 Math MLE $$ \\theta_{MLE}=\\mathop{argmax}\\limits {\\theta}\\log p(X|\\theta)\\mathop{=}\\limits \\mathop{argmax}\\limits {\\theta}\\sum\\limits ^{N}\\log p(x_{i}|\\theta) $$ MAP $$ \\theta_{MAP}=\\mathop{argmax}\\limits {\\theta}p(\\theta|X)=\\mathop{argmax}\\limits p(X|\\theta)\\cdot p(\\theta) $$ Gaussian Distribution $$ \\begin{align}&p(x|\\mu,\\Sigma)=\\frac{1}{(2\\pi)^{p/2}|\\Sigma|^{1/2}}e^{-\\frac{1}{2}(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)}\\ &\\Delta=(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)=\\sum\\limits {i=1}^{p}(x-\\mu)^{T}u \\frac{1}{\\lambda_{i}}u_{i}^{T}(x-\\mu)=\\sum\\limits {i=1}^{p}\\frac{y ^{2}}{\\lambda_{i}} \\end{align} $$ \u5df2\u77e5 \\(x\\sim\\mathcal{N}(\\mu,\\Sigma), y\\sim Ax+b\\) \uff0c\u6709\uff1a $$ \\begin{align}y\\sim\\mathcal{N}(A\\mu+b, A\\Sigma A^T) \\end{align} $$ \u8bb0 \\(x=(x_1, x_2,\\cdots,x_p)^T=(x_{a,m\\times 1}, x_{b,n\\times1})^T,\\mu=(\\mu_{a,m\\times1}, \\mu_{b,n\\times1}),\\Sigma=\\begin{pmatrix}\\Sigma_{aa}&\\Sigma_{ab}\\\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\) \uff0c\u5df2\u77e5 \\(x\\sim\\mathcal{N}(\\mu,\\Sigma)\\) \uff0c\u5219\uff1a $$ \\begin{align}&x_a\\sim\\mathcal{N}(\\mu_a,\\Sigma_{aa})\\ &x_b|x_a\\sim\\mathcal{N}(\\mu_{b|a},\\Sigma_{b|a})\\ &\\mu_{b|a}=\\Sigma_{ba}\\Sigma_{aa}^{-1}(x_a-\\mu_a)+\\mu_b\\ &\\Sigma_{b|a}=\\Sigma_{bb}-\\Sigma_{ba}\\Sigma_{aa}^{-1}\\Sigma_{ab} \\end{align} $$ Linear Regression Model Dataset: $$ \\mathcal{D}={(x_1, y_1),(x_2, y_2),\\cdots,(x_N, y_N)} $$ Notation: $$ X=(x_1,x_2,\\cdots,x_N)^T,Y=(y_1,y_2,\\cdots,y_N)^T $$ Model: $$ f(w)=w^Tx $$ Loss Function \u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee/\u9ad8\u65af\u566a\u58f0\u7684MLE $$ L(w)=\\sum\\limits_{i=1}^N||w^Tx_i-y_i||^2_2 $$ \u95ed\u5f0f\u89e3 \\[ \\begin{align}\\hat{w}=(X^TX)^{-1}X^TY=X^+Y\\\\ X=U\\Sigma V^T\\\\ X^+=V\\Sigma^{-1}U^T \\end{align} \\] \u6b63\u5219\u5316 \\[ \\begin{align} L1-Gaussian \\ priori&:\\mathop{argmin}\\limits_wL(w)+\\lambda||w||_1,\\lambda\\gt0\\\\ L2-Laplasian\\ priori-Sparsity&:\\mathop{argmin}\\limits_wL(w)+\\lambda||w||^2_2,\\lambda \\gt 0 \\end{align} \\] Linear Classification Hard PCA Idea: \u5728\u7ebf\u6027\u6a21\u578b\u4e0a\u52a0\u5165\u6fc0\u6d3b\u51fd\u6570 Loss Function: \\[ L(w)=\\sum\\limits_{x_i\\in\\mathcal{D}_{wrong}}-y_iw^Tx_i \\] Parameters: \\[ w^{t+1}\\leftarrow w^{t}+\\lambda y_ix_i \\] Fisher Idea: \u6295\u5f71\uff0c\u7c7b\u5185\u5c0f\uff0c\u7c7b\u95f4\u5927\u3002 Loss Function: $$ \\begin{align}&J(w)=\\frac{w^TS_bw}{w^TS_ww}\\ &S_b=(\\overline{x_{c1}}-\\overline{x_{c2}})(\\overline{x_{c1}}-\\overline{x_{c2}})^T\\ &S_w=S_1+S_2 \\end{align} $$ \u95ed\u5f0f\u89e3\uff0c\u6295\u5f71\u65b9\u5411: $$ S_w^{-1}(\\overline{x_{c1}}-\\overline{x_{c2}}) $$ Soft \u5224\u522b\u6a21\u578b Logistic Regression Idea\uff0c\u6fc0\u6d3b\u51fd\u6570: $$ \\begin{align}p(C_1|x)&=\\frac{1}{1+\\exp(-a)}\\ a&=w^Tx \\end{align} $$ Loss Function(\u4ea4\u53c9\u71b5): $$ \\hat{w}=\\mathop{argmax} wJ(w)=\\mathop{argmax}_w\\sum\\limits ^N(y_i\\log p_1+(1-y_i)\\log p_0) $$ \u89e3\u6cd5\uff0cSGD $$ J'(w)=\\sum\\limits_{i=1}^N(y_i-p_1)x_i $$ \u751f\u6210\u6a21\u578b GDA Model \\(y\\sim Bernoulli(\\phi)\\) \\(x|y=1\\sim\\mathcal{N}(\\mu_1,\\Sigma)\\) \\(x|y=0\\sim\\mathcal{N}(\\mu_0,\\Sigma)\\) MAP $$ \\begin{align} &\\mathop{argmax} {\\phi,\\mu_0,\\mu_1,\\Sigma}\\log p(X|Y)p(Y)\\nonumber\\ &=\\mathop{argmax} \\sum\\limits_{i=1}^N((1-y_i)\\log\\mathcal{N}(\\mu_0,\\Sigma)+y_i\\log \\mathcal{N}(\\mu_1,\\Sigma)+y_i\\log\\phi+(1-y_i)\\log(1-\\phi)) \\end{align} $$ \u89e3 $$ \\begin{align}\\phi&=\\frac{N_1}{N}\\ \\mu_1&=\\frac{\\sum\\limits_{i=1}^Ny_ix_i}{N_1}\\ \\mu_0&=\\frac{\\sum\\limits_{i=1}^N(1-y_i)x_i}{N_0}\\ \\Sigma&=\\frac{N_1S_1+N_2S_2}{N} \\end{align} $$ Naive Bayesian Model, \u5bf9\u5355\u4e2a\u6570\u636e\u70b9\u7684\u5404\u4e2a\u7ef4\u5ea6\u4f5c\u51fa\u9650\u5236 $$ x_i\\perp x_j|y,\\forall\\ i\\ne j $$ \\(x_i\\) \u4e3a\u8fde\u7eed\u53d8\u91cf\uff1a \\(p(x_i|y)=\\mathcal{N}(\\mu_i,\\sigma_i^2)\\) \\(x_i\\) \u4e3a\u79bb\u6563\u53d8\u91cf\uff1a\u7c7b\u522b\u5206\u5e03\uff08Categorical\uff09\uff1a \\(p(x_i=i|y)=\\theta_i,\\sum\\limits_{i=1}^K\\theta_i=1\\) \\(p(y)=\\phi^y(1-\\phi)^{1-y}\\) \u89e3\uff1a\u548cGDA\u76f8\u540c Dimension Reduction \u4e2d\u5fc3\u5316\uff1a $$ \\begin{align}S &=\\frac{1}{N}X^T(E_N-\\frac{1}{N}\\mathbb{I} {N1}\\mathbb{I} )(E_N-\\frac{1}{N}\\mathbb{I} {N1}\\mathbb{I} )^TX\\nonumber\\ &=\\frac{1}{N}X^TH^2X=\\frac{1}{N}X^THX \\end{align} $$ PCA Idea: \u5750\u6807\u53d8\u6362\uff0c\u5bfb\u627e\u7ebf\u6027\u65e0\u5173\u7684\u65b0\u57fa\u77e2\uff0c\u53d6\u4fe1\u606f\u635f\u5931\u6700\u5c0f\u7684\u524d\u51e0\u4e2a\u7ef4\u5ea6 Loss Function: $$ \\begin{align}J &=\\sum\\limits_{j=1}^qu_j^TSu_j\\ ,\\ s.t.\\ u_j^Tu_j=1 \\end{align} $$ \u89e3\uff1a \u7279\u5f81\u5206\u89e3\u6cd5 $$ S=U\\Lambda U^T $$ SVD for X/S $$ \\begin{align}HX=U\\Sigma V^T\\ S=\\frac{1}{N}V\\Sigma^T\\Sigma V^T \\new\\ co=HX\\cdot V\\end{align} $$ SVD for T $$ \\begin{align}T=HXX^TH=U\\Sigma\\Sigma^TU^T\\ new\\ co=U\\Sigma \\end{align} $$ p-PCA Model: $$ \\begin{align} z&\\sim\\mathcal{N}(\\mathbb{O} {q1},\\mathbb{I} )\\ x&=Wz+\\mu+\\varepsilon\\ \\varepsilon&\\sim\\mathcal{N}(0,\\sigma^2\\mathbb{I}_{pp}) \\end{align} $$ Learning: E-M Inference: $$ p(z|x)=\\mathcal{N}(W^T(WW^T+\\sigma^2\\mathbb{I})^{-1}(x-\\mu),\\mathbb{I}-W^T(WW^T+\\sigma^2\\mathbb{I})^{-1}W) $$ SVM \u5f3a\u5bf9\u5076\u5173\u7cfb\uff1a\u51f8\u4f18\u5316+\uff08\u677e\u5f1b\uff09Slater \u6761\u4ef6->\u5f3a\u5bf9\u5076\u3002 \u53c2\u6570\u6c42\u89e3\uff1aKKT\u6761\u4ef6 \u53ef\u884c\u57df \u4e92\u8865\u677e\u5f1b+\u68af\u5ea6\u4e3a0 Hard-margin Idea: \u6700\u5927\u5316\u95f4\u9694 Model: $$ \\mathop{argmin}_{w,b}\\frac{1}{2}w^Tw\\ s.t.\\ y_i(w^Tx_i+b)\\ge1,i=1,2,\\cdots,N $$ \u5bf9\u5076\u95ee\u9898 $$ \\max_{\\lambda}-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i,\\ s.t.\\ \\lambda_i\\ge0 $$ \u6a21\u578b\u53c2\u6570 $$ \\hat{w}=\\sum\\limits_{i=1}^N\\lambda_iy_ix_i\\ \\hat{b}=y_k-w^Tx_k=y_k-\\sum\\limits_{i=1}^N\\lambda_iy_ix_i^Tx_k,\\exist k,1-y_k(w^Tx_k+b)=0 $$ Soft-margin Idea:\u5141\u8bb8\u5c11\u91cf\u9519\u8bef Model: $$ error=\\sum\\limits_{i=1}^N\\max{0,1-y_i(w^Tx_i+b)}\\ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw+C\\sum\\limits ^N\\xi_i\\ s.t.\\ y_i(w^Tx_i+b)\\ge1-\\xi_i,\\xi_i\\ge0,i=1,2,\\cdots,N $$ Kernel \u5bf9\u79f0\u7684\u6b63\u5b9a\u51fd\u6570\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u6b63\u5b9a\u6838\u3002 Exp Family \u8868\u8fbe\u5f0f $$ p(x|\\eta)=h(x)\\exp(\\eta^T\\phi(x)-A(\\eta))=\\frac{1}{\\exp(A(\\eta))}h(x)\\exp(\\eta^T\\phi(x)) $$ \u5bf9\u6570\u914d\u5206\u51fd\u6570 $$ \\begin{align} A'(\\eta)=\\mathbb{E} {p(x|\\eta)}[\\phi(x)]\\ A''(\\eta)=Var [\\phi(x)] \\end{align} $$ \u6307\u6570\u65cf\u5206\u5e03\u6ee1\u8db3\u6700\u5927\u71b5\u5b9a\u7406 PGM Representation \u6709\u5411\u56fe $$ p(x_1,x_2,\\cdots,x_p)=\\prod\\limits_{i=1}^pp(x_i|x_{parent(i)}) $$ D-separation $$ p(x_i|x_{-i})=\\frac{p(x)}{\\int p(x)dx_{i}}=\\frac{\\prod\\limits_{j=1}^pp(x_j|x_{parents(j)})}{\\int\\prod\\limits_{j=1}^pp(x_j|x_{parents(j)})dx_i}=\\frac{p(x_i|x_{parents(i)})p(x_{child(i)}|x_i)}{\\int p(x_i|x_{parents(i)})p(x_{child(i)}|x_i)dx_i} $$ \u65e0\u5411\u56fe $$ \\begin{align}p(x)=\\frac{1}{Z}\\prod\\limits_{i=1}^{K}\\phi(x_{ci})\\ Z=\\sum\\limits_{x\\in\\mathcal{X}}\\prod\\limits_{i=1}^{K}\\phi(x_{ci})\\ \\phi(x_{ci})=\\exp(-E(x_{ci})) \\end{align} $$ \u6709\u5411\u8f6c\u65e0\u5411 \u5c06\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u4e24\u4e24\u76f8\u8fde \u5c06\u6709\u5411\u8fb9\u66ff\u6362\u4e3a\u65e0\u5411\u8fb9 Learning \u53c2\u6570\u5b66\u4e60-EM \u76ee\u7684\uff1a\u89e3\u51b3\u5177\u6709\u9690\u53d8\u91cf\u7684\u6df7\u5408\u6a21\u578b\u7684\u53c2\u6570\u4f30\u8ba1\uff08\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\uff09 \u53c2\u6570\uff1a $$ \\theta_{MLE}=\\mathop{argmax}\\limits_\\theta\\log p(x|\\theta) $$ \u8fed\u4ee3\u6c42\u89e3\uff1a $$ \\theta^{t+1}=\\mathop{argmax}\\limits_{\\theta}\\int_z\\log [p(x,z|\\theta)]p(z|x,\\theta^t)dz=\\mathbb{E}_{z|x,\\theta^t}[\\log p(x,z|\\theta)] $$ \u539f\u7406 $$ \\log p(x|\\theta^t)\\le\\log p(x|\\theta^{t+1}) $$ \u5e7f\u4e49EM E step\uff1a $$ \\hat{q}^{t+1}(z)=\\mathop{argmax}_q\\int_zq^t(z)\\log\\frac{p(x,z|\\theta)}{q^t(z)}dz,fixed\\ \\theta $$ M step\uff1a $$ \\hat{\\theta}=\\mathop{argmax}_\\theta \\int_zq^{t+1}(z)\\log\\frac{p(x,z|\\theta)}{q^{t+1}(z)}dz,fixed\\ \\hat{q} $$ Inference \u7cbe\u786e\u63a8\u65ad VE BP $$ m_{j\\to i}(i)=\\sum\\limits_j\\phi_j(j)\\phi_{ij}(ij)\\prod\\limits_{k\\in Neighbour(j)-i}m_{k\\to j}(j) $$ MP $$ m_{j\\to i}=\\max\\limits_{j}\\phi_j\\phi_{ij}\\prod\\limits_{k\\in Neighbour(j)-i}m_{k\\to j} $$ \u8fd1\u4f3c\u63a8\u65ad \u786e\u5b9a\u6027\u8fd1\u4f3c\uff0cVI \u53d8\u5206\u8868\u8fbe\u5f0f $$ \\hat{q}(Z)=\\mathop{argmax}_{q(Z)}L(q) $$ \u5e73\u5747\u573a\u8fd1\u4f3c\u4e0b\u7684 VI-\u5750\u6807\u4e0a\u5347 $$ \\mathbb{E} {\\prod\\limits q_i(Z_i)}[\\log p(X,Z)]=\\log \\hat{p}(X,Z_j)\\ q_j(Z_j)=\\hat{p}(X,Z_j) $$ SGVI-\u53d8\u6210\u4f18\u5316\u95ee\u9898\uff0c\u91cd\u53c2\u6570\u6cd5 $$ \\mathop{argmax} {q(Z)}L(q)=\\mathop{argmax} L(\\phi)\\ \\nabla_\\phi L(\\phi)=\\mathbb{E} {q \\phi}[(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z))]\\ =\\mathbb{E} {p(\\varepsilon)}[\\nabla_z[\\log p \\theta(x^i,z)-\\log q_\\phi(z)]\\nabla_\\phi g_\\phi(\\varepsilon,x^i)]\\ z=g_\\phi(\\varepsilon,x^i),\\varepsilon\\sim p(\\varepsilon) $$ \u968f\u673a\u6027\u8fd1\u4f3c \u8499\u7279\u5361\u6d1b\u65b9\u6cd5\u91c7\u6837 CDF \u91c7\u6837 \u62d2\u7edd\u91c7\u6837\uff0c \\(q(z)\\) \uff0c\u4f7f\u5f97 \\(\\forall z_i,Mq(z_i)\\ge p(z_i)\\) \uff0c\u62d2\u7edd\u56e0\u5b50\uff1a \\(\\alpha=\\frac{p(z^i)}{Mq(z^i)}\\le1\\) \u91cd\u8981\u6027\u91c7\u6837 $$ \\mathbb{E} {p(z)}[f(z)]=\\int p(z)f(z)dz=\\int \\frac{p(z)}{q(z)}f(z)q(z)dz\\simeq\\frac{1}{N}\\sum\\limits ^Nf(z_i)\\frac{p(z_i)}{q(z_i)} $$ \u91cd\u8981\u6027\u91cd\u91c7\u6837\uff1a\u91cd\u8981\u6027\u91c7\u6837+\u91cd\u91c7\u6837 MCMC\uff1a\u6784\u5efa\u9a6c\u5c14\u53ef\u592b\u94fe\u6982\u7387\u5e8f\u5217\uff0c\u4f7f\u5176\u6536\u655b\u5230\u5e73\u7a33\u5206\u5e03 \\(p(z)\\) \u3002 \u8f6c\u79fb\u77e9\u9635\uff08\u63d0\u8bae\u5206\u5e03\uff09 $$ p(z)\\cdot Q_{z\\to z^ }\\alpha(z,z^ )=p(z^ )\\cdot Q_{z^ \\to z}\\alpha(z^ ,z)\\ \\alpha(z,z^ )=\\min{1,\\frac{p(z^ )Q_{z^ \\to z}}{p(z)Q_{z\\to z^*}}} $$ \u7b97\u6cd5\uff08MH\uff09\uff1a \u901a\u8fc7\u57280\uff0c1\u4e4b\u95f4\u5747\u5300\u5206\u5e03\u53d6\u70b9 \\(u\\) \u751f\u6210 \\(z^*\\sim Q(z^*|z^{i-1})\\) \u8ba1\u7b97 \\(\\alpha\\) \u503c \u5982\u679c \\(\\alpha\\ge u\\) \uff0c\u5219 \\(z^i=z^*\\) \uff0c\u5426\u5219 \\(z^{i}=z^{i-1}\\) Gibbs \u91c7\u6837\uff1a\u7ed9\u5b9a\u521d\u59cb\u503c \\(z_1^0,z_2^0,\\cdots\\) \u5728 \\(t+1\\) \u65f6\u523b\uff0c\u91c7\u6837 \\(z_i^{t+1}\\sim p(z_i|z_{-i})\\) \uff0c\u4ece\u7b2c\u4e00\u4e2a\u7ef4\u5ea6\u4e00\u4e2a\u4e2a\u91c7\u6837\u3002 GMM Model $$ p(x)=\\sum\\limits_{k=1}^Kp_k\\mathcal{N}(x|\\mu_k,\\Sigma_k) $$ \u6c42\u89e3-EM $$ \\begin{align}Q(\\theta,\\theta^t)&=\\sum\\limits_z[\\log\\prod\\limits_{i=1}^Np(x_i,z_i|\\theta)]\\prod \\limits_{i=1}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_z[\\sum\\limits_{i=1}^N\\log p(x_i,z_i|\\theta)]\\prod \\limits_{i=1}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_{i=1}^N\\sum\\limits_{z_i}\\log p(x_i,z_i|\\theta)p(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_{i=1}^N\\sum\\limits_{z_i}\\log p_{z_i}\\mathcal{N(x_i|\\mu_{z_i},\\Sigma_{z_i})}\\frac{p_{z_i}^t\\mathcal{N}(x_i|\\mu_{z_i}^t,\\Sigma_{z_i}^t)}{\\sum\\limits_kp_k^t\\mathcal{N}(x_i|\\mu_k^t,\\Sigma_k^t)} \\end{align} $$ \\[ p_k^{t+1}=\\frac{1}{N}\\sum\\limits_{i=1}^Np(z_i=k|x_i,\\theta^t) \\] \u5e8f\u5217\u6a21\u578b-HMM\uff0cLDS\uff0cParticle \u5047\u8bbe\uff1a \u9f50\u6b21 Markov \u5047\u8bbe\uff08\u672a\u6765\u53ea\u4f9d\u8d56\u4e8e\u5f53\u524d\uff09\uff1a $$ p(i_{t+1}|i_t,i_{t-1},\\cdots,i_1,o_t,o_{t-1},\\cdots,o_1)=p(i_{t+1}|i_t) $$ \u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\uff1a $$ p(o_t|i_t,i_{t-1},\\cdots,i_1,o_{t-1},\\cdots,o_1)=p(o_t|i_t) $$ \u53c2\u6570 $$ \\lambda=(\\pi,A,B) $$ \u79bb\u6563\u7ebf\u6027\u9690\u53d8\u91cf-HMM Evaluation\uff1a \\(p(O|\\lambda)\\) \uff0cForward-Backward \u7b97\u6cd5 $$ p(O|\\lambda)=\\sum\\limits_{i=1}^Np(O,i_T=q_i|\\lambda)=\\sum\\limits_{i=1}^N\\alpha_T(i)=\\sum\\limits_{i=1}^Nb_i(o_1)\\pi_i\\beta_1(i)\\ \\alpha_{t+1}(j)=\\sum\\limits_{i=1}^Nb_{j}(o_t)a_{ij}\\alpha_t(i)\\ \\beta_t(i)=\\sum\\limits_{j=1}^Nb_j(o_{t+1})a_{ij}\\beta_{t+1}(j) $$ Learning\uff1a \\(\\lambda=\\mathop{argmax}\\limits_{\\lambda}p(O|\\lambda)\\) \uff0cEM \u7b97\u6cd5\uff08Baum-Welch\uff09 $$ \\lambda^{t+1}=\\mathop{argmax} \\lambda\\sum\\limits_I\\log p(O,I|\\lambda)p(O,I|\\lambda^t)\\=\\sum\\limits_I[\\log \\pi +\\sum\\limits_{t=2}^T\\log a_{i_{t-1},i_t}+\\sum\\limits_{t=1}^T\\log b_{i_t}(o_t)]p(O,I|\\lambda^t) $$ Decoding\uff1a \\(I=\\mathop{argmax}\\limits_{I}p(I|O,\\lambda)\\) \uff0cViterbi \u7b97\u6cd5-\u52a8\u6001\u89c4\u5212 $$ \\delta_{t}(j)=\\max\\limits_{i_1,\\cdots,i_{t-1}}p(o_1,\\cdots,o_t,i_1,\\cdots,i_{t-1},i_t=q_i)\\\\delta_{t+1}(j)=\\max\\limits_{1\\le i\\le N}\\delta_t(i)a_{ij}b_j(o_{t+1})\\\\psi_{t+1}(j)=\\mathop{argmax}\\limits_{1\\le i\\le N}\\delta_t(i)a_{ij} $$ \u8fde\u7eed\u7ebf\u6027\u9690\u53d8\u91cf-LDS Model $$ \\begin{align} p(z_t|z_{t-1})&\\sim\\mathcal{N}(A\\cdot z_{t-1}+B,Q)\\ p(x_t|z_t)&\\sim\\mathcal{N}(C\\cdot z_t+D,R)\\ z_1&\\sim\\mathcal{N}(\\mu_1,\\Sigma_1) \\end{align} $$ \u6ee4\u6ce2 $$ p(z_t|x_{1:t})=p(x_{1:t},z_t)/p(x_{1:t})\\propto p(x_{1:t},z_t)\\=p(x_t|z_t)p(z_t|x_{1:t-1})p(x_{1:t-1})\\propto p(x_t|z_t)p(z_t|x_{1:t-1}) $$ \u9012\u63a8\u6c42\u89e3-\u7ebf\u6027\u9ad8\u65af\u6a21\u578b Prediction $$ p(z_t|x_{1:t-1})=\\int_{z_{t-1}}p(z_t|z_{t-1})p(z_{t-1}|x_{1:t-1})dz_{t-1}=\\int_{z_{t-1}}\\mathcal{N}(Az_{t-1}+B,Q)\\mathcal{N}(\\mu_{t-1},\\Sigma_{t-1})dz_{t-1} $$ Update: $$ p(z_t|x_{1:t})\\propto p(x_t|z_t)p(z_t|x_{1:t-1} $$ \u8fde\u7eed\u975e\u7ebf\u6027\u9690\u53d8\u91cf-\u7c92\u5b50\u6ee4\u6ce2 \u901a\u8fc7\u91c7\u6837(SIR)\u89e3\u51b3\uff1a $$ \\mathbb{E}[f(z)]=\\int_zf(z)p(z)dz=\\int_zf(z)\\frac{p(z)}{q(z)}q(z)dz=\\sum\\limits_{i=1}^Nf(z_i)\\frac{p(z_i)}{q(z_i)} $$ \u91c7\u6837 $$ w_t^i\\propto\\frac{p(x_t|z_t)p(z_t|z_{t-1})}{q(z_t|z_{1:t-1},x_{1:t})}w_{t-1}^i\\ q(z_t|z_{1:t-1},x_{1:t})=p(z_t|z_{t-1}) $$ \u91cd\u91c7\u6837 CRF PDF $$ p(Y=y|X=x)=\\frac{1}{Z(x,\\theta)}\\exp[\\theta^TH(y_t,y_{t-1},x)] $$ \u8fb9\u7f18\u6982\u7387 $$ p(y_t=i|x)=\\sum\\limits_{y_{1:t-1}}\\sum\\limits_{y_{t+1:T}}\\frac{1}{Z}\\prod\\limits_{t'=1}^T\\phi_{t'}(y_{t'-1},y_{t'},x)\\ p(y_t=i|x)=\\frac{1}{Z}\\Delta_l\\Delta_r\\ \\Delta_l=\\sum\\limits_{y_{1:t-1}}\\phi_{1}(y_0,y_1,x)\\phi_2(y_1,y_2,x)\\cdots\\phi_{t-1}(y_{t-2},y_{t-1},x)\\phi_t(y_{t-1},y_t=i,x)\\ \\Delta_r=\\sum\\limits_{y_{t+1:T}}\\phi_{t+1}(y_t=i,y_{t+1},x)\\phi_{t+2}(y_{t+1},y_{t+2},x)\\cdots\\phi_T(y_{T-1},y_T,x) $$ \\[ \\alpha_t(i)=\\Delta_l=\\sum\\limits_{j\\in S}\\phi_t(y_{t-1}=j,y_t=i,x)\\alpha_{t-1}(j)\\\\ \\Delta_r=\\beta_t(i)=\\sum\\limits_{j\\in S}\\phi_{t+1}(y_t=i,y_{t+1}=j,x)\\beta_{t+1}(j) \\] \u5b66\u4e60 $$ \\nabla_\\lambda L=\\sum\\limits_{i=1}^N\\sum\\limits_{t=1}^T[f(y_{t-1},y_t,x^i)-\\sum\\limits_{y_{t-1}}\\sum\\limits_{y_t}p(y_{t-1},y_t|x^i)f(y_{t-1},y_t,x^i)] $$","title":"\u603b\u7ed3"},{"location":"Machine_Learning/cheatsheet/#_1","text":"","title":"\u603b\u7ed3"},{"location":"Machine_Learning/cheatsheet/#math","text":"MLE $$ \\theta_{MLE}=\\mathop{argmax}\\limits {\\theta}\\log p(X|\\theta)\\mathop{=}\\limits \\mathop{argmax}\\limits {\\theta}\\sum\\limits ^{N}\\log p(x_{i}|\\theta) $$ MAP $$ \\theta_{MAP}=\\mathop{argmax}\\limits {\\theta}p(\\theta|X)=\\mathop{argmax}\\limits p(X|\\theta)\\cdot p(\\theta) $$ Gaussian Distribution $$ \\begin{align}&p(x|\\mu,\\Sigma)=\\frac{1}{(2\\pi)^{p/2}|\\Sigma|^{1/2}}e^{-\\frac{1}{2}(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)}\\ &\\Delta=(x-\\mu)^{T}\\Sigma^{-1}(x-\\mu)=\\sum\\limits {i=1}^{p}(x-\\mu)^{T}u \\frac{1}{\\lambda_{i}}u_{i}^{T}(x-\\mu)=\\sum\\limits {i=1}^{p}\\frac{y ^{2}}{\\lambda_{i}} \\end{align} $$ \u5df2\u77e5 \\(x\\sim\\mathcal{N}(\\mu,\\Sigma), y\\sim Ax+b\\) \uff0c\u6709\uff1a $$ \\begin{align}y\\sim\\mathcal{N}(A\\mu+b, A\\Sigma A^T) \\end{align} $$ \u8bb0 \\(x=(x_1, x_2,\\cdots,x_p)^T=(x_{a,m\\times 1}, x_{b,n\\times1})^T,\\mu=(\\mu_{a,m\\times1}, \\mu_{b,n\\times1}),\\Sigma=\\begin{pmatrix}\\Sigma_{aa}&\\Sigma_{ab}\\\\\\Sigma_{ba}&\\Sigma_{bb}\\end{pmatrix}\\) \uff0c\u5df2\u77e5 \\(x\\sim\\mathcal{N}(\\mu,\\Sigma)\\) \uff0c\u5219\uff1a $$ \\begin{align}&x_a\\sim\\mathcal{N}(\\mu_a,\\Sigma_{aa})\\ &x_b|x_a\\sim\\mathcal{N}(\\mu_{b|a},\\Sigma_{b|a})\\ &\\mu_{b|a}=\\Sigma_{ba}\\Sigma_{aa}^{-1}(x_a-\\mu_a)+\\mu_b\\ &\\Sigma_{b|a}=\\Sigma_{bb}-\\Sigma_{ba}\\Sigma_{aa}^{-1}\\Sigma_{ab} \\end{align} $$","title":"Math"},{"location":"Machine_Learning/cheatsheet/#linear-regression","text":"","title":"Linear Regression"},{"location":"Machine_Learning/cheatsheet/#model","text":"Dataset: $$ \\mathcal{D}={(x_1, y_1),(x_2, y_2),\\cdots,(x_N, y_N)} $$ Notation: $$ X=(x_1,x_2,\\cdots,x_N)^T,Y=(y_1,y_2,\\cdots,y_N)^T $$ Model: $$ f(w)=w^Tx $$","title":"Model"},{"location":"Machine_Learning/cheatsheet/#loss-function","text":"\u6700\u5c0f\u4e8c\u4e58\u8bef\u5dee/\u9ad8\u65af\u566a\u58f0\u7684MLE $$ L(w)=\\sum\\limits_{i=1}^N||w^Tx_i-y_i||^2_2 $$","title":"Loss Function"},{"location":"Machine_Learning/cheatsheet/#_2","text":"\\[ \\begin{align}\\hat{w}=(X^TX)^{-1}X^TY=X^+Y\\\\ X=U\\Sigma V^T\\\\ X^+=V\\Sigma^{-1}U^T \\end{align} \\]","title":"\u95ed\u5f0f\u89e3"},{"location":"Machine_Learning/cheatsheet/#_3","text":"\\[ \\begin{align} L1-Gaussian \\ priori&:\\mathop{argmin}\\limits_wL(w)+\\lambda||w||_1,\\lambda\\gt0\\\\ L2-Laplasian\\ priori-Sparsity&:\\mathop{argmin}\\limits_wL(w)+\\lambda||w||^2_2,\\lambda \\gt 0 \\end{align} \\]","title":"\u6b63\u5219\u5316"},{"location":"Machine_Learning/cheatsheet/#linear-classification","text":"","title":"Linear Classification"},{"location":"Machine_Learning/cheatsheet/#hard","text":"","title":"Hard"},{"location":"Machine_Learning/cheatsheet/#pca","text":"Idea: \u5728\u7ebf\u6027\u6a21\u578b\u4e0a\u52a0\u5165\u6fc0\u6d3b\u51fd\u6570 Loss Function: \\[ L(w)=\\sum\\limits_{x_i\\in\\mathcal{D}_{wrong}}-y_iw^Tx_i \\] Parameters: \\[ w^{t+1}\\leftarrow w^{t}+\\lambda y_ix_i \\]","title":"PCA"},{"location":"Machine_Learning/cheatsheet/#fisher","text":"Idea: \u6295\u5f71\uff0c\u7c7b\u5185\u5c0f\uff0c\u7c7b\u95f4\u5927\u3002 Loss Function: $$ \\begin{align}&J(w)=\\frac{w^TS_bw}{w^TS_ww}\\ &S_b=(\\overline{x_{c1}}-\\overline{x_{c2}})(\\overline{x_{c1}}-\\overline{x_{c2}})^T\\ &S_w=S_1+S_2 \\end{align} $$ \u95ed\u5f0f\u89e3\uff0c\u6295\u5f71\u65b9\u5411: $$ S_w^{-1}(\\overline{x_{c1}}-\\overline{x_{c2}}) $$","title":"Fisher"},{"location":"Machine_Learning/cheatsheet/#soft","text":"","title":"Soft"},{"location":"Machine_Learning/cheatsheet/#_4","text":"","title":"\u5224\u522b\u6a21\u578b"},{"location":"Machine_Learning/cheatsheet/#logistic-regression","text":"Idea\uff0c\u6fc0\u6d3b\u51fd\u6570: $$ \\begin{align}p(C_1|x)&=\\frac{1}{1+\\exp(-a)}\\ a&=w^Tx \\end{align} $$ Loss Function(\u4ea4\u53c9\u71b5): $$ \\hat{w}=\\mathop{argmax} wJ(w)=\\mathop{argmax}_w\\sum\\limits ^N(y_i\\log p_1+(1-y_i)\\log p_0) $$ \u89e3\u6cd5\uff0cSGD $$ J'(w)=\\sum\\limits_{i=1}^N(y_i-p_1)x_i $$","title":"Logistic Regression"},{"location":"Machine_Learning/cheatsheet/#_5","text":"","title":"\u751f\u6210\u6a21\u578b"},{"location":"Machine_Learning/cheatsheet/#gda","text":"Model \\(y\\sim Bernoulli(\\phi)\\) \\(x|y=1\\sim\\mathcal{N}(\\mu_1,\\Sigma)\\) \\(x|y=0\\sim\\mathcal{N}(\\mu_0,\\Sigma)\\) MAP $$ \\begin{align} &\\mathop{argmax} {\\phi,\\mu_0,\\mu_1,\\Sigma}\\log p(X|Y)p(Y)\\nonumber\\ &=\\mathop{argmax} \\sum\\limits_{i=1}^N((1-y_i)\\log\\mathcal{N}(\\mu_0,\\Sigma)+y_i\\log \\mathcal{N}(\\mu_1,\\Sigma)+y_i\\log\\phi+(1-y_i)\\log(1-\\phi)) \\end{align} $$ \u89e3 $$ \\begin{align}\\phi&=\\frac{N_1}{N}\\ \\mu_1&=\\frac{\\sum\\limits_{i=1}^Ny_ix_i}{N_1}\\ \\mu_0&=\\frac{\\sum\\limits_{i=1}^N(1-y_i)x_i}{N_0}\\ \\Sigma&=\\frac{N_1S_1+N_2S_2}{N} \\end{align} $$","title":"GDA"},{"location":"Machine_Learning/cheatsheet/#naive-bayesian","text":"Model, \u5bf9\u5355\u4e2a\u6570\u636e\u70b9\u7684\u5404\u4e2a\u7ef4\u5ea6\u4f5c\u51fa\u9650\u5236 $$ x_i\\perp x_j|y,\\forall\\ i\\ne j $$ \\(x_i\\) \u4e3a\u8fde\u7eed\u53d8\u91cf\uff1a \\(p(x_i|y)=\\mathcal{N}(\\mu_i,\\sigma_i^2)\\) \\(x_i\\) \u4e3a\u79bb\u6563\u53d8\u91cf\uff1a\u7c7b\u522b\u5206\u5e03\uff08Categorical\uff09\uff1a \\(p(x_i=i|y)=\\theta_i,\\sum\\limits_{i=1}^K\\theta_i=1\\) \\(p(y)=\\phi^y(1-\\phi)^{1-y}\\) \u89e3\uff1a\u548cGDA\u76f8\u540c","title":"Naive Bayesian"},{"location":"Machine_Learning/cheatsheet/#dimension-reduction","text":"\u4e2d\u5fc3\u5316\uff1a $$ \\begin{align}S &=\\frac{1}{N}X^T(E_N-\\frac{1}{N}\\mathbb{I} {N1}\\mathbb{I} )(E_N-\\frac{1}{N}\\mathbb{I} {N1}\\mathbb{I} )^TX\\nonumber\\ &=\\frac{1}{N}X^TH^2X=\\frac{1}{N}X^THX \\end{align} $$","title":"Dimension Reduction"},{"location":"Machine_Learning/cheatsheet/#pca_1","text":"Idea: \u5750\u6807\u53d8\u6362\uff0c\u5bfb\u627e\u7ebf\u6027\u65e0\u5173\u7684\u65b0\u57fa\u77e2\uff0c\u53d6\u4fe1\u606f\u635f\u5931\u6700\u5c0f\u7684\u524d\u51e0\u4e2a\u7ef4\u5ea6 Loss Function: $$ \\begin{align}J &=\\sum\\limits_{j=1}^qu_j^TSu_j\\ ,\\ s.t.\\ u_j^Tu_j=1 \\end{align} $$ \u89e3\uff1a \u7279\u5f81\u5206\u89e3\u6cd5 $$ S=U\\Lambda U^T $$ SVD for X/S $$ \\begin{align}HX=U\\Sigma V^T\\ S=\\frac{1}{N}V\\Sigma^T\\Sigma V^T \\new\\ co=HX\\cdot V\\end{align} $$ SVD for T $$ \\begin{align}T=HXX^TH=U\\Sigma\\Sigma^TU^T\\ new\\ co=U\\Sigma \\end{align} $$","title":"PCA"},{"location":"Machine_Learning/cheatsheet/#p-pca","text":"Model: $$ \\begin{align} z&\\sim\\mathcal{N}(\\mathbb{O} {q1},\\mathbb{I} )\\ x&=Wz+\\mu+\\varepsilon\\ \\varepsilon&\\sim\\mathcal{N}(0,\\sigma^2\\mathbb{I}_{pp}) \\end{align} $$ Learning: E-M Inference: $$ p(z|x)=\\mathcal{N}(W^T(WW^T+\\sigma^2\\mathbb{I})^{-1}(x-\\mu),\\mathbb{I}-W^T(WW^T+\\sigma^2\\mathbb{I})^{-1}W) $$","title":"p-PCA"},{"location":"Machine_Learning/cheatsheet/#svm","text":"\u5f3a\u5bf9\u5076\u5173\u7cfb\uff1a\u51f8\u4f18\u5316+\uff08\u677e\u5f1b\uff09Slater \u6761\u4ef6->\u5f3a\u5bf9\u5076\u3002 \u53c2\u6570\u6c42\u89e3\uff1aKKT\u6761\u4ef6 \u53ef\u884c\u57df \u4e92\u8865\u677e\u5f1b+\u68af\u5ea6\u4e3a0","title":"SVM"},{"location":"Machine_Learning/cheatsheet/#hard-margin","text":"Idea: \u6700\u5927\u5316\u95f4\u9694 Model: $$ \\mathop{argmin}_{w,b}\\frac{1}{2}w^Tw\\ s.t.\\ y_i(w^Tx_i+b)\\ge1,i=1,2,\\cdots,N $$ \u5bf9\u5076\u95ee\u9898 $$ \\max_{\\lambda}-\\frac{1}{2}\\sum\\limits_{i=1}^N\\sum\\limits_{j=1}^N\\lambda_i\\lambda_jy_iy_jx_i^Tx_j+\\sum\\limits_{i=1}^N\\lambda_i,\\ s.t.\\ \\lambda_i\\ge0 $$ \u6a21\u578b\u53c2\u6570 $$ \\hat{w}=\\sum\\limits_{i=1}^N\\lambda_iy_ix_i\\ \\hat{b}=y_k-w^Tx_k=y_k-\\sum\\limits_{i=1}^N\\lambda_iy_ix_i^Tx_k,\\exist k,1-y_k(w^Tx_k+b)=0 $$","title":"Hard-margin"},{"location":"Machine_Learning/cheatsheet/#soft-margin","text":"Idea:\u5141\u8bb8\u5c11\u91cf\u9519\u8bef Model: $$ error=\\sum\\limits_{i=1}^N\\max{0,1-y_i(w^Tx_i+b)}\\ \\mathop{argmin} {w,b}\\frac{1}{2}w^Tw+C\\sum\\limits ^N\\xi_i\\ s.t.\\ y_i(w^Tx_i+b)\\ge1-\\xi_i,\\xi_i\\ge0,i=1,2,\\cdots,N $$","title":"Soft-margin"},{"location":"Machine_Learning/cheatsheet/#kernel","text":"\u5bf9\u79f0\u7684\u6b63\u5b9a\u51fd\u6570\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u6b63\u5b9a\u6838\u3002","title":"Kernel"},{"location":"Machine_Learning/cheatsheet/#exp-family","text":"\u8868\u8fbe\u5f0f $$ p(x|\\eta)=h(x)\\exp(\\eta^T\\phi(x)-A(\\eta))=\\frac{1}{\\exp(A(\\eta))}h(x)\\exp(\\eta^T\\phi(x)) $$ \u5bf9\u6570\u914d\u5206\u51fd\u6570 $$ \\begin{align} A'(\\eta)=\\mathbb{E} {p(x|\\eta)}[\\phi(x)]\\ A''(\\eta)=Var [\\phi(x)] \\end{align} $$ \u6307\u6570\u65cf\u5206\u5e03\u6ee1\u8db3\u6700\u5927\u71b5\u5b9a\u7406","title":"Exp Family"},{"location":"Machine_Learning/cheatsheet/#pgm","text":"","title":"PGM"},{"location":"Machine_Learning/cheatsheet/#representation","text":"\u6709\u5411\u56fe $$ p(x_1,x_2,\\cdots,x_p)=\\prod\\limits_{i=1}^pp(x_i|x_{parent(i)}) $$ D-separation $$ p(x_i|x_{-i})=\\frac{p(x)}{\\int p(x)dx_{i}}=\\frac{\\prod\\limits_{j=1}^pp(x_j|x_{parents(j)})}{\\int\\prod\\limits_{j=1}^pp(x_j|x_{parents(j)})dx_i}=\\frac{p(x_i|x_{parents(i)})p(x_{child(i)}|x_i)}{\\int p(x_i|x_{parents(i)})p(x_{child(i)}|x_i)dx_i} $$ \u65e0\u5411\u56fe $$ \\begin{align}p(x)=\\frac{1}{Z}\\prod\\limits_{i=1}^{K}\\phi(x_{ci})\\ Z=\\sum\\limits_{x\\in\\mathcal{X}}\\prod\\limits_{i=1}^{K}\\phi(x_{ci})\\ \\phi(x_{ci})=\\exp(-E(x_{ci})) \\end{align} $$ \u6709\u5411\u8f6c\u65e0\u5411 \u5c06\u6bcf\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9\u4e24\u4e24\u76f8\u8fde \u5c06\u6709\u5411\u8fb9\u66ff\u6362\u4e3a\u65e0\u5411\u8fb9","title":"Representation"},{"location":"Machine_Learning/cheatsheet/#learning","text":"\u53c2\u6570\u5b66\u4e60-EM \u76ee\u7684\uff1a\u89e3\u51b3\u5177\u6709\u9690\u53d8\u91cf\u7684\u6df7\u5408\u6a21\u578b\u7684\u53c2\u6570\u4f30\u8ba1\uff08\u6781\u5927\u4f3c\u7136\u4f30\u8ba1\uff09 \u53c2\u6570\uff1a $$ \\theta_{MLE}=\\mathop{argmax}\\limits_\\theta\\log p(x|\\theta) $$ \u8fed\u4ee3\u6c42\u89e3\uff1a $$ \\theta^{t+1}=\\mathop{argmax}\\limits_{\\theta}\\int_z\\log [p(x,z|\\theta)]p(z|x,\\theta^t)dz=\\mathbb{E}_{z|x,\\theta^t}[\\log p(x,z|\\theta)] $$ \u539f\u7406 $$ \\log p(x|\\theta^t)\\le\\log p(x|\\theta^{t+1}) $$ \u5e7f\u4e49EM E step\uff1a $$ \\hat{q}^{t+1}(z)=\\mathop{argmax}_q\\int_zq^t(z)\\log\\frac{p(x,z|\\theta)}{q^t(z)}dz,fixed\\ \\theta $$ M step\uff1a $$ \\hat{\\theta}=\\mathop{argmax}_\\theta \\int_zq^{t+1}(z)\\log\\frac{p(x,z|\\theta)}{q^{t+1}(z)}dz,fixed\\ \\hat{q} $$","title":"Learning"},{"location":"Machine_Learning/cheatsheet/#inference","text":"\u7cbe\u786e\u63a8\u65ad VE BP $$ m_{j\\to i}(i)=\\sum\\limits_j\\phi_j(j)\\phi_{ij}(ij)\\prod\\limits_{k\\in Neighbour(j)-i}m_{k\\to j}(j) $$ MP $$ m_{j\\to i}=\\max\\limits_{j}\\phi_j\\phi_{ij}\\prod\\limits_{k\\in Neighbour(j)-i}m_{k\\to j} $$ \u8fd1\u4f3c\u63a8\u65ad \u786e\u5b9a\u6027\u8fd1\u4f3c\uff0cVI \u53d8\u5206\u8868\u8fbe\u5f0f $$ \\hat{q}(Z)=\\mathop{argmax}_{q(Z)}L(q) $$ \u5e73\u5747\u573a\u8fd1\u4f3c\u4e0b\u7684 VI-\u5750\u6807\u4e0a\u5347 $$ \\mathbb{E} {\\prod\\limits q_i(Z_i)}[\\log p(X,Z)]=\\log \\hat{p}(X,Z_j)\\ q_j(Z_j)=\\hat{p}(X,Z_j) $$ SGVI-\u53d8\u6210\u4f18\u5316\u95ee\u9898\uff0c\u91cd\u53c2\u6570\u6cd5 $$ \\mathop{argmax} {q(Z)}L(q)=\\mathop{argmax} L(\\phi)\\ \\nabla_\\phi L(\\phi)=\\mathbb{E} {q \\phi}[(\\nabla_\\phi\\log q_\\phi)(\\log p_\\theta(x^i,z)-\\log q_\\phi(z))]\\ =\\mathbb{E} {p(\\varepsilon)}[\\nabla_z[\\log p \\theta(x^i,z)-\\log q_\\phi(z)]\\nabla_\\phi g_\\phi(\\varepsilon,x^i)]\\ z=g_\\phi(\\varepsilon,x^i),\\varepsilon\\sim p(\\varepsilon) $$ \u968f\u673a\u6027\u8fd1\u4f3c \u8499\u7279\u5361\u6d1b\u65b9\u6cd5\u91c7\u6837 CDF \u91c7\u6837 \u62d2\u7edd\u91c7\u6837\uff0c \\(q(z)\\) \uff0c\u4f7f\u5f97 \\(\\forall z_i,Mq(z_i)\\ge p(z_i)\\) \uff0c\u62d2\u7edd\u56e0\u5b50\uff1a \\(\\alpha=\\frac{p(z^i)}{Mq(z^i)}\\le1\\) \u91cd\u8981\u6027\u91c7\u6837 $$ \\mathbb{E} {p(z)}[f(z)]=\\int p(z)f(z)dz=\\int \\frac{p(z)}{q(z)}f(z)q(z)dz\\simeq\\frac{1}{N}\\sum\\limits ^Nf(z_i)\\frac{p(z_i)}{q(z_i)} $$ \u91cd\u8981\u6027\u91cd\u91c7\u6837\uff1a\u91cd\u8981\u6027\u91c7\u6837+\u91cd\u91c7\u6837 MCMC\uff1a\u6784\u5efa\u9a6c\u5c14\u53ef\u592b\u94fe\u6982\u7387\u5e8f\u5217\uff0c\u4f7f\u5176\u6536\u655b\u5230\u5e73\u7a33\u5206\u5e03 \\(p(z)\\) \u3002 \u8f6c\u79fb\u77e9\u9635\uff08\u63d0\u8bae\u5206\u5e03\uff09 $$ p(z)\\cdot Q_{z\\to z^ }\\alpha(z,z^ )=p(z^ )\\cdot Q_{z^ \\to z}\\alpha(z^ ,z)\\ \\alpha(z,z^ )=\\min{1,\\frac{p(z^ )Q_{z^ \\to z}}{p(z)Q_{z\\to z^*}}} $$ \u7b97\u6cd5\uff08MH\uff09\uff1a \u901a\u8fc7\u57280\uff0c1\u4e4b\u95f4\u5747\u5300\u5206\u5e03\u53d6\u70b9 \\(u\\) \u751f\u6210 \\(z^*\\sim Q(z^*|z^{i-1})\\) \u8ba1\u7b97 \\(\\alpha\\) \u503c \u5982\u679c \\(\\alpha\\ge u\\) \uff0c\u5219 \\(z^i=z^*\\) \uff0c\u5426\u5219 \\(z^{i}=z^{i-1}\\) Gibbs \u91c7\u6837\uff1a\u7ed9\u5b9a\u521d\u59cb\u503c \\(z_1^0,z_2^0,\\cdots\\) \u5728 \\(t+1\\) \u65f6\u523b\uff0c\u91c7\u6837 \\(z_i^{t+1}\\sim p(z_i|z_{-i})\\) \uff0c\u4ece\u7b2c\u4e00\u4e2a\u7ef4\u5ea6\u4e00\u4e2a\u4e2a\u91c7\u6837\u3002","title":"Inference"},{"location":"Machine_Learning/cheatsheet/#gmm","text":"Model $$ p(x)=\\sum\\limits_{k=1}^Kp_k\\mathcal{N}(x|\\mu_k,\\Sigma_k) $$ \u6c42\u89e3-EM $$ \\begin{align}Q(\\theta,\\theta^t)&=\\sum\\limits_z[\\log\\prod\\limits_{i=1}^Np(x_i,z_i|\\theta)]\\prod \\limits_{i=1}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_z[\\sum\\limits_{i=1}^N\\log p(x_i,z_i|\\theta)]\\prod \\limits_{i=1}^Np(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_{i=1}^N\\sum\\limits_{z_i}\\log p(x_i,z_i|\\theta)p(z_i|x_i,\\theta^t)\\nonumber\\ &=\\sum\\limits_{i=1}^N\\sum\\limits_{z_i}\\log p_{z_i}\\mathcal{N(x_i|\\mu_{z_i},\\Sigma_{z_i})}\\frac{p_{z_i}^t\\mathcal{N}(x_i|\\mu_{z_i}^t,\\Sigma_{z_i}^t)}{\\sum\\limits_kp_k^t\\mathcal{N}(x_i|\\mu_k^t,\\Sigma_k^t)} \\end{align} $$ \\[ p_k^{t+1}=\\frac{1}{N}\\sum\\limits_{i=1}^Np(z_i=k|x_i,\\theta^t) \\]","title":"GMM"},{"location":"Machine_Learning/cheatsheet/#-hmmldsparticle","text":"\u5047\u8bbe\uff1a \u9f50\u6b21 Markov \u5047\u8bbe\uff08\u672a\u6765\u53ea\u4f9d\u8d56\u4e8e\u5f53\u524d\uff09\uff1a $$ p(i_{t+1}|i_t,i_{t-1},\\cdots,i_1,o_t,o_{t-1},\\cdots,o_1)=p(i_{t+1}|i_t) $$ \u89c2\u6d4b\u72ec\u7acb\u5047\u8bbe\uff1a $$ p(o_t|i_t,i_{t-1},\\cdots,i_1,o_{t-1},\\cdots,o_1)=p(o_t|i_t) $$ \u53c2\u6570 $$ \\lambda=(\\pi,A,B) $$","title":"\u5e8f\u5217\u6a21\u578b-HMM\uff0cLDS\uff0cParticle"},{"location":"Machine_Learning/cheatsheet/#-hmm","text":"Evaluation\uff1a \\(p(O|\\lambda)\\) \uff0cForward-Backward \u7b97\u6cd5 $$ p(O|\\lambda)=\\sum\\limits_{i=1}^Np(O,i_T=q_i|\\lambda)=\\sum\\limits_{i=1}^N\\alpha_T(i)=\\sum\\limits_{i=1}^Nb_i(o_1)\\pi_i\\beta_1(i)\\ \\alpha_{t+1}(j)=\\sum\\limits_{i=1}^Nb_{j}(o_t)a_{ij}\\alpha_t(i)\\ \\beta_t(i)=\\sum\\limits_{j=1}^Nb_j(o_{t+1})a_{ij}\\beta_{t+1}(j) $$ Learning\uff1a \\(\\lambda=\\mathop{argmax}\\limits_{\\lambda}p(O|\\lambda)\\) \uff0cEM \u7b97\u6cd5\uff08Baum-Welch\uff09 $$ \\lambda^{t+1}=\\mathop{argmax} \\lambda\\sum\\limits_I\\log p(O,I|\\lambda)p(O,I|\\lambda^t)\\=\\sum\\limits_I[\\log \\pi +\\sum\\limits_{t=2}^T\\log a_{i_{t-1},i_t}+\\sum\\limits_{t=1}^T\\log b_{i_t}(o_t)]p(O,I|\\lambda^t) $$ Decoding\uff1a \\(I=\\mathop{argmax}\\limits_{I}p(I|O,\\lambda)\\) \uff0cViterbi \u7b97\u6cd5-\u52a8\u6001\u89c4\u5212 $$ \\delta_{t}(j)=\\max\\limits_{i_1,\\cdots,i_{t-1}}p(o_1,\\cdots,o_t,i_1,\\cdots,i_{t-1},i_t=q_i)\\\\delta_{t+1}(j)=\\max\\limits_{1\\le i\\le N}\\delta_t(i)a_{ij}b_j(o_{t+1})\\\\psi_{t+1}(j)=\\mathop{argmax}\\limits_{1\\le i\\le N}\\delta_t(i)a_{ij} $$","title":"\u79bb\u6563\u7ebf\u6027\u9690\u53d8\u91cf-HMM"},{"location":"Machine_Learning/cheatsheet/#-lds","text":"Model $$ \\begin{align} p(z_t|z_{t-1})&\\sim\\mathcal{N}(A\\cdot z_{t-1}+B,Q)\\ p(x_t|z_t)&\\sim\\mathcal{N}(C\\cdot z_t+D,R)\\ z_1&\\sim\\mathcal{N}(\\mu_1,\\Sigma_1) \\end{align} $$ \u6ee4\u6ce2 $$ p(z_t|x_{1:t})=p(x_{1:t},z_t)/p(x_{1:t})\\propto p(x_{1:t},z_t)\\=p(x_t|z_t)p(z_t|x_{1:t-1})p(x_{1:t-1})\\propto p(x_t|z_t)p(z_t|x_{1:t-1}) $$ \u9012\u63a8\u6c42\u89e3-\u7ebf\u6027\u9ad8\u65af\u6a21\u578b Prediction $$ p(z_t|x_{1:t-1})=\\int_{z_{t-1}}p(z_t|z_{t-1})p(z_{t-1}|x_{1:t-1})dz_{t-1}=\\int_{z_{t-1}}\\mathcal{N}(Az_{t-1}+B,Q)\\mathcal{N}(\\mu_{t-1},\\Sigma_{t-1})dz_{t-1} $$ Update: $$ p(z_t|x_{1:t})\\propto p(x_t|z_t)p(z_t|x_{1:t-1} $$","title":"\u8fde\u7eed\u7ebf\u6027\u9690\u53d8\u91cf-LDS"},{"location":"Machine_Learning/cheatsheet/#-","text":"\u901a\u8fc7\u91c7\u6837(SIR)\u89e3\u51b3\uff1a $$ \\mathbb{E}[f(z)]=\\int_zf(z)p(z)dz=\\int_zf(z)\\frac{p(z)}{q(z)}q(z)dz=\\sum\\limits_{i=1}^Nf(z_i)\\frac{p(z_i)}{q(z_i)} $$ \u91c7\u6837 $$ w_t^i\\propto\\frac{p(x_t|z_t)p(z_t|z_{t-1})}{q(z_t|z_{1:t-1},x_{1:t})}w_{t-1}^i\\ q(z_t|z_{1:t-1},x_{1:t})=p(z_t|z_{t-1}) $$ \u91cd\u91c7\u6837","title":"\u8fde\u7eed\u975e\u7ebf\u6027\u9690\u53d8\u91cf-\u7c92\u5b50\u6ee4\u6ce2"},{"location":"Machine_Learning/cheatsheet/#crf","text":"PDF $$ p(Y=y|X=x)=\\frac{1}{Z(x,\\theta)}\\exp[\\theta^TH(y_t,y_{t-1},x)] $$ \u8fb9\u7f18\u6982\u7387 $$ p(y_t=i|x)=\\sum\\limits_{y_{1:t-1}}\\sum\\limits_{y_{t+1:T}}\\frac{1}{Z}\\prod\\limits_{t'=1}^T\\phi_{t'}(y_{t'-1},y_{t'},x)\\ p(y_t=i|x)=\\frac{1}{Z}\\Delta_l\\Delta_r\\ \\Delta_l=\\sum\\limits_{y_{1:t-1}}\\phi_{1}(y_0,y_1,x)\\phi_2(y_1,y_2,x)\\cdots\\phi_{t-1}(y_{t-2},y_{t-1},x)\\phi_t(y_{t-1},y_t=i,x)\\ \\Delta_r=\\sum\\limits_{y_{t+1:T}}\\phi_{t+1}(y_t=i,y_{t+1},x)\\phi_{t+2}(y_{t+1},y_{t+2},x)\\cdots\\phi_T(y_{T-1},y_T,x) $$ \\[ \\alpha_t(i)=\\Delta_l=\\sum\\limits_{j\\in S}\\phi_t(y_{t-1}=j,y_t=i,x)\\alpha_{t-1}(j)\\\\ \\Delta_r=\\beta_t(i)=\\sum\\limits_{j\\in S}\\phi_{t+1}(y_t=i,y_{t+1}=j,x)\\beta_{t+1}(j) \\] \u5b66\u4e60 $$ \\nabla_\\lambda L=\\sum\\limits_{i=1}^N\\sum\\limits_{t=1}^T[f(y_{t-1},y_t,x^i)-\\sum\\limits_{y_{t-1}}\\sum\\limits_{y_t}p(y_{t-1},y_t|x^i)f(y_{t-1},y_t,x^i)] $$","title":"CRF"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/","text":"SWIG \u7b80\u4ecb SWIG \u662f\u4e2a\u5e2e\u52a9\u4f7f\u7528 C \u6216\u8005 C++ \u7f16\u5199\u7684\u8f6f\u4ef6\u80fd\u4e0e\u5176\u5b83\u5404\u79cd\u9ad8\u7ea7\u7f16\u7a0b\u8bed\u8a00\u8fdb\u884c\u5d4c\u5165\u8054\u63a5\u7684\u5f00\u53d1\u5de5\u5177\u3002 SWIG \u80fd\u5e94\u7528\u4e8e\u5404\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u8bed\u8a00\u5305\u62ec\u5e38\u7528\u811a\u672c\u7f16\u8bd1\u8bed\u8a00\u4f8b\u5982 Perl , PHP , Python , Tcl , Ruby and PHP \u3002 \u5de5\u4f5c\u6d41 \u901a\u8fc7 *.i \u6587\u4ef6\uff0c\u58f0\u660e\u4e00\u4e9b\u63a5\u53e3 interface \uff0c\u81ea\u52a8\u751f\u6210\u4e00\u4e2a *_wrap.c \u548c\u4e00\u4e2a *.py \u6587\u4ef6\u3002 *_wrap.c \u6587\u4ef6\u53c2\u4e0eC/C++\u5c42\u7684\u7f16\u8bd1\uff0c\u4e00\u8d77\u751f\u6210 _*.so \u6587\u4ef6\uff0c\u800c *.py \u6587\u4ef6\u5219\u4f5c\u4e3a\u4e0a\u5c42Python\u7684\u4f7f\u7528\u63a5\u53e3\u3002 \u5176\u4ef7\u503c\u5728\u4e8e\uff0c\u65b0\u589e\u4e86\u4e00\u4e2a\u62bd\u8c61\u5c42\u7ea7\uff0c\u4ee4\u4f7f\u7528\u66f4\u4fbf\u6377\uff0c\u800c\u4e14\u5176\u4e2d\u7684\u4ee3\u7801\u90fd\u662f\u81ea\u52a8\u751f\u6210\u7684\u3002 example \u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u4efb\u610f\u7684 example.c++ \u6587\u4ef6\u6765\u63cf\u8ff0 C++ \u4e0e Python \u901a\u4fe1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 #include <time.h> double My_variable = 3.0 ; int fact ( int n ) { if ( n <= 1 ) return 1 ; else return n * fact ( n -1 ); } int my_mod ( int x , int y ) { return ( x % y ); } char * get_time () { time_t ltime ; time ( & ltime ); return ctime ( & ltime ); } \u4ee5\u53ca example.h \uff0c\u5f53\u7136\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u53ea\u662f\u7528\u6765\u5c55\u793a interface \u6587\u4ef6\u7684\u4e00\u4e9b\u533a\u522b\u3002 1 2 3 4 5 6 7 8 9 #ifndef EXAMPLE_H #define EXAMPLE_H extern double My_variable ; extern int fact ( int n ); extern int my_mod ( int x , int y ); extern char * get_time (); #endif \u524d\u9762\u63cf\u8ff0\u7684\u8fc7\u7a0b\u7b80\u5355\u7684\u8bb2\u5c31\u662f\u5199\u4e00\u4e2a interface \u6587\u4ef6\uff0c\u5373\u53ef\u81ea\u52a8\u751f\u6210\u4e00\u4e2a C/C++ \u4e0e\u4e00\u4e2a Python \u7684\u5305\u88c5\u6587\u4ef6\u3002 \u8ba9\u8fde\u63a5 C/C++ \u4e0e Python \u7684\u8fd9\u4e2a\u62bd\u8c61\u5c42\u7ea7\uff0c\u5b8c\u5168\u4e0d\u7528\u624b\u5199\u3002 \u6bd4\u5982\uff0c\u4e0b\u9762\u7684 example.i \u6587\u4ef6\uff0c\u66b4\u9732\u4e86\u56db\u4e2a\u63a5\u53e3\u3002 1 2 3 4 5 6 7 8 9 10 % module example % { #include \"example.h\" % } extern double My_variable ; extern int fact ( int n ); extern int my_mod ( int x , int y ); extern char * get_time (); \u6ce8\u610f\uff1a - %module \u6307\u5b9a\u4e86\u6a21\u5757\u540d\u4e3a example \u3002 - %{}% \u5219\u6307\u5b9a\u4e86\u5728\u751f\u6210\u7684 example_wrap.c \u6587\u4ef6\u4e2d\u9700\u8981\u7684\u58f0\u660e\uff0c\u8fd9\u91cc\u7528\u4e86\u4e00\u4e2a example.h \u6587\u4ef6\u3002 \u5982\u679c\u6362\u6210\u4e0b\u9762\u7684\u56db\u884c extern \uff0c\u5728\u8fd9\u4e2aDemo\u91cc\u4e5f\u662f\u7b49\u6548\u7684\u3002 - extern \u7684\u56db\u884c\uff0c\u58f0\u660e\u4e86\u9700\u8981\u5bf9\u5916\u66b4\u9732\u7684\u56db\u4e2a\u63a5\u53e3\u3002 - \u9664\u4e86 % \u90e8\u5206\uff0c\u5176\u5b83\u5747\u9075\u5faa .h \u6587\u4ef6\u7684\u8bed\u6cd5\u3002 - \u867d\u7136 example.h \u7684\u5185\u5bb9\u548c\u56db\u4e2a extern \u51e0\u4e4e\u662f\u4e00\u81f4\u7684\uff0c\u800c\u4e14 %{}% \u4e2d\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 extern \uff0c\u4f46\u7b2c\u4e09\u90e8\u5206\u4e0d\u80fd\u4f7f\u7528 #include \u3002 \u7f16\u8bd1\u4ee5\u53caMakefile \u7b14\u8005\u4e00\u822c\u4f7f\u7528 swig -python example.i \u8fdb\u884c\u7f16\u8bd1 \u5c06 example.i \u6587\u4ef6\u8f6c\u5316\u6210 example_wrap.cpp \u548c example.py \u6587\u4ef6 \u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a Makefile \u793a\u4f8b 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 _example.so : example.o example_wrap.o g++ -shared example.o example_wrap.o -o _example.so -lpython3.8m example.o : example.c++ g++ -c -fPIC -I/usr/include/python3.8m example.c++ example_wrap.o : example_wrap.c++ g++ -c -fPIC -I/usr/include/python3.5m example_wrap.c++ example_wrap.c++ example.py : example.i example.h swig -python -c++ example.i clean: rm -f *.o *.so example_wrap.* example.py* test: python3 test.py all: _example.so test .PHONY: clean test all .DEFAULT_GOAL : = all \u4e0a\u5c42\u7684Python\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u8fd9\u56db\u4e2a\u63a5\u53e3\uff0c\u800c\u65e0\u9700\u8003\u8651\u4e2d\u95f4\u7684\u8f6c\u6362\u8fc7\u7a0b\u3002 1 2 3 4 5 6 import example print ( 'My_varaiable: %s ' % example . cvar . My_variable ) print ( 'fact(5): %s ' % example . fact ( 5 )) print ( 'my_mod(7,3): %s ' % example . my_mod ( 7 , 3 )) print ( 'get_time(): %s ' % example . get_time ()) \u901a\u8fc7Setup.py\u5c06\u52a8\u6001SWIG\u914d\u7f6e\u5230\u9879\u76ee\u4e2d SWIG \u7684\u4e00\u4e2a\u4f18\u70b9\u662f\uff0c\u53d7\u5230\u4e86 distutils/setuptools \u7684\u539f\u751f\u652f\u6301\u3002 \u5728 setup.py \u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u76f4\u63a5\u628a *.i \u6587\u4ef6\u4f5c\u4e3a\u6e90\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e\uff0c\u800c\u4e0d\u7528\u624b\u5199\u7f16\u8bd1\u811a\u672c\u3002 \u4e0e ctypes \u76f8\u6bd4\uff0c\u867d\u7136\u4f7f\u7528\u4e0a\u9ebb\u70e6\u4e00\u4e9b\uff0c\u4f46\u63a5\u53e3\u66f4\u5bb9\u6613\u4f7f\u7528\uff0c\u4e5f\u652f\u6301 C++ \u3002 \u6700\u91cd\u8981\u7684\u662f\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u8ba9 C/C++ \u4ee3\u7801\u5728 setup.py \u4e2d\u7f16\u8bd1\uff0c\u66f4\u5bb9\u6613\u8de8\u5e73\u53f0\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 swig - python - demo \u251c\u2500\u2500 LICENSE \u251c\u2500\u2500 Makefile \u251c\u2500\u2500 setup . cfg \u251c\u2500\u2500 setup . py \u251c\u2500\u2500 src \u2502 \u2514\u2500\u2500 example \u2502 \u251c\u2500\u2500 example . c \u2502 \u251c\u2500\u2500 example . h \u2502 \u251c\u2500\u2500 example . i \u2502 \u251c\u2500\u2500 __init__ . py \u2502 \u251c\u2500\u2500 _meta . py \u2502 \u251c\u2500\u2500 stl_example . cpp \u2502 \u251c\u2500\u2500 stl_example . hpp \u2502 \u2514\u2500\u2500 stl_example . i \u2514\u2500\u2500 tests \u251c\u2500\u2500 test_example . py \u2514\u2500\u2500 test_stl_example . py \u5b83\u867d\u7136\u53ea\u6709\u4e00\u4e2a example \u6a21\u5757\uff0c\u4f46\u989d\u5916\u5305\u62ec\u4e86 example.i \u548c stl_example.i \u4e24\u4e2a SWIG \u6a21\u5757\u3002 \u524d\u8005\u662f\u5b98\u65b9 C \u8bed\u8a00\u7684\u6837\u4f8b\uff0c\u540e\u8005\u662f\u7279\u522b\u63d0\u4f9b\u7684 C++ \u8bed\u8a00 STL \u5bb9\u5668\u6837\u4f8b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 from setuptools import Extension , find_packages , setup EXAMPLE_EXT = Extension ( name = '_example' , sources = [ 'src/example/example.c' , 'src/example/example.i' , ], ) STD_EXT = Extension ( name = '_stl_example' , swig_opts = [ '-c++' ], sources = [ 'src/example/stl_example.cpp' , 'src/example/stl_example.i' , ], include_dirs = [ 'src/example' , ], extra_compile_args = [ # The g++ (4.8) in Travis needs this '-std=c++11' , ] ) setup ( ... packages = find_packages ( 'src' ), package_dir = { '' : 'src' }, ext_modules = [ EXAMPLE_EXT , STD_EXT ], ... ) EXAMPLE_EXT \u548c STD_EXT \u5206\u522b\u662f\u4e24\u4e2a SWIG \u7684 Extension \u3002 \u5f53\u7136\uff0c\u5b83\u4eec\u53ef\u4ee5\u5408\u5e76\u6210\u4e00\u4e2a\uff0c\u8fd9\u91cc\u662f\u4e3a\u4e86\u5206\u522b\u5c55\u793aC\u9879\u76ee\u4e0eC++\u9879\u76ee\u3002 \u5728 setup \u51fd\u6570\u4e2d\uff0c ext_modules \u53c2\u6570\u662f\u4e00\u4e2a\u5217\u8868\uff08\u5b9e\u9645\u4e0a\u53ef\u4ee5\u662f\u4e00\u4e2aIterable\uff09\uff0c\u7528\u6765\u8bbe\u7f6e\u8fd9\u4e2a\u5305\u6240\u5305\u542b\u7684 Extension \u3002 \u6ce8\u610f \uff1a\u5305\u540d\u90fd\u4ee5\u4e0b\u5212\u7ebf _ \u5f00\u5934\uff0c\u8fd9\u662f SWIG \u81ea\u52a8\u751f\u6210\u7684\u6a21\u5757\u6240\u7ea6\u5b9a\u7684\u3002 \u4f8b\u5982\uff0c\u5728 example.i \u4e2d\u5b9a\u4e49\u7684\u6a21\u5757\u540d\u662f example \uff0c\u90a3\u4e48\u81ea\u52a8\u751f\u6210\u7684Python\u6587\u4ef6\u5c31\u662f example.py \uff0c\u800c SWIG \u7684\u63a5\u53e3\u6a21\u5757\u5219\u662f _example \uff0c\u7f16\u8bd1\u540e\u7684\u6587\u4ef6\u4e5f\u662f _example.*.so \u3002 \u5e94\u5bf9\u751f\u4ea7py\u6a21\u5757\u6d88\u5931 \u5728\u4f7f\u7528 SWIG \u65f6\uff0c\u6709\u4e00\u4e2a\u9690\u85cf\u7684\u95ee\u9898\u3002 \u65e0\u8bba\u662f\u7528 bdist \u3001 bdist_wheel \u8fd8\u662f bdist_rpm \uff0c\u8fd9\u7c7b\u4ee5\u7f16\u8bd1\u4ea7\u7269\u6253\u5305\u7684\u547d\u4ee4\uff0c\u90fd\u4f1a\u4e22\u5931 SWIG \u751f\u6210\u7684py\u6587\u4ef6\u3002 \u6bd4\u5982\u8fd9\u91cc\uff0c\u4f1a\u4e22\u5931 example.py \u548c stl_example.py \u4e24\u4e2a\u6587\u4ef6\u3002 \u4e4b\u6240\u4ee5\u8bf4 \u9690\u85cf \uff0c\u662f\u56e0\u4e3a\u5728\u8fd9\u4e2a\u95ee\u9898\u5728\u672c\u5730\u5f00\u53d1\u65f6\u96be\u4ee5\u53d1\u73b0\u3002 \u5b83\u53ea\u6709\u5728\u9996\u6b21\u7f16\u8bd1\u6253\u5305\u65f6\uff0c\u624d\u4f1a\u51fa\u73b0\uff1b\u5982\u679c\u5728\u4e0d\u5220\u9664\u8fd9\u4e24\u4e2a\u751f\u6210\u7684py\u6587\u4ef6\u7684\u524d\u63d0\u4e0b\uff0c\u518d\u6b21\u7f16\u8bd1\u3001\u6253\u5305\uff0c\u5c31\u4e0d\u4f1a\u6709\u8fd9\u4e2a\u95ee\u9898\u3002 \u6839\u672c\u539f\u56e0\u5728\u4e8e\uff0c\u5728\u6267\u884c setup \u51fd\u6570\u8fdb\u884c\u7f16\u8bd1\u3001\u6253\u5305\u65f6\uff0c build_ext \u662f\u5728 build_py \u4e4b\u540e\u6267\u884c\u7684\u3002 \u7531\u4e8e SWIG \u9879\u76ee\u7684\u7279\u6b8a\u6027\uff0c\u8fd9\u4e2a\u9ed8\u8ba4\u7684\u6267\u884c\u987a\u5e8f\u4f1a\u8ba9\u81ea\u52a8\u751f\u6210\u7684Python\u6587\u4ef6\u5728Python\u90e8\u5206\u6253\u5305\u540e\u624d\u751f\u6210\uff0c\u6240\u4ee5\u5728\u7a0b\u5e8f\u5305\u91cc\u4e22\u5931\u3002 \u518d\u6b21\u6253\u5305\u4e0d\u4f1a\u9047\u5230\u95ee\u9898\uff0c\u4e5f\u662f\u56e0\u4e3a\u9996\u6b21\u7f16\u8bd1\u65f6\u5df2\u7ecf\u6267\u884c\u4e86 build_ext \u3002 \u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u8ba9 build_ext \u5728 build_py \u4e4b\u524d\u6267\u884c\u3002 1 2 3 4 5 6 7 8 9 10 11 # Build extensions before python modules, # or the generated SWIG python files will be missing. class BuildPy ( build_py ): def run ( self ): self . run_command ( 'build_ext' ) super ( build_py , self ) . run () setup ( ... cmdclass = { 'build_py' : BuildPy , }, ... ) \u5b9e\u9645\u4e0a\uff0c\u5728 Issue 7562: Custom order for the subcommands of build - Python tracker \u5c31\u63cf\u8ff0\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u800c\u4ee5\u4e0b\u4e24\u4e2a\u95ee\u9898\u4e5f\u8bb0\u5f55\u4e86\u4e00\u4e9b\u89e3\u51b3\u65b9\u6848\u3002 \u5982\u679c\u5bf9\u6b64\u5904\u63d0\u4f9b\u7684\u89e3\u51b3\u65b9\u6848\u4e0d\u6ee1\u610f\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u53c2\u8003\u5b83\u4eec\u3002 c++ - python distutils not include the SWIG generated module - Stack Overflow python - setup.py: run build_ext before anything else - Stack Overflow STL \u4e2d\u5bb9\u5668\u7684\u63d0\u4f9b String \u5728 interface \u58f0\u660e\u76f4\u63a5\u901a\u4fe1Python\u6587\u4ef6\u4e2d\u7684str\uff0c\u9700\u8981\u5728 %module ... \u4e0b\u58f0\u660e %include \"std_string.i\" 1 2 3 4 5 6 7 8 9 % module example_string % include \"std_string.i\" % { std :: string echo ( std :: string msg ); } % std :: string echo ( std :: string msg ); \u5982\u679c\u53ea\u662f\u4e00\u4e9b\u5185\u5bb9\u7b80\u5355\u3001\u7ed3\u6784\u590d\u6742\u7684\u6570\u636e\u4ea4\u6362\uff0c\u53ef\u4ee5\u8003\u8651\u4ee5\u67d0\u79cd\u65b9\u5f0f\u5e8f\u5217\u5316\u4e3a\u5b57\u7b26\u4e32\uff0c\u5230\u4e0a\u5c42\u518d\u89e3\u6790\u4e3aPython\u5c42\u7684\u6570\u636e\u7ed3\u6784\u3002 \u8fd9\u91cc\u5c55\u793a\u7684\u662f\u4e00\u4e2a\u8fd4\u56de\u81ea\u8eab\u7684 echo \u51fd\u6570\uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 #include <string> using namespace std ; string echo ( string msg ){ return msg ; } \u5728Python\u4e2d\u8c03\u7528\u7ed3\u679c\u5982\u4e0b\uff1a 1 2 3 4 5 6 >>> import example_string >>> msg = example_string . echo ( 'message' ) >>> msg 'message' >>> isinstance ( msg , str ) True Vector vector \u9700\u8981\u7528 %template \u6a21\u7248\u7c7b\u58f0\u660e\u4e00\u4e0b 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 % module example_vector % include \"std_string.i\" % include \"std_vector.i\" % { using namespace std ; vector < string > vector_int2str ( vector < int > input ); % } namespace std { % template ( StringVector ) vector < string > ; % template ( IntVector ) vector < int > ; } using namespace std ; vector < string > vector_int2str ( vector < int > input ); \u4ee5\u4e0a\u793a\u4f8b\uff0cPython\u5c42\u4f1a\u81ea\u52a8\u751f\u6210 StringVector \u548c IntVector \u8fd9\u4e24\u4e2a\u7c7b\uff0c\u4f5c\u4e3a\u7c7b\u578b\u7684\u66ff\u4ee3\u3002 \u8fd9\u4e24\u4e2a\u7c7b\u7684\u547d\u540d\u53ef\u4ee5\u968f\u610f\uff0c\u5b83\u4eec\u90fd\u5b9e\u73b0\u4e86 list \u7684\u76f8\u5173\u534f\u8bae\uff0c\u53ef\u4ee5\u5f53\u4f5c list \u6765\u4f7f\u7528\u3002 \u793a\u4f8b\u4e2d\u7684 vector_int2str \u51fd\u6570\uff0c\u5c31\u662f\u628a vector \u7684 int \u8f6c\u6362\u4e3a string \uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 #include <string> #include <vector> using namespace std ; vector < string > vector_int2str ( vector < int > input ) { vector < string > result ; for ( vector < int >:: const_iterator it = input . begin (); it != input . end (); ++ it ) { result . push_back ( to_string ( * it )); } return result ; } \u7136\u800c\uff0c\u5b9e\u9645\u5728Python\u5c42\u83b7\u53d6\u8fd4\u56de\u503c\u65f6\uff0c\u5374\u662f tuple \u7c7b\u578b\u3002 \u4f20\u5165\u65f6\uff0c\u4e5f\u53ef\u76f4\u63a5\u4f7f\u7528 list \u6216 tuple \u7b49\u7c7b\u578b 1 2 3 4 5 6 >>> import example_vector >>> data = example_vector . vector_int2str ([ 1 , 2 , 3 ]) >>> data ( '1' , '2' , '3' ) >>> isinstance ( data , tuple ) True map map \u662f\u6700\u5e38\u89c1\u7684\u7684\u5173\u8054\u5bb9\u5668\u3002 \u548c vector \u4e00\u8d77\uff0c\u53ef\u4ee5\u7b80\u5355\u8868\u8fbe\u4e00\u5207\u7ebf\u6027\u6570\u636e\u7ed3\u6784\u3002 \u4e0e vector \u7c7b\u4f3c\uff0c\u4f7f\u7528\u65f6\u4e5f\u9700\u8981\u7528 %template \u58f0\u660e\u3002 \u6b64\u5916\uff0c\u5b83\u8fd8\u6709\u4e00\u4e2a \u7279\u6b8a\u60c5\u51b5 \u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 % module example_map % include \"std_string.i\" % include \"std_map.i\" % { using namespace std ; map < int , string > reverse_map ( map < string , int > input ); % } namespace std { % template ( Int2strMap ) map < int , string > ; % template ( Str2intMap ) map < string , int > ; } using namespace std ; map < int , string > reverse_map ( map < string , int > input ); \u4e0a\u9762\u7684\u5f62\u5f0f\uff0c\u548c vector \u7c7b\u4f3c\u3002 \u5176\u4e2d\uff0c reverse_map \u53cd\u8f6c\u4e86\u6620\u5c04\u5173\u7cfb\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #include <string> #include <vector> #include <map> using namespace std ; map < int , string > reverse_map ( map < string , int > input ) { map < int , string > result ; for ( map < string , int >:: const_iterator it = input . begin (); it != input . end (); ++ it ) { result [ it -> second ] = it -> first ; } return result ; } \u7279\u6b8a\u60c5\u51b5 \u5c31\u662f\uff0c\u867d\u7136 Str2intMap \u548c Int2strMap \u4e5f\u5b9e\u73b0\u4e86 dict \u7684\u534f\u8bae\uff0c\u4f46\u662f\u4f7f\u7528\u65f6\u4e0d\u80fd\u76f4\u63a5\u7528Python\u7684 dict \u3002 1 2 3 4 5 6 7 8 str2int = example_map . Str2intMap () str2int [ '1' ] = 1 str2int [ '2' ] = 2 str2int [ '3' ] = 3 result = example_map . reverse_map ( str2int ) assert isinstance ( result , example_map . Int2strMap ) for key , value in result . items (): assert str2int [ value ] == key \u5e38\u7528\u529f\u80fd \u5904\u7406\u8f93\u5165\u8f93\u51fa\u53c2\u6570 C++\u5305\u88c5\u7684\u4e00\u4e2a\u5e38\u89c1\u95ee\u9898\u662f\u6709\u7684C++\u51fd\u6570\u4ee5\u6307\u9488\u505a\u4e3a\u51fd\u6570\u53c2\u6570: 1 2 3 void add ( int x , int y , int * result ) { * result = x + y ; } \u6216 1 2 3 int sub ( int * x , int * y ) { return * x -* y ; } \u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u7684\u6700\u65b9\u4fbf\u65b9\u5f0f\u662f\u4f7f\u7528SWIG\u5e93\u91cc\u7684 typemaps.i (\u5173\u4e8eSWIG\u5e93\u548cTypemap\u89c1\u4e4b\u540e\u5185\u5bb9): 1 2 3 4 5 % module example % include \"typemaps.i\" void add ( int , int , int * OUTPUT ); int sub ( int * INPUT , int * INPUT ); 1 2 3 4 5 6 >>> a = add ( 3 , 4 ) >>> print a 7 >>> b = sub ( 7 , 4 ) >>> print b 3 \u53e6\u4e00\u79cd\u5199\u6cd5\uff1a 1 2 3 4 5 6 7 8 % module example % include \"typemaps.i\" % apply int * OUTPUT { int * result }; % apply int * INPUT { int * x , int * y }; void add ( int x , int y , int * result ); int sub ( int * x , int * y ); \u5bf9\u4e8e\u65e2\u662f\u8f93\u5165\u53c8\u662f\u8f93\u51fa\u53c2\u6570\u7684\u5904\u7406\uff1a 1 2 3 void negate ( int * x ) { * x = - ( * x ); } 1 2 3 % include \"typemaps.i\" ... void negate ( int * INOUT ); 1 2 3 >>> a = negate ( 3 ) >>> print a - 3 \u5bf9\u4e8e\u591a\u4e2a\u8fd4\u56de\u53c2\u6570\u7684\u5904\u7406\uff1a 1 2 /* send message, return number of bytes sent, along with success code */ int send_message ( char * text , int len , int * success ); 1 2 3 4 5 % module example % include \"typemaps.i\" % apply int * OUTPUT { int * success }; ... int send_message ( char * text , int * success ); 1 2 3 4 5 bytes , success = send_message ( \"Hello World\" ) if not success : print \"Whoa!\" else : print \"Sent\" , bytes \u5f53\u8f93\u51fa\u90fd\u901a\u8fc7\u53c2\u6570\u7ed9\u51fa\u60c5\u51b5\u7684\u5904\u7406\uff1a 1 2 3 4 5 void get_dimensions ( Matrix * m , int * rows , int * columns ); % module example % include \"typemaps.i\" % apply int * OUTPUT { int * rows , int * columns }; 1 void get_dimensions ( Matrix * m , int * rows , * columns ); 1 >>> r , c = get_dimensions ( m ) \u6ce8\u610f \uff0ctypemaps.i\u53ea\u652f\u6301\u4e86\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u6240\u4ee5\u4e0d\u80fd\u5199 void foo(Bar *OUTPUT); \uff0c\u56e0\u4e3atypemaps.i\u91cc\u6ca1\u6709\u5bf9Bar\u5b9a\u4e49OUTPUT\u89c4\u5219\u3002 C\u6570\u7ec4\u5b9e\u73b0 \u6709\u7684C\u51fd\u6570\u8981\u6c42\u4f20\u5165\u4e00\u4e2a\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\uff0c\u8c03\u7528\u8fd9\u79cd\u51fd\u6570\u65f6\u4e0d\u80fd\u76f4\u63a5\u4f20\u5165\u4e00\u4e2aPython list\u6216tuple, \u6709\u4e09\u79cd\u65b9\u5f0f\u80fd\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a \u4f7f\u7528\u7c7b\u578b\u6620\u5c04(Typemap), \u5c06\u6570\u7ec4\u4ee3\u7801\u751f\u6210\u4e3aPython list\u6216tuple\u76f8\u5e94\u4ee3\u7801\u4f7f\u7528\u8f85\u52a9\u51fd\u6570\uff0c\u7528\u8f85\u52a9\u51fd\u6570\u751f\u6210\u548c\u64cd\u4f5c\u6570\u7ec4\u5bf9\u8c61\uff0c\u518d\u7ed3\u5408\u5728\u63a5\u53e3\u6587\u4ef6\u4e2d\u63d2\u5165\u4e00\u4e9bPython\u4ee3\u7801\uff0c\u4e5f\u53ef\u4f7fPython\u76f4\u63a5\u4f20\u5165list\u6216tuple\u3002\u8fd9\u79cd\u65b9\u5f0f\u5728\u4e4b\u540e\u8bf4\u660e\u3002\u4f7f\u7528SWIG\u5e93\u91cc\u7684 carrays.i \uff0c\u8fd9\u91cc\u5148\u4ecb\u7ecdcarrays.i\u65b9\u5f0f\uff1a 1 2 3 4 5 6 7 int sumitems ( int * first , int nitems ) { int i , sum = 0 ; for ( i = 0 ; i < nitems ; i \\ + \\ + ) { sum += first [ i ]; } return sum ; } 1 2 % include \"carrays.i\" % array_class ( int , intArray ); 1 2 3 4 5 >>> a = intArray ( 10000000 ) # Array of 10-million integers >>> for i in xrange ( 10000 ): # Set some values ... a [ i ] = i >>> sumitems ( a , 10000 ) 49995000 \u901a\u8fc7 %array_class \u521b\u5efa\u51fa\u6765\u7684\u6570\u7ec4\u662fC\u6570\u7ec4\u7684\u76f4\u63a5\u4ee3\u7406\uff0c\u975e\u5e38\u5e95\u5c42\u548c\u9ad8\u6548\uff0c\u4f46\u662f\uff0c\u5b83\u4e5f\u548cC\u6570\u7ec4\u4e00\u6837\u4e0d\u5b89\u5168\uff0c\u4e00\u6837\u6ca1\u6709\u8fb9\u754c\u68c0\u67e5\u3002 C/C++\u8f85\u52a9\u51fd\u6570 \u53ef\u4ee5\u901a\u8fc7\u8f85\u52a9\u51fd\u6570\u6765\u5b8c\u4e00\u4e9bSWIG\u672c\u8eab\u4e0d\u652f\u6301\u7684\u529f\u80fd\u3002\u4e8b\u5b9e\u4e0a\uff0c\u4f60\u53ef\u4ee5\u4f7fSWIG\u652f\u6301\u51e0\u4e4e\u6240\u6709\u4f60\u9700\u8981\u7684\u529f\u80fd\uff0c\u6709\u5f88\u591aC++\u7279\u6027\u662fSWIG\u672c\u8eab\u652f\u6301\u6216\u8005\u901a\u8fc7\u5e93\u652f\u6301\u7684\uff0c\u4e0d\u9700\u8981\u901a\u8fc7\u8f85\u52a9\u51fd\u6570\u5b9e\u73b0\u3002 \u540c\u6837\u7684\uff0c\u76f4\u63a5\u4e0a\u4f8b\u793a\u4ee3\u7801\uff1a 1 void set_transform ( Image * im , double m [ 4 ][ 4 ]); 1 2 3 4 5 6 7 8 9 >>> a = [ ... [ 1 , 0 , 0 , 0 ], ... [ 0 , 1 , 0 , 0 ], ... [ 0 , 0 , 1 , 0 ], ... [ 0 , 0 , 0 , 1 ]] >>> set_transform ( im , a ) Traceback ( most recent call last ): File \"<stdin>\" , line 1 , in ? TypeError : Type error . Expected _p_a_4__double \u53ef\u4ee5\u770b\u5230\uff0cset_transform\u662f\u4e0d\u80fd\u63a5\u53d7Python\u4e8c\u7ef4List\u7684\uff0c\u53ef\u4ee5\u7528\u8f85\u52a9\u51fd\u6570\u5e2e\u52a9\u5b9e\u73b0\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 % inline % { /* Note: double[4][4] is equivalent to a pointer to an array double (*)[4] */ double ( * new_mat44 ())[ 4 ] { return ( double ( * )[ 4 ]) malloc ( 16 * sizeof ( double )); } void free_mat44 ( double ( * x )[ 4 ]) { free ( x ); } void mat44_set ( double x [ 4 ][ 4 ], int i , int j , double v ) { x [ i ][ j ] = v ; } double mat44_get ( double x [ 4 ][ 4 ], int i , int j ) { return x [ i ][ j ]; } % } 1 2 3 4 5 6 >>> a = new_mat44 () >>> mat44_set ( a , 0 , 0 , 1.0 ) >>> mat44_set ( a , 1 , 1 , 1.0 ) >>> mat44_set ( a , 2 , 2 , 1.0 ) ... >>> set_transform ( im , a ) \u5f53\u7136\uff0c\u8fd9\u6837\u4f7f\u7528\u8d77\u6765\u8fd8\u4e0d\u591f\u4f18\u96c5\uff0c\u4f46\u53ef\u4ee5\u5de5\u4f5c\u4e86\uff0c\u63a5\u4e0b\u6765\u4ecb\u7ecd\u901a\u8fc7\u63d2\u5165\u989d\u5916\u7684Python\u4ee3\u7801\u6765\u8ba9\u4f7f\u7528\u4f18\u96c5\u8d77\u6765\u3002 \u63d2\u5165\u989d\u5916\u7684Python\u4ee3\u7801 \u4e3a\u4e86\u8ba9set_transform\u51fd\u6570\u63a5\u53d7Python\u4e8c\u7ef4list\u6216tuple\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u5b83\u7684Python\u4ee3\u7801\u7a0d\u52a0\u6539\u9020\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 void set_transform ( Image * im , double x [ 4 ][ 4 ]); ... /* Rewrite the high level interface to set_transform */ % pythoncode % { def set_transform ( im , x ) : a = new_mat44 () for i in range ( 4 ) : for j in range ( 4 ) : mat44_set ( a , i , j , x [ i ][ j ]) _example . set_transform ( im , a ) free_mat44 ( a ) % } 1 2 3 4 5 6 >>> a = [ ... [ 1 , 0 , 0 , 0 ], ... [ 0 , 1 , 0 , 0 ], ... [ 0 , 0 , 1 , 0 ], ... [ 0 , 0 , 0 , 1 ]] >>> set_transform ( im , a ) SWIG\u8fd8\u63d0\u4f9b\u4e86 %feature(\"shadow\") , %feature(\"pythonprepend\") , %feature(\"pythonappend\") \u6765\u652f\u6301\u91cd\u5199\u67d0\u51fd\u6570\u7684\u4ee3\u7406\u51fd\u6570\uff0c\u6216\u5728\u67d0\u51fd\u6570\u524d\u540e\u63d2\u5165\u989d\u5916\u4ee3\u7801\uff0c\u5728 %feature(\"shadow\") \u4e2d \u53ef\u7528 $action \u6765\u6307\u4ee3\u5bf9C++\u76f8\u5e94\u51fd\u6570\u7684\u8c03\u7528\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 % module example // Rewrite bar() python code % feature ( \"shadow\" ) Foo :: bar ( int ) % { def bar ( * args ) : #do something before $action #do something after % } class Foo { public : int bar ( int x ); } \u6216\u8005\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 % module example // Add python code to bar() % feature ( \"pythonprepend\" ) Foo :: bar ( int ) % { #do something before C\\+\\+ call % } % feature ( \"pythonappend\" ) Foo :: bar ( int ) % { #do something after C\\+\\+ call % } class Foo { public : int bar ( int x ); } \u7528%extend\u6307\u793a\u5668\u6269\u5c55C++\u7c7b \u4f60\u53ef\u4ee5\u901a\u8fc7 %extend \u6307\u793a\u5668\u6269\u5c55C++\u7c7b\uff0c\u751a\u81f3\u53ef\u7528\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u91cd\u8f7dPython\u8fd0\u7b97\u7b26\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 % module example % { #include \"someheader.h\" % } struct Vector { double x , y , z ; }; % extend Vector { char * __str__ () { static char tmp [ 1024 ]; sprintf ( tmp , \"Vector(%g,%g,%g)\" , $self -> x , $self -> y , $self -> z ); return tmp ; } Vector ( double x , double y , double z ) { Vector * v = ( Vector * ) malloc ( sizeof ( Vector )); v -> x = x ; v -> y = y ; v -> z = z ; return v ; } Vector __add__ ( Vector * other ) { Vector v ; v . x = $self -> x + other -> x ; v . y = $self -> y + other -> y ; v . z = $self -> z + other -> z ; return v ; } }; 1 2 3 4 5 6 7 >>> v = example . Vector ( 2 , 3 , 4 ) >>> print v Vector ( 2 , 3 , 4 ) >>> v = example . Vector ( 2 , 3 , 4 ) >>> w = example . Vector ( 10 , 11 , 12 ) >>> print v + w Vector ( 12 , 14 , 16 ) \u6ce8\u610f \uff0c\u5728 %extend \u91cc this \u7528 $self \u4ee3\u66ff\u3002 \u5b57\u7b26\u4e32\u5904\u7406 SWIG\u5c06char_ \u6620\u5c04\u4e3aPython\u7684\u5b57\u7b26\u4e32\uff0c\u4f46\u662fPython\u5b57\u7b26\u4e32\u662f\u4e0d\u53ef\u4fee\u6539\u7684\uff08immutable\uff09\uff0c\u5982\u679c\u67d0\u51fd\u6570\u6709\u4fee\u6539char_ \uff0c\u5f88\u53ef\u80fd\u5bfc\u81f4Python\u89e3\u91ca\u5668\u5d29\u6e83\u3002\u5bf9\u7531\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u4f7f\u7528SWIG\u5e93\u91cc\u7684 cstring.i \u3002 \u6a21\u5757 SWIG \u901a\u8fc7 %module \u6307\u793a\u5668\u6307\u5b9a Python \u6a21\u5757\u7684\u540d\u5b57 \u51fd\u6570\u53ca\u56de\u8c03\u51fd\u6570 \u5168\u5c40\u51fd\u6570\u88ab\u5305\u88c5\u4e3a %module \u6307\u793a\u6a21\u5757\u4e0b\u7684\u51fd\u6570\uff0c\u5982\uff1a 1 2 % module example int add ( int a , int b ); 1 2 3 >>> import example >>> print example . add ( 3 , 4 ) 7 \u5168\u5c40\u53d8\u91cf SWIG \u521b\u5efa\u4e00\u4e2a\u7279\u6b8a\u7684\u53d8\u91cf cvar \u6765\u5b58\u53d6\u5168\u5c40\u53d8\u91cf\uff0c\u5982\uff1a 1 2 3 4 % module example % inline % { double density = 2.5 ; % } 1 2 3 >>> import example >>> print example . cvar . density 2.5 inline\u662f\u53e6\u4e00\u4e2a\u5e38\u89c1\u7684SWIG\u6307\u793a\u5668\uff0c\u7528\u6765\u5728\u63a5\u53e3\u6587\u4ef6\u4e2d\u63d2\u5165C/C++\u4ee3\u7801\uff0c\u5e76\u5c06\u4ee3\u7801\u4e2d\u58f0\u660e\u7684\u5185\u5bb9\u8f93\u51fa\u5230\u63a5\u53e3\u4e2d\u3002 \u5e38\u91cf\u548c\u679a\u4e3e\u53d8\u91cf \u7528 #define , enum \u6216\u8005 %constant \u6307\u5b9a\u5e38\u91cf\uff1a 1 2 3 4 5 6 7 #define PI 3.14159 #define VERSION \"1.0\" enum Beverage { ALE , LAGER , STOUT , PILSNER }; % constant int FOO = 42 ; % constant const char * path = \"/usr/local\" ; \u6307\u9488\uff0c\u5f15\u7528\uff0c\u503c\u548c\u6570\u7ec4 SWIG\u5b8c\u6574\u5730\u652f\u6301\u6307\u9488\uff1a 1 2 3 4 5 % module example FILE * fopen ( const char * filename , const char * mode ); int fputs ( const char * , FILE * ); int fclose ( FILE * ); 1 2 3 4 5 6 7 8 >>> import example >>> f = example . fopen ( \"junk\" , \"w\" ) >>> example . fputs ( \"Hello World \\n \" , f ) >>> example . fclose ( f ) >>> print f < Swig Object at _08a71808_p_FILE > >>> print str ( f ) _c0671108_p_FILE \u6307\u9488\u7684\u88f8\u503c\u53ef\u4ee5\u901a\u8fc7\u5c06\u6307\u9488\u5bf9\u8c61\u8f6c\u6362\u6210int\u83b7\u5f97\uff0c\u4e0d\u8fc7\uff0c\u65e0\u6cd5\u901a\u8fc7\u4e00\u4e2aint\u503c\u6784\u9020\u51fa\u4e00\u4e2a\u6307\u9488\u5bf9\u8c61\u3002 1 2 >>> print int ( f ) 135833352 0 \u6216 NULL \u88ab\u8868\u793a\u4e3aNone. \u5bf9\u6307\u9488\u7684\u7c7b\u578b\u8f6c\u6362\u6216\u8fd0\u7b97\u5fc5\u987b\u901a\u8fc7\u8f85\u52a9\u51fd\u6570\u5b8c\u6210\uff0c\u7279\u6b8a\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9C++\u6307\u9488\u7684\u7c7b\u578b\u8f6c\u6362\uff0c\u5e94\u8be5\u7528C++\u65b9\u5f0f\u7684\u8f6c\u6362\uff0c\u800c\u4e0d\u662f\u7528C\u65b9\u5f0f\u7684\u8f6c\u6362\uff0c\u56e0\u4e3a\u5728\u8f6c\u6362\u65e0\u6cd5\u5b8c\u6210\u662f\uff0cC++\u65b9\u5f0f\u7684\u8f6c\u6362\u4f1a\u8fd4\u56deNULL\uff0c\u800cC\u65b9\u5f0f\u7684\u8f6c\u6362\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65e0\u6548\u7684\u6307\u9488\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 % inline % { /* C-style cast */ Bar * FooToBar ( Foo * f ) { return ( Bar * ) f ; } /* C\\+\\+-style cast */ Foo * BarToFoo ( Bar * b ) { return dynamic_cast < Foo *> ( b ); } Foo * IncrFoo ( Foo * f , int i ) { return f + i ; } \u5728C++\u4e2d\uff0c\u51fd\u6570\u53c2\u6570\u53ef\u80fd\u662f\u6307\u9488\uff0c\u5f15\u7528\uff0c\u5e38\u91cf\u5f15\u7528\uff0c\u503c\uff0c\u6570\u636e\u7b49\uff0cSWIG\u5c06\u8fd9\u4e9b\u7c7b\u578b\u7edf\u4e00\u4e3a\u6307\u9488\u7c7b\u578b\u5904\u7406\uff08\u901a\u8fc7\u76f8\u5e94\u7684\u5305\u88c5\u4ee3\u7801\uff09: 1 2 3 4 5 void spam1 ( Foo * x ); // Pass by pointer void spam2 ( Foo & x ); // Pass by reference void spam3 ( const Foo & x ); // Pass by const reference void spam4 ( Foo x ); // Pass by value void spam5 ( Foo x []); // Array of objects 1 2 3 4 5 6 >>> f = Foo () # Create a Foo >>> spam1 ( f ) # Ok. Pointer >>> spam2 ( f ) # Ok. Reference >>> spam3 ( f ) # Ok. Const reference >>> spam4 ( f ) # Ok. Value. >>> spam5 ( f ) # Ok. Array (1 element) \u8fd4\u56de\u503c\u662f\u4e5f\u540c\u6837\u7684\uff1a 1 2 3 4 Foo * spam6 (); Foo & spam7 (); Foo spam8 (); const Foo & spam9 (); \u8fd9\u4e9b\u51fd\u6570\u90fd\u4f1a\u7edf\u4e00\u4e3a\u8fd4\u56de\u4e00\u4e2aFoo\u6307\u9488\u3002 \u7ed3\u6784\u548c\u7c7b\uff0c\u4ee5\u53ca\u7ee7\u627f \u7ed3\u6784\u548c\u7c7b\u662f\u4ee5Python\u7c7b\u6765\u5305\u88c5\u7684\uff1a 1 2 3 struct Vector { double x , y , z ; }; 1 2 3 4 5 >>> v = example . Vector () >>> v . x = 3.5 >>> v . y = 7.2 >>> print v . x , v . y , v . z 7.8 - 4.5 0.0 \u5982\u679c\u7c7b\u6216\u7ed3\u6784\u4e2d\u5305\u542b\u6570\u7ec4\uff0c\u8be5\u6570\u7ec4\u662f\u901a\u8fc7\u6307\u9488\u6765\u64cd\u7eb5\u7684\uff1a 1 2 3 struct Bar { int x [ 16 ]; }; 1 2 3 >>> b = example . Bar () >>> print b . x _801861a4_p_int \u5bf9\u4e8e\u6570\u7ec4\u8d4b\u503c\uff0cSWIG\u4f1a\u505a\u6570\u636e\u7684\u503c\u62f7\u8d1d\uff1a 1 2 >>> c = example . Bar () >>> c . x = b . x # Copy contents of b.x to c.x \u4f46\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u7c7b\u6216\u7ed3\u6784\u4e2d\u5305\u542b\u53e6\u4e00\u4e2a\u7c7b\u6216\u7ed3\u6784\u6210\u5458\uff0c\u8d4b\u503c\u64cd\u4f5c\u5b8c\u5168\u548c\u6307\u9488\u64cd\u4f5c\u76f8\u540c\u3002 \u5bf9\u4e8e\u9759\u6001\u7c7b\u6210\u5458\u51fd\u6570\uff0c\u5728Python\u4e2d\u6709\u4e09\u79cd\u8bbf\u95ee\u65b9\u5f0f: 1 2 3 4 5 class Spam { public : static int bar ; static void foo (); }; 1 2 3 4 >>> example . Spam_foo () # Spam::foo() >>> s = example . Spam () >>> s . foo () # Spam::foo() via an instance >>> example . Spam . foo () # Spam::foo(). Python-2.2 only \u5176\u4e2d\u7b2c\u4e09\u79cd\u65b9\u5f0fPython2.2\u53ca\u4ee5\u4e0a\u7248\u672c\u624d\u652f\u6301\uff0c\u56e0\u4e3a\u4e4b\u524d\u7248\u672c\u7684Python\u4e0d\u652f\u6301\u9759\u6001\u7c7b\u6210\u5458\u51fd\u6570\u3002 \u9759\u6001\u7c7b\u6210\u5458\u53d8\u91cf\u4ee5\u5168\u5c40\u53d8\u91cf\u65b9\u5f0f\u83b7\u53d6\uff1a 1 >>> print example . cvar . Spam_bar SWIG\u652f\u6301C++\u7ee7\u627f\uff0c\u53ef\u4ee5\u7528Python\u5de5\u5177\u51fd\u6570\u9a8c\u8bc1\u8fd9\u4e00\u70b9\uff1a 1 2 3 4 5 6 7 class Foo { ... }; class Bar : public Foo { ... }; 1 2 3 4 5 6 7 >>> b = Bar () >>> instance ( b , Foo ) 1 >>> issubclass ( Bar , Foo ) 1 >>> issubclass ( Foo , Bar ) 0 \u540c\u65f6\uff0c\u5982\u679c\u6709\u5f62\u5982 void spam(Foo *f); \u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u4f20 b = Bar() \u8fdb\u53bb\u3002 SWIG\u652f\u6301\u591a\u7ee7\u627f\u3002 \u91cd\u8f7d SWIG\u652f\u6301C++\u91cd\u8f7d\uff1a 1 2 void foo ( int ); void foo ( char * c ); 1 2 >>> foo ( 3 ) # foo(int) >>> foo ( \"Hello\" ) # foo(char *c) \u4f46\u662f\uff0cSWIG\u4e0d\u80fd\u652f\u6301\u6240\u6709\u5f62\u5f0f\u7684C++\u91cd\u8f7d\uff0c\u5982\uff1a 1 2 void spam ( int ); void spam ( short ); \u6216 1 2 void foo ( Bar * b ); void foo ( Bar & b ); \u8fd9\u79cd\u5f62\u5f0f\u7684\u58f0\u660e\u4f1a\u8ba9SWIG\u4ea7\u751f\u8b66\u544a\uff0c\u53ef\u4ee5\u901a\u8fc7\u91cd\u540d\u547d\u6216\u5ffd\u7565\u5176\u4e2d\u4e00\u4e2a\u6765\u907f\u514d\u8fd9\u4e2a\u8b66\u544a\uff1a 1 % rename ( spam_short ) spam ( short ); \u6216 1 % ignore spam ( short ); \u8fd0\u7b97\u7b26\u91cd\u8f7d SWIG\u80fd\u591f\u81ea\u52a8\u5904\u7406\u8fd0\u7b97\u7b26\u91cd\u8f7d\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 class Complex { private : double rpart , ipart ; public : Complex ( double r = 0 , double i = 0 ) : rpart ( r ), ipart ( i ) { } Complex ( const Complex & c ) : rpart ( c . rpart ), ipart ( c . ipart ) { } Complex & operator = ( const Complex & c ); Complex operator += ( const Complex & c ) const ; Complex operator + ( const Complex & c ) const ; Complex operator - ( const Complex & c ) const ; Complex operator * ( const Complex & c ) const ; Complex operator - () const ; double re () const { return rpart ; } double im () const { return ipart ; } }; 1 2 3 4 5 6 7 8 9 10 11 12 >>> c = Complex ( 3 , 4 ) >>> d = Complex ( 7 , 8 ) >>> e = c + d >>> e . re () 10.0 >>> e . im () 12.0 >>> c += d >>> c . re () 10.0 >>> c . im () 12.0 \u5982\u679c\u91cd\u8f7d\u7684\u8fd0\u7b97\u7b26\u4e0d\u662f\u7c7b\u7684\u4e00\u90e8\u5206\uff0cSWIG\u65e0\u6cd5\u76f4\u63a5\u652f\u6301\uff0c\u5982\uff1a 1 2 3 4 5 class Complex { ... friend Complex operator + ( double , const Complex & c ); ... }; \u8fd9\u79cd\u60c5\u51b5\u4e0bSWIG\u662f\u62a5\u4e00\u4e2a\u8b66\u544a\uff0c\u4e0d\u8fc7\u8fd8\u662f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u7279\u6b8a\u7684\u51fd\u6570\uff0c\u6765\u5305\u88c5\u8fd9\u4e2a\u8fd0\u7b97\u7b26\uff1a 1 % rename ( Complex_add_dc ) operator + ( double , const Complex & ); \u4e0d\u8fc7\uff0c\u6709\u7684\u8fd0\u7b97\u7b26\u65e0\u6cd5\u6e05\u6670\u5730\u6620\u5c04\u5230Python\u8868\u793a\uff0c\u5982\u8d4b\u503c\u8fd0\u7b97\u7b26\uff0c\u50cf\u8fd9\u6837\u7684\u91cd\u8f7d\u4f1a\u88ab\u5ffd\u7565\u3002 \u540d\u5b57\u7a7a\u95f4 \u540d\u5b57\u7a7a\u95f4\u4e0d\u4f1a\u6620\u5c04\u6210Python\u7684\u6a21\u5757\u540d\uff0c\u5982\u679c\u4e0d\u540c\u540d\u5b57\u7a7a\u95f4\u6709\u540c\u540d\u5b9e\u4f53\u8981\u66b4\u9732\u5230\u63a5\u53e3\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u91cd\u547d\u540d\u6307\u793a\u5668\u89e3\u51b3\uff1a 1 2 3 4 5 6 7 8 9 % rename ( Bar_spam ) Bar :: spam ; namespace Foo { int spam (); } namespace Bar { int spam (); } \u6a21\u677f SWIG\u5bf9C/C++\u7684\u5305\u88c5\u662f\u4e8c\u8fdb\u5236\u7ea7\u522b\u7684\uff0c\u4f46C++\u6a21\u677f\u6839\u672c\u4e0d\u662f\u4e8c\u8fdb\u5236\u7ea7\u522b\u7684\u6982\u5ff5\uff0c\u6240\u4ee5\u5bf9\u6a21\u677f\u7684\u5305\u88c5\u9700\u8981\u5c06\u6a21\u677f\u5b9e\u4f8b\u5316\uff0cSWIG\u63d0\u4f9b%template\u6307\u793a\u5668\u652f\u6301\u8fd9\u9879\u529f\u80fd\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 % module example % { #include \"pair.h\" % } template < class T1 , class T2 > struct pair { typedef T1 first_type ; typedef T2 second_type ; T1 first ; T2 second ; pair (); pair ( const T1 & , const T2 & ); ~ pair (); }; % template ( pairii ) pair < int , int > ; 1 2 3 4 5 6 >>> import example >>> p = example . pairii ( 3 , 4 ) >>> p . first 3 >>> p . second 4 \u5982\u679c\u4f60\u8981\u540c\u65f6\u6620\u5c04\u4e00\u4e2a\u6a21\u677f\uff0c\u4ee5\u53ca\u4ee5\u8fd9\u4e2a\u6a21\u677f\u4e3a\u53c2\u6570\u7684\u53e6\u4e00\u4e2a\u6a21\u677f\uff0c\u8fd8\u8981\u505a\u4e00\u70b9\u7279\u6b8a\u7684\u5de5\u4f5c, \u6bd4\u5982\uff0c\u540c\u65f6\u6620\u5c04 pair< string, string > \u548c vector< pair <string, string> > \uff0c\u9700\u8981\u50cf\u4e0b\u9762\u8fd9\u6837\u505a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 % module testpair % include \"std_string.i\" % include \"std_vector.i\" % include \"std_pair.i\" % { #include <string> #include <utility> #include <vector> using namespace std ; % } % template ( StringPair ) std :: pair < std :: string , std :: string > ; SWIG_STD_VECTOR_SPECIALIZE_MINIMUM ( StringPair , std :: pair < std :: string , std :: string > ); % template ( StringPairVector ) std :: vector < std :: pair < std :: string , std :: string > > ; \u667a\u80fd\u6307\u9488 \u6709\u7684\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f\u667a\u80fd\u6307\u9488\uff0c\u4e3a\u4e86\u8c03\u7528\u8fd9\u6837\u7684\u51fd\u6570\uff0c\u53ea\u9700\u8981\u5bf9\u667a\u80fd\u6307\u9488\u7c7b\u578b\u505a\u76f8\u5e94\u58f0\u660e\uff1a 1 2 3 4 % module example ... % template ( SmartPtrFoo ) SmartPtr < Foo > ; ... 1 2 3 >>> p = example . CreateFoo () # CreatFool()\u8fd4\u56de\u4e00\u4e2aSmartPtr<Foo> >>> p . x = 3 # Foo::x >>> p . bar () # Foo::bar \u53ef\u4ee5\u901a\u8fc7 p.__deref__() \u5f97\u5230\u76f8\u5e94\u7684 Foo* \u5f15\u7528\u8bb0\u6570\u5bf9\u8c61\u652f\u6301 \u5bf9\u4e8e\u4f7f\u7528\u5f15\u7528\u8bb0\u6570\u60ef\u4f8b\u7684C++\u5bf9\u8c61\uff0cSWIG\u63d0\u4f9b\u4e86 %ref \u548c %unref \u6307\u793a\u5668\u652f\u6301\uff0c\u4f7f\u7528Python\u91cc\u4f7f\u7528\u65f6\u4e0d\u7528\u624b\u5de5\u8c03\u7528 ref \u548c unref \u51fd\u6570\u3002\u56e0\u4e3a\u6211\u4eec\u76ee\u524d\u6ca1\u6709\u4f7f\u7528\u5f15\u7528\u8bb0\u6570\u6280\u672f\uff0c\u5177\u4f53\u7ec6\u8282\u8fd9\u91cc\u4e0d\u8be6\u8ff0\u4e86\u3002 \u5185\u5b58\u7ba1\u7406 SWIG\u662f\u901a\u8fc7\u5728Python\u91cc\u521b\u5efaC++\u76f8\u5e94\u7c7b\u578b\u7684\u4ee3\u7406\u7c7b\u578b\u6765\u5305\u88c5C++\u7684\uff0c\u6bcf\u4e2aPython\u4ee3\u7406\u5bf9\u8c61\u91cc\u6709\u4e00\u4e2a .thisown \u7684\u6807\u5fd7\uff0c\u8fd9\u4e2a\u6807\u5fd7 \u51b3\u5b9a\u6b64\u4ee3\u7406\u5bf9\u8c61\u662f\u5426\u8d1f\u8d23\u76f8\u5e94C++\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\uff1a\u5982\u679c .thisown \u8fd9\u4e2a\u6807\u5fd7\u4e3a 1 \uff0cPython\u89e3\u91ca\u5668\u5728\u56de\u6536Python\u4ee3\u7406\u5bf9\u8c61\u65f6\u4e5f\u4f1a\u9500\u6bc1\u76f8\u5e94\u7684 C++\u5bf9\u8c61\uff0c\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u6807\u5fd7\u6216\u8fd9\u4e2a\u6807\u5fd7\u7684\u503c\u662f 0 \uff0c\u5219Python\u4ee3\u7406\u5bf9\u8c61\u56de\u6536\u65f6\u4e0d\u5f71\u54cd\u76f8\u5e94\u7684C++\u5bf9\u8c61\u3002 \u5f53\u521b\u5efa\u5bf9\u8c61\uff0c\u6216\u901a\u8fc7\u503c\u8fd4\u56de\u65b9\u5f0f\u83b7\u5f97\u5bf9\u8c61\u65f6\uff0c\u4ee3\u7406\u5bf9\u8c61\u81ea\u52a8\u83b7\u5f97 .thisown \u6807\u5fd7\u3002\u5f53\u901a\u8fc7\u6307\u9488\u65b9\u5f0f\u83b7\u5f97\u5bf9\u8c61\u65f6\uff0c\u4ee3\u7406\u5bf9\u8c61 .thisown \u7684\u503c\u4e3a 0 \uff1a 1 2 3 4 5 6 class Foo { public : Foo (); Foo bar (); Foo * spam (); }; 1 2 3 4 5 6 7 8 9 10 >>> f = Foo () >>> f . thisown 1 >>> g = f . bar () >>> g . thisown 1 >>> f = Foo () >>> s = f . spam () >>> print s . thisown 0 \u5f53\u8fd9\u79cd\u884c\u4e3a\u4e0d\u662f\u671f\u671b\u7684\u884c\u4e3a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4eba\u5de5\u8bbe\u7f6e\u8fd9\u4e2a\u6807\u5fd7\u7684\u503c\uff1a 1 >>> v . thisown = 0 \u8de8\u8bed\u8a00\u591a\u6001 \u5f53\u4f60\u5e0c\u671b\u7528Python\u6269\u5c55\uff08\u7ee7\u627f\uff09C++\u7684\u7c7b\u578b\u7684\u65f6\u5019\uff0c\u4f60\u5c31\u9700\u8981\u8de8\u8bed\u8a00\u591a\u6001\u652f\u6301\u4e86\u3002SWIG\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8c03\u5ea6\u8005(director)\u7279\u6027\u652f\u6301\u6b64\u529f\u80fd\uff0c\u4f46\u6b64\u7279\u6027\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\uff0c\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u6253\u5f00\u6b64\u7279\u6027\uff1a \u9996\u5148\uff0c\u5728module\u6307\u793a\u5668\u91cc\u6253\u5f00 1 % module ( directors = \"1\" ) modulename \u5176\u6b21\uff0c\u901a\u8fc7%feature\u6307\u793a\u5668\u544a\u8bc9SWIG\u54ea\u4e9b\u7c7b\u548c\u51fd\u6570\u9700\u8981\u8de8\u8bed\u8a00\u591a\u6001\u652f\u6301\uff1a 1 2 3 4 5 6 7 8 // generate directors for all classes that have virtual methods % feature ( \"director\" ); // generate directors for all virtual methods in class Foo % feature ( \"director\" ) Foo ; // generate a director for just Foo::bar() % feature ( \"director\" ) Foo :: bar ; \u53ef\u4ee5\u4f7f\u7528 %feature(\"nodirector\") \u6307\u793a\u5668\u5173\u95ed\u67d0\u4e2a\u7c7b\u578b\u6216\u51fd\u6570\u7684\u7684\u8de8\u8bed\u8a00\u591a\u6001\u652f\u6301\uff1a 1 2 % feature ( \"director\" ) Foo ; % feature ( \"nodirector\" ) Foo :: bar ; \u7c7b\u578b\u6620\u5c04(Typemaps) \u7c7b\u578b\u6620\u5c04\u662fSWIG\u6700\u6838\u5fc3\u7684\u4e00\u90e8\u5206\uff0c\u7c7b\u578b\u6620\u5c04\u5c31\u662f\u544a\u8bc9SWIG\u5bf9\u67d0\u4e2aC\u7c7b\u578b\uff0c\u751f\u6210\u4ec0\u4e48\u6837\u7684\u4ee3\u7801\u3002\u4e0d\u8fc7\uff0cSWIG\u7684\u6587\u6863\u91cc\u8bf4\u7c7b\u578b\u6620\u5c04\u662fSWIG\u7684\u9ad8\u7ea7\u81ea\u5b9a\u4e49\u90e8\u5206\uff0c\u4e0d\u662f\u4f7f\u7528SWIG\u9700\u8981\u7406\u89e3\u7684\uff0c\u9664\u975e\u4f60\u8981\u63d0\u5347\u81ea\u5df1\u7684NB\u7b49\u7ea7 \u4ee5\u4e0b\u7684\u7c7b\u578b\u6620\u5c04\u53ef\u7528\u4e8e\u5c06\u6574\u6570\u4ecePython\u8f6c\u6362\u4e3aC: 1 2 3 4 5 6 7 8 9 10 11 % module example % typemap ( in ) int { $1 = ( int ) PyLong_AsLong ( $input ); printf ( \"Received an integer : %d \\n \" , $1 ); } % inline % { int add ( int a , int b ){ return a + b ; } % } 1 2 3 4 5 >>> import example >>> example . add ( 3 , 4 ) Received an integer : 3 Received an integer : 4 7 SWIG\u5e93 SWIG\u63d0\u4f9b\u4e86\u4e00\u7ec4\u5e93\u6587\u4ef6\uff0c\u7528\u4ee5\u652f\u6301\u5e38\u7528\u7684\u5305\u88c5\uff0c\u5982\u6570\u7ec4\uff0c\u6807\u51c6\u5e93\u7b49\u3002\u53ef\u4ee5\u5728\u63a5\u53e3\u6587\u4ef6\u4e2d\u5f15\u5165\u8fd9\u4e9b\u5e93\u6587\u4ef6\u3002\u6bd4\u5982\uff0c\u5728 %include \"std_string.i\" \u540e\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u7ed9\u9700\u8981string\u53c2\u6570\u6570\u7684\u51fd\u6570\u4f20Python\u5b57\u7b26\u4e32\u4e86\u3002\u5bf9 \"std_vector.i\" \u4e3e\u4f8b\u5982\u4e0b\uff1a 1 2 3 4 5 6 % module example % include \"std_vector.i\" namespace std { % template ( vectori ) vector < int > ; }; 1 2 3 4 5 >>> from example import * >>> v = vectori () >>> v . push_back ( 1 ) >>> print v . size () 1 \u53c2\u8003\u8d44\u6599 SWIG\u548cPython: http://www.swig.org/Doc1.3/SWIGDocumentation.html#Python SWIG\u57fa\u7840\uff1a http://www.swig.org/Doc1.3/SWIGDocumentation.html#SWIG SWIG\u548cC++: http://www.swig.org/Doc1.3/SWIGDocumentation.html#SWIGPlus","title":"SWIG"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#swig","text":"SWIG \u662f\u4e2a\u5e2e\u52a9\u4f7f\u7528 C \u6216\u8005 C++ \u7f16\u5199\u7684\u8f6f\u4ef6\u80fd\u4e0e\u5176\u5b83\u5404\u79cd\u9ad8\u7ea7\u7f16\u7a0b\u8bed\u8a00\u8fdb\u884c\u5d4c\u5165\u8054\u63a5\u7684\u5f00\u53d1\u5de5\u5177\u3002 SWIG \u80fd\u5e94\u7528\u4e8e\u5404\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u8bed\u8a00\u5305\u62ec\u5e38\u7528\u811a\u672c\u7f16\u8bd1\u8bed\u8a00\u4f8b\u5982 Perl , PHP , Python , Tcl , Ruby and PHP \u3002","title":"SWIG \u7b80\u4ecb"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_1","text":"\u901a\u8fc7 *.i \u6587\u4ef6\uff0c\u58f0\u660e\u4e00\u4e9b\u63a5\u53e3 interface \uff0c\u81ea\u52a8\u751f\u6210\u4e00\u4e2a *_wrap.c \u548c\u4e00\u4e2a *.py \u6587\u4ef6\u3002 *_wrap.c \u6587\u4ef6\u53c2\u4e0eC/C++\u5c42\u7684\u7f16\u8bd1\uff0c\u4e00\u8d77\u751f\u6210 _*.so \u6587\u4ef6\uff0c\u800c *.py \u6587\u4ef6\u5219\u4f5c\u4e3a\u4e0a\u5c42Python\u7684\u4f7f\u7528\u63a5\u53e3\u3002 \u5176\u4ef7\u503c\u5728\u4e8e\uff0c\u65b0\u589e\u4e86\u4e00\u4e2a\u62bd\u8c61\u5c42\u7ea7\uff0c\u4ee4\u4f7f\u7528\u66f4\u4fbf\u6377\uff0c\u800c\u4e14\u5176\u4e2d\u7684\u4ee3\u7801\u90fd\u662f\u81ea\u52a8\u751f\u6210\u7684\u3002","title":"\u5de5\u4f5c\u6d41"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#example","text":"\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u4efb\u610f\u7684 example.c++ \u6587\u4ef6\u6765\u63cf\u8ff0 C++ \u4e0e Python \u901a\u4fe1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 #include <time.h> double My_variable = 3.0 ; int fact ( int n ) { if ( n <= 1 ) return 1 ; else return n * fact ( n -1 ); } int my_mod ( int x , int y ) { return ( x % y ); } char * get_time () { time_t ltime ; time ( & ltime ); return ctime ( & ltime ); } \u4ee5\u53ca example.h \uff0c\u5f53\u7136\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u53ea\u662f\u7528\u6765\u5c55\u793a interface \u6587\u4ef6\u7684\u4e00\u4e9b\u533a\u522b\u3002 1 2 3 4 5 6 7 8 9 #ifndef EXAMPLE_H #define EXAMPLE_H extern double My_variable ; extern int fact ( int n ); extern int my_mod ( int x , int y ); extern char * get_time (); #endif \u524d\u9762\u63cf\u8ff0\u7684\u8fc7\u7a0b\u7b80\u5355\u7684\u8bb2\u5c31\u662f\u5199\u4e00\u4e2a interface \u6587\u4ef6\uff0c\u5373\u53ef\u81ea\u52a8\u751f\u6210\u4e00\u4e2a C/C++ \u4e0e\u4e00\u4e2a Python \u7684\u5305\u88c5\u6587\u4ef6\u3002 \u8ba9\u8fde\u63a5 C/C++ \u4e0e Python \u7684\u8fd9\u4e2a\u62bd\u8c61\u5c42\u7ea7\uff0c\u5b8c\u5168\u4e0d\u7528\u624b\u5199\u3002 \u6bd4\u5982\uff0c\u4e0b\u9762\u7684 example.i \u6587\u4ef6\uff0c\u66b4\u9732\u4e86\u56db\u4e2a\u63a5\u53e3\u3002 1 2 3 4 5 6 7 8 9 10 % module example % { #include \"example.h\" % } extern double My_variable ; extern int fact ( int n ); extern int my_mod ( int x , int y ); extern char * get_time (); \u6ce8\u610f\uff1a - %module \u6307\u5b9a\u4e86\u6a21\u5757\u540d\u4e3a example \u3002 - %{}% \u5219\u6307\u5b9a\u4e86\u5728\u751f\u6210\u7684 example_wrap.c \u6587\u4ef6\u4e2d\u9700\u8981\u7684\u58f0\u660e\uff0c\u8fd9\u91cc\u7528\u4e86\u4e00\u4e2a example.h \u6587\u4ef6\u3002 \u5982\u679c\u6362\u6210\u4e0b\u9762\u7684\u56db\u884c extern \uff0c\u5728\u8fd9\u4e2aDemo\u91cc\u4e5f\u662f\u7b49\u6548\u7684\u3002 - extern \u7684\u56db\u884c\uff0c\u58f0\u660e\u4e86\u9700\u8981\u5bf9\u5916\u66b4\u9732\u7684\u56db\u4e2a\u63a5\u53e3\u3002 - \u9664\u4e86 % \u90e8\u5206\uff0c\u5176\u5b83\u5747\u9075\u5faa .h \u6587\u4ef6\u7684\u8bed\u6cd5\u3002 - \u867d\u7136 example.h \u7684\u5185\u5bb9\u548c\u56db\u4e2a extern \u51e0\u4e4e\u662f\u4e00\u81f4\u7684\uff0c\u800c\u4e14 %{}% \u4e2d\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 extern \uff0c\u4f46\u7b2c\u4e09\u90e8\u5206\u4e0d\u80fd\u4f7f\u7528 #include \u3002","title":"example"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#makefile","text":"\u7b14\u8005\u4e00\u822c\u4f7f\u7528 swig -python example.i \u8fdb\u884c\u7f16\u8bd1 \u5c06 example.i \u6587\u4ef6\u8f6c\u5316\u6210 example_wrap.cpp \u548c example.py \u6587\u4ef6 \u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a Makefile \u793a\u4f8b 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 _example.so : example.o example_wrap.o g++ -shared example.o example_wrap.o -o _example.so -lpython3.8m example.o : example.c++ g++ -c -fPIC -I/usr/include/python3.8m example.c++ example_wrap.o : example_wrap.c++ g++ -c -fPIC -I/usr/include/python3.5m example_wrap.c++ example_wrap.c++ example.py : example.i example.h swig -python -c++ example.i clean: rm -f *.o *.so example_wrap.* example.py* test: python3 test.py all: _example.so test .PHONY: clean test all .DEFAULT_GOAL : = all \u4e0a\u5c42\u7684Python\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u8fd9\u56db\u4e2a\u63a5\u53e3\uff0c\u800c\u65e0\u9700\u8003\u8651\u4e2d\u95f4\u7684\u8f6c\u6362\u8fc7\u7a0b\u3002 1 2 3 4 5 6 import example print ( 'My_varaiable: %s ' % example . cvar . My_variable ) print ( 'fact(5): %s ' % example . fact ( 5 )) print ( 'my_mod(7,3): %s ' % example . my_mod ( 7 , 3 )) print ( 'get_time(): %s ' % example . get_time ())","title":"\u7f16\u8bd1\u4ee5\u53caMakefile"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#setuppyswig","text":"SWIG \u7684\u4e00\u4e2a\u4f18\u70b9\u662f\uff0c\u53d7\u5230\u4e86 distutils/setuptools \u7684\u539f\u751f\u652f\u6301\u3002 \u5728 setup.py \u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u76f4\u63a5\u628a *.i \u6587\u4ef6\u4f5c\u4e3a\u6e90\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e\uff0c\u800c\u4e0d\u7528\u624b\u5199\u7f16\u8bd1\u811a\u672c\u3002 \u4e0e ctypes \u76f8\u6bd4\uff0c\u867d\u7136\u4f7f\u7528\u4e0a\u9ebb\u70e6\u4e00\u4e9b\uff0c\u4f46\u63a5\u53e3\u66f4\u5bb9\u6613\u4f7f\u7528\uff0c\u4e5f\u652f\u6301 C++ \u3002 \u6700\u91cd\u8981\u7684\u662f\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u8ba9 C/C++ \u4ee3\u7801\u5728 setup.py \u4e2d\u7f16\u8bd1\uff0c\u66f4\u5bb9\u6613\u8de8\u5e73\u53f0\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 swig - python - demo \u251c\u2500\u2500 LICENSE \u251c\u2500\u2500 Makefile \u251c\u2500\u2500 setup . cfg \u251c\u2500\u2500 setup . py \u251c\u2500\u2500 src \u2502 \u2514\u2500\u2500 example \u2502 \u251c\u2500\u2500 example . c \u2502 \u251c\u2500\u2500 example . h \u2502 \u251c\u2500\u2500 example . i \u2502 \u251c\u2500\u2500 __init__ . py \u2502 \u251c\u2500\u2500 _meta . py \u2502 \u251c\u2500\u2500 stl_example . cpp \u2502 \u251c\u2500\u2500 stl_example . hpp \u2502 \u2514\u2500\u2500 stl_example . i \u2514\u2500\u2500 tests \u251c\u2500\u2500 test_example . py \u2514\u2500\u2500 test_stl_example . py \u5b83\u867d\u7136\u53ea\u6709\u4e00\u4e2a example \u6a21\u5757\uff0c\u4f46\u989d\u5916\u5305\u62ec\u4e86 example.i \u548c stl_example.i \u4e24\u4e2a SWIG \u6a21\u5757\u3002 \u524d\u8005\u662f\u5b98\u65b9 C \u8bed\u8a00\u7684\u6837\u4f8b\uff0c\u540e\u8005\u662f\u7279\u522b\u63d0\u4f9b\u7684 C++ \u8bed\u8a00 STL \u5bb9\u5668\u6837\u4f8b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 from setuptools import Extension , find_packages , setup EXAMPLE_EXT = Extension ( name = '_example' , sources = [ 'src/example/example.c' , 'src/example/example.i' , ], ) STD_EXT = Extension ( name = '_stl_example' , swig_opts = [ '-c++' ], sources = [ 'src/example/stl_example.cpp' , 'src/example/stl_example.i' , ], include_dirs = [ 'src/example' , ], extra_compile_args = [ # The g++ (4.8) in Travis needs this '-std=c++11' , ] ) setup ( ... packages = find_packages ( 'src' ), package_dir = { '' : 'src' }, ext_modules = [ EXAMPLE_EXT , STD_EXT ], ... ) EXAMPLE_EXT \u548c STD_EXT \u5206\u522b\u662f\u4e24\u4e2a SWIG \u7684 Extension \u3002 \u5f53\u7136\uff0c\u5b83\u4eec\u53ef\u4ee5\u5408\u5e76\u6210\u4e00\u4e2a\uff0c\u8fd9\u91cc\u662f\u4e3a\u4e86\u5206\u522b\u5c55\u793aC\u9879\u76ee\u4e0eC++\u9879\u76ee\u3002 \u5728 setup \u51fd\u6570\u4e2d\uff0c ext_modules \u53c2\u6570\u662f\u4e00\u4e2a\u5217\u8868\uff08\u5b9e\u9645\u4e0a\u53ef\u4ee5\u662f\u4e00\u4e2aIterable\uff09\uff0c\u7528\u6765\u8bbe\u7f6e\u8fd9\u4e2a\u5305\u6240\u5305\u542b\u7684 Extension \u3002 \u6ce8\u610f \uff1a\u5305\u540d\u90fd\u4ee5\u4e0b\u5212\u7ebf _ \u5f00\u5934\uff0c\u8fd9\u662f SWIG \u81ea\u52a8\u751f\u6210\u7684\u6a21\u5757\u6240\u7ea6\u5b9a\u7684\u3002 \u4f8b\u5982\uff0c\u5728 example.i \u4e2d\u5b9a\u4e49\u7684\u6a21\u5757\u540d\u662f example \uff0c\u90a3\u4e48\u81ea\u52a8\u751f\u6210\u7684Python\u6587\u4ef6\u5c31\u662f example.py \uff0c\u800c SWIG \u7684\u63a5\u53e3\u6a21\u5757\u5219\u662f _example \uff0c\u7f16\u8bd1\u540e\u7684\u6587\u4ef6\u4e5f\u662f _example.*.so \u3002","title":"\u901a\u8fc7Setup.py\u5c06\u52a8\u6001SWIG\u914d\u7f6e\u5230\u9879\u76ee\u4e2d"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#py","text":"\u5728\u4f7f\u7528 SWIG \u65f6\uff0c\u6709\u4e00\u4e2a\u9690\u85cf\u7684\u95ee\u9898\u3002 \u65e0\u8bba\u662f\u7528 bdist \u3001 bdist_wheel \u8fd8\u662f bdist_rpm \uff0c\u8fd9\u7c7b\u4ee5\u7f16\u8bd1\u4ea7\u7269\u6253\u5305\u7684\u547d\u4ee4\uff0c\u90fd\u4f1a\u4e22\u5931 SWIG \u751f\u6210\u7684py\u6587\u4ef6\u3002 \u6bd4\u5982\u8fd9\u91cc\uff0c\u4f1a\u4e22\u5931 example.py \u548c stl_example.py \u4e24\u4e2a\u6587\u4ef6\u3002 \u4e4b\u6240\u4ee5\u8bf4 \u9690\u85cf \uff0c\u662f\u56e0\u4e3a\u5728\u8fd9\u4e2a\u95ee\u9898\u5728\u672c\u5730\u5f00\u53d1\u65f6\u96be\u4ee5\u53d1\u73b0\u3002 \u5b83\u53ea\u6709\u5728\u9996\u6b21\u7f16\u8bd1\u6253\u5305\u65f6\uff0c\u624d\u4f1a\u51fa\u73b0\uff1b\u5982\u679c\u5728\u4e0d\u5220\u9664\u8fd9\u4e24\u4e2a\u751f\u6210\u7684py\u6587\u4ef6\u7684\u524d\u63d0\u4e0b\uff0c\u518d\u6b21\u7f16\u8bd1\u3001\u6253\u5305\uff0c\u5c31\u4e0d\u4f1a\u6709\u8fd9\u4e2a\u95ee\u9898\u3002 \u6839\u672c\u539f\u56e0\u5728\u4e8e\uff0c\u5728\u6267\u884c setup \u51fd\u6570\u8fdb\u884c\u7f16\u8bd1\u3001\u6253\u5305\u65f6\uff0c build_ext \u662f\u5728 build_py \u4e4b\u540e\u6267\u884c\u7684\u3002 \u7531\u4e8e SWIG \u9879\u76ee\u7684\u7279\u6b8a\u6027\uff0c\u8fd9\u4e2a\u9ed8\u8ba4\u7684\u6267\u884c\u987a\u5e8f\u4f1a\u8ba9\u81ea\u52a8\u751f\u6210\u7684Python\u6587\u4ef6\u5728Python\u90e8\u5206\u6253\u5305\u540e\u624d\u751f\u6210\uff0c\u6240\u4ee5\u5728\u7a0b\u5e8f\u5305\u91cc\u4e22\u5931\u3002 \u518d\u6b21\u6253\u5305\u4e0d\u4f1a\u9047\u5230\u95ee\u9898\uff0c\u4e5f\u662f\u56e0\u4e3a\u9996\u6b21\u7f16\u8bd1\u65f6\u5df2\u7ecf\u6267\u884c\u4e86 build_ext \u3002 \u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u8ba9 build_ext \u5728 build_py \u4e4b\u524d\u6267\u884c\u3002 1 2 3 4 5 6 7 8 9 10 11 # Build extensions before python modules, # or the generated SWIG python files will be missing. class BuildPy ( build_py ): def run ( self ): self . run_command ( 'build_ext' ) super ( build_py , self ) . run () setup ( ... cmdclass = { 'build_py' : BuildPy , }, ... ) \u5b9e\u9645\u4e0a\uff0c\u5728 Issue 7562: Custom order for the subcommands of build - Python tracker \u5c31\u63cf\u8ff0\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u800c\u4ee5\u4e0b\u4e24\u4e2a\u95ee\u9898\u4e5f\u8bb0\u5f55\u4e86\u4e00\u4e9b\u89e3\u51b3\u65b9\u6848\u3002 \u5982\u679c\u5bf9\u6b64\u5904\u63d0\u4f9b\u7684\u89e3\u51b3\u65b9\u6848\u4e0d\u6ee1\u610f\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u53c2\u8003\u5b83\u4eec\u3002 c++ - python distutils not include the SWIG generated module - Stack Overflow python - setup.py: run build_ext before anything else - Stack Overflow","title":"\u5e94\u5bf9\u751f\u4ea7py\u6a21\u5757\u6d88\u5931"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#stl","text":"","title":"STL \u4e2d\u5bb9\u5668\u7684\u63d0\u4f9b"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#string","text":"\u5728 interface \u58f0\u660e\u76f4\u63a5\u901a\u4fe1Python\u6587\u4ef6\u4e2d\u7684str\uff0c\u9700\u8981\u5728 %module ... \u4e0b\u58f0\u660e %include \"std_string.i\" 1 2 3 4 5 6 7 8 9 % module example_string % include \"std_string.i\" % { std :: string echo ( std :: string msg ); } % std :: string echo ( std :: string msg ); \u5982\u679c\u53ea\u662f\u4e00\u4e9b\u5185\u5bb9\u7b80\u5355\u3001\u7ed3\u6784\u590d\u6742\u7684\u6570\u636e\u4ea4\u6362\uff0c\u53ef\u4ee5\u8003\u8651\u4ee5\u67d0\u79cd\u65b9\u5f0f\u5e8f\u5217\u5316\u4e3a\u5b57\u7b26\u4e32\uff0c\u5230\u4e0a\u5c42\u518d\u89e3\u6790\u4e3aPython\u5c42\u7684\u6570\u636e\u7ed3\u6784\u3002 \u8fd9\u91cc\u5c55\u793a\u7684\u662f\u4e00\u4e2a\u8fd4\u56de\u81ea\u8eab\u7684 echo \u51fd\u6570\uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 #include <string> using namespace std ; string echo ( string msg ){ return msg ; } \u5728Python\u4e2d\u8c03\u7528\u7ed3\u679c\u5982\u4e0b\uff1a 1 2 3 4 5 6 >>> import example_string >>> msg = example_string . echo ( 'message' ) >>> msg 'message' >>> isinstance ( msg , str ) True","title":"String"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#vector","text":"vector \u9700\u8981\u7528 %template \u6a21\u7248\u7c7b\u58f0\u660e\u4e00\u4e0b 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 % module example_vector % include \"std_string.i\" % include \"std_vector.i\" % { using namespace std ; vector < string > vector_int2str ( vector < int > input ); % } namespace std { % template ( StringVector ) vector < string > ; % template ( IntVector ) vector < int > ; } using namespace std ; vector < string > vector_int2str ( vector < int > input ); \u4ee5\u4e0a\u793a\u4f8b\uff0cPython\u5c42\u4f1a\u81ea\u52a8\u751f\u6210 StringVector \u548c IntVector \u8fd9\u4e24\u4e2a\u7c7b\uff0c\u4f5c\u4e3a\u7c7b\u578b\u7684\u66ff\u4ee3\u3002 \u8fd9\u4e24\u4e2a\u7c7b\u7684\u547d\u540d\u53ef\u4ee5\u968f\u610f\uff0c\u5b83\u4eec\u90fd\u5b9e\u73b0\u4e86 list \u7684\u76f8\u5173\u534f\u8bae\uff0c\u53ef\u4ee5\u5f53\u4f5c list \u6765\u4f7f\u7528\u3002 \u793a\u4f8b\u4e2d\u7684 vector_int2str \u51fd\u6570\uff0c\u5c31\u662f\u628a vector \u7684 int \u8f6c\u6362\u4e3a string \uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 #include <string> #include <vector> using namespace std ; vector < string > vector_int2str ( vector < int > input ) { vector < string > result ; for ( vector < int >:: const_iterator it = input . begin (); it != input . end (); ++ it ) { result . push_back ( to_string ( * it )); } return result ; } \u7136\u800c\uff0c\u5b9e\u9645\u5728Python\u5c42\u83b7\u53d6\u8fd4\u56de\u503c\u65f6\uff0c\u5374\u662f tuple \u7c7b\u578b\u3002 \u4f20\u5165\u65f6\uff0c\u4e5f\u53ef\u76f4\u63a5\u4f7f\u7528 list \u6216 tuple \u7b49\u7c7b\u578b 1 2 3 4 5 6 >>> import example_vector >>> data = example_vector . vector_int2str ([ 1 , 2 , 3 ]) >>> data ( '1' , '2' , '3' ) >>> isinstance ( data , tuple ) True","title":"Vector"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#map","text":"map \u662f\u6700\u5e38\u89c1\u7684\u7684\u5173\u8054\u5bb9\u5668\u3002 \u548c vector \u4e00\u8d77\uff0c\u53ef\u4ee5\u7b80\u5355\u8868\u8fbe\u4e00\u5207\u7ebf\u6027\u6570\u636e\u7ed3\u6784\u3002 \u4e0e vector \u7c7b\u4f3c\uff0c\u4f7f\u7528\u65f6\u4e5f\u9700\u8981\u7528 %template \u58f0\u660e\u3002 \u6b64\u5916\uff0c\u5b83\u8fd8\u6709\u4e00\u4e2a \u7279\u6b8a\u60c5\u51b5 \u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 % module example_map % include \"std_string.i\" % include \"std_map.i\" % { using namespace std ; map < int , string > reverse_map ( map < string , int > input ); % } namespace std { % template ( Int2strMap ) map < int , string > ; % template ( Str2intMap ) map < string , int > ; } using namespace std ; map < int , string > reverse_map ( map < string , int > input ); \u4e0a\u9762\u7684\u5f62\u5f0f\uff0c\u548c vector \u7c7b\u4f3c\u3002 \u5176\u4e2d\uff0c reverse_map \u53cd\u8f6c\u4e86\u6620\u5c04\u5173\u7cfb\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #include <string> #include <vector> #include <map> using namespace std ; map < int , string > reverse_map ( map < string , int > input ) { map < int , string > result ; for ( map < string , int >:: const_iterator it = input . begin (); it != input . end (); ++ it ) { result [ it -> second ] = it -> first ; } return result ; } \u7279\u6b8a\u60c5\u51b5 \u5c31\u662f\uff0c\u867d\u7136 Str2intMap \u548c Int2strMap \u4e5f\u5b9e\u73b0\u4e86 dict \u7684\u534f\u8bae\uff0c\u4f46\u662f\u4f7f\u7528\u65f6\u4e0d\u80fd\u76f4\u63a5\u7528Python\u7684 dict \u3002 1 2 3 4 5 6 7 8 str2int = example_map . Str2intMap () str2int [ '1' ] = 1 str2int [ '2' ] = 2 str2int [ '3' ] = 3 result = example_map . reverse_map ( str2int ) assert isinstance ( result , example_map . Int2strMap ) for key , value in result . items (): assert str2int [ value ] == key","title":"map"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_2","text":"","title":"\u5e38\u7528\u529f\u80fd"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_3","text":"C++\u5305\u88c5\u7684\u4e00\u4e2a\u5e38\u89c1\u95ee\u9898\u662f\u6709\u7684C++\u51fd\u6570\u4ee5\u6307\u9488\u505a\u4e3a\u51fd\u6570\u53c2\u6570: 1 2 3 void add ( int x , int y , int * result ) { * result = x + y ; } \u6216 1 2 3 int sub ( int * x , int * y ) { return * x -* y ; } \u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u7684\u6700\u65b9\u4fbf\u65b9\u5f0f\u662f\u4f7f\u7528SWIG\u5e93\u91cc\u7684 typemaps.i (\u5173\u4e8eSWIG\u5e93\u548cTypemap\u89c1\u4e4b\u540e\u5185\u5bb9): 1 2 3 4 5 % module example % include \"typemaps.i\" void add ( int , int , int * OUTPUT ); int sub ( int * INPUT , int * INPUT ); 1 2 3 4 5 6 >>> a = add ( 3 , 4 ) >>> print a 7 >>> b = sub ( 7 , 4 ) >>> print b 3 \u53e6\u4e00\u79cd\u5199\u6cd5\uff1a 1 2 3 4 5 6 7 8 % module example % include \"typemaps.i\" % apply int * OUTPUT { int * result }; % apply int * INPUT { int * x , int * y }; void add ( int x , int y , int * result ); int sub ( int * x , int * y ); \u5bf9\u4e8e\u65e2\u662f\u8f93\u5165\u53c8\u662f\u8f93\u51fa\u53c2\u6570\u7684\u5904\u7406\uff1a 1 2 3 void negate ( int * x ) { * x = - ( * x ); } 1 2 3 % include \"typemaps.i\" ... void negate ( int * INOUT ); 1 2 3 >>> a = negate ( 3 ) >>> print a - 3 \u5bf9\u4e8e\u591a\u4e2a\u8fd4\u56de\u53c2\u6570\u7684\u5904\u7406\uff1a 1 2 /* send message, return number of bytes sent, along with success code */ int send_message ( char * text , int len , int * success ); 1 2 3 4 5 % module example % include \"typemaps.i\" % apply int * OUTPUT { int * success }; ... int send_message ( char * text , int * success ); 1 2 3 4 5 bytes , success = send_message ( \"Hello World\" ) if not success : print \"Whoa!\" else : print \"Sent\" , bytes \u5f53\u8f93\u51fa\u90fd\u901a\u8fc7\u53c2\u6570\u7ed9\u51fa\u60c5\u51b5\u7684\u5904\u7406\uff1a 1 2 3 4 5 void get_dimensions ( Matrix * m , int * rows , int * columns ); % module example % include \"typemaps.i\" % apply int * OUTPUT { int * rows , int * columns }; 1 void get_dimensions ( Matrix * m , int * rows , * columns ); 1 >>> r , c = get_dimensions ( m ) \u6ce8\u610f \uff0ctypemaps.i\u53ea\u652f\u6301\u4e86\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u6240\u4ee5\u4e0d\u80fd\u5199 void foo(Bar *OUTPUT); \uff0c\u56e0\u4e3atypemaps.i\u91cc\u6ca1\u6709\u5bf9Bar\u5b9a\u4e49OUTPUT\u89c4\u5219\u3002","title":"\u5904\u7406\u8f93\u5165\u8f93\u51fa\u53c2\u6570"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#c","text":"\u6709\u7684C\u51fd\u6570\u8981\u6c42\u4f20\u5165\u4e00\u4e2a\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\uff0c\u8c03\u7528\u8fd9\u79cd\u51fd\u6570\u65f6\u4e0d\u80fd\u76f4\u63a5\u4f20\u5165\u4e00\u4e2aPython list\u6216tuple, \u6709\u4e09\u79cd\u65b9\u5f0f\u80fd\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a \u4f7f\u7528\u7c7b\u578b\u6620\u5c04(Typemap), \u5c06\u6570\u7ec4\u4ee3\u7801\u751f\u6210\u4e3aPython list\u6216tuple\u76f8\u5e94\u4ee3\u7801\u4f7f\u7528\u8f85\u52a9\u51fd\u6570\uff0c\u7528\u8f85\u52a9\u51fd\u6570\u751f\u6210\u548c\u64cd\u4f5c\u6570\u7ec4\u5bf9\u8c61\uff0c\u518d\u7ed3\u5408\u5728\u63a5\u53e3\u6587\u4ef6\u4e2d\u63d2\u5165\u4e00\u4e9bPython\u4ee3\u7801\uff0c\u4e5f\u53ef\u4f7fPython\u76f4\u63a5\u4f20\u5165list\u6216tuple\u3002\u8fd9\u79cd\u65b9\u5f0f\u5728\u4e4b\u540e\u8bf4\u660e\u3002\u4f7f\u7528SWIG\u5e93\u91cc\u7684 carrays.i \uff0c\u8fd9\u91cc\u5148\u4ecb\u7ecdcarrays.i\u65b9\u5f0f\uff1a 1 2 3 4 5 6 7 int sumitems ( int * first , int nitems ) { int i , sum = 0 ; for ( i = 0 ; i < nitems ; i \\ + \\ + ) { sum += first [ i ]; } return sum ; } 1 2 % include \"carrays.i\" % array_class ( int , intArray ); 1 2 3 4 5 >>> a = intArray ( 10000000 ) # Array of 10-million integers >>> for i in xrange ( 10000 ): # Set some values ... a [ i ] = i >>> sumitems ( a , 10000 ) 49995000 \u901a\u8fc7 %array_class \u521b\u5efa\u51fa\u6765\u7684\u6570\u7ec4\u662fC\u6570\u7ec4\u7684\u76f4\u63a5\u4ee3\u7406\uff0c\u975e\u5e38\u5e95\u5c42\u548c\u9ad8\u6548\uff0c\u4f46\u662f\uff0c\u5b83\u4e5f\u548cC\u6570\u7ec4\u4e00\u6837\u4e0d\u5b89\u5168\uff0c\u4e00\u6837\u6ca1\u6709\u8fb9\u754c\u68c0\u67e5\u3002","title":"C\u6570\u7ec4\u5b9e\u73b0"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#cc","text":"\u53ef\u4ee5\u901a\u8fc7\u8f85\u52a9\u51fd\u6570\u6765\u5b8c\u4e00\u4e9bSWIG\u672c\u8eab\u4e0d\u652f\u6301\u7684\u529f\u80fd\u3002\u4e8b\u5b9e\u4e0a\uff0c\u4f60\u53ef\u4ee5\u4f7fSWIG\u652f\u6301\u51e0\u4e4e\u6240\u6709\u4f60\u9700\u8981\u7684\u529f\u80fd\uff0c\u6709\u5f88\u591aC++\u7279\u6027\u662fSWIG\u672c\u8eab\u652f\u6301\u6216\u8005\u901a\u8fc7\u5e93\u652f\u6301\u7684\uff0c\u4e0d\u9700\u8981\u901a\u8fc7\u8f85\u52a9\u51fd\u6570\u5b9e\u73b0\u3002 \u540c\u6837\u7684\uff0c\u76f4\u63a5\u4e0a\u4f8b\u793a\u4ee3\u7801\uff1a 1 void set_transform ( Image * im , double m [ 4 ][ 4 ]); 1 2 3 4 5 6 7 8 9 >>> a = [ ... [ 1 , 0 , 0 , 0 ], ... [ 0 , 1 , 0 , 0 ], ... [ 0 , 0 , 1 , 0 ], ... [ 0 , 0 , 0 , 1 ]] >>> set_transform ( im , a ) Traceback ( most recent call last ): File \"<stdin>\" , line 1 , in ? TypeError : Type error . Expected _p_a_4__double \u53ef\u4ee5\u770b\u5230\uff0cset_transform\u662f\u4e0d\u80fd\u63a5\u53d7Python\u4e8c\u7ef4List\u7684\uff0c\u53ef\u4ee5\u7528\u8f85\u52a9\u51fd\u6570\u5e2e\u52a9\u5b9e\u73b0\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 % inline % { /* Note: double[4][4] is equivalent to a pointer to an array double (*)[4] */ double ( * new_mat44 ())[ 4 ] { return ( double ( * )[ 4 ]) malloc ( 16 * sizeof ( double )); } void free_mat44 ( double ( * x )[ 4 ]) { free ( x ); } void mat44_set ( double x [ 4 ][ 4 ], int i , int j , double v ) { x [ i ][ j ] = v ; } double mat44_get ( double x [ 4 ][ 4 ], int i , int j ) { return x [ i ][ j ]; } % } 1 2 3 4 5 6 >>> a = new_mat44 () >>> mat44_set ( a , 0 , 0 , 1.0 ) >>> mat44_set ( a , 1 , 1 , 1.0 ) >>> mat44_set ( a , 2 , 2 , 1.0 ) ... >>> set_transform ( im , a ) \u5f53\u7136\uff0c\u8fd9\u6837\u4f7f\u7528\u8d77\u6765\u8fd8\u4e0d\u591f\u4f18\u96c5\uff0c\u4f46\u53ef\u4ee5\u5de5\u4f5c\u4e86\uff0c\u63a5\u4e0b\u6765\u4ecb\u7ecd\u901a\u8fc7\u63d2\u5165\u989d\u5916\u7684Python\u4ee3\u7801\u6765\u8ba9\u4f7f\u7528\u4f18\u96c5\u8d77\u6765\u3002","title":"C/C++\u8f85\u52a9\u51fd\u6570"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#python","text":"\u4e3a\u4e86\u8ba9set_transform\u51fd\u6570\u63a5\u53d7Python\u4e8c\u7ef4list\u6216tuple\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u5b83\u7684Python\u4ee3\u7801\u7a0d\u52a0\u6539\u9020\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 void set_transform ( Image * im , double x [ 4 ][ 4 ]); ... /* Rewrite the high level interface to set_transform */ % pythoncode % { def set_transform ( im , x ) : a = new_mat44 () for i in range ( 4 ) : for j in range ( 4 ) : mat44_set ( a , i , j , x [ i ][ j ]) _example . set_transform ( im , a ) free_mat44 ( a ) % } 1 2 3 4 5 6 >>> a = [ ... [ 1 , 0 , 0 , 0 ], ... [ 0 , 1 , 0 , 0 ], ... [ 0 , 0 , 1 , 0 ], ... [ 0 , 0 , 0 , 1 ]] >>> set_transform ( im , a ) SWIG\u8fd8\u63d0\u4f9b\u4e86 %feature(\"shadow\") , %feature(\"pythonprepend\") , %feature(\"pythonappend\") \u6765\u652f\u6301\u91cd\u5199\u67d0\u51fd\u6570\u7684\u4ee3\u7406\u51fd\u6570\uff0c\u6216\u5728\u67d0\u51fd\u6570\u524d\u540e\u63d2\u5165\u989d\u5916\u4ee3\u7801\uff0c\u5728 %feature(\"shadow\") \u4e2d \u53ef\u7528 $action \u6765\u6307\u4ee3\u5bf9C++\u76f8\u5e94\u51fd\u6570\u7684\u8c03\u7528\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 % module example // Rewrite bar() python code % feature ( \"shadow\" ) Foo :: bar ( int ) % { def bar ( * args ) : #do something before $action #do something after % } class Foo { public : int bar ( int x ); } \u6216\u8005\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 % module example // Add python code to bar() % feature ( \"pythonprepend\" ) Foo :: bar ( int ) % { #do something before C\\+\\+ call % } % feature ( \"pythonappend\" ) Foo :: bar ( int ) % { #do something after C\\+\\+ call % } class Foo { public : int bar ( int x ); }","title":"\u63d2\u5165\u989d\u5916\u7684Python\u4ee3\u7801"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#extendc","text":"\u4f60\u53ef\u4ee5\u901a\u8fc7 %extend \u6307\u793a\u5668\u6269\u5c55C++\u7c7b\uff0c\u751a\u81f3\u53ef\u7528\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u91cd\u8f7dPython\u8fd0\u7b97\u7b26\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 % module example % { #include \"someheader.h\" % } struct Vector { double x , y , z ; }; % extend Vector { char * __str__ () { static char tmp [ 1024 ]; sprintf ( tmp , \"Vector(%g,%g,%g)\" , $self -> x , $self -> y , $self -> z ); return tmp ; } Vector ( double x , double y , double z ) { Vector * v = ( Vector * ) malloc ( sizeof ( Vector )); v -> x = x ; v -> y = y ; v -> z = z ; return v ; } Vector __add__ ( Vector * other ) { Vector v ; v . x = $self -> x + other -> x ; v . y = $self -> y + other -> y ; v . z = $self -> z + other -> z ; return v ; } }; 1 2 3 4 5 6 7 >>> v = example . Vector ( 2 , 3 , 4 ) >>> print v Vector ( 2 , 3 , 4 ) >>> v = example . Vector ( 2 , 3 , 4 ) >>> w = example . Vector ( 10 , 11 , 12 ) >>> print v + w Vector ( 12 , 14 , 16 ) \u6ce8\u610f \uff0c\u5728 %extend \u91cc this \u7528 $self \u4ee3\u66ff\u3002","title":"\u7528%extend\u6307\u793a\u5668\u6269\u5c55C++\u7c7b"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_4","text":"SWIG\u5c06char_ \u6620\u5c04\u4e3aPython\u7684\u5b57\u7b26\u4e32\uff0c\u4f46\u662fPython\u5b57\u7b26\u4e32\u662f\u4e0d\u53ef\u4fee\u6539\u7684\uff08immutable\uff09\uff0c\u5982\u679c\u67d0\u51fd\u6570\u6709\u4fee\u6539char_ \uff0c\u5f88\u53ef\u80fd\u5bfc\u81f4Python\u89e3\u91ca\u5668\u5d29\u6e83\u3002\u5bf9\u7531\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u4f7f\u7528SWIG\u5e93\u91cc\u7684 cstring.i \u3002","title":"\u5b57\u7b26\u4e32\u5904\u7406"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_5","text":"SWIG \u901a\u8fc7 %module \u6307\u793a\u5668\u6307\u5b9a Python \u6a21\u5757\u7684\u540d\u5b57","title":"\u6a21\u5757"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_6","text":"\u5168\u5c40\u51fd\u6570\u88ab\u5305\u88c5\u4e3a %module \u6307\u793a\u6a21\u5757\u4e0b\u7684\u51fd\u6570\uff0c\u5982\uff1a 1 2 % module example int add ( int a , int b ); 1 2 3 >>> import example >>> print example . add ( 3 , 4 ) 7","title":"\u51fd\u6570\u53ca\u56de\u8c03\u51fd\u6570"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_7","text":"SWIG \u521b\u5efa\u4e00\u4e2a\u7279\u6b8a\u7684\u53d8\u91cf cvar \u6765\u5b58\u53d6\u5168\u5c40\u53d8\u91cf\uff0c\u5982\uff1a 1 2 3 4 % module example % inline % { double density = 2.5 ; % } 1 2 3 >>> import example >>> print example . cvar . density 2.5 inline\u662f\u53e6\u4e00\u4e2a\u5e38\u89c1\u7684SWIG\u6307\u793a\u5668\uff0c\u7528\u6765\u5728\u63a5\u53e3\u6587\u4ef6\u4e2d\u63d2\u5165C/C++\u4ee3\u7801\uff0c\u5e76\u5c06\u4ee3\u7801\u4e2d\u58f0\u660e\u7684\u5185\u5bb9\u8f93\u51fa\u5230\u63a5\u53e3\u4e2d\u3002","title":"\u5168\u5c40\u53d8\u91cf"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_8","text":"\u7528 #define , enum \u6216\u8005 %constant \u6307\u5b9a\u5e38\u91cf\uff1a 1 2 3 4 5 6 7 #define PI 3.14159 #define VERSION \"1.0\" enum Beverage { ALE , LAGER , STOUT , PILSNER }; % constant int FOO = 42 ; % constant const char * path = \"/usr/local\" ;","title":"\u5e38\u91cf\u548c\u679a\u4e3e\u53d8\u91cf"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_9","text":"SWIG\u5b8c\u6574\u5730\u652f\u6301\u6307\u9488\uff1a 1 2 3 4 5 % module example FILE * fopen ( const char * filename , const char * mode ); int fputs ( const char * , FILE * ); int fclose ( FILE * ); 1 2 3 4 5 6 7 8 >>> import example >>> f = example . fopen ( \"junk\" , \"w\" ) >>> example . fputs ( \"Hello World \\n \" , f ) >>> example . fclose ( f ) >>> print f < Swig Object at _08a71808_p_FILE > >>> print str ( f ) _c0671108_p_FILE \u6307\u9488\u7684\u88f8\u503c\u53ef\u4ee5\u901a\u8fc7\u5c06\u6307\u9488\u5bf9\u8c61\u8f6c\u6362\u6210int\u83b7\u5f97\uff0c\u4e0d\u8fc7\uff0c\u65e0\u6cd5\u901a\u8fc7\u4e00\u4e2aint\u503c\u6784\u9020\u51fa\u4e00\u4e2a\u6307\u9488\u5bf9\u8c61\u3002 1 2 >>> print int ( f ) 135833352 0 \u6216 NULL \u88ab\u8868\u793a\u4e3aNone. \u5bf9\u6307\u9488\u7684\u7c7b\u578b\u8f6c\u6362\u6216\u8fd0\u7b97\u5fc5\u987b\u901a\u8fc7\u8f85\u52a9\u51fd\u6570\u5b8c\u6210\uff0c\u7279\u6b8a\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5bf9C++\u6307\u9488\u7684\u7c7b\u578b\u8f6c\u6362\uff0c\u5e94\u8be5\u7528C++\u65b9\u5f0f\u7684\u8f6c\u6362\uff0c\u800c\u4e0d\u662f\u7528C\u65b9\u5f0f\u7684\u8f6c\u6362\uff0c\u56e0\u4e3a\u5728\u8f6c\u6362\u65e0\u6cd5\u5b8c\u6210\u662f\uff0cC++\u65b9\u5f0f\u7684\u8f6c\u6362\u4f1a\u8fd4\u56deNULL\uff0c\u800cC\u65b9\u5f0f\u7684\u8f6c\u6362\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65e0\u6548\u7684\u6307\u9488\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 % inline % { /* C-style cast */ Bar * FooToBar ( Foo * f ) { return ( Bar * ) f ; } /* C\\+\\+-style cast */ Foo * BarToFoo ( Bar * b ) { return dynamic_cast < Foo *> ( b ); } Foo * IncrFoo ( Foo * f , int i ) { return f + i ; } \u5728C++\u4e2d\uff0c\u51fd\u6570\u53c2\u6570\u53ef\u80fd\u662f\u6307\u9488\uff0c\u5f15\u7528\uff0c\u5e38\u91cf\u5f15\u7528\uff0c\u503c\uff0c\u6570\u636e\u7b49\uff0cSWIG\u5c06\u8fd9\u4e9b\u7c7b\u578b\u7edf\u4e00\u4e3a\u6307\u9488\u7c7b\u578b\u5904\u7406\uff08\u901a\u8fc7\u76f8\u5e94\u7684\u5305\u88c5\u4ee3\u7801\uff09: 1 2 3 4 5 void spam1 ( Foo * x ); // Pass by pointer void spam2 ( Foo & x ); // Pass by reference void spam3 ( const Foo & x ); // Pass by const reference void spam4 ( Foo x ); // Pass by value void spam5 ( Foo x []); // Array of objects 1 2 3 4 5 6 >>> f = Foo () # Create a Foo >>> spam1 ( f ) # Ok. Pointer >>> spam2 ( f ) # Ok. Reference >>> spam3 ( f ) # Ok. Const reference >>> spam4 ( f ) # Ok. Value. >>> spam5 ( f ) # Ok. Array (1 element) \u8fd4\u56de\u503c\u662f\u4e5f\u540c\u6837\u7684\uff1a 1 2 3 4 Foo * spam6 (); Foo & spam7 (); Foo spam8 (); const Foo & spam9 (); \u8fd9\u4e9b\u51fd\u6570\u90fd\u4f1a\u7edf\u4e00\u4e3a\u8fd4\u56de\u4e00\u4e2aFoo\u6307\u9488\u3002 \u7ed3\u6784\u548c\u7c7b\uff0c\u4ee5\u53ca\u7ee7\u627f \u7ed3\u6784\u548c\u7c7b\u662f\u4ee5Python\u7c7b\u6765\u5305\u88c5\u7684\uff1a 1 2 3 struct Vector { double x , y , z ; }; 1 2 3 4 5 >>> v = example . Vector () >>> v . x = 3.5 >>> v . y = 7.2 >>> print v . x , v . y , v . z 7.8 - 4.5 0.0 \u5982\u679c\u7c7b\u6216\u7ed3\u6784\u4e2d\u5305\u542b\u6570\u7ec4\uff0c\u8be5\u6570\u7ec4\u662f\u901a\u8fc7\u6307\u9488\u6765\u64cd\u7eb5\u7684\uff1a 1 2 3 struct Bar { int x [ 16 ]; }; 1 2 3 >>> b = example . Bar () >>> print b . x _801861a4_p_int \u5bf9\u4e8e\u6570\u7ec4\u8d4b\u503c\uff0cSWIG\u4f1a\u505a\u6570\u636e\u7684\u503c\u62f7\u8d1d\uff1a 1 2 >>> c = example . Bar () >>> c . x = b . x # Copy contents of b.x to c.x \u4f46\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u7c7b\u6216\u7ed3\u6784\u4e2d\u5305\u542b\u53e6\u4e00\u4e2a\u7c7b\u6216\u7ed3\u6784\u6210\u5458\uff0c\u8d4b\u503c\u64cd\u4f5c\u5b8c\u5168\u548c\u6307\u9488\u64cd\u4f5c\u76f8\u540c\u3002 \u5bf9\u4e8e\u9759\u6001\u7c7b\u6210\u5458\u51fd\u6570\uff0c\u5728Python\u4e2d\u6709\u4e09\u79cd\u8bbf\u95ee\u65b9\u5f0f: 1 2 3 4 5 class Spam { public : static int bar ; static void foo (); }; 1 2 3 4 >>> example . Spam_foo () # Spam::foo() >>> s = example . Spam () >>> s . foo () # Spam::foo() via an instance >>> example . Spam . foo () # Spam::foo(). Python-2.2 only \u5176\u4e2d\u7b2c\u4e09\u79cd\u65b9\u5f0fPython2.2\u53ca\u4ee5\u4e0a\u7248\u672c\u624d\u652f\u6301\uff0c\u56e0\u4e3a\u4e4b\u524d\u7248\u672c\u7684Python\u4e0d\u652f\u6301\u9759\u6001\u7c7b\u6210\u5458\u51fd\u6570\u3002 \u9759\u6001\u7c7b\u6210\u5458\u53d8\u91cf\u4ee5\u5168\u5c40\u53d8\u91cf\u65b9\u5f0f\u83b7\u53d6\uff1a 1 >>> print example . cvar . Spam_bar SWIG\u652f\u6301C++\u7ee7\u627f\uff0c\u53ef\u4ee5\u7528Python\u5de5\u5177\u51fd\u6570\u9a8c\u8bc1\u8fd9\u4e00\u70b9\uff1a 1 2 3 4 5 6 7 class Foo { ... }; class Bar : public Foo { ... }; 1 2 3 4 5 6 7 >>> b = Bar () >>> instance ( b , Foo ) 1 >>> issubclass ( Bar , Foo ) 1 >>> issubclass ( Foo , Bar ) 0 \u540c\u65f6\uff0c\u5982\u679c\u6709\u5f62\u5982 void spam(Foo *f); \u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u4f20 b = Bar() \u8fdb\u53bb\u3002 SWIG\u652f\u6301\u591a\u7ee7\u627f\u3002","title":"\u6307\u9488\uff0c\u5f15\u7528\uff0c\u503c\u548c\u6570\u7ec4"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_10","text":"SWIG\u652f\u6301C++\u91cd\u8f7d\uff1a 1 2 void foo ( int ); void foo ( char * c ); 1 2 >>> foo ( 3 ) # foo(int) >>> foo ( \"Hello\" ) # foo(char *c) \u4f46\u662f\uff0cSWIG\u4e0d\u80fd\u652f\u6301\u6240\u6709\u5f62\u5f0f\u7684C++\u91cd\u8f7d\uff0c\u5982\uff1a 1 2 void spam ( int ); void spam ( short ); \u6216 1 2 void foo ( Bar * b ); void foo ( Bar & b ); \u8fd9\u79cd\u5f62\u5f0f\u7684\u58f0\u660e\u4f1a\u8ba9SWIG\u4ea7\u751f\u8b66\u544a\uff0c\u53ef\u4ee5\u901a\u8fc7\u91cd\u540d\u547d\u6216\u5ffd\u7565\u5176\u4e2d\u4e00\u4e2a\u6765\u907f\u514d\u8fd9\u4e2a\u8b66\u544a\uff1a 1 % rename ( spam_short ) spam ( short ); \u6216 1 % ignore spam ( short );","title":"\u91cd\u8f7d"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_11","text":"SWIG\u80fd\u591f\u81ea\u52a8\u5904\u7406\u8fd0\u7b97\u7b26\u91cd\u8f7d\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 class Complex { private : double rpart , ipart ; public : Complex ( double r = 0 , double i = 0 ) : rpart ( r ), ipart ( i ) { } Complex ( const Complex & c ) : rpart ( c . rpart ), ipart ( c . ipart ) { } Complex & operator = ( const Complex & c ); Complex operator += ( const Complex & c ) const ; Complex operator + ( const Complex & c ) const ; Complex operator - ( const Complex & c ) const ; Complex operator * ( const Complex & c ) const ; Complex operator - () const ; double re () const { return rpart ; } double im () const { return ipart ; } }; 1 2 3 4 5 6 7 8 9 10 11 12 >>> c = Complex ( 3 , 4 ) >>> d = Complex ( 7 , 8 ) >>> e = c + d >>> e . re () 10.0 >>> e . im () 12.0 >>> c += d >>> c . re () 10.0 >>> c . im () 12.0 \u5982\u679c\u91cd\u8f7d\u7684\u8fd0\u7b97\u7b26\u4e0d\u662f\u7c7b\u7684\u4e00\u90e8\u5206\uff0cSWIG\u65e0\u6cd5\u76f4\u63a5\u652f\u6301\uff0c\u5982\uff1a 1 2 3 4 5 class Complex { ... friend Complex operator + ( double , const Complex & c ); ... }; \u8fd9\u79cd\u60c5\u51b5\u4e0bSWIG\u662f\u62a5\u4e00\u4e2a\u8b66\u544a\uff0c\u4e0d\u8fc7\u8fd8\u662f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u7279\u6b8a\u7684\u51fd\u6570\uff0c\u6765\u5305\u88c5\u8fd9\u4e2a\u8fd0\u7b97\u7b26\uff1a 1 % rename ( Complex_add_dc ) operator + ( double , const Complex & ); \u4e0d\u8fc7\uff0c\u6709\u7684\u8fd0\u7b97\u7b26\u65e0\u6cd5\u6e05\u6670\u5730\u6620\u5c04\u5230Python\u8868\u793a\uff0c\u5982\u8d4b\u503c\u8fd0\u7b97\u7b26\uff0c\u50cf\u8fd9\u6837\u7684\u91cd\u8f7d\u4f1a\u88ab\u5ffd\u7565\u3002","title":"\u8fd0\u7b97\u7b26\u91cd\u8f7d"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_12","text":"\u540d\u5b57\u7a7a\u95f4\u4e0d\u4f1a\u6620\u5c04\u6210Python\u7684\u6a21\u5757\u540d\uff0c\u5982\u679c\u4e0d\u540c\u540d\u5b57\u7a7a\u95f4\u6709\u540c\u540d\u5b9e\u4f53\u8981\u66b4\u9732\u5230\u63a5\u53e3\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u91cd\u547d\u540d\u6307\u793a\u5668\u89e3\u51b3\uff1a 1 2 3 4 5 6 7 8 9 % rename ( Bar_spam ) Bar :: spam ; namespace Foo { int spam (); } namespace Bar { int spam (); }","title":"\u540d\u5b57\u7a7a\u95f4"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_13","text":"SWIG\u5bf9C/C++\u7684\u5305\u88c5\u662f\u4e8c\u8fdb\u5236\u7ea7\u522b\u7684\uff0c\u4f46C++\u6a21\u677f\u6839\u672c\u4e0d\u662f\u4e8c\u8fdb\u5236\u7ea7\u522b\u7684\u6982\u5ff5\uff0c\u6240\u4ee5\u5bf9\u6a21\u677f\u7684\u5305\u88c5\u9700\u8981\u5c06\u6a21\u677f\u5b9e\u4f8b\u5316\uff0cSWIG\u63d0\u4f9b%template\u6307\u793a\u5668\u652f\u6301\u8fd9\u9879\u529f\u80fd\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 % module example % { #include \"pair.h\" % } template < class T1 , class T2 > struct pair { typedef T1 first_type ; typedef T2 second_type ; T1 first ; T2 second ; pair (); pair ( const T1 & , const T2 & ); ~ pair (); }; % template ( pairii ) pair < int , int > ; 1 2 3 4 5 6 >>> import example >>> p = example . pairii ( 3 , 4 ) >>> p . first 3 >>> p . second 4 \u5982\u679c\u4f60\u8981\u540c\u65f6\u6620\u5c04\u4e00\u4e2a\u6a21\u677f\uff0c\u4ee5\u53ca\u4ee5\u8fd9\u4e2a\u6a21\u677f\u4e3a\u53c2\u6570\u7684\u53e6\u4e00\u4e2a\u6a21\u677f\uff0c\u8fd8\u8981\u505a\u4e00\u70b9\u7279\u6b8a\u7684\u5de5\u4f5c, \u6bd4\u5982\uff0c\u540c\u65f6\u6620\u5c04 pair< string, string > \u548c vector< pair <string, string> > \uff0c\u9700\u8981\u50cf\u4e0b\u9762\u8fd9\u6837\u505a\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 % module testpair % include \"std_string.i\" % include \"std_vector.i\" % include \"std_pair.i\" % { #include <string> #include <utility> #include <vector> using namespace std ; % } % template ( StringPair ) std :: pair < std :: string , std :: string > ; SWIG_STD_VECTOR_SPECIALIZE_MINIMUM ( StringPair , std :: pair < std :: string , std :: string > ); % template ( StringPairVector ) std :: vector < std :: pair < std :: string , std :: string > > ;","title":"\u6a21\u677f"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_14","text":"\u6709\u7684\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f\u667a\u80fd\u6307\u9488\uff0c\u4e3a\u4e86\u8c03\u7528\u8fd9\u6837\u7684\u51fd\u6570\uff0c\u53ea\u9700\u8981\u5bf9\u667a\u80fd\u6307\u9488\u7c7b\u578b\u505a\u76f8\u5e94\u58f0\u660e\uff1a 1 2 3 4 % module example ... % template ( SmartPtrFoo ) SmartPtr < Foo > ; ... 1 2 3 >>> p = example . CreateFoo () # CreatFool()\u8fd4\u56de\u4e00\u4e2aSmartPtr<Foo> >>> p . x = 3 # Foo::x >>> p . bar () # Foo::bar \u53ef\u4ee5\u901a\u8fc7 p.__deref__() \u5f97\u5230\u76f8\u5e94\u7684 Foo*","title":"\u667a\u80fd\u6307\u9488"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_15","text":"\u5bf9\u4e8e\u4f7f\u7528\u5f15\u7528\u8bb0\u6570\u60ef\u4f8b\u7684C++\u5bf9\u8c61\uff0cSWIG\u63d0\u4f9b\u4e86 %ref \u548c %unref \u6307\u793a\u5668\u652f\u6301\uff0c\u4f7f\u7528Python\u91cc\u4f7f\u7528\u65f6\u4e0d\u7528\u624b\u5de5\u8c03\u7528 ref \u548c unref \u51fd\u6570\u3002\u56e0\u4e3a\u6211\u4eec\u76ee\u524d\u6ca1\u6709\u4f7f\u7528\u5f15\u7528\u8bb0\u6570\u6280\u672f\uff0c\u5177\u4f53\u7ec6\u8282\u8fd9\u91cc\u4e0d\u8be6\u8ff0\u4e86\u3002","title":"\u5f15\u7528\u8bb0\u6570\u5bf9\u8c61\u652f\u6301"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_16","text":"SWIG\u662f\u901a\u8fc7\u5728Python\u91cc\u521b\u5efaC++\u76f8\u5e94\u7c7b\u578b\u7684\u4ee3\u7406\u7c7b\u578b\u6765\u5305\u88c5C++\u7684\uff0c\u6bcf\u4e2aPython\u4ee3\u7406\u5bf9\u8c61\u91cc\u6709\u4e00\u4e2a .thisown \u7684\u6807\u5fd7\uff0c\u8fd9\u4e2a\u6807\u5fd7 \u51b3\u5b9a\u6b64\u4ee3\u7406\u5bf9\u8c61\u662f\u5426\u8d1f\u8d23\u76f8\u5e94C++\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\uff1a\u5982\u679c .thisown \u8fd9\u4e2a\u6807\u5fd7\u4e3a 1 \uff0cPython\u89e3\u91ca\u5668\u5728\u56de\u6536Python\u4ee3\u7406\u5bf9\u8c61\u65f6\u4e5f\u4f1a\u9500\u6bc1\u76f8\u5e94\u7684 C++\u5bf9\u8c61\uff0c\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u6807\u5fd7\u6216\u8fd9\u4e2a\u6807\u5fd7\u7684\u503c\u662f 0 \uff0c\u5219Python\u4ee3\u7406\u5bf9\u8c61\u56de\u6536\u65f6\u4e0d\u5f71\u54cd\u76f8\u5e94\u7684C++\u5bf9\u8c61\u3002 \u5f53\u521b\u5efa\u5bf9\u8c61\uff0c\u6216\u901a\u8fc7\u503c\u8fd4\u56de\u65b9\u5f0f\u83b7\u5f97\u5bf9\u8c61\u65f6\uff0c\u4ee3\u7406\u5bf9\u8c61\u81ea\u52a8\u83b7\u5f97 .thisown \u6807\u5fd7\u3002\u5f53\u901a\u8fc7\u6307\u9488\u65b9\u5f0f\u83b7\u5f97\u5bf9\u8c61\u65f6\uff0c\u4ee3\u7406\u5bf9\u8c61 .thisown \u7684\u503c\u4e3a 0 \uff1a 1 2 3 4 5 6 class Foo { public : Foo (); Foo bar (); Foo * spam (); }; 1 2 3 4 5 6 7 8 9 10 >>> f = Foo () >>> f . thisown 1 >>> g = f . bar () >>> g . thisown 1 >>> f = Foo () >>> s = f . spam () >>> print s . thisown 0 \u5f53\u8fd9\u79cd\u884c\u4e3a\u4e0d\u662f\u671f\u671b\u7684\u884c\u4e3a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4eba\u5de5\u8bbe\u7f6e\u8fd9\u4e2a\u6807\u5fd7\u7684\u503c\uff1a 1 >>> v . thisown = 0","title":"\u5185\u5b58\u7ba1\u7406"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_17","text":"\u5f53\u4f60\u5e0c\u671b\u7528Python\u6269\u5c55\uff08\u7ee7\u627f\uff09C++\u7684\u7c7b\u578b\u7684\u65f6\u5019\uff0c\u4f60\u5c31\u9700\u8981\u8de8\u8bed\u8a00\u591a\u6001\u652f\u6301\u4e86\u3002SWIG\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8c03\u5ea6\u8005(director)\u7279\u6027\u652f\u6301\u6b64\u529f\u80fd\uff0c\u4f46\u6b64\u7279\u6027\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\uff0c\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u6253\u5f00\u6b64\u7279\u6027\uff1a \u9996\u5148\uff0c\u5728module\u6307\u793a\u5668\u91cc\u6253\u5f00 1 % module ( directors = \"1\" ) modulename \u5176\u6b21\uff0c\u901a\u8fc7%feature\u6307\u793a\u5668\u544a\u8bc9SWIG\u54ea\u4e9b\u7c7b\u548c\u51fd\u6570\u9700\u8981\u8de8\u8bed\u8a00\u591a\u6001\u652f\u6301\uff1a 1 2 3 4 5 6 7 8 // generate directors for all classes that have virtual methods % feature ( \"director\" ); // generate directors for all virtual methods in class Foo % feature ( \"director\" ) Foo ; // generate a director for just Foo::bar() % feature ( \"director\" ) Foo :: bar ; \u53ef\u4ee5\u4f7f\u7528 %feature(\"nodirector\") \u6307\u793a\u5668\u5173\u95ed\u67d0\u4e2a\u7c7b\u578b\u6216\u51fd\u6570\u7684\u7684\u8de8\u8bed\u8a00\u591a\u6001\u652f\u6301\uff1a 1 2 % feature ( \"director\" ) Foo ; % feature ( \"nodirector\" ) Foo :: bar ;","title":"\u8de8\u8bed\u8a00\u591a\u6001"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#typemaps","text":"\u7c7b\u578b\u6620\u5c04\u662fSWIG\u6700\u6838\u5fc3\u7684\u4e00\u90e8\u5206\uff0c\u7c7b\u578b\u6620\u5c04\u5c31\u662f\u544a\u8bc9SWIG\u5bf9\u67d0\u4e2aC\u7c7b\u578b\uff0c\u751f\u6210\u4ec0\u4e48\u6837\u7684\u4ee3\u7801\u3002\u4e0d\u8fc7\uff0cSWIG\u7684\u6587\u6863\u91cc\u8bf4\u7c7b\u578b\u6620\u5c04\u662fSWIG\u7684\u9ad8\u7ea7\u81ea\u5b9a\u4e49\u90e8\u5206\uff0c\u4e0d\u662f\u4f7f\u7528SWIG\u9700\u8981\u7406\u89e3\u7684\uff0c\u9664\u975e\u4f60\u8981\u63d0\u5347\u81ea\u5df1\u7684NB\u7b49\u7ea7 \u4ee5\u4e0b\u7684\u7c7b\u578b\u6620\u5c04\u53ef\u7528\u4e8e\u5c06\u6574\u6570\u4ecePython\u8f6c\u6362\u4e3aC: 1 2 3 4 5 6 7 8 9 10 11 % module example % typemap ( in ) int { $1 = ( int ) PyLong_AsLong ( $input ); printf ( \"Received an integer : %d \\n \" , $1 ); } % inline % { int add ( int a , int b ){ return a + b ; } % } 1 2 3 4 5 >>> import example >>> example . add ( 3 , 4 ) Received an integer : 3 Received an integer : 4 7","title":"\u7c7b\u578b\u6620\u5c04(Typemaps)"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#swig_1","text":"SWIG\u63d0\u4f9b\u4e86\u4e00\u7ec4\u5e93\u6587\u4ef6\uff0c\u7528\u4ee5\u652f\u6301\u5e38\u7528\u7684\u5305\u88c5\uff0c\u5982\u6570\u7ec4\uff0c\u6807\u51c6\u5e93\u7b49\u3002\u53ef\u4ee5\u5728\u63a5\u53e3\u6587\u4ef6\u4e2d\u5f15\u5165\u8fd9\u4e9b\u5e93\u6587\u4ef6\u3002\u6bd4\u5982\uff0c\u5728 %include \"std_string.i\" \u540e\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u7ed9\u9700\u8981string\u53c2\u6570\u6570\u7684\u51fd\u6570\u4f20Python\u5b57\u7b26\u4e32\u4e86\u3002\u5bf9 \"std_vector.i\" \u4e3e\u4f8b\u5982\u4e0b\uff1a 1 2 3 4 5 6 % module example % include \"std_vector.i\" namespace std { % template ( vectori ) vector < int > ; }; 1 2 3 4 5 >>> from example import * >>> v = vectori () >>> v . push_back ( 1 ) >>> print v . size () 1","title":"SWIG\u5e93"},{"location":"Machine_Learning/%E4%BD%BF%E7%94%A8SWIG%20%E6%8F%90%E4%BE%9Bpython%E4%B8%8Ec%2B%2B%E9%80%9A%E4%BF%A1%20%E4%BB%A5%E5%A4%87%E5%8A%A0%E9%80%9F%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/#_18","text":"SWIG\u548cPython: http://www.swig.org/Doc1.3/SWIGDocumentation.html#Python SWIG\u57fa\u7840\uff1a http://www.swig.org/Doc1.3/SWIGDocumentation.html#SWIG SWIG\u548cC++: http://www.swig.org/Doc1.3/SWIGDocumentation.html#SWIGPlus","title":"\u53c2\u8003\u8d44\u6599"},{"location":"Work/","text":"Introduction Designed to document some cutting-edge novelty development techniques","title":"Index"},{"location":"Work/#introduction","text":"Designed to document some cutting-edge novelty development techniques","title":"Introduction"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/","text":"\u80cc\u666f \u968f\u7740\u8d22\u7ecf\u652f\u4ed8\u4e1a\u52a1\u7684\u5feb\u901f\u53d1\u5c55\uff0c\u8003\u8651\u5230\u672a\u6765\u8ba2\u5355\u91cf\u6301\u7eed\u589e\u957f\uff0c\u5728\u7ebf\u5b58\u50a8\u9047\u5230\u66f4\u5927\u7684\u6311\u6218\uff0c\u9700\u63d0\u524d\u505a\u597d\u89c4\u5212\u3002\u76ee\u524d\u8d22\u7ecf\u652f\u4ed8\u4e3b\u8981\u4e1a\u52a1\u90fd\u662f\u4f7f\u7528 mysql\uff08InnoDB\uff09\u4f5c\u4e3a\u6570\u636e\u5b58\u50a8\uff0c\u56e0\u5386\u53f2\u8ba2\u5355\u4fe1\u606f\u8bbf\u95ee\u9891\u7387\u4f4e\u5e76\u5360\u7528\u4e86\u5927\u91cf\u6570\u636e\u5e93\u5b58\u50a8\u7a7a\u95f4\uff0c\u671f\u671b\u5c06\u5386\u53f2\u6570\u636e\u8ddf\u751f\u4ea7\u6700\u65b0\u4ea4\u6613\u6570\u636e\u8fdb\u884c\u5206\u79bb\uff0c\u5f53\u524d\u6570\u636e\u5e93\u4fdd\u7559\u6700\u8fd1\u4e00\u6bb5\u65f6\u95f4\u7684\u6570\u636e\u4f5c\u4e3a\u70ed\u5e93\uff0c\u5386\u53f2\u4ea4\u6613\u5b58\u5165\u53e6\u4e00\u4e2a\u6570\u636e\u5e93\u538b\u7f29\u5b58\u50a8\u4f5c\u4e3a\u51b7\u5e93(rocksdb)\uff0c\u5373\u6570\u636e\u5e93\u51b7\u70ed\u5206\u79bb\u3002\u6b64\u4e3e\u5c06\u4f1a\u6781\u5927\u7684\u8282\u7701\u6570\u636e\u5e93\u8bbe\u5907\u6210\u672c\uff0c\u51cf\u5c11\u56e0\u5728\u7ebf\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\u6269\u5bb9\u5bfc\u81f4\u505c\u670d\u4e0d\u53ef\u7528\u7684\u65f6\u957f\uff0c\u4ee5\u4e0b\u57fa\u4e8e\u8d22\u7ecf\u652f\u4ed8\u7684\u7edf\u4e00\u4ea4\u6613\u7cfb\u7edf\u73b0\u72b6\u505a\u7684\u76f8\u5173\u6848\u4f8b\u5206\u6790\u4ec5\u4f9b\u5927\u5bb6\u53c2\u8003\u3002 \u65b9\u6848 \u6280\u672f\u9009\u578b \u67b6\u6784\u56fe \u65b9\u6848\u5206\u6790 \u56e0\u4e1a\u52a1\u573a\u666f\u6bd4\u8f83\u590d\u6742\uff0c\u5982\u679c\u6309\u7167\u4e1a\u52a1\u573a\u666f\u68b3\u7406\u5de5\u4f5c\u91cf\u5c06\u51e0\u4f55\u500d\u7684\u589e\u957f\uff0c\u6362\u79cd\u7ef4\u5ea6\uff0c\u6570\u636e\u5e93\u76f8\u5173\u7684\u64cd\u4f5c\u65e0\u975e\u5c31\u662f\u67e5\u8be2\u3001\u63d2\u5165\u3001\u66f4\u65b0\uff0c\u53ea\u8981\u80fd\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u5b9e\u73b0\u4fdd\u8bc1\u67e5\u8be2\u3001\u63d2\u5165\u3001\u66f4\u65b0\u8fd9\u4e9b\u6570\u636e\u5e93\u57fa\u672c\u64cd\u4f5c\u5728\u589e\u52a0\u51b7\u70ed\u5206\u79bb\u540e\u529f\u80fd\u4e0d\u53d7\u5f71\u54cd\u5373\u53ef\u3002\u8d22\u7ecf\u652f\u4ed8\u4ee3\u7801\u6709\u7edf\u4e00\u7684\u5206\u5c42\u89c4\u8303\uff0c\u5bf9\u6570\u636e\u5e93\u64cd\u4f5c\u5168\u90e8\u6536\u655b\u5c01\u88c5\u81f3\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\uff0c\u56e0\u6b64\u6bd4\u8f83\u597d\u6539\u9020\uff0c\u4e0d\u6269\u5bb9\u7684\u60c5\u51b5\u4e0b\uff0c\u70ed\u5e93\u9884\u8ba1\u4fdd\u7559\u6700\u8fd1 X \u5929\uff08\u65f6\u95f4\u53ef\u8c03\uff09\u6570\u636e\uff0c X \u5929\u524d\u7684\u6570\u636e\u5f52\u6863\u5230\u51b7\u5e93\u3002 \u65b9\u6848\u5bf9\u6bd4 \u65b9\u6848\u4e00\uff1a \u80fd\u591f\u5f7b\u5e95\u6570\u636e\u5e93\u5b58\u50a8\u538b\u529b\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4f46\u662f\u5bf9\u51b7\u5e93\u6027\u80fd\u8981\u6c42\u592a\u9ad8\uff0c\u5982\u679c\u6d89\u53ca\u7684\u63d2\u5165\u3001\u66f4\u65b0\u3001\u67e5\u8be2\u80fd\u591f\u6839\u636e\u5355\u53f7\u8fc7\u6ee4\u65f6\u95f4\uff0c\u964d\u4f4e\u5bf9\u51b7\u5e93\u7684\u4f9d\u8d56\u3002 \u65b9\u6848\u4e8c\uff1a \u9002\u7528\u4e8e\u51b7\u5e93\u6027\u80fd\u8f83\u4f4e\uff0c\u6d89\u53ca\u7684\u63d2\u5165\u3001\u66f4\u65b0\u3001\u67e5\u8be2\u5927\u90e8\u5206\u65e0\u6cd5\u6839\u636e\u5355\u53f7\u8fc7\u6ee4\u65f6\u95f4\u65f6\uff0c\u9700\u8981\u70ed\u5e93\u5f52\u6863\u8868\u4e2d\u8f6c\u8fc7\u6ee4\u3002 \u65b9\u6848\u4e09\uff1a \u5982\u679c\u7cfb\u7edf\u6d89\u53ca\u7684\u573a\u666f\u6bd4\u8f83\u7b80\u5355\uff0c\u5386\u53f2\u8ba2\u5355\u540e\u7eed\u4e5f\u65e0\u53d8\u66f4\uff0c\u53ef\u4ee5\u6309\u573a\u666f\u8fdb\u884c\u5f52\u6863\u3002 \u65b9\u6848\u9009\u62e9 \u4ea4\u6613\uff1a \u4ea4\u6613\u8868\u8d1f\u8d23\u8bb0\u5f55\u5546\u6237\u8ba2\u5355\u4e0e\u8d22\u7ecf\u652f\u4ed8\u5185\u90e8\u8ba2\u5355\u7684\u6620\u5c04\u3001\u4ea4\u6613\u91d1\u989d\u3001\u4e70\u65b9\u548c\u5356\u65b9\u7b49\u91cd\u8981\u4fe1\u606f\uff0c\u6700\u91cd\u8981\u7684\u529f\u80fd\u662f\u9632\u6b62\u91cd\u590d\u4ea4\u6613\u3002\u4f46\u662f\u51b7\u5e93\u76f8\u6bd4\u70ed\u5e93\u6027\u80fd\u8f83\u4f4e\uff0c\u5546\u6237\u8ba2\u5355\u53f7\u65e0\u56fa\u5b9a\u89c4\u5219\uff0c\u65e0\u6cd5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\u8fc7\u6ee4\u51cf\u5c11\u51b7\u5e93\u538b\u529b\uff0c\u800c\u70ed\u5e93 cpu \u4f7f\u7528\u7387\u5f88\u4f4e\uff0c\u70ed\u5e93\u6570\u636e\u5e93\u8ba1\u7b97\u4e0d\u662f\u74f6\u9888\uff0c\u56e0\u6b64\u4ea4\u6613\u9009\u7528\u65b9\u6848\u4e8c\u3002\u4ea4\u6613\u5f52\u6863\u8868\u4e3b\u8981\u610f\u4e49\u5728\u4e8e\u51cf\u5c11\u5728\u7ebf\u4ea4\u6613\u5bf9\u51b7\u5e93\u7684\u4f9d\u8d56\u3002 \u652f\u4ed8\uff1a \u652f\u4ed8\u8868\u8d1f\u8d23\u4fdd\u5b58\u4ea4\u6613\u5355\u7528\u4e86\u4ec0\u4e48\u652f\u4ed8\u65b9\u5f0f\u3001\u8be5\u652f\u4ed8\u65b9\u5f0f\u9700\u8981\u6263\u591a\u5c11\u94b1\u3001\u4ece\u54ea\u91cc\u6263\u3001\u6263\u5230\u54ea\u91cc\u53bb\u7b49\u4fe1\u606f\uff0c\u6d89\u53ca\u7684\u8ba2\u5355\u67e5\u8be2\u3001\u66f4\u65b0\u3001\u63d2\u5165\u90fd\u53ef\u4ee5\u6839\u636e\u4ea4\u6613\u5355\u53f7\u6216\u8005\u652f\u4ed8\u5355\u53f7\u8fdb\u884c\u5224\u65ad\u65f6\u95f4\u51cf\u5c11\u5bf9\u51b7\u5e93\u7684\u67e5\u8be2\uff0c\u56e0\u6b64\u652f\u4ed8\u9009\u62e9\u65b9\u6848\u4e00\u3002 \u57fa\u672c\u539f\u5219 \u4e3a\u4e86\u5145\u5206\u7684\u4fdd\u8bc1 0 \u4e8b\u6545\uff0c0 \u8d44\u635f\uff0c\u65b9\u6848\u8bbe\u8ba1\u65f6\uff0c\u63d0\u51fa\u4e86\u4ee5\u4e0b\u57fa\u672c\u539f\u5219\uff0c\u5728\u7814\u53d1\u3001\u6d4b\u8bd5\u3001\u4ee3\u7801\u8bc4\u5ba1\u65f6\u5747\u53c2\u8003\u4ee5\u4e0b\u57fa\u672c\u539f\u5219\u8fdb\u884c\u5c42\u5c42\u628a\u63a7\uff0c\u53ef\u4ee5\u6709\u6548\u7684\u907f\u514d\u751f\u4ea7\u4e8b\u6545\u7684\u53d1\u751f\u3002 \u6570\u636e\u63d2\u5165\u552f\u4e00\u6027\uff1a \u70ed\u5e93\u5f52\u6863\u8868\u7684\u6240\u6709\u552f\u4e00\u952e\u5fc5\u987b\u8ddf\u8981\u5f52\u6863\u7684\u70ed\u5e93\u8868\u4fdd\u6301\u4e00\u81f4\u3002 \u70ed\u5e93\u5f52\u6863\u8bb0\u5f55\u5df2\u5b58\u5728\u7684\u8ba2\u5355\uff0c\u51b7\u5e93\u5fc5\u987b\u6709\u76f8\u5e94\u6570\u636e\uff0c \u51b7\u5e93\u63d2\u5165: \u5148 insert \u51b7\u5e93\u6210\u529f\u540e \u518d insert \u70ed\u5e93\u5f52\u6863\u8868 \u51b7\u5e93\u66f4\u65b0\uff1a\u66f4\u65b0\u51b7\u5e93\u6570\u636e\uff0c\u4f7f\u7528\u540c\u4e00\u4e2a\u4e8b\u52a1 \u5148 delete \u518d insert \u51b7\u5e93\u6570\u636e \u70ed\u5e93\u5220\u9664\uff1a\u5220\u9664\u70ed\u5e93\u6570\u636e\u65f6\u4f7f\u7528\u51b7\u5e93\u6570\u636e\u5f53 where \u6761\u4ef6\uff0c\u6240\u6709\u70ed\u5e93\u5b57\u6bb5\uff08\u5305\u542b ID\uff09\u6761\u4ef6\u90fd\u6ee1\u8db3\u540e\u624d\u80fd\u5220\u9664\u6210\u529f\u3002 \u6570\u636e\u66f4\u65b0\u4e00\u81f4\u6027\uff1a \u51b7\u5e93\u65e0 update \u64cd\u4f5c\uff0c\u6240\u6709\u7684\u66f4\u65b0\u64cd\u4f5c\u5fc5\u987b\u5728\u70ed\u5e93\u8fdb\u884c\uff0c\u5982\u679c\u6570\u636e\u9700\u8981\u66f4\u65b0\u5e76\u4e14\u4ec5\u5728\u51b7\u5e93\u5b58\u5728\uff0c\u9700\u540c\u6b65\u5230\u70ed\u5e93\u540e\uff0c\u518d\u5728\u70ed\u5e93\u5b8c\u6210\u66f4\u65b0\u3002 \u51b7\u5e93\u70ed\u5e93\u6570\u636e\u540c\u65f6\u5b58\u5728\u65f6\uff0c\u4ee5\u70ed\u5e93\u6570\u636e\u4e3a\u51c6\u3002\u51b7\u5e93\u7684\u6570\u636e\u6765\u6e90\u53ea\u6709\u70ed\u5e93\u6570\u636e\u540c\u6b65\u5230\u51b7\u5e93\u3002 \u6570\u636e\u4ece\u51b7\u5e93\u540c\u6b65\u5230\u70ed\u5e93\u65f6\uff0c\u64cd\u4f5c\u5f52\u6863\u8868\u548c\u4ea4\u6613\u8868\u9700\u4fdd\u8bc1\u5728\u540c\u4e00\u4e2a\u662f\u4e8b\u52a1\u5185\u5b8c\u6210\uff0c\u6d89\u53ca\u5230\u7684\u67e5\u8be2\u5fc5\u987b\u4f7f\u7528\u5199\u5e93\u3002 \u6570\u636e\u67e5\u8be2\u51c6\u786e\u6027\uff1a \u5355\u7b14\u67e5\u8be2\uff1a \u67e5\u8be2\u70ed\u5e93\u6570\u636e\u4e0d\u5b58\u5728\u65f6\uff0c\u4e0d\u5b58\u5728\u518d\u6b21\u67e5\u8be2\u51b7\u5e93\uff08\u5982\u679c\u5355\u53f7\u4e2d\u53ef\u4ee5\u5224\u65ad\u8ba2\u5355\u65e5\u671f\uff0c\u53ef\u518d\u589e\u52a0\u4e00\u5c42\u65e5\u671f\u8fc7\u6ee4\uff0c\u51cf\u5c11\u51b7\u5e93\u67e5\u8be2\uff09 \u6279\u91cf\u67e5\u8be2\uff1a \u51b7\u5e93\u70ed\u5e93\u6570\u636e\u90fd\u5b58\u5728\u65f6\u4f18\u5148\u8fd4\u56de\u70ed\u5e93\u6570\u636e\u3002 \u6279\u91cf\u67e5\u8be2\uff1a \u5408\u5e76\u51b7\u70ed\u5e93\u6570\u636e\u540e\uff0c\u9700\u770b\u539f\u5148\u67e5\u8be2\u7684\u63a5\u53e3\u987a\u5e8f\u662f\u5426\u6709\u8981\u6c42\uff0c\u5982\u679c\u5bf9\u987a\u5e8f\u6709\u8981\u6c42\u5408\u5e76\u540e\u8fd8\u9700\u6392\u5e8f\u3002 \u51cf\u5c11\u51b7\u5e93\u538b\u529b\uff1a \u51b7\u5e93\u6027\u80fd\u8f83\u4f4e\uff0c\u7ebf\u4e0a\u5b9e\u65f6\u4ea4\u6613\u5c3d\u53ef\u80fd\u51cf\u5c11\u5bf9\u51b7\u5e93\u7684\u67e5\u8be2\u548c\u4f9d\u8d56\uff08\u53ef\u901a\u8fc7\u4ea4\u6613\u5355\u53f7\u4e2d\u7684\u65e5\u671f\u6216\u8005\u5f52\u6863\u8868\u8fdb\u884c\u8fc7\u6ee4\uff09\u3002 \u9650\u5236\u5929\u6570\u63a7\u5236\uff1a \u6570\u636e\u5e93\u4ea4\u4e92 \u5c42\u5929\u6570\u63a7\u5236 \u4e3a n\uff0c\u5f52\u6863\u4efb\u52a1\u63a7\u5236\u7684\u5929\u6570\u4e3a m\uff0c\u8981\u6c42 m>n\u3002\u4f8b\u5982\uff0cmode \u5c42 \u6709\u4e9b\u5224\u65ad\u8ba2\u5355\u8d85\u8fc7 n \u5929\u7684\u624d\u4f1a\u67e5\u8be2\u51b7\u5e93\uff0c\u5f52\u6863\u4efb\u52a1\u53ea\u5f52\u6863 m \u5929\u524d\u7684\u5386\u53f2\u6570\u636e\uff0c\u5206\u5f00\u63a7\u5236\u53ef\u4ee5\u9632\u6b62\u56e0\u8c03\u6574\u5f52\u6863\u5929\u6570\u5bfc\u81f4\u6570\u636e\u67e5\u4e0d\u5230\u60c5\u51b5\u3002 \u5177\u4f53\u7ec6\u8282 \u5f52\u6863\u8868\u7ed3\u6784 \u5f52\u6863\u8868\u72b6\u6001\u6d41\u8f6c \u4e00\u81f4\u6027\u5220\u9664 \u4f7f\u7528\u51b7\u5e93\u8bb0\u5f55\u7684\u6240\u6709\u5b57\u6bb5\u5f53\u4f5c\u5220\u9664\u70ed\u5e93\u7684 where \u6761\u4ef6\uff08\u5305\u542b\u81ea\u589e id\uff09,\u5220\u9664\u70ed\u5e93\u548c\u66f4\u65b0\u70ed\u5e93\u5f52\u6863\u72b6\u6001\u4e3a\u51b7\u5e93\u9700\u5728\u4e00\u4e2a\u4e8b\u7269\uff0c\u4efb\u4e00\u5931\u8d25\u5219\u56de\u6eda\u3002 \u4ea4\u6613\u53ca\u652f\u4ed8\u4efb\u52a1\uff08\u6570\u636e\u5f52\u6863\u3001\u5220\u9664\u3001\u515c\u5e95\uff09 \u5f52\u6863\u4efb\u52a1 \u67e5\u8be2\u70ed\u5e93\u8ba2\u5355\u8868 X \uff08\u65f6\u95f4\u53ef\u8c03\uff09\u5929\u524d\u7684\u8ba2\u5355\uff0c\u540c\u6b65\u70ed\u5e93\u8ba2\u5355\u5230\u51b7\u5e93\uff0c\u63d2\u5165\u70ed\u5e93\u5f52\u6863\u8868\uff0c\u5f52\u6863\u72b6\u6001\u4e3a\u5904\u7406\u4e2d\uff0c\u653e\u5165\u5ef6\u8fdf\u5220\u9664 mq \u6d88\u606f\u3002 \u5f52\u6863\u5220\u9664 TASK \u5e38\u9a7b\u670d\u52a1 TASK \u6d88\u8d39\u5220\u9664 mq \u6d88\u606f\uff0crpc \u8c03\u7528\u4ea4\u6613\u652f\u4ed8\u63d0\u4f9b\u7684\u5220\u9664\u63a5\u53e3\uff0c\u652f\u6301\u672c\u5730\u9650\u6d41\u80fd\u529b\u3002 \u515c\u5e95\u4efb\u52a1\uff1a \u4e3b\u8981\u529f\u80fd\uff1a \u67e5\u8be2\u70ed\u5e93\u5f52\u6863\u8868\u4e2d\u5904\u7406\u4e2d\u4fee\u6539\u65f6\u95f4\u8d85\u8fc7\u89c4\u5b9a\u65f6\u95f4\u7684\u8ba2\u5355\u5f3a\u5236\u6267\u884c\u5220\u9664\u64cd\u4f5c\u3002\u4e3b\u8981\u7528\u6765\u9632\u6b62 mq \u5f02\u5e38\u6216\u8005\u65e5\u5e38\u4e22\u5931\u6d88\u606f\u65f6\uff0c\u4f7f\u7528\u515c\u5e95\u4efb\u52a1\u53ef\u4ee5\u8865\u507f\u6d88\u5316\u5904\u7406\u4e2d\u7684\u5f52\u6863\u8bb0\u5f55\u3002 \u6267\u884c\u903b\u8f91 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 \u6570\u636e\u5f52\u6863\u4efb\u52a1 \uff08 \u6bcf\u5929\u542f\u52a8\u4e00\u6b21 \uff09 for { \u521d\u59cb\u5316\u67e5\u8be2\u65f6\u95f4\u8303\u56f4\u548c\u5206\u9875 for { \u67e5\u8be2 X \u5929\u524d\u4ea4\u6613\u5355 limit 1000 ( \u7d22\u5f15\u6392\u5e8f \uff0c \u6eda\u52a8\u65f6\u95f4\u67e5\u8be2 ) if \u8bb0\u5f55\u5b58\u5728 \u5e76\u4e14 \u6761\u6570 = 1000 { for \u5bf9\u4e8e\u6bcf\u6761\u8bb0\u5f55 { // \u542f\u7528x\u4e2a\u534f\u7a0b\u5904\u7406 \u4ea4\u6613\u5355\u5e42\u7b49\u5199\u5165\u51b7\u5e93 \uff08 \u4e0d\u4fdd\u8bc1\u6700\u65b0 \uff0c \u53ea\u4fdd\u8bc1\u51b7\u5e93\u6570\u636e\u5b58\u5728\u6027 \uff09 \u5e42\u7b49\u5199\u5f52\u6863\u8bb0\u5f55\u8868 \uff08 type : PROCESSING \uff0c \u70ed\u5e93\u6570\u636e\u5220\u9664\u65f6\u518d\u66f4\u65b0\u4e3aCOLD \uff0c \u5f52\u6863\u8bb0\u5f55\u5df2\u5b58\u5728HOT\u72b6\u6001\u66f4\u65b0\u4e3aPROCESSING \uff09 \u53d1MQ\u5ef6\u8fdf\u6d88\u606f \uff0c X min \uff08 \u53ef\u914d\u7f6e \uff09 \u540e\u5220\u9664\u70ed\u5e93\u6570\u636e } } if \u6761\u6570 = 1000 { continue } \u65f6\u95f4\u8303\u56f4\u5f80\u4e0b\u63a8\u8fdb //\u8bb0\u5f55\u4e0d\u5b58\u5728 if \u7ed3\u675f\u65f6\u95f4\u8d85\u8fc7\u89c4\u5b9a\u65f6\u95f4 { break ( \u8df3\u51fa\u5faa\u73af \uff0c \u4efb\u52a1\u7ed3\u675f ) } redis\u8bb0\u5f55\u5f53\u524d\u67e5\u8be2\u6761\u4ef6 \uff0c \u65b9\u4fbf\u540e\u7eed\u4efb\u52a1\u91cd\u8dd1\u6062\u590d\u7ee7\u7eed } } \u5220\u9664\u70ed\u5e93\u6570\u636e \uff0c \u6d88\u8d39MQ \u6d88\u8d39MQ\u8bb0\u5f55 { \u67e5\u8be2\u51b7\u5e93 \u6570\u636e\u4e00\u81f4\u6027\u5220\u9664 \uff08 \u5f00\u542f\u4e8b\u52a1 \u6761\u4ef6\u5220\u9664\u70ed\u5e93\u6570\u636e \uff0c \u66f4\u65b0\u5f52\u6863\u8bb0\u5f55\u8868\u72b6\u6001\u4e3aCOLD \u7ed3\u675f\u4e8b\u52a1 \uff09 \u4e00\u81f4\u6027\u5220\u9664\u70ed\u5e93\u5931\u8d25 \uff0c \u540c\u6b65\u70ed\u5e93\u6570\u636e\u5230\u51b7\u5e93 \uff0c \u6570\u636e\u4e00\u81f4\u6027\u5220\u9664 } \u515c\u5e95\u8865\u507f\u4efb\u52a1 \uff08 \u6bcf30\u5206\u949f\u542f\u52a8\u4e00\u6b21 \uff09 { \u67e5\u8be2\u5f52\u6863\u8bb0\u5f55\u8868\u4e2d\u72b6\u6001\u4e3aPROCESSING \uff0c \u4fee\u6539\u65f6\u95f4\u4e3aX + Y min\u524d\u7684\u8bb0\u5f55 limit 1000 if \u4e0d\u5b58\u5728 { break } for \u5bf9\u4e8e\u6bcf\u6761\u8bb0\u5f55 \u67e5\u8be2\u51b7\u5e93 \u6570\u636e\u4e00\u81f4\u6027\u5220\u9664 \uff08 \u5f00\u542f\u4e8b\u52a1 \u6761\u4ef6\u5220\u9664\u70ed\u5e93\u6570\u636e \uff0c \u66f4\u65b0\u5f52\u6863\u8bb0\u5f55\u8868\u72b6\u6001\u4e3aCOLD \u7ed3\u675f\u4e8b\u52a1 \uff09 \u4e00\u81f4\u6027\u5220\u9664\u70ed\u5e93\u5931\u8d25 \uff0c \u540c\u6b65\u70ed\u5e93\u6570\u636e\u5230\u51b7\u5e93 \uff0c \u6570\u636e\u4e00\u81f4\u6027\u5220\u9664 } } \u5f52\u6863\u4efb\u52a1\u67e5\u8be2\u65f6\u95f4\u6eda\u52a8\u673a\u5236\uff1a \u65f6\u95f4\u8303\u56f4\u7b2c\u4e00\u6b21\u8d77\u59cb\u65f6\u95f4\u4e3a\u56fa\u5b9a\u65e5\u671f\uff08\u8d22\u7ecf\u652f\u4ed8\u8ba2\u5355\u6700\u65e9\u70b9\u65e5\u671f\uff09\uff0c\u7ed3\u675f\u65f6\u95f4\u4e3a\u6307\u5b9a\u65e5\u671f\uff0c\u4e0b\u6b21\u5f00\u59cb\u65f6\u95f4\u7b49\u4e8e\u4e0a\u6b21\u7ed3\u675f\u65f6\u95f4\uff0c\u7ed3\u675f\u65f6\u95f4\u4e3a\u4e0a\u6b21\u7ed3\u675f\u65f6\u95f4\u52a0\u4e0a\u6307\u5b9a\u65f6\u95f4\u8303\u56f4\uff09\u3002\u6bcf\u6b21\u67e5\u8be2\u4e0b\u4e00\u4e2a\u65f6\u95f4\u7a97\u53e3\u65f6 redis \u4fdd\u5b58\u4fe1\u606f\uff0c\u6307\u5b9a\u65e5\u671f\uff0c\u5f53\u5929\u4efb\u52a1\u7684\u65f6\u95f4\u8303\u56f4\uff0c\u5206\u9875\u6570\u3002 \u5f52\u6863\u4efb\u52a1\u5e76\u53d1\u5904\u7406\uff1a \u9700\u652f\u6301\u591a\u4efb\u52a1\u5206\u7247\u5e76\u53d1\u5904\u7406 \u63d0\u5347\u5168\u5929\u5f52\u6863\u8ba2\u5355\u91cf\uff1a \u4e3a\u4e86\u4e0d\u5f71\u54cd\u5728\u7ebf\u4ea4\u6613\uff0c\u5168\u5929 24 \u5c0f\u65f6 \u533a\u5206 \u4ea4\u6613\u9ad8\u5cf0\u3001\u4f4e\u5cf0\u3001\u65e5\u5e38 \u4e09\u4e2a\u4e0d\u540c\u65f6\u95f4\u6bb5\uff0c\u5f52\u6863\u901f\u5ea6\u4e0d\u540c\u3002 \u4ea4\u6613-\u6709\u5f52\u6863\u8868\uff08\u67e5\u8be2\u3001\u65b0\u589e\u3001\u66f4\u65b0\uff09 \u7279\u70b9: \u552f\u4e00\u952e\u6709\u5916\u90e8\u5355\u53f7\uff0c\u8ba2\u5355\u89c4\u5219\u968f\u673a\u65e0\u6cd5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u56e0\u6b64\u5fc5\u987b\u6709\u5f52\u6863\u8868\u3002 \u67e5\u8be2 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904\u7406 \u5b58\u5728\u4ee5\u4e0b\u90e8\u5206\u60c5\u51b5\u53ef\u505a\u7279\u6b8a\u5904\u7406\u51cf\u5c11\u6570\u636e\u5e93\u51b7\u5e93\u4f9d\u8d56\u3002 \u5355\u7b14\u67e5\u8be2\uff1a \u6839\u636e\u5916\u90e8\u5355\u53f7\u67e5\u8be2\uff0c\u5982\u679c\u67e5\u8be2\u7684 qps \u8f83\u9ad8\uff0c\u53ef\u4ee5\u67e5\u8be2\u51b7\u5e93\u524d\u4f7f\u7528\u5f52\u6863\u8868\u8fdb\u884c\u8fc7\u6ee4\u5224\u65ad\u3002 \u6839\u636e\u4ea4\u6613\u5355\u53f7\u67e5\u8be2\uff0c\u5982\u679c\u53ef\u4ee5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u67e5\u8be2\u51b7\u5e93\u524d\u4f7f\u7528\u5355\u53f7\u8fdb\u884c\u65f6\u95f4\u8303\u56f4\u8fc7\u6ee4\u3002 \u6279\u91cf\u67e5\u8be2\uff1a\u90e8\u5206\u529f\u80fd\u7ba1\u7406\u540e\u53f0\u529f\u80fd\u5206\u9875\u67e5\u8be2\uff0c\u5bf9\u6570\u636e\u67e5\u8be2\u8303\u56f4\u8981\u6c42\u8f83\u9ad8\u7684\u589e\u52a0\u51b7\u5e93\u67e5\u8be2\u903b\u8f91\u65f6\uff0c\u53ef\u4ee5\u589e\u52a0\u4f20\u5165\u7684\u67e5\u8be2\u65f6\u95f4\u8303\u56f4\u7684\u5f00\u59cb\u65f6\u95f4\u8fc7\u6ee4\u662f\u5426\u9700\u8981\u67e5\u8be2\u51b7\u5e93\uff0c\u9488\u5bf9\u51b7\u5e93\u70ed\u5e93\u90fd\u5b58\u5728\u60c5\u51b5\u65f6\u4f18\u5148\u4fdd\u7559\u70ed\u5e93\u6570\u636e\uff08\u53ea\u8fc7\u6ee4\u540c\u4e00\u5206\u9875\u5185\u7684\u76f8\u540c\u5355\u53f7\u6570\u636e\uff09\uff0c\u5982\u679c\u5bf9\u7ed3\u679c\u6709\u5f02\u8bae\u53ef\u4f7f\u7528\u5355\u53f7\u5355\u72ec\u518d\u6b21\u67e5\u8be2\u8fd4\u56de\u6700\u65b0\u518d\u6b21\u786e\u8ba4\u3002\u8ddf\u4ea7\u54c1\u548c\u8fd0\u8425\u786e\u8ba4\u80fd\u4e0d\u652f\u6301\u7684\u5c31\u4ec5\u67e5\u8be2\u70ed\u5e93\u3002 \u66f4\u65b0 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904\u7406 \u63d2\u5165 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904 \u652f\u4ed8-\u65e0\u5f52\u6863\u8868\uff08\u67e5\u8be2\u3001\u65b0\u589e\u3001\u66f4\u65b0\uff09 \u7279\u70b9: \u552f\u4e00\u952e\u90fd\u4e3a\u5185\u90e8\u5355\u53f7\uff0c\u73b0\u6709\u4e3b\u8981\u67e5\u8be2\u53ef\u4ee5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u4e0d\u9700\u8981\u5f52\u6863\u8868\uff0c\u53ef\u4ee5\u5f7b\u5e95\u89e3\u51b3\u70ed\u5e93\u6570\u636e\u5e93\u5b58\u50a8\u95ee\u9898\u3002 \u67e5\u8be2 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904\u7406 \u5b58\u5728\u4ee5\u4e0b\u90e8\u5206\u60c5\u51b5\u53ef\u505a\u7279\u6b8a\u5904\u7406\u51cf\u5c11\u6570\u636e\u5e93\u51b7\u5e93\u4f9d\u8d56\u3002 \u5355\u7b14\u67e5\u8be2\uff1a \u6839\u636e\u652f\u4ed8\u5355\u53f7\u67e5\u8be2\uff0c\u5982\u679c\u53ef\u4ee5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u67e5\u8be2\u51b7\u5e93\u524d\u4f7f\u7528\u5355\u53f7\u8fdb\u884c\u65f6\u95f4\u8303\u56f4\u8fc7\u6ee4\u3002 \u6279\u91cf\u67e5\u8be2\uff1a \u6839\u636e\u4ea4\u6613\u5355\u53f7\u67e5\u8be2\uff0c\u5982\u679c\u53ef\u4ee5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u67e5\u8be2\u51b7\u5e93\u524d\u4f7f\u7528\u5355\u53f7\u8fdb\u884c\u65f6\u95f4\u8303\u56f4\u8fc7\u6ee4\u3002 \u90e8\u5206\u529f\u80fd\u7ba1\u7406\u540e\u53f0\u529f\u80fd\u5206\u9875\u67e5\u8be2\uff0c\u5bf9\u6570\u636e\u67e5\u8be2\u8303\u56f4\u8981\u6c42\u8f83\u9ad8\u7684\u589e\u52a0\u51b7\u5e93\u67e5\u8be2\u903b\u8f91\u65f6\uff0c\u53ef\u4ee5\u589e\u52a0\u4f20\u5165\u7684\u67e5\u8be2\u65f6\u95f4\u8303\u56f4\u7684\u5f00\u59cb\u65f6\u95f4\u8fc7\u6ee4\u662f\u5426\u9700\u8981\u67e5\u8be2\u51b7\u5e93\uff0c\u9488\u5bf9\u51b7\u5e93\u70ed\u5e93\u90fd\u5b58\u5728\u60c5\u51b5\u65f6\u4f18\u5148\u4fdd\u7559\u70ed\u5e93\u6570\u636e\uff08\u53ea\u8fc7\u6ee4\u540c\u4e00\u5206\u9875\u5185\u7684\u76f8\u540c\u5355\u53f7\u6570\u636e\uff09\uff0c\u5982\u679c\u5bf9\u7ed3\u679c\u6709\u5f02\u8bae\u53ef\u4f7f\u7528\u5355\u53f7\u5355\u72ec\u518d\u6b21\u67e5\u8be2\u8fd4\u56de\u6700\u65b0\u518d\u6b21\u786e\u8ba4\u3002\u8ddf\u4ea7\u54c1\u548c\u8fd0\u8425\u786e\u8ba4\u80fd\u4e0d\u652f\u6301\u7684\u5c31\u4ec5\u67e5\u8be2\u70ed\u5e93\u3002 \u66f4\u65b0 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904\u7406 \u63d2\u5165 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904 \u603b\u7ed3 \u652f\u4ed8\u56e0\u6ca1\u6709\u5f52\u6863\u8868\u5f7b\u5e95\u89e3\u51b3\u4e86\u6570\u636e\u5e93\u5b58\u50a8\u538b\u529b\u95ee\u9898\uff0c\u5927\u5927\u7684\u8282\u7701\u4e86\u6570\u636e\u5e93\u5b58\u50a8\u8d44\u6e90\u3002 \u4ea4\u6613\u56e0\u65b0\u589e\u4e86\u5f52\u6863\u8868\uff0c\u5927\u5927\u5ef6\u7f13\u4e86\u70ed\u5e93\u6570\u636e\u5e93\u5b58\u50a8\u538b\u529b\uff0c\u4e3a\u4ea4\u6613\u6570\u636e\u5e93\u53c8\u989d\u5916\u63d0\u4f9b\u4e86\u7f13\u51b2\u6269\u5bb9\u65f6\u95f4\uff0c\u4e3a\u540e\u7eed\u518d\u6b21\u4f18\u5316\u5f7b\u5e95\u4ea4\u6613\u89e3\u51b3\u6570\u636e\u5e93\u5b58\u50a8\u95ee\u9898\u63d0\u4f9b\u4e86\u5145\u8db3\u7684\u65f6\u95f4\u3002 \u6210\u679c \u5f7b\u5e95\u89e3\u51b3\u4e86\u652f\u4ed8\u6570\u636e\u5e93\u5b58\u50a8\u538b\u529b\u95ee\u9898\uff0c\u6709\u6548\u7684\u7f13\u89e3\u4e86\u4ea4\u6613\u6570\u636e\u5e93\u70ed\u5e93\u7684\u5b58\u50a8\u538b\u529b\u3002 \u6570\u636e\u5e93\u70ed\u5e93\u4fdd\u7559\u5929\u6570\u53ef\u7075\u6d3b\u8c03\u63a7\uff0c\u53ef\u4ee5\u6839\u636e\u540e\u7eed\u8ba2\u5355\u91cf\u8fdb\u884c\u5408\u7406\u8c03\u6574\u5b58\u50a8\u53ef\u7528\u5929\u6570\u3002 \u7f3a\u70b9 \u4ea4\u6613\u91c7\u7528\u65b9\u6848\u4e8c\u65b0\u589e\u4e86\u5f52\u6863\u8868\uff0c\u5e76\u4e14\u5f52\u6863\u8868\u91cc\u7684\u5b58\u50a8\u7684\u5168\u91cf\u6570\u636e\uff0c\u4ec5\u80fd\u51cf\u7f13\u4ea4\u6613\u548c\u652f\u4ed8\u6570\u636e\u5e93\u7684\u5b58\u50a8\u7a7a\u95f4\u7d27\u5f20\u60c5\u51b5\uff0c\u65e0\u6cd5\u5f7b\u5e95\u89e3\u51b3\u6570\u636e\u5e93\u5b58\u50a8\u95ee\u9898\u3002 \u4ea4\u6613\u8868\u91ca\u653e\u7684 datafree \u5b58\u50a8\u7a7a\u95f4\u65e0\u6cd5\u63d0\u4f9b\u7ed9\u5f52\u6863\u8868\u4f7f\u7528\uff0c\u4ec5\u80fd\u4ea4\u6613\u8868\u4f7f\u7528\uff0c\u9700\u8981\u4e0d\u5b9a\u671f\u91ca\u653e\u4ea4\u6613\u8868\u7684 datafree \u7a7a\u95f4\u3002","title":"\u6570\u636e\u51b7\u70ed\u5206\u79bb(bytedance)"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_1","text":"\u968f\u7740\u8d22\u7ecf\u652f\u4ed8\u4e1a\u52a1\u7684\u5feb\u901f\u53d1\u5c55\uff0c\u8003\u8651\u5230\u672a\u6765\u8ba2\u5355\u91cf\u6301\u7eed\u589e\u957f\uff0c\u5728\u7ebf\u5b58\u50a8\u9047\u5230\u66f4\u5927\u7684\u6311\u6218\uff0c\u9700\u63d0\u524d\u505a\u597d\u89c4\u5212\u3002\u76ee\u524d\u8d22\u7ecf\u652f\u4ed8\u4e3b\u8981\u4e1a\u52a1\u90fd\u662f\u4f7f\u7528 mysql\uff08InnoDB\uff09\u4f5c\u4e3a\u6570\u636e\u5b58\u50a8\uff0c\u56e0\u5386\u53f2\u8ba2\u5355\u4fe1\u606f\u8bbf\u95ee\u9891\u7387\u4f4e\u5e76\u5360\u7528\u4e86\u5927\u91cf\u6570\u636e\u5e93\u5b58\u50a8\u7a7a\u95f4\uff0c\u671f\u671b\u5c06\u5386\u53f2\u6570\u636e\u8ddf\u751f\u4ea7\u6700\u65b0\u4ea4\u6613\u6570\u636e\u8fdb\u884c\u5206\u79bb\uff0c\u5f53\u524d\u6570\u636e\u5e93\u4fdd\u7559\u6700\u8fd1\u4e00\u6bb5\u65f6\u95f4\u7684\u6570\u636e\u4f5c\u4e3a\u70ed\u5e93\uff0c\u5386\u53f2\u4ea4\u6613\u5b58\u5165\u53e6\u4e00\u4e2a\u6570\u636e\u5e93\u538b\u7f29\u5b58\u50a8\u4f5c\u4e3a\u51b7\u5e93(rocksdb)\uff0c\u5373\u6570\u636e\u5e93\u51b7\u70ed\u5206\u79bb\u3002\u6b64\u4e3e\u5c06\u4f1a\u6781\u5927\u7684\u8282\u7701\u6570\u636e\u5e93\u8bbe\u5907\u6210\u672c\uff0c\u51cf\u5c11\u56e0\u5728\u7ebf\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\u6269\u5bb9\u5bfc\u81f4\u505c\u670d\u4e0d\u53ef\u7528\u7684\u65f6\u957f\uff0c\u4ee5\u4e0b\u57fa\u4e8e\u8d22\u7ecf\u652f\u4ed8\u7684\u7edf\u4e00\u4ea4\u6613\u7cfb\u7edf\u73b0\u72b6\u505a\u7684\u76f8\u5173\u6848\u4f8b\u5206\u6790\u4ec5\u4f9b\u5927\u5bb6\u53c2\u8003\u3002","title":"\u80cc\u666f"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_2","text":"","title":"\u65b9\u6848"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_3","text":"","title":"\u6280\u672f\u9009\u578b"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_4","text":"","title":"\u67b6\u6784\u56fe"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_5","text":"\u56e0\u4e1a\u52a1\u573a\u666f\u6bd4\u8f83\u590d\u6742\uff0c\u5982\u679c\u6309\u7167\u4e1a\u52a1\u573a\u666f\u68b3\u7406\u5de5\u4f5c\u91cf\u5c06\u51e0\u4f55\u500d\u7684\u589e\u957f\uff0c\u6362\u79cd\u7ef4\u5ea6\uff0c\u6570\u636e\u5e93\u76f8\u5173\u7684\u64cd\u4f5c\u65e0\u975e\u5c31\u662f\u67e5\u8be2\u3001\u63d2\u5165\u3001\u66f4\u65b0\uff0c\u53ea\u8981\u80fd\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u5b9e\u73b0\u4fdd\u8bc1\u67e5\u8be2\u3001\u63d2\u5165\u3001\u66f4\u65b0\u8fd9\u4e9b\u6570\u636e\u5e93\u57fa\u672c\u64cd\u4f5c\u5728\u589e\u52a0\u51b7\u70ed\u5206\u79bb\u540e\u529f\u80fd\u4e0d\u53d7\u5f71\u54cd\u5373\u53ef\u3002\u8d22\u7ecf\u652f\u4ed8\u4ee3\u7801\u6709\u7edf\u4e00\u7684\u5206\u5c42\u89c4\u8303\uff0c\u5bf9\u6570\u636e\u5e93\u64cd\u4f5c\u5168\u90e8\u6536\u655b\u5c01\u88c5\u81f3\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\uff0c\u56e0\u6b64\u6bd4\u8f83\u597d\u6539\u9020\uff0c\u4e0d\u6269\u5bb9\u7684\u60c5\u51b5\u4e0b\uff0c\u70ed\u5e93\u9884\u8ba1\u4fdd\u7559\u6700\u8fd1 X \u5929\uff08\u65f6\u95f4\u53ef\u8c03\uff09\u6570\u636e\uff0c X \u5929\u524d\u7684\u6570\u636e\u5f52\u6863\u5230\u51b7\u5e93\u3002","title":"\u65b9\u6848\u5206\u6790"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_6","text":"\u65b9\u6848\u4e00\uff1a \u80fd\u591f\u5f7b\u5e95\u6570\u636e\u5e93\u5b58\u50a8\u538b\u529b\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4f46\u662f\u5bf9\u51b7\u5e93\u6027\u80fd\u8981\u6c42\u592a\u9ad8\uff0c\u5982\u679c\u6d89\u53ca\u7684\u63d2\u5165\u3001\u66f4\u65b0\u3001\u67e5\u8be2\u80fd\u591f\u6839\u636e\u5355\u53f7\u8fc7\u6ee4\u65f6\u95f4\uff0c\u964d\u4f4e\u5bf9\u51b7\u5e93\u7684\u4f9d\u8d56\u3002 \u65b9\u6848\u4e8c\uff1a \u9002\u7528\u4e8e\u51b7\u5e93\u6027\u80fd\u8f83\u4f4e\uff0c\u6d89\u53ca\u7684\u63d2\u5165\u3001\u66f4\u65b0\u3001\u67e5\u8be2\u5927\u90e8\u5206\u65e0\u6cd5\u6839\u636e\u5355\u53f7\u8fc7\u6ee4\u65f6\u95f4\u65f6\uff0c\u9700\u8981\u70ed\u5e93\u5f52\u6863\u8868\u4e2d\u8f6c\u8fc7\u6ee4\u3002 \u65b9\u6848\u4e09\uff1a \u5982\u679c\u7cfb\u7edf\u6d89\u53ca\u7684\u573a\u666f\u6bd4\u8f83\u7b80\u5355\uff0c\u5386\u53f2\u8ba2\u5355\u540e\u7eed\u4e5f\u65e0\u53d8\u66f4\uff0c\u53ef\u4ee5\u6309\u573a\u666f\u8fdb\u884c\u5f52\u6863\u3002","title":"\u65b9\u6848\u5bf9\u6bd4"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_7","text":"\u4ea4\u6613\uff1a \u4ea4\u6613\u8868\u8d1f\u8d23\u8bb0\u5f55\u5546\u6237\u8ba2\u5355\u4e0e\u8d22\u7ecf\u652f\u4ed8\u5185\u90e8\u8ba2\u5355\u7684\u6620\u5c04\u3001\u4ea4\u6613\u91d1\u989d\u3001\u4e70\u65b9\u548c\u5356\u65b9\u7b49\u91cd\u8981\u4fe1\u606f\uff0c\u6700\u91cd\u8981\u7684\u529f\u80fd\u662f\u9632\u6b62\u91cd\u590d\u4ea4\u6613\u3002\u4f46\u662f\u51b7\u5e93\u76f8\u6bd4\u70ed\u5e93\u6027\u80fd\u8f83\u4f4e\uff0c\u5546\u6237\u8ba2\u5355\u53f7\u65e0\u56fa\u5b9a\u89c4\u5219\uff0c\u65e0\u6cd5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\u8fc7\u6ee4\u51cf\u5c11\u51b7\u5e93\u538b\u529b\uff0c\u800c\u70ed\u5e93 cpu \u4f7f\u7528\u7387\u5f88\u4f4e\uff0c\u70ed\u5e93\u6570\u636e\u5e93\u8ba1\u7b97\u4e0d\u662f\u74f6\u9888\uff0c\u56e0\u6b64\u4ea4\u6613\u9009\u7528\u65b9\u6848\u4e8c\u3002\u4ea4\u6613\u5f52\u6863\u8868\u4e3b\u8981\u610f\u4e49\u5728\u4e8e\u51cf\u5c11\u5728\u7ebf\u4ea4\u6613\u5bf9\u51b7\u5e93\u7684\u4f9d\u8d56\u3002 \u652f\u4ed8\uff1a \u652f\u4ed8\u8868\u8d1f\u8d23\u4fdd\u5b58\u4ea4\u6613\u5355\u7528\u4e86\u4ec0\u4e48\u652f\u4ed8\u65b9\u5f0f\u3001\u8be5\u652f\u4ed8\u65b9\u5f0f\u9700\u8981\u6263\u591a\u5c11\u94b1\u3001\u4ece\u54ea\u91cc\u6263\u3001\u6263\u5230\u54ea\u91cc\u53bb\u7b49\u4fe1\u606f\uff0c\u6d89\u53ca\u7684\u8ba2\u5355\u67e5\u8be2\u3001\u66f4\u65b0\u3001\u63d2\u5165\u90fd\u53ef\u4ee5\u6839\u636e\u4ea4\u6613\u5355\u53f7\u6216\u8005\u652f\u4ed8\u5355\u53f7\u8fdb\u884c\u5224\u65ad\u65f6\u95f4\u51cf\u5c11\u5bf9\u51b7\u5e93\u7684\u67e5\u8be2\uff0c\u56e0\u6b64\u652f\u4ed8\u9009\u62e9\u65b9\u6848\u4e00\u3002","title":"\u65b9\u6848\u9009\u62e9"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_8","text":"\u4e3a\u4e86\u5145\u5206\u7684\u4fdd\u8bc1 0 \u4e8b\u6545\uff0c0 \u8d44\u635f\uff0c\u65b9\u6848\u8bbe\u8ba1\u65f6\uff0c\u63d0\u51fa\u4e86\u4ee5\u4e0b\u57fa\u672c\u539f\u5219\uff0c\u5728\u7814\u53d1\u3001\u6d4b\u8bd5\u3001\u4ee3\u7801\u8bc4\u5ba1\u65f6\u5747\u53c2\u8003\u4ee5\u4e0b\u57fa\u672c\u539f\u5219\u8fdb\u884c\u5c42\u5c42\u628a\u63a7\uff0c\u53ef\u4ee5\u6709\u6548\u7684\u907f\u514d\u751f\u4ea7\u4e8b\u6545\u7684\u53d1\u751f\u3002","title":"\u57fa\u672c\u539f\u5219"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_9","text":"\u70ed\u5e93\u5f52\u6863\u8868\u7684\u6240\u6709\u552f\u4e00\u952e\u5fc5\u987b\u8ddf\u8981\u5f52\u6863\u7684\u70ed\u5e93\u8868\u4fdd\u6301\u4e00\u81f4\u3002 \u70ed\u5e93\u5f52\u6863\u8bb0\u5f55\u5df2\u5b58\u5728\u7684\u8ba2\u5355\uff0c\u51b7\u5e93\u5fc5\u987b\u6709\u76f8\u5e94\u6570\u636e\uff0c \u51b7\u5e93\u63d2\u5165: \u5148 insert \u51b7\u5e93\u6210\u529f\u540e \u518d insert \u70ed\u5e93\u5f52\u6863\u8868 \u51b7\u5e93\u66f4\u65b0\uff1a\u66f4\u65b0\u51b7\u5e93\u6570\u636e\uff0c\u4f7f\u7528\u540c\u4e00\u4e2a\u4e8b\u52a1 \u5148 delete \u518d insert \u51b7\u5e93\u6570\u636e \u70ed\u5e93\u5220\u9664\uff1a\u5220\u9664\u70ed\u5e93\u6570\u636e\u65f6\u4f7f\u7528\u51b7\u5e93\u6570\u636e\u5f53 where \u6761\u4ef6\uff0c\u6240\u6709\u70ed\u5e93\u5b57\u6bb5\uff08\u5305\u542b ID\uff09\u6761\u4ef6\u90fd\u6ee1\u8db3\u540e\u624d\u80fd\u5220\u9664\u6210\u529f\u3002","title":"\u6570\u636e\u63d2\u5165\u552f\u4e00\u6027\uff1a"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_10","text":"\u51b7\u5e93\u65e0 update \u64cd\u4f5c\uff0c\u6240\u6709\u7684\u66f4\u65b0\u64cd\u4f5c\u5fc5\u987b\u5728\u70ed\u5e93\u8fdb\u884c\uff0c\u5982\u679c\u6570\u636e\u9700\u8981\u66f4\u65b0\u5e76\u4e14\u4ec5\u5728\u51b7\u5e93\u5b58\u5728\uff0c\u9700\u540c\u6b65\u5230\u70ed\u5e93\u540e\uff0c\u518d\u5728\u70ed\u5e93\u5b8c\u6210\u66f4\u65b0\u3002 \u51b7\u5e93\u70ed\u5e93\u6570\u636e\u540c\u65f6\u5b58\u5728\u65f6\uff0c\u4ee5\u70ed\u5e93\u6570\u636e\u4e3a\u51c6\u3002\u51b7\u5e93\u7684\u6570\u636e\u6765\u6e90\u53ea\u6709\u70ed\u5e93\u6570\u636e\u540c\u6b65\u5230\u51b7\u5e93\u3002 \u6570\u636e\u4ece\u51b7\u5e93\u540c\u6b65\u5230\u70ed\u5e93\u65f6\uff0c\u64cd\u4f5c\u5f52\u6863\u8868\u548c\u4ea4\u6613\u8868\u9700\u4fdd\u8bc1\u5728\u540c\u4e00\u4e2a\u662f\u4e8b\u52a1\u5185\u5b8c\u6210\uff0c\u6d89\u53ca\u5230\u7684\u67e5\u8be2\u5fc5\u987b\u4f7f\u7528\u5199\u5e93\u3002","title":"\u6570\u636e\u66f4\u65b0\u4e00\u81f4\u6027\uff1a"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_11","text":"\u5355\u7b14\u67e5\u8be2\uff1a \u67e5\u8be2\u70ed\u5e93\u6570\u636e\u4e0d\u5b58\u5728\u65f6\uff0c\u4e0d\u5b58\u5728\u518d\u6b21\u67e5\u8be2\u51b7\u5e93\uff08\u5982\u679c\u5355\u53f7\u4e2d\u53ef\u4ee5\u5224\u65ad\u8ba2\u5355\u65e5\u671f\uff0c\u53ef\u518d\u589e\u52a0\u4e00\u5c42\u65e5\u671f\u8fc7\u6ee4\uff0c\u51cf\u5c11\u51b7\u5e93\u67e5\u8be2\uff09 \u6279\u91cf\u67e5\u8be2\uff1a \u51b7\u5e93\u70ed\u5e93\u6570\u636e\u90fd\u5b58\u5728\u65f6\u4f18\u5148\u8fd4\u56de\u70ed\u5e93\u6570\u636e\u3002 \u6279\u91cf\u67e5\u8be2\uff1a \u5408\u5e76\u51b7\u70ed\u5e93\u6570\u636e\u540e\uff0c\u9700\u770b\u539f\u5148\u67e5\u8be2\u7684\u63a5\u53e3\u987a\u5e8f\u662f\u5426\u6709\u8981\u6c42\uff0c\u5982\u679c\u5bf9\u987a\u5e8f\u6709\u8981\u6c42\u5408\u5e76\u540e\u8fd8\u9700\u6392\u5e8f\u3002 \u51cf\u5c11\u51b7\u5e93\u538b\u529b\uff1a \u51b7\u5e93\u6027\u80fd\u8f83\u4f4e\uff0c\u7ebf\u4e0a\u5b9e\u65f6\u4ea4\u6613\u5c3d\u53ef\u80fd\u51cf\u5c11\u5bf9\u51b7\u5e93\u7684\u67e5\u8be2\u548c\u4f9d\u8d56\uff08\u53ef\u901a\u8fc7\u4ea4\u6613\u5355\u53f7\u4e2d\u7684\u65e5\u671f\u6216\u8005\u5f52\u6863\u8868\u8fdb\u884c\u8fc7\u6ee4\uff09\u3002 \u9650\u5236\u5929\u6570\u63a7\u5236\uff1a \u6570\u636e\u5e93\u4ea4\u4e92 \u5c42\u5929\u6570\u63a7\u5236 \u4e3a n\uff0c\u5f52\u6863\u4efb\u52a1\u63a7\u5236\u7684\u5929\u6570\u4e3a m\uff0c\u8981\u6c42 m>n\u3002\u4f8b\u5982\uff0cmode \u5c42 \u6709\u4e9b\u5224\u65ad\u8ba2\u5355\u8d85\u8fc7 n \u5929\u7684\u624d\u4f1a\u67e5\u8be2\u51b7\u5e93\uff0c\u5f52\u6863\u4efb\u52a1\u53ea\u5f52\u6863 m \u5929\u524d\u7684\u5386\u53f2\u6570\u636e\uff0c\u5206\u5f00\u63a7\u5236\u53ef\u4ee5\u9632\u6b62\u56e0\u8c03\u6574\u5f52\u6863\u5929\u6570\u5bfc\u81f4\u6570\u636e\u67e5\u4e0d\u5230\u60c5\u51b5\u3002","title":"\u6570\u636e\u67e5\u8be2\u51c6\u786e\u6027\uff1a"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_12","text":"","title":"\u5177\u4f53\u7ec6\u8282"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_13","text":"","title":"\u5f52\u6863\u8868\u7ed3\u6784"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_14","text":"\u4e00\u81f4\u6027\u5220\u9664 \u4f7f\u7528\u51b7\u5e93\u8bb0\u5f55\u7684\u6240\u6709\u5b57\u6bb5\u5f53\u4f5c\u5220\u9664\u70ed\u5e93\u7684 where \u6761\u4ef6\uff08\u5305\u542b\u81ea\u589e id\uff09,\u5220\u9664\u70ed\u5e93\u548c\u66f4\u65b0\u70ed\u5e93\u5f52\u6863\u72b6\u6001\u4e3a\u51b7\u5e93\u9700\u5728\u4e00\u4e2a\u4e8b\u7269\uff0c\u4efb\u4e00\u5931\u8d25\u5219\u56de\u6eda\u3002","title":"\u5f52\u6863\u8868\u72b6\u6001\u6d41\u8f6c"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_15","text":"\u5f52\u6863\u4efb\u52a1 \u67e5\u8be2\u70ed\u5e93\u8ba2\u5355\u8868 X \uff08\u65f6\u95f4\u53ef\u8c03\uff09\u5929\u524d\u7684\u8ba2\u5355\uff0c\u540c\u6b65\u70ed\u5e93\u8ba2\u5355\u5230\u51b7\u5e93\uff0c\u63d2\u5165\u70ed\u5e93\u5f52\u6863\u8868\uff0c\u5f52\u6863\u72b6\u6001\u4e3a\u5904\u7406\u4e2d\uff0c\u653e\u5165\u5ef6\u8fdf\u5220\u9664 mq \u6d88\u606f\u3002 \u5f52\u6863\u5220\u9664 TASK \u5e38\u9a7b\u670d\u52a1 TASK \u6d88\u8d39\u5220\u9664 mq \u6d88\u606f\uff0crpc \u8c03\u7528\u4ea4\u6613\u652f\u4ed8\u63d0\u4f9b\u7684\u5220\u9664\u63a5\u53e3\uff0c\u652f\u6301\u672c\u5730\u9650\u6d41\u80fd\u529b\u3002 \u515c\u5e95\u4efb\u52a1\uff1a \u4e3b\u8981\u529f\u80fd\uff1a \u67e5\u8be2\u70ed\u5e93\u5f52\u6863\u8868\u4e2d\u5904\u7406\u4e2d\u4fee\u6539\u65f6\u95f4\u8d85\u8fc7\u89c4\u5b9a\u65f6\u95f4\u7684\u8ba2\u5355\u5f3a\u5236\u6267\u884c\u5220\u9664\u64cd\u4f5c\u3002\u4e3b\u8981\u7528\u6765\u9632\u6b62 mq \u5f02\u5e38\u6216\u8005\u65e5\u5e38\u4e22\u5931\u6d88\u606f\u65f6\uff0c\u4f7f\u7528\u515c\u5e95\u4efb\u52a1\u53ef\u4ee5\u8865\u507f\u6d88\u5316\u5904\u7406\u4e2d\u7684\u5f52\u6863\u8bb0\u5f55\u3002 \u6267\u884c\u903b\u8f91 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 \u6570\u636e\u5f52\u6863\u4efb\u52a1 \uff08 \u6bcf\u5929\u542f\u52a8\u4e00\u6b21 \uff09 for { \u521d\u59cb\u5316\u67e5\u8be2\u65f6\u95f4\u8303\u56f4\u548c\u5206\u9875 for { \u67e5\u8be2 X \u5929\u524d\u4ea4\u6613\u5355 limit 1000 ( \u7d22\u5f15\u6392\u5e8f \uff0c \u6eda\u52a8\u65f6\u95f4\u67e5\u8be2 ) if \u8bb0\u5f55\u5b58\u5728 \u5e76\u4e14 \u6761\u6570 = 1000 { for \u5bf9\u4e8e\u6bcf\u6761\u8bb0\u5f55 { // \u542f\u7528x\u4e2a\u534f\u7a0b\u5904\u7406 \u4ea4\u6613\u5355\u5e42\u7b49\u5199\u5165\u51b7\u5e93 \uff08 \u4e0d\u4fdd\u8bc1\u6700\u65b0 \uff0c \u53ea\u4fdd\u8bc1\u51b7\u5e93\u6570\u636e\u5b58\u5728\u6027 \uff09 \u5e42\u7b49\u5199\u5f52\u6863\u8bb0\u5f55\u8868 \uff08 type : PROCESSING \uff0c \u70ed\u5e93\u6570\u636e\u5220\u9664\u65f6\u518d\u66f4\u65b0\u4e3aCOLD \uff0c \u5f52\u6863\u8bb0\u5f55\u5df2\u5b58\u5728HOT\u72b6\u6001\u66f4\u65b0\u4e3aPROCESSING \uff09 \u53d1MQ\u5ef6\u8fdf\u6d88\u606f \uff0c X min \uff08 \u53ef\u914d\u7f6e \uff09 \u540e\u5220\u9664\u70ed\u5e93\u6570\u636e } } if \u6761\u6570 = 1000 { continue } \u65f6\u95f4\u8303\u56f4\u5f80\u4e0b\u63a8\u8fdb //\u8bb0\u5f55\u4e0d\u5b58\u5728 if \u7ed3\u675f\u65f6\u95f4\u8d85\u8fc7\u89c4\u5b9a\u65f6\u95f4 { break ( \u8df3\u51fa\u5faa\u73af \uff0c \u4efb\u52a1\u7ed3\u675f ) } redis\u8bb0\u5f55\u5f53\u524d\u67e5\u8be2\u6761\u4ef6 \uff0c \u65b9\u4fbf\u540e\u7eed\u4efb\u52a1\u91cd\u8dd1\u6062\u590d\u7ee7\u7eed } } \u5220\u9664\u70ed\u5e93\u6570\u636e \uff0c \u6d88\u8d39MQ \u6d88\u8d39MQ\u8bb0\u5f55 { \u67e5\u8be2\u51b7\u5e93 \u6570\u636e\u4e00\u81f4\u6027\u5220\u9664 \uff08 \u5f00\u542f\u4e8b\u52a1 \u6761\u4ef6\u5220\u9664\u70ed\u5e93\u6570\u636e \uff0c \u66f4\u65b0\u5f52\u6863\u8bb0\u5f55\u8868\u72b6\u6001\u4e3aCOLD \u7ed3\u675f\u4e8b\u52a1 \uff09 \u4e00\u81f4\u6027\u5220\u9664\u70ed\u5e93\u5931\u8d25 \uff0c \u540c\u6b65\u70ed\u5e93\u6570\u636e\u5230\u51b7\u5e93 \uff0c \u6570\u636e\u4e00\u81f4\u6027\u5220\u9664 } \u515c\u5e95\u8865\u507f\u4efb\u52a1 \uff08 \u6bcf30\u5206\u949f\u542f\u52a8\u4e00\u6b21 \uff09 { \u67e5\u8be2\u5f52\u6863\u8bb0\u5f55\u8868\u4e2d\u72b6\u6001\u4e3aPROCESSING \uff0c \u4fee\u6539\u65f6\u95f4\u4e3aX + Y min\u524d\u7684\u8bb0\u5f55 limit 1000 if \u4e0d\u5b58\u5728 { break } for \u5bf9\u4e8e\u6bcf\u6761\u8bb0\u5f55 \u67e5\u8be2\u51b7\u5e93 \u6570\u636e\u4e00\u81f4\u6027\u5220\u9664 \uff08 \u5f00\u542f\u4e8b\u52a1 \u6761\u4ef6\u5220\u9664\u70ed\u5e93\u6570\u636e \uff0c \u66f4\u65b0\u5f52\u6863\u8bb0\u5f55\u8868\u72b6\u6001\u4e3aCOLD \u7ed3\u675f\u4e8b\u52a1 \uff09 \u4e00\u81f4\u6027\u5220\u9664\u70ed\u5e93\u5931\u8d25 \uff0c \u540c\u6b65\u70ed\u5e93\u6570\u636e\u5230\u51b7\u5e93 \uff0c \u6570\u636e\u4e00\u81f4\u6027\u5220\u9664 } } \u5f52\u6863\u4efb\u52a1\u67e5\u8be2\u65f6\u95f4\u6eda\u52a8\u673a\u5236\uff1a \u65f6\u95f4\u8303\u56f4\u7b2c\u4e00\u6b21\u8d77\u59cb\u65f6\u95f4\u4e3a\u56fa\u5b9a\u65e5\u671f\uff08\u8d22\u7ecf\u652f\u4ed8\u8ba2\u5355\u6700\u65e9\u70b9\u65e5\u671f\uff09\uff0c\u7ed3\u675f\u65f6\u95f4\u4e3a\u6307\u5b9a\u65e5\u671f\uff0c\u4e0b\u6b21\u5f00\u59cb\u65f6\u95f4\u7b49\u4e8e\u4e0a\u6b21\u7ed3\u675f\u65f6\u95f4\uff0c\u7ed3\u675f\u65f6\u95f4\u4e3a\u4e0a\u6b21\u7ed3\u675f\u65f6\u95f4\u52a0\u4e0a\u6307\u5b9a\u65f6\u95f4\u8303\u56f4\uff09\u3002\u6bcf\u6b21\u67e5\u8be2\u4e0b\u4e00\u4e2a\u65f6\u95f4\u7a97\u53e3\u65f6 redis \u4fdd\u5b58\u4fe1\u606f\uff0c\u6307\u5b9a\u65e5\u671f\uff0c\u5f53\u5929\u4efb\u52a1\u7684\u65f6\u95f4\u8303\u56f4\uff0c\u5206\u9875\u6570\u3002 \u5f52\u6863\u4efb\u52a1\u5e76\u53d1\u5904\u7406\uff1a \u9700\u652f\u6301\u591a\u4efb\u52a1\u5206\u7247\u5e76\u53d1\u5904\u7406 \u63d0\u5347\u5168\u5929\u5f52\u6863\u8ba2\u5355\u91cf\uff1a \u4e3a\u4e86\u4e0d\u5f71\u54cd\u5728\u7ebf\u4ea4\u6613\uff0c\u5168\u5929 24 \u5c0f\u65f6 \u533a\u5206 \u4ea4\u6613\u9ad8\u5cf0\u3001\u4f4e\u5cf0\u3001\u65e5\u5e38 \u4e09\u4e2a\u4e0d\u540c\u65f6\u95f4\u6bb5\uff0c\u5f52\u6863\u901f\u5ea6\u4e0d\u540c\u3002","title":"\u4ea4\u6613\u53ca\u652f\u4ed8\u4efb\u52a1\uff08\u6570\u636e\u5f52\u6863\u3001\u5220\u9664\u3001\u515c\u5e95\uff09"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#-","text":"\u7279\u70b9: \u552f\u4e00\u952e\u6709\u5916\u90e8\u5355\u53f7\uff0c\u8ba2\u5355\u89c4\u5219\u968f\u673a\u65e0\u6cd5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u56e0\u6b64\u5fc5\u987b\u6709\u5f52\u6863\u8868\u3002 \u67e5\u8be2 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904\u7406 \u5b58\u5728\u4ee5\u4e0b\u90e8\u5206\u60c5\u51b5\u53ef\u505a\u7279\u6b8a\u5904\u7406\u51cf\u5c11\u6570\u636e\u5e93\u51b7\u5e93\u4f9d\u8d56\u3002 \u5355\u7b14\u67e5\u8be2\uff1a \u6839\u636e\u5916\u90e8\u5355\u53f7\u67e5\u8be2\uff0c\u5982\u679c\u67e5\u8be2\u7684 qps \u8f83\u9ad8\uff0c\u53ef\u4ee5\u67e5\u8be2\u51b7\u5e93\u524d\u4f7f\u7528\u5f52\u6863\u8868\u8fdb\u884c\u8fc7\u6ee4\u5224\u65ad\u3002 \u6839\u636e\u4ea4\u6613\u5355\u53f7\u67e5\u8be2\uff0c\u5982\u679c\u53ef\u4ee5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u67e5\u8be2\u51b7\u5e93\u524d\u4f7f\u7528\u5355\u53f7\u8fdb\u884c\u65f6\u95f4\u8303\u56f4\u8fc7\u6ee4\u3002 \u6279\u91cf\u67e5\u8be2\uff1a\u90e8\u5206\u529f\u80fd\u7ba1\u7406\u540e\u53f0\u529f\u80fd\u5206\u9875\u67e5\u8be2\uff0c\u5bf9\u6570\u636e\u67e5\u8be2\u8303\u56f4\u8981\u6c42\u8f83\u9ad8\u7684\u589e\u52a0\u51b7\u5e93\u67e5\u8be2\u903b\u8f91\u65f6\uff0c\u53ef\u4ee5\u589e\u52a0\u4f20\u5165\u7684\u67e5\u8be2\u65f6\u95f4\u8303\u56f4\u7684\u5f00\u59cb\u65f6\u95f4\u8fc7\u6ee4\u662f\u5426\u9700\u8981\u67e5\u8be2\u51b7\u5e93\uff0c\u9488\u5bf9\u51b7\u5e93\u70ed\u5e93\u90fd\u5b58\u5728\u60c5\u51b5\u65f6\u4f18\u5148\u4fdd\u7559\u70ed\u5e93\u6570\u636e\uff08\u53ea\u8fc7\u6ee4\u540c\u4e00\u5206\u9875\u5185\u7684\u76f8\u540c\u5355\u53f7\u6570\u636e\uff09\uff0c\u5982\u679c\u5bf9\u7ed3\u679c\u6709\u5f02\u8bae\u53ef\u4f7f\u7528\u5355\u53f7\u5355\u72ec\u518d\u6b21\u67e5\u8be2\u8fd4\u56de\u6700\u65b0\u518d\u6b21\u786e\u8ba4\u3002\u8ddf\u4ea7\u54c1\u548c\u8fd0\u8425\u786e\u8ba4\u80fd\u4e0d\u652f\u6301\u7684\u5c31\u4ec5\u67e5\u8be2\u70ed\u5e93\u3002 \u66f4\u65b0 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904\u7406 \u63d2\u5165 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904","title":"\u4ea4\u6613-\u6709\u5f52\u6863\u8868\uff08\u67e5\u8be2\u3001\u65b0\u589e\u3001\u66f4\u65b0\uff09"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#-_1","text":"\u7279\u70b9: \u552f\u4e00\u952e\u90fd\u4e3a\u5185\u90e8\u5355\u53f7\uff0c\u73b0\u6709\u4e3b\u8981\u67e5\u8be2\u53ef\u4ee5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u4e0d\u9700\u8981\u5f52\u6863\u8868\uff0c\u53ef\u4ee5\u5f7b\u5e95\u89e3\u51b3\u70ed\u5e93\u6570\u636e\u5e93\u5b58\u50a8\u95ee\u9898\u3002 \u67e5\u8be2 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904\u7406 \u5b58\u5728\u4ee5\u4e0b\u90e8\u5206\u60c5\u51b5\u53ef\u505a\u7279\u6b8a\u5904\u7406\u51cf\u5c11\u6570\u636e\u5e93\u51b7\u5e93\u4f9d\u8d56\u3002 \u5355\u7b14\u67e5\u8be2\uff1a \u6839\u636e\u652f\u4ed8\u5355\u53f7\u67e5\u8be2\uff0c\u5982\u679c\u53ef\u4ee5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u67e5\u8be2\u51b7\u5e93\u524d\u4f7f\u7528\u5355\u53f7\u8fdb\u884c\u65f6\u95f4\u8303\u56f4\u8fc7\u6ee4\u3002 \u6279\u91cf\u67e5\u8be2\uff1a \u6839\u636e\u4ea4\u6613\u5355\u53f7\u67e5\u8be2\uff0c\u5982\u679c\u53ef\u4ee5\u6839\u636e\u5355\u53f7\u5224\u65ad\u65f6\u95f4\uff0c\u67e5\u8be2\u51b7\u5e93\u524d\u4f7f\u7528\u5355\u53f7\u8fdb\u884c\u65f6\u95f4\u8303\u56f4\u8fc7\u6ee4\u3002 \u90e8\u5206\u529f\u80fd\u7ba1\u7406\u540e\u53f0\u529f\u80fd\u5206\u9875\u67e5\u8be2\uff0c\u5bf9\u6570\u636e\u67e5\u8be2\u8303\u56f4\u8981\u6c42\u8f83\u9ad8\u7684\u589e\u52a0\u51b7\u5e93\u67e5\u8be2\u903b\u8f91\u65f6\uff0c\u53ef\u4ee5\u589e\u52a0\u4f20\u5165\u7684\u67e5\u8be2\u65f6\u95f4\u8303\u56f4\u7684\u5f00\u59cb\u65f6\u95f4\u8fc7\u6ee4\u662f\u5426\u9700\u8981\u67e5\u8be2\u51b7\u5e93\uff0c\u9488\u5bf9\u51b7\u5e93\u70ed\u5e93\u90fd\u5b58\u5728\u60c5\u51b5\u65f6\u4f18\u5148\u4fdd\u7559\u70ed\u5e93\u6570\u636e\uff08\u53ea\u8fc7\u6ee4\u540c\u4e00\u5206\u9875\u5185\u7684\u76f8\u540c\u5355\u53f7\u6570\u636e\uff09\uff0c\u5982\u679c\u5bf9\u7ed3\u679c\u6709\u5f02\u8bae\u53ef\u4f7f\u7528\u5355\u53f7\u5355\u72ec\u518d\u6b21\u67e5\u8be2\u8fd4\u56de\u6700\u65b0\u518d\u6b21\u786e\u8ba4\u3002\u8ddf\u4ea7\u54c1\u548c\u8fd0\u8425\u786e\u8ba4\u80fd\u4e0d\u652f\u6301\u7684\u5c31\u4ec5\u67e5\u8be2\u70ed\u5e93\u3002 \u66f4\u65b0 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904\u7406 \u63d2\u5165 \u903b\u8f91\u5728\u6570\u636e\u5e93\u4ea4\u4e92\u5c42\u7edf\u4e00\u5b9e\u73b0\u5904","title":"\u652f\u4ed8-\u65e0\u5f52\u6863\u8868\uff08\u67e5\u8be2\u3001\u65b0\u589e\u3001\u66f4\u65b0\uff09"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_16","text":"\u652f\u4ed8\u56e0\u6ca1\u6709\u5f52\u6863\u8868\u5f7b\u5e95\u89e3\u51b3\u4e86\u6570\u636e\u5e93\u5b58\u50a8\u538b\u529b\u95ee\u9898\uff0c\u5927\u5927\u7684\u8282\u7701\u4e86\u6570\u636e\u5e93\u5b58\u50a8\u8d44\u6e90\u3002 \u4ea4\u6613\u56e0\u65b0\u589e\u4e86\u5f52\u6863\u8868\uff0c\u5927\u5927\u5ef6\u7f13\u4e86\u70ed\u5e93\u6570\u636e\u5e93\u5b58\u50a8\u538b\u529b\uff0c\u4e3a\u4ea4\u6613\u6570\u636e\u5e93\u53c8\u989d\u5916\u63d0\u4f9b\u4e86\u7f13\u51b2\u6269\u5bb9\u65f6\u95f4\uff0c\u4e3a\u540e\u7eed\u518d\u6b21\u4f18\u5316\u5f7b\u5e95\u4ea4\u6613\u89e3\u51b3\u6570\u636e\u5e93\u5b58\u50a8\u95ee\u9898\u63d0\u4f9b\u4e86\u5145\u8db3\u7684\u65f6\u95f4\u3002","title":"\u603b\u7ed3"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_17","text":"\u5f7b\u5e95\u89e3\u51b3\u4e86\u652f\u4ed8\u6570\u636e\u5e93\u5b58\u50a8\u538b\u529b\u95ee\u9898\uff0c\u6709\u6548\u7684\u7f13\u89e3\u4e86\u4ea4\u6613\u6570\u636e\u5e93\u70ed\u5e93\u7684\u5b58\u50a8\u538b\u529b\u3002 \u6570\u636e\u5e93\u70ed\u5e93\u4fdd\u7559\u5929\u6570\u53ef\u7075\u6d3b\u8c03\u63a7\uff0c\u53ef\u4ee5\u6839\u636e\u540e\u7eed\u8ba2\u5355\u91cf\u8fdb\u884c\u5408\u7406\u8c03\u6574\u5b58\u50a8\u53ef\u7528\u5929\u6570\u3002","title":"\u6210\u679c"},{"location":"Work/byte%20dance%20%E6%95%B0%E6%8D%AE%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/#_18","text":"\u4ea4\u6613\u91c7\u7528\u65b9\u6848\u4e8c\u65b0\u589e\u4e86\u5f52\u6863\u8868\uff0c\u5e76\u4e14\u5f52\u6863\u8868\u91cc\u7684\u5b58\u50a8\u7684\u5168\u91cf\u6570\u636e\uff0c\u4ec5\u80fd\u51cf\u7f13\u4ea4\u6613\u548c\u652f\u4ed8\u6570\u636e\u5e93\u7684\u5b58\u50a8\u7a7a\u95f4\u7d27\u5f20\u60c5\u51b5\uff0c\u65e0\u6cd5\u5f7b\u5e95\u89e3\u51b3\u6570\u636e\u5e93\u5b58\u50a8\u95ee\u9898\u3002 \u4ea4\u6613\u8868\u91ca\u653e\u7684 datafree \u5b58\u50a8\u7a7a\u95f4\u65e0\u6cd5\u63d0\u4f9b\u7ed9\u5f52\u6863\u8868\u4f7f\u7528\uff0c\u4ec5\u80fd\u4ea4\u6613\u8868\u4f7f\u7528\uff0c\u9700\u8981\u4e0d\u5b9a\u671f\u91ca\u653e\u4ea4\u6613\u8868\u7684 datafree \u7a7a\u95f4\u3002","title":"\u7f3a\u70b9"}]}